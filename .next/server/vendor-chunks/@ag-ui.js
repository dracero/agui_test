"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "vendor-chunks/@ag-ui";
exports.ids = ["vendor-chunks/@ag-ui"];
exports.modules = {

/***/ "(rsc)/./node_modules/@ag-ui/client/dist/index.mjs":
/*!***************************************************!*\
  !*** ./node_modules/@ag-ui/client/dist/index.mjs ***!
  \***************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AGUIError: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.AGUIError),\n/* harmony export */   AbstractAgent: () => (/* binding */ G),\n/* harmony export */   AssistantMessageSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.AssistantMessageSchema),\n/* harmony export */   BaseEventSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.BaseEventSchema),\n/* harmony export */   BaseMessageSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.BaseMessageSchema),\n/* harmony export */   ContextSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.ContextSchema),\n/* harmony export */   CustomEventSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.CustomEventSchema),\n/* harmony export */   DeveloperMessageSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.DeveloperMessageSchema),\n/* harmony export */   EventSchemas: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventSchemas),\n/* harmony export */   EventType: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType),\n/* harmony export */   FunctionCallSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.FunctionCallSchema),\n/* harmony export */   HttpAgent: () => (/* binding */ q),\n/* harmony export */   MessageSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.MessageSchema),\n/* harmony export */   MessagesSnapshotEventSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.MessagesSnapshotEventSchema),\n/* harmony export */   RawEventSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.RawEventSchema),\n/* harmony export */   RoleSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.RoleSchema),\n/* harmony export */   RunAgentInputSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.RunAgentInputSchema),\n/* harmony export */   RunErrorEventSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.RunErrorEventSchema),\n/* harmony export */   RunFinishedEventSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.RunFinishedEventSchema),\n/* harmony export */   RunStartedEventSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.RunStartedEventSchema),\n/* harmony export */   StateDeltaEventSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.StateDeltaEventSchema),\n/* harmony export */   StateSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.StateSchema),\n/* harmony export */   StateSnapshotEventSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.StateSnapshotEventSchema),\n/* harmony export */   StepFinishedEventSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.StepFinishedEventSchema),\n/* harmony export */   StepStartedEventSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.StepStartedEventSchema),\n/* harmony export */   SystemMessageSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.SystemMessageSchema),\n/* harmony export */   TextMessageChunkEventSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.TextMessageChunkEventSchema),\n/* harmony export */   TextMessageContentEventSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.TextMessageContentEventSchema),\n/* harmony export */   TextMessageEndEventSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.TextMessageEndEventSchema),\n/* harmony export */   TextMessageStartEventSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.TextMessageStartEventSchema),\n/* harmony export */   ThinkingEndEventSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.ThinkingEndEventSchema),\n/* harmony export */   ThinkingStartEventSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.ThinkingStartEventSchema),\n/* harmony export */   ThinkingTextMessageContentEventSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.ThinkingTextMessageContentEventSchema),\n/* harmony export */   ThinkingTextMessageEndEventSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.ThinkingTextMessageEndEventSchema),\n/* harmony export */   ThinkingTextMessageStartEventSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.ThinkingTextMessageStartEventSchema),\n/* harmony export */   ToolCallArgsEventSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.ToolCallArgsEventSchema),\n/* harmony export */   ToolCallChunkEventSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.ToolCallChunkEventSchema),\n/* harmony export */   ToolCallEndEventSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.ToolCallEndEventSchema),\n/* harmony export */   ToolCallResultEventSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.ToolCallResultEventSchema),\n/* harmony export */   ToolCallSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.ToolCallSchema),\n/* harmony export */   ToolCallStartEventSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.ToolCallStartEventSchema),\n/* harmony export */   ToolMessageSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.ToolMessageSchema),\n/* harmony export */   ToolSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.ToolSchema),\n/* harmony export */   UserMessageSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.UserMessageSchema),\n/* harmony export */   convertToLegacyEvents: () => (/* binding */ $),\n/* harmony export */   defaultApplyEvents: () => (/* binding */ K),\n/* harmony export */   parseProtoStream: () => (/* binding */ B),\n/* harmony export */   parseSSEStream: () => (/* binding */ z),\n/* harmony export */   runHttpRequest: () => (/* binding */ j),\n/* harmony export */   transformHttpEventStream: () => (/* binding */ J),\n/* harmony export */   verifyEvents: () => (/* binding */ U)\n/* harmony export */ });\n/* harmony import */ var _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @ag-ui/core */ \"(rsc)/./node_modules/@ag-ui/core/dist/index.mjs\");\n/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! rxjs/operators */ \"(rsc)/./node_modules/rxjs/dist/cjs/operators/index.js\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! rxjs */ \"(rsc)/./node_modules/rxjs/dist/esm5/internal/observable/of.js\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! rxjs */ \"(rsc)/./node_modules/rxjs/dist/esm5/internal/observable/empty.js\");\n/* harmony import */ var fast_json_patch__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! fast-json-patch */ \"(rsc)/./node_modules/fast-json-patch/index.mjs\");\n/* harmony import */ var untruncate_json__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! untruncate-json */ \"(rsc)/./node_modules/untruncate-json/dist/esm/index.js\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! rxjs */ \"(rsc)/./node_modules/rxjs/dist/esm5/internal/observable/throwError.js\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! rxjs */ \"(rsc)/./node_modules/rxjs/dist/esm5/internal/Subject.js\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! rxjs */ \"(rsc)/./node_modules/rxjs/dist/esm5/internal/ReplaySubject.js\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! rxjs */ \"(rsc)/./node_modules/rxjs/dist/esm5/internal/observable/defer.js\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! rxjs */ \"(rsc)/./node_modules/rxjs/dist/esm5/internal/observable/from.js\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! rxjs */ \"(rsc)/./node_modules/rxjs/dist/esm5/internal/Observable.js\");\n/* harmony import */ var _ag_ui_proto__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! @ag-ui/proto */ \"(rsc)/./node_modules/@ag-ui/proto/dist/index.mjs\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/zod/v3/types.js\");\n/* harmony import */ var uuid__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! uuid */ \"(rsc)/./node_modules/uuid/dist/esm/v4.js\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! rxjs */ \"(rsc)/./node_modules/rxjs/dist/esm5/internal/util/pipe.js\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! rxjs */ \"(rsc)/./node_modules/rxjs/dist/esm5/internal/lastValueFrom.js\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! rxjs */ \"(rsc)/./node_modules/rxjs/dist/esm5/internal/operators/mergeMap.js\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! rxjs */ \"(rsc)/./node_modules/rxjs/dist/esm5/internal/operators/finalize.js\");\nvar ne=Object.defineProperty,ae=Object.defineProperties;var se=Object.getOwnPropertyDescriptors;var W=Object.getOwnPropertySymbols;var oe=Object.prototype.hasOwnProperty,re=Object.prototype.propertyIsEnumerable;var V=(u,o,n)=>o in u?ne(u,o,{enumerable:!0,configurable:!0,writable:!0,value:n}):u[o]=n,L=(u,o)=>{for(var n in o||(o={}))oe.call(o,n)&&V(u,n,o[n]);if(W)for(var n of W(o))re.call(o,n)&&V(u,n,o[n]);return u},H=(u,o)=>ae(u,se(o));var C=u=>{if(typeof structuredClone==\"function\")return structuredClone(u);try{return JSON.parse(JSON.stringify(u))}catch(o){return L({},u)}};async function y(u,o,n,a){let e=o,s=n,l;for(let r of u)try{let i=await a(r,C(e),C(s));if(i===void 0)continue;if(i.messages!==void 0&&(e=i.messages),i.state!==void 0&&(s=i.state),l=i.stopPropagation,l===!0)break}catch(i){ false||process.env.JEST_WORKER_ID!==void 0||console.error(\"Subscriber error:\",i);continue}return L(L(L({},JSON.stringify(e)!==JSON.stringify(o)?{messages:e}:{}),JSON.stringify(s)!==JSON.stringify(n)?{state:s}:{}),l!==void 0?{stopPropagation:l}:{})}var K=(u,o,n,a)=>{let e=C(u.messages),s=C(u.state),l={},r=E=>{E.messages!==void 0&&(e=E.messages,l.messages=E.messages),E.state!==void 0&&(s=E.state,l.state=E.state)},i=()=>{let E=C(l);return l={},E.messages!==void 0||E.state!==void 0?(0,rxjs__WEBPACK_IMPORTED_MODULE_2__.of)(E):rxjs__WEBPACK_IMPORTED_MODULE_3__.EMPTY};return o.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_4__.concatMap)(async E=>{var d;let h=await y(a,e,s,(g,t,S)=>{var m;return(m=g.onEvent)==null?void 0:m.call(g,{event:E,agent:n,input:u,messages:t,state:S})});if(r(h),h.stopPropagation===!0)return i();switch(E.type){case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TEXT_MESSAGE_START:{let g=await y(a,e,s,(t,S,m)=>{var c;return(c=t.onTextMessageStartEvent)==null?void 0:c.call(t,{event:E,messages:S,state:m,agent:n,input:u})});if(r(g),g.stopPropagation!==!0){let{messageId:t,role:S=\"assistant\"}=E,m={id:t,role:S,content:\"\"};e.push(m),r({messages:e})}return i()}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TEXT_MESSAGE_CONTENT:{let{messageId:g,delta:t}=E,S=e.find(c=>c.id===g);if(!S)return console.warn(`TEXT_MESSAGE_CONTENT: No message found with ID '${g}'`),i();let m=await y(a,e,s,(c,T,x)=>{var O,P;return(P=c.onTextMessageContentEvent)==null?void 0:P.call(c,{event:E,messages:T,state:x,agent:n,input:u,textMessageBuffer:(O=S.content)!=null?O:\"\"})});return r(m),m.stopPropagation!==!0&&(S.content=(S.content||\"\")+t,r({messages:e})),i()}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TEXT_MESSAGE_END:{let{messageId:g}=E,t=e.find(m=>m.id===g);if(!t)return console.warn(`TEXT_MESSAGE_END: No message found with ID '${g}'`),i();let S=await y(a,e,s,(m,c,T)=>{var x,O;return(O=m.onTextMessageEndEvent)==null?void 0:O.call(m,{event:E,messages:c,state:T,agent:n,input:u,textMessageBuffer:(x=t.content)!=null?x:\"\"})});return r(S),await Promise.all(a.map(m=>{var c;(c=m.onNewMessage)==null||c.call(m,{message:t,messages:e,state:s,agent:n,input:u})})),i()}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TOOL_CALL_START:{let g=await y(a,e,s,(t,S,m)=>{var c;return(c=t.onToolCallStartEvent)==null?void 0:c.call(t,{event:E,messages:S,state:m,agent:n,input:u})});if(r(g),g.stopPropagation!==!0){let{toolCallId:t,toolCallName:S,parentMessageId:m}=E,c;m&&e.length>0&&e[e.length-1].id===m?c=e[e.length-1]:(c={id:m||t,role:\"assistant\",toolCalls:[]},e.push(c)),(d=c.toolCalls)!=null||(c.toolCalls=[]),c.toolCalls.push({id:t,type:\"function\",function:{name:S,arguments:\"\"}}),r({messages:e})}return i()}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TOOL_CALL_ARGS:{let{toolCallId:g,delta:t}=E,S=e.find(T=>{var x;return(x=T.toolCalls)==null?void 0:x.some(O=>O.id===g)});if(!S)return console.warn(`TOOL_CALL_ARGS: No message found containing tool call with ID '${g}'`),i();let m=S.toolCalls.find(T=>T.id===g);if(!m)return console.warn(`TOOL_CALL_ARGS: No tool call found with ID '${g}'`),i();let c=await y(a,e,s,(T,x,O)=>{var k;let P=m.function.arguments,F=m.function.name,D={};try{D=(0,untruncate_json__WEBPACK_IMPORTED_MODULE_5__[\"default\"])(P)}catch(qe){}return(k=T.onToolCallArgsEvent)==null?void 0:k.call(T,{event:E,messages:x,state:O,agent:n,input:u,toolCallBuffer:P,toolCallName:F,partialToolCallArgs:D})});return r(c),c.stopPropagation!==!0&&(m.function.arguments+=t,r({messages:e})),i()}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TOOL_CALL_END:{let{toolCallId:g}=E,t=e.find(c=>{var T;return(T=c.toolCalls)==null?void 0:T.some(x=>x.id===g)});if(!t)return console.warn(`TOOL_CALL_END: No message found containing tool call with ID '${g}'`),i();let S=t.toolCalls.find(c=>c.id===g);if(!S)return console.warn(`TOOL_CALL_END: No tool call found with ID '${g}'`),i();let m=await y(a,e,s,(c,T,x)=>{var D;let O=S.function.arguments,P=S.function.name,F={};try{F=JSON.parse(O)}catch(k){}return(D=c.onToolCallEndEvent)==null?void 0:D.call(c,{event:E,messages:T,state:x,agent:n,input:u,toolCallName:P,toolCallArgs:F})});return r(m),await Promise.all(a.map(c=>{var T;(T=c.onNewToolCall)==null||T.call(c,{toolCall:S,messages:e,state:s,agent:n,input:u})})),i()}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TOOL_CALL_RESULT:{let g=await y(a,e,s,(t,S,m)=>{var c;return(c=t.onToolCallResultEvent)==null?void 0:c.call(t,{event:E,messages:S,state:m,agent:n,input:u})});if(r(g),g.stopPropagation!==!0){let{messageId:t,toolCallId:S,content:m,role:c}=E,T={id:t,toolCallId:S,role:c||\"tool\",content:m};e.push(T),await Promise.all(a.map(x=>{var O;(O=x.onNewMessage)==null||O.call(x,{message:T,messages:e,state:s,agent:n,input:u})})),r({messages:e})}return i()}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.STATE_SNAPSHOT:{let g=await y(a,e,s,(t,S,m)=>{var c;return(c=t.onStateSnapshotEvent)==null?void 0:c.call(t,{event:E,messages:S,state:m,agent:n,input:u})});if(r(g),g.stopPropagation!==!0){let{snapshot:t}=E;s=t,r({state:s})}return i()}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.STATE_DELTA:{let g=await y(a,e,s,(t,S,m)=>{var c;return(c=t.onStateDeltaEvent)==null?void 0:c.call(t,{event:E,messages:S,state:m,agent:n,input:u})});if(r(g),g.stopPropagation!==!0){let{delta:t}=E;try{s=(0,fast_json_patch__WEBPACK_IMPORTED_MODULE_1__.applyPatch)(s,t,!0,!1).newDocument,r({state:s})}catch(S){let m=S instanceof Error?S.message:String(S);console.warn(`Failed to apply state patch:\nCurrent state: ${JSON.stringify(s,null,2)}\nPatch operations: ${JSON.stringify(t,null,2)}\nError: ${m}`)}}return i()}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.MESSAGES_SNAPSHOT:{let g=await y(a,e,s,(t,S,m)=>{var c;return(c=t.onMessagesSnapshotEvent)==null?void 0:c.call(t,{event:E,messages:S,state:m,agent:n,input:u})});if(r(g),g.stopPropagation!==!0){let{messages:t}=E;e=t,r({messages:e})}return i()}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.RAW:{let g=await y(a,e,s,(t,S,m)=>{var c;return(c=t.onRawEvent)==null?void 0:c.call(t,{event:E,messages:S,state:m,agent:n,input:u})});return r(g),i()}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.CUSTOM:{let g=await y(a,e,s,(t,S,m)=>{var c;return(c=t.onCustomEvent)==null?void 0:c.call(t,{event:E,messages:S,state:m,agent:n,input:u})});return r(g),i()}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.RUN_STARTED:{let g=await y(a,e,s,(t,S,m)=>{var c;return(c=t.onRunStartedEvent)==null?void 0:c.call(t,{event:E,messages:S,state:m,agent:n,input:u})});return r(g),i()}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.RUN_FINISHED:{let g=await y(a,e,s,(t,S,m)=>{var c;return(c=t.onRunFinishedEvent)==null?void 0:c.call(t,{event:E,messages:S,state:m,agent:n,input:u,result:E.result})});return r(g),i()}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.RUN_ERROR:{let g=await y(a,e,s,(t,S,m)=>{var c;return(c=t.onRunErrorEvent)==null?void 0:c.call(t,{event:E,messages:S,state:m,agent:n,input:u})});return r(g),i()}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.STEP_STARTED:{let g=await y(a,e,s,(t,S,m)=>{var c;return(c=t.onStepStartedEvent)==null?void 0:c.call(t,{event:E,messages:S,state:m,agent:n,input:u})});return r(g),i()}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.STEP_FINISHED:{let g=await y(a,e,s,(t,S,m)=>{var c;return(c=t.onStepFinishedEvent)==null?void 0:c.call(t,{event:E,messages:S,state:m,agent:n,input:u})});return r(g),i()}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TEXT_MESSAGE_CHUNK:throw new Error(\"TEXT_MESSAGE_CHUNK must be tranformed before being applied\");case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TOOL_CALL_CHUNK:throw new Error(\"TOOL_CALL_CHUNK must be tranformed before being applied\");case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.THINKING_START:return i();case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.THINKING_END:return i();case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.THINKING_TEXT_MESSAGE_START:return i();case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.THINKING_TEXT_MESSAGE_CONTENT:return i();case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.THINKING_TEXT_MESSAGE_END:return i()}let w=E.type;return i()}),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_4__.mergeAll)(),a.length>0?(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_4__.defaultIfEmpty)({}):E=>E)};var U=u=>o=>{let n=new Map,a=new Map,e=!1,s=!1,l=!1,r=new Map,i=!1,E=!1,h=!1,w=()=>{n.clear(),a.clear(),r.clear(),i=!1,E=!1,e=!1,s=!1,h=!0};return o.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_4__.mergeMap)(d=>{let g=d.type;if(u&&console.debug(\"[VERIFY]:\",JSON.stringify(d)),s)return (0,rxjs__WEBPACK_IMPORTED_MODULE_6__.throwError)(()=>new _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.AGUIError(`Cannot send event type '${g}': The run has already errored with 'RUN_ERROR'. No further events can be sent.`));if(e&&g!==_ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.RUN_ERROR&&g!==_ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.RUN_STARTED)return (0,rxjs__WEBPACK_IMPORTED_MODULE_6__.throwError)(()=>new _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.AGUIError(`Cannot send event type '${g}': The run has already finished with 'RUN_FINISHED'. Start a new run with 'RUN_STARTED'.`));if(l){if(g===_ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.RUN_STARTED){if(h&&!e)return (0,rxjs__WEBPACK_IMPORTED_MODULE_6__.throwError)(()=>new _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.AGUIError(\"Cannot send 'RUN_STARTED' while a run is still active. The previous run must be finished with 'RUN_FINISHED' before starting a new run.\"));e&&w()}}else if(l=!0,g!==_ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.RUN_STARTED&&g!==_ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.RUN_ERROR)return (0,rxjs__WEBPACK_IMPORTED_MODULE_6__.throwError)(()=>new _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.AGUIError(\"First event must be 'RUN_STARTED'\"));switch(g){case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TEXT_MESSAGE_START:{let t=d.messageId;return n.has(t)?(0,rxjs__WEBPACK_IMPORTED_MODULE_6__.throwError)(()=>new _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.AGUIError(`Cannot send 'TEXT_MESSAGE_START' event: A text message with ID '${t}' is already in progress. Complete it with 'TEXT_MESSAGE_END' first.`)):(n.set(t,!0),(0,rxjs__WEBPACK_IMPORTED_MODULE_2__.of)(d))}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TEXT_MESSAGE_CONTENT:{let t=d.messageId;return n.has(t)?(0,rxjs__WEBPACK_IMPORTED_MODULE_2__.of)(d):(0,rxjs__WEBPACK_IMPORTED_MODULE_6__.throwError)(()=>new _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.AGUIError(`Cannot send 'TEXT_MESSAGE_CONTENT' event: No active text message found with ID '${t}'. Start a text message with 'TEXT_MESSAGE_START' first.`))}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TEXT_MESSAGE_END:{let t=d.messageId;return n.has(t)?(n.delete(t),(0,rxjs__WEBPACK_IMPORTED_MODULE_2__.of)(d)):(0,rxjs__WEBPACK_IMPORTED_MODULE_6__.throwError)(()=>new _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.AGUIError(`Cannot send 'TEXT_MESSAGE_END' event: No active text message found with ID '${t}'. A 'TEXT_MESSAGE_START' event must be sent first.`))}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TOOL_CALL_START:{let t=d.toolCallId;return a.has(t)?(0,rxjs__WEBPACK_IMPORTED_MODULE_6__.throwError)(()=>new _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.AGUIError(`Cannot send 'TOOL_CALL_START' event: A tool call with ID '${t}' is already in progress. Complete it with 'TOOL_CALL_END' first.`)):(a.set(t,!0),(0,rxjs__WEBPACK_IMPORTED_MODULE_2__.of)(d))}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TOOL_CALL_ARGS:{let t=d.toolCallId;return a.has(t)?(0,rxjs__WEBPACK_IMPORTED_MODULE_2__.of)(d):(0,rxjs__WEBPACK_IMPORTED_MODULE_6__.throwError)(()=>new _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.AGUIError(`Cannot send 'TOOL_CALL_ARGS' event: No active tool call found with ID '${t}'. Start a tool call with 'TOOL_CALL_START' first.`))}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TOOL_CALL_END:{let t=d.toolCallId;return a.has(t)?(a.delete(t),(0,rxjs__WEBPACK_IMPORTED_MODULE_2__.of)(d)):(0,rxjs__WEBPACK_IMPORTED_MODULE_6__.throwError)(()=>new _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.AGUIError(`Cannot send 'TOOL_CALL_END' event: No active tool call found with ID '${t}'. A 'TOOL_CALL_START' event must be sent first.`))}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.STEP_STARTED:{let t=d.stepName;return r.has(t)?(0,rxjs__WEBPACK_IMPORTED_MODULE_6__.throwError)(()=>new _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.AGUIError(`Step \"${t}\" is already active for 'STEP_STARTED'`)):(r.set(t,!0),(0,rxjs__WEBPACK_IMPORTED_MODULE_2__.of)(d))}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.STEP_FINISHED:{let t=d.stepName;return r.has(t)?(r.delete(t),(0,rxjs__WEBPACK_IMPORTED_MODULE_2__.of)(d)):(0,rxjs__WEBPACK_IMPORTED_MODULE_6__.throwError)(()=>new _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.AGUIError(`Cannot send 'STEP_FINISHED' for step \"${t}\" that was not started`))}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.RUN_STARTED:return h=!0,(0,rxjs__WEBPACK_IMPORTED_MODULE_2__.of)(d);case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.RUN_FINISHED:{if(r.size>0){let t=Array.from(r.keys()).join(\", \");return (0,rxjs__WEBPACK_IMPORTED_MODULE_6__.throwError)(()=>new _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.AGUIError(`Cannot send 'RUN_FINISHED' while steps are still active: ${t}`))}if(n.size>0){let t=Array.from(n.keys()).join(\", \");return (0,rxjs__WEBPACK_IMPORTED_MODULE_6__.throwError)(()=>new _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.AGUIError(`Cannot send 'RUN_FINISHED' while text messages are still active: ${t}`))}if(a.size>0){let t=Array.from(a.keys()).join(\", \");return (0,rxjs__WEBPACK_IMPORTED_MODULE_6__.throwError)(()=>new _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.AGUIError(`Cannot send 'RUN_FINISHED' while tool calls are still active: ${t}`))}return e=!0,(0,rxjs__WEBPACK_IMPORTED_MODULE_2__.of)(d)}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.RUN_ERROR:return s=!0,(0,rxjs__WEBPACK_IMPORTED_MODULE_2__.of)(d);case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.CUSTOM:return (0,rxjs__WEBPACK_IMPORTED_MODULE_2__.of)(d);case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.THINKING_TEXT_MESSAGE_START:return i?E?(0,rxjs__WEBPACK_IMPORTED_MODULE_6__.throwError)(()=>new _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.AGUIError(\"Cannot send 'THINKING_TEXT_MESSAGE_START' event: A thinking message is already in progress. Complete it with 'THINKING_TEXT_MESSAGE_END' first.\")):(E=!0,(0,rxjs__WEBPACK_IMPORTED_MODULE_2__.of)(d)):(0,rxjs__WEBPACK_IMPORTED_MODULE_6__.throwError)(()=>new _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.AGUIError(\"Cannot send 'THINKING_TEXT_MESSAGE_START' event: A thinking step is not in progress. Create one with 'THINKING_START' first.\"));case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.THINKING_TEXT_MESSAGE_CONTENT:return E?(0,rxjs__WEBPACK_IMPORTED_MODULE_2__.of)(d):(0,rxjs__WEBPACK_IMPORTED_MODULE_6__.throwError)(()=>new _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.AGUIError(\"Cannot send 'THINKING_TEXT_MESSAGE_CONTENT' event: No active thinking message found. Start a message with 'THINKING_TEXT_MESSAGE_START' first.\"));case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.THINKING_TEXT_MESSAGE_END:return E?(E=!1,(0,rxjs__WEBPACK_IMPORTED_MODULE_2__.of)(d)):(0,rxjs__WEBPACK_IMPORTED_MODULE_6__.throwError)(()=>new _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.AGUIError(\"Cannot send 'THINKING_TEXT_MESSAGE_END' event: No active thinking message found. A 'THINKING_TEXT_MESSAGE_START' event must be sent first.\"));case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.THINKING_START:return i?(0,rxjs__WEBPACK_IMPORTED_MODULE_6__.throwError)(()=>new _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.AGUIError(\"Cannot send 'THINKING_START' event: A thinking step is already in progress. End it with 'THINKING_END' first.\")):(i=!0,(0,rxjs__WEBPACK_IMPORTED_MODULE_2__.of)(d));case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.THINKING_END:return i?(i=!1,(0,rxjs__WEBPACK_IMPORTED_MODULE_2__.of)(d)):(0,rxjs__WEBPACK_IMPORTED_MODULE_6__.throwError)(()=>new _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.AGUIError(\"Cannot send 'THINKING_END' event: No active thinking step found. A 'THINKING_START' event must be sent first.\"));default:return (0,rxjs__WEBPACK_IMPORTED_MODULE_2__.of)(d)}}))};var j=(u,o)=>(0,rxjs__WEBPACK_IMPORTED_MODULE_7__.defer)(()=>(0,rxjs__WEBPACK_IMPORTED_MODULE_8__.from)(fetch(u,o))).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_4__.switchMap)(n=>{var s;if(!n.ok){let l=n.headers.get(\"content-type\")||\"\";return (0,rxjs__WEBPACK_IMPORTED_MODULE_8__.from)(n.text()).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_4__.mergeMap)(r=>{let i=r;if(l.includes(\"application/json\"))try{i=JSON.parse(r)}catch(h){}let E=new Error(`HTTP ${n.status}: ${typeof i==\"string\"?i:JSON.stringify(i)}`);return E.status=n.status,E.payload=i,(0,rxjs__WEBPACK_IMPORTED_MODULE_6__.throwError)(()=>E)}))}let a={type:\"headers\",status:n.status,headers:n.headers},e=(s=n.body)==null?void 0:s.getReader();return e?new rxjs__WEBPACK_IMPORTED_MODULE_9__.Observable(l=>(l.next(a),(async()=>{try{for(;;){let{done:r,value:i}=await e.read();if(r)break;let E={type:\"data\",data:i};l.next(E)}l.complete()}catch(r){l.error(r)}})(),()=>{e.cancel()})):(0,rxjs__WEBPACK_IMPORTED_MODULE_6__.throwError)(()=>new Error(\"Failed to getReader() from response\"))}));var z=u=>{let o=new rxjs__WEBPACK_IMPORTED_MODULE_10__.Subject,n=new TextDecoder(\"utf-8\",{fatal:!1}),a=\"\";u.subscribe({next:s=>{if(s.type!==\"headers\"&&s.type===\"data\"&&s.data){let l=n.decode(s.data,{stream:!0});a+=l;let r=a.split(/\\n\\n/);a=r.pop()||\"\";for(let i of r)e(i)}},error:s=>o.error(s),complete:()=>{a&&(a+=n.decode(),e(a)),o.complete()}});function e(s){let l=s.split(`\n`),r=[];for(let i of l)i.startsWith(\"data: \")&&r.push(i.slice(6));if(r.length>0)try{let i=r.join(`\n`),E=JSON.parse(i);o.next(E)}catch(i){o.error(i)}}return o.asObservable()};var B=u=>{let o=new rxjs__WEBPACK_IMPORTED_MODULE_10__.Subject,n=new Uint8Array(0);u.subscribe({next:e=>{if(e.type!==\"headers\"&&e.type===\"data\"&&e.data){let s=new Uint8Array(n.length+e.data.length);s.set(n,0),s.set(e.data,n.length),n=s,a()}},error:e=>o.error(e),complete:()=>{if(n.length>0)try{a()}catch(e){console.warn(\"Incomplete or invalid protocol buffer data at stream end\")}o.complete()}});function a(){for(;n.length>=4;){let l=4+new DataView(n.buffer,n.byteOffset,4).getUint32(0,!1);if(n.length<l)break;try{let r=n.slice(4,l),i=_ag_ui_proto__WEBPACK_IMPORTED_MODULE_11__.decode(r);o.next(i),n=n.slice(l)}catch(r){let i=r instanceof Error?r.message:String(r);o.error(new Error(`Failed to decode protocol buffer message: ${i}`));return}}}return o.asObservable()};var J=u=>{let o=new rxjs__WEBPACK_IMPORTED_MODULE_10__.Subject,n=new rxjs__WEBPACK_IMPORTED_MODULE_12__.ReplaySubject,a=!1;return u.subscribe({next:e=>{n.next(e),e.type===\"headers\"&&!a?(a=!0,e.headers.get(\"content-type\")===_ag_ui_proto__WEBPACK_IMPORTED_MODULE_11__.AGUI_MEDIA_TYPE?B(n).subscribe({next:l=>o.next(l),error:l=>o.error(l),complete:()=>o.complete()}):z(n).subscribe({next:l=>{try{let r=_ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventSchemas.parse(l);o.next(r)}catch(r){o.error(r)}},error:l=>o.error(l),complete:()=>o.complete()})):a||o.error(new Error(\"No headers event received before data events\"))},error:e=>{n.error(e),o.error(e)},complete:()=>{n.complete()}}),o.asObservable()};var A=zod__WEBPACK_IMPORTED_MODULE_13__[\"enum\"]([\"TextMessageStart\",\"TextMessageContent\",\"TextMessageEnd\",\"ActionExecutionStart\",\"ActionExecutionArgs\",\"ActionExecutionEnd\",\"ActionExecutionResult\",\"AgentStateMessage\",\"MetaEvent\",\"RunStarted\",\"RunFinished\",\"RunError\",\"NodeStarted\",\"NodeFinished\"]),Ce=zod__WEBPACK_IMPORTED_MODULE_13__[\"enum\"]([\"LangGraphInterruptEvent\",\"PredictState\",\"Exit\"]),Re=zod__WEBPACK_IMPORTED_MODULE_13__.object({type:zod__WEBPACK_IMPORTED_MODULE_13__.literal(A.enum.TextMessageStart),messageId:zod__WEBPACK_IMPORTED_MODULE_13__.string(),parentMessageId:zod__WEBPACK_IMPORTED_MODULE_13__.string().optional(),role:zod__WEBPACK_IMPORTED_MODULE_13__.string().optional()}),_e=zod__WEBPACK_IMPORTED_MODULE_13__.object({type:zod__WEBPACK_IMPORTED_MODULE_13__.literal(A.enum.TextMessageContent),messageId:zod__WEBPACK_IMPORTED_MODULE_13__.string(),content:zod__WEBPACK_IMPORTED_MODULE_13__.string()}),Ne=zod__WEBPACK_IMPORTED_MODULE_13__.object({type:zod__WEBPACK_IMPORTED_MODULE_13__.literal(A.enum.TextMessageEnd),messageId:zod__WEBPACK_IMPORTED_MODULE_13__.string()}),xe=zod__WEBPACK_IMPORTED_MODULE_13__.object({type:zod__WEBPACK_IMPORTED_MODULE_13__.literal(A.enum.ActionExecutionStart),actionExecutionId:zod__WEBPACK_IMPORTED_MODULE_13__.string(),actionName:zod__WEBPACK_IMPORTED_MODULE_13__.string(),parentMessageId:zod__WEBPACK_IMPORTED_MODULE_13__.string().optional()}),Ie=zod__WEBPACK_IMPORTED_MODULE_13__.object({type:zod__WEBPACK_IMPORTED_MODULE_13__.literal(A.enum.ActionExecutionArgs),actionExecutionId:zod__WEBPACK_IMPORTED_MODULE_13__.string(),args:zod__WEBPACK_IMPORTED_MODULE_13__.string()}),Le=zod__WEBPACK_IMPORTED_MODULE_13__.object({type:zod__WEBPACK_IMPORTED_MODULE_13__.literal(A.enum.ActionExecutionEnd),actionExecutionId:zod__WEBPACK_IMPORTED_MODULE_13__.string()}),Oe=zod__WEBPACK_IMPORTED_MODULE_13__.object({type:zod__WEBPACK_IMPORTED_MODULE_13__.literal(A.enum.ActionExecutionResult),actionName:zod__WEBPACK_IMPORTED_MODULE_13__.string(),actionExecutionId:zod__WEBPACK_IMPORTED_MODULE_13__.string(),result:zod__WEBPACK_IMPORTED_MODULE_13__.string()}),we=zod__WEBPACK_IMPORTED_MODULE_13__.object({type:zod__WEBPACK_IMPORTED_MODULE_13__.literal(A.enum.AgentStateMessage),threadId:zod__WEBPACK_IMPORTED_MODULE_13__.string(),agentName:zod__WEBPACK_IMPORTED_MODULE_13__.string(),nodeName:zod__WEBPACK_IMPORTED_MODULE_13__.string(),runId:zod__WEBPACK_IMPORTED_MODULE_13__.string(),active:zod__WEBPACK_IMPORTED_MODULE_13__.boolean(),role:zod__WEBPACK_IMPORTED_MODULE_13__.string(),state:zod__WEBPACK_IMPORTED_MODULE_13__.string(),running:zod__WEBPACK_IMPORTED_MODULE_13__.boolean()}),Pe=zod__WEBPACK_IMPORTED_MODULE_13__.object({type:zod__WEBPACK_IMPORTED_MODULE_13__.literal(A.enum.MetaEvent),name:Ce,value:zod__WEBPACK_IMPORTED_MODULE_13__.any()}),De=zod__WEBPACK_IMPORTED_MODULE_13__.object({type:zod__WEBPACK_IMPORTED_MODULE_13__.literal(A.enum.RunError),message:zod__WEBPACK_IMPORTED_MODULE_13__.string(),code:zod__WEBPACK_IMPORTED_MODULE_13__.string().optional()}),fn=zod__WEBPACK_IMPORTED_MODULE_13__.discriminatedUnion(\"type\",[Re,_e,Ne,xe,Ie,Le,Oe,we,Pe,De]),Tn=zod__WEBPACK_IMPORTED_MODULE_13__.object({id:zod__WEBPACK_IMPORTED_MODULE_13__.string(),role:zod__WEBPACK_IMPORTED_MODULE_13__.string(),content:zod__WEBPACK_IMPORTED_MODULE_13__.string(),parentMessageId:zod__WEBPACK_IMPORTED_MODULE_13__.string().optional()}),An=zod__WEBPACK_IMPORTED_MODULE_13__.object({id:zod__WEBPACK_IMPORTED_MODULE_13__.string(),name:zod__WEBPACK_IMPORTED_MODULE_13__.string(),arguments:zod__WEBPACK_IMPORTED_MODULE_13__.any(),parentMessageId:zod__WEBPACK_IMPORTED_MODULE_13__.string().optional()}),vn=zod__WEBPACK_IMPORTED_MODULE_13__.object({id:zod__WEBPACK_IMPORTED_MODULE_13__.string(),result:zod__WEBPACK_IMPORTED_MODULE_13__.any(),actionExecutionId:zod__WEBPACK_IMPORTED_MODULE_13__.string(),actionName:zod__WEBPACK_IMPORTED_MODULE_13__.string()});var $=(u,o,n)=>a=>{let e={},s=!0,l=!0,r=\"\",i=null,E=null,h=[],w={},d=g=>{typeof g==\"object\"&&g!==null&&(\"messages\"in g&&delete g.messages,e=g)};return a.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_4__.mergeMap)(g=>{switch(g.type){case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TEXT_MESSAGE_START:{let t=g;return[{type:A.enum.TextMessageStart,messageId:t.messageId,role:t.role}]}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TEXT_MESSAGE_CONTENT:{let t=g;return[{type:A.enum.TextMessageContent,messageId:t.messageId,content:t.delta}]}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TEXT_MESSAGE_END:{let t=g;return[{type:A.enum.TextMessageEnd,messageId:t.messageId}]}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TOOL_CALL_START:{let t=g;return h.push({id:t.toolCallId,type:\"function\",function:{name:t.toolCallName,arguments:\"\"}}),l=!0,w[t.toolCallId]=t.toolCallName,[{type:A.enum.ActionExecutionStart,actionExecutionId:t.toolCallId,actionName:t.toolCallName,parentMessageId:t.parentMessageId}]}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TOOL_CALL_ARGS:{let t=g,S=h.find(c=>c.id===t.toolCallId);if(!S)return console.warn(`TOOL_CALL_ARGS: No tool call found with ID '${t.toolCallId}'`),[];S.function.arguments+=t.delta;let m=!1;if(E){let c=E.find(T=>T.tool==S.function.name);if(c)try{let T=JSON.parse((0,untruncate_json__WEBPACK_IMPORTED_MODULE_5__[\"default\"])(S.function.arguments));c.tool_argument&&c.tool_argument in T?(d(H(L({},e),{[c.state_key]:T[c.tool_argument]})),m=!0):c.tool_argument||(d(H(L({},e),{[c.state_key]:T})),m=!0)}catch(T){}}return[{type:A.enum.ActionExecutionArgs,actionExecutionId:t.toolCallId,args:t.delta},...m?[{type:A.enum.AgentStateMessage,threadId:u,agentName:n,nodeName:r,runId:o,running:s,role:\"assistant\",state:JSON.stringify(e),active:l}]:[]]}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TOOL_CALL_END:{let t=g;return[{type:A.enum.ActionExecutionEnd,actionExecutionId:t.toolCallId}]}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TOOL_CALL_RESULT:{let t=g;return[{type:A.enum.ActionExecutionResult,actionExecutionId:t.toolCallId,result:t.content,actionName:w[t.toolCallId]||\"unknown\"}]}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.RAW:return[];case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.CUSTOM:{let t=g;switch(t.name){case\"Exit\":s=!1;break;case\"PredictState\":E=t.value;break}return[{type:A.enum.MetaEvent,name:t.name,value:t.value}]}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.STATE_SNAPSHOT:return d(g.snapshot),[{type:A.enum.AgentStateMessage,threadId:u,agentName:n,nodeName:r,runId:o,running:s,role:\"assistant\",state:JSON.stringify(e),active:l}];case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.STATE_DELTA:{let S=(0,fast_json_patch__WEBPACK_IMPORTED_MODULE_1__.applyPatch)(e,g.delta,!0,!1);return S?(d(S.newDocument),[{type:A.enum.AgentStateMessage,threadId:u,agentName:n,nodeName:r,runId:o,running:s,role:\"assistant\",state:JSON.stringify(e),active:l}]):[]}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.MESSAGES_SNAPSHOT:return i=g.messages,[{type:A.enum.AgentStateMessage,threadId:u,agentName:n,nodeName:r,runId:o,running:s,role:\"assistant\",state:JSON.stringify(L(L({},e),i?{messages:i}:{})),active:!0}];case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.RUN_STARTED:return[];case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.RUN_FINISHED:return i&&(e.messages=i),Object.keys(e).length===0?[]:[{type:A.enum.AgentStateMessage,threadId:u,agentName:n,nodeName:r,runId:o,running:s,role:\"assistant\",state:JSON.stringify(L(L({},e),i?{messages:Ue(i)}:{})),active:!1}];case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.RUN_ERROR:{let t=g;return[{type:A.enum.RunError,message:t.message,code:t.code}]}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.STEP_STARTED:return r=g.stepName,h=[],E=null,[{type:A.enum.AgentStateMessage,threadId:u,agentName:n,nodeName:r,runId:o,running:s,role:\"assistant\",state:JSON.stringify(e),active:!0}];case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.STEP_FINISHED:return h=[],E=null,[{type:A.enum.AgentStateMessage,threadId:u,agentName:n,nodeName:r,runId:o,running:s,role:\"assistant\",state:JSON.stringify(e),active:!1}];default:return[]}}))};function Ue(u){var n;let o=[];for(let a of u)if(a.role===\"assistant\"||a.role===\"user\"||a.role===\"system\"){if(a.content){let e={id:a.id,role:a.role,content:a.content};o.push(e)}if(a.role===\"assistant\"&&a.toolCalls&&a.toolCalls.length>0)for(let e of a.toolCalls){let s={id:e.id,name:e.function.name,arguments:JSON.parse(e.function.arguments),parentMessageId:a.id};o.push(s)}}else if(a.role===\"tool\"){let e=\"unknown\";for(let l of u)if(l.role===\"assistant\"&&((n=l.toolCalls)!=null&&n.length)){for(let r of l.toolCalls)if(r.id===a.toolCallId){e=r.function.name;break}}let s={id:a.id,result:a.content,actionExecutionId:a.toolCallId,actionName:e};o.push(s)}return o}var b=u=>o=>{let n,a,e,s=()=>{if(!n||e!==\"text\")throw new Error(\"No text message to close\");let i={type:_ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TEXT_MESSAGE_END,messageId:n.messageId};return e=void 0,n=void 0,u&&console.debug(\"[TRANSFORM]: TEXT_MESSAGE_END\",JSON.stringify(i)),i},l=()=>{if(!a||e!==\"tool\")throw new Error(\"No tool call to close\");let i={type:_ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TOOL_CALL_END,toolCallId:a.toolCallId};return e=void 0,a=void 0,u&&console.debug(\"[TRANSFORM]: TOOL_CALL_END\",JSON.stringify(i)),i},r=()=>e===\"text\"?[s()]:e===\"tool\"?[l()]:[];return o.pipe((0,rxjs__WEBPACK_IMPORTED_MODULE_14__.mergeMap)(i=>{switch(i.type){case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TEXT_MESSAGE_START:case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TEXT_MESSAGE_CONTENT:case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TEXT_MESSAGE_END:case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TOOL_CALL_START:case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TOOL_CALL_ARGS:case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TOOL_CALL_END:case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TOOL_CALL_RESULT:case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.STATE_SNAPSHOT:case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.STATE_DELTA:case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.MESSAGES_SNAPSHOT:case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.CUSTOM:case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.RUN_STARTED:case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.RUN_FINISHED:case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.RUN_ERROR:case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.STEP_STARTED:case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.STEP_FINISHED:case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.THINKING_START:case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.THINKING_END:case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.THINKING_TEXT_MESSAGE_START:case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.THINKING_TEXT_MESSAGE_CONTENT:case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.THINKING_TEXT_MESSAGE_END:return[...r(),i];case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.RAW:return[i];case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TEXT_MESSAGE_CHUNK:let h=i,w=[];if((e!==\"text\"||h.messageId!==void 0&&h.messageId!==(n==null?void 0:n.messageId))&&w.push(...r()),e!==\"text\"){if(h.messageId===void 0)throw new Error(\"First TEXT_MESSAGE_CHUNK must have a messageId\");n={messageId:h.messageId},e=\"text\";let t={type:_ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TEXT_MESSAGE_START,messageId:h.messageId,role:h.role||\"assistant\"};w.push(t),u&&console.debug(\"[TRANSFORM]: TEXT_MESSAGE_START\",JSON.stringify(t))}if(h.delta!==void 0){let t={type:_ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TEXT_MESSAGE_CONTENT,messageId:n.messageId,delta:h.delta};w.push(t),u&&console.debug(\"[TRANSFORM]: TEXT_MESSAGE_CONTENT\",JSON.stringify(t))}return w;case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TOOL_CALL_CHUNK:let d=i,g=[];if((e!==\"tool\"||d.toolCallId!==void 0&&d.toolCallId!==(a==null?void 0:a.toolCallId))&&g.push(...r()),e!==\"tool\"){if(d.toolCallId===void 0)throw new Error(\"First TOOL_CALL_CHUNK must have a toolCallId\");if(d.toolCallName===void 0)throw new Error(\"First TOOL_CALL_CHUNK must have a toolCallName\");a={toolCallId:d.toolCallId,toolCallName:d.toolCallName,parentMessageId:d.parentMessageId},e=\"tool\";let t={type:_ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TOOL_CALL_START,toolCallId:d.toolCallId,toolCallName:d.toolCallName,parentMessageId:d.parentMessageId};g.push(t),u&&console.debug(\"[TRANSFORM]: TOOL_CALL_START\",JSON.stringify(t))}if(d.delta!==void 0){let t={type:_ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TOOL_CALL_ARGS,toolCallId:a.toolCallId,delta:d.delta};g.push(t),u&&console.debug(\"[TRANSFORM]: TOOL_CALL_ARGS\",JSON.stringify(t))}return g}let E=i.type}),(0,rxjs__WEBPACK_IMPORTED_MODULE_15__.finalize)(()=>r()))};var G=class{constructor({agentId:o,description:n,threadId:a,initialMessages:e,initialState:s,debug:l}={}){this.debug=!1;this.subscribers=[];this.agentId=o,this.description=n!=null?n:\"\",this.threadId=a!=null?a:(0,uuid__WEBPACK_IMPORTED_MODULE_16__[\"default\"])(),this.messages=C(e!=null?e:[]),this.state=C(s!=null?s:{}),this.debug=l!=null?l:!1}subscribe(o){return this.subscribers.push(o),{unsubscribe:()=>{this.subscribers=this.subscribers.filter(n=>n!==o)}}}async runAgent(o,n){var i;this.agentId=(i=this.agentId)!=null?i:(0,uuid__WEBPACK_IMPORTED_MODULE_16__[\"default\"])();let a=this.prepareRunAgentInput(o),e,s=new Set(this.messages.map(E=>E.id)),l=[{onRunFinishedEvent:E=>{e=E.result}},...this.subscribers,n!=null?n:{}];await this.onInitialize(a,l);let r=(0,rxjs__WEBPACK_IMPORTED_MODULE_17__.pipe)(()=>this.run(a),b(this.debug),U(this.debug),E=>this.apply(a,E,l),E=>this.processApplyEvents(a,E,l),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_4__.catchError)(E=>this.onError(a,E,l)),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_4__.finalize)(()=>{this.onFinalize(a,l)}));return (0,rxjs__WEBPACK_IMPORTED_MODULE_18__.lastValueFrom)(r((0,rxjs__WEBPACK_IMPORTED_MODULE_2__.of)(null))).then(()=>{let E=C(this.messages).filter(h=>!s.has(h.id));return{result:e,newMessages:E}})}abortRun(){}apply(o,n,a){return K(o,n,this,a)}processApplyEvents(o,n,a){return n.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_4__.tap)(e=>{e.messages&&(this.messages=e.messages,a.forEach(s=>{var l;(l=s.onMessagesChanged)==null||l.call(s,{messages:this.messages,state:this.state,agent:this,input:o})})),e.state&&(this.state=e.state,a.forEach(s=>{var l;(l=s.onStateChanged)==null||l.call(s,{state:this.state,messages:this.messages,agent:this,input:o})}))}))}prepareRunAgentInput(o){var n,a,e;return{threadId:this.threadId,runId:(o==null?void 0:o.runId)||(0,uuid__WEBPACK_IMPORTED_MODULE_16__[\"default\"])(),tools:C((n=o==null?void 0:o.tools)!=null?n:[]),context:C((a=o==null?void 0:o.context)!=null?a:[]),forwardedProps:C((e=o==null?void 0:o.forwardedProps)!=null?e:{}),state:C(this.state),messages:C(this.messages)}}async onInitialize(o,n){let a=await y(n,this.messages,this.state,(e,s,l)=>{var r;return(r=e.onRunInitialized)==null?void 0:r.call(e,{messages:s,state:l,agent:this,input:o})});(a.messages!==void 0||a.state!==void 0)&&(a.messages&&(this.messages=a.messages,o.messages=a.messages,n.forEach(e=>{var s;(s=e.onMessagesChanged)==null||s.call(e,{messages:this.messages,state:this.state,agent:this,input:o})})),a.state&&(this.state=a.state,o.state=a.state,n.forEach(e=>{var s;(s=e.onStateChanged)==null||s.call(e,{state:this.state,messages:this.messages,agent:this,input:o})})))}onError(o,n,a){return (0,rxjs__WEBPACK_IMPORTED_MODULE_8__.from)(y(a,this.messages,this.state,(e,s,l)=>{var r;return(r=e.onRunFailed)==null?void 0:r.call(e,{error:n,messages:s,state:l,agent:this,input:o})})).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_4__.map)(e=>{let s=e;if((s.messages!==void 0||s.state!==void 0)&&(s.messages!==void 0&&(this.messages=s.messages,a.forEach(l=>{var r;(r=l.onMessagesChanged)==null||r.call(l,{messages:this.messages,state:this.state,agent:this,input:o})})),s.state!==void 0&&(this.state=s.state,a.forEach(l=>{var r;(r=l.onStateChanged)==null||r.call(l,{state:this.state,messages:this.messages,agent:this,input:o})}))),s.stopPropagation!==!0)throw console.error(\"Agent execution failed:\",n),n;return{}}))}async onFinalize(o,n){let a=await y(n,this.messages,this.state,(e,s,l)=>{var r;return(r=e.onRunFinalized)==null?void 0:r.call(e,{messages:s,state:l,agent:this,input:o})});(a.messages!==void 0||a.state!==void 0)&&(a.messages!==void 0&&(this.messages=a.messages,n.forEach(e=>{var s;(s=e.onMessagesChanged)==null||s.call(e,{messages:this.messages,state:this.state,agent:this,input:o})})),a.state!==void 0&&(this.state=a.state,n.forEach(e=>{var s;(s=e.onStateChanged)==null||s.call(e,{state:this.state,messages:this.messages,agent:this,input:o})})))}clone(){let o=Object.create(Object.getPrototypeOf(this));for(let n of Object.getOwnPropertyNames(this)){let a=this[n];typeof a!=\"function\"&&(o[n]=C(a))}return o}addMessage(o){this.messages.push(o),(async()=>{var n,a,e;for(let s of this.subscribers)await((n=s.onNewMessage)==null?void 0:n.call(s,{message:o,messages:this.messages,state:this.state,agent:this}));if(o.role===\"assistant\"&&o.toolCalls)for(let s of o.toolCalls)for(let l of this.subscribers)await((a=l.onNewToolCall)==null?void 0:a.call(l,{toolCall:s,messages:this.messages,state:this.state,agent:this}));for(let s of this.subscribers)await((e=s.onMessagesChanged)==null?void 0:e.call(s,{messages:this.messages,state:this.state,agent:this}))})()}addMessages(o){this.messages.push(...o),(async()=>{var n,a,e;for(let s of o){for(let l of this.subscribers)await((n=l.onNewMessage)==null?void 0:n.call(l,{message:s,messages:this.messages,state:this.state,agent:this}));if(s.role===\"assistant\"&&s.toolCalls)for(let l of s.toolCalls)for(let r of this.subscribers)await((a=r.onNewToolCall)==null?void 0:a.call(r,{toolCall:l,messages:this.messages,state:this.state,agent:this}))}for(let s of this.subscribers)await((e=s.onMessagesChanged)==null?void 0:e.call(s,{messages:this.messages,state:this.state,agent:this}))})()}setMessages(o){this.messages=C(o),(async()=>{var n;for(let a of this.subscribers)await((n=a.onMessagesChanged)==null?void 0:n.call(a,{messages:this.messages,state:this.state,agent:this}))})()}setState(o){this.state=C(o),(async()=>{var n;for(let a of this.subscribers)await((n=a.onStateChanged)==null?void 0:n.call(a,{messages:this.messages,state:this.state,agent:this}))})()}legacy_to_be_removed_runAgentBridged(o){var a;this.agentId=(a=this.agentId)!=null?a:(0,uuid__WEBPACK_IMPORTED_MODULE_16__[\"default\"])();let n=this.prepareRunAgentInput(o);return this.run(n).pipe(b(this.debug),U(this.debug),$(this.threadId,n.runId,this.agentId),e=>e.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_4__.map)(s=>(this.debug&&console.debug(\"[LEGACY]:\",JSON.stringify(s)),s))))}};var q=class extends G{constructor(n){var a;super(n);this.abortController=new AbortController;this.url=n.url,this.headers=C((a=n.headers)!=null?a:{})}requestInit(n){return{method:\"POST\",headers:H(L({},this.headers),{\"Content-Type\":\"application/json\",Accept:\"text/event-stream\"}),body:JSON.stringify(n),signal:this.abortController.signal}}runAgent(n,a){var e;return this.abortController=(e=n==null?void 0:n.abortController)!=null?e:new AbortController,super.runAgent(n,a)}abortRun(){this.abortController.abort(),super.abortRun()}run(n){let a=j(this.url,this.requestInit(n));return J(a)}};\n//# sourceMappingURL=index.mjs.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQGFnLXVpL2NsaWVudC9kaXN0L2luZGV4Lm1qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUEsd0RBQXdELHdDQUF3QyxtQ0FBbUMsZ0ZBQWdGLDhCQUE4QixrREFBa0QsbUJBQW1CLHFCQUFxQiw0QkFBNEIsaURBQWlELFNBQVMsc0JBQXFMLFVBQVUsZ0VBQWdFLElBQUkscUNBQXFDLFNBQVMsV0FBVyxNQUFvRCwwQkFBMEIsY0FBYyxtQkFBbUIsMkJBQTJCLHVCQUF1QixzR0FBc0csU0FBUyxNQUE2Qiw0RUFBNEUsU0FBUyxlQUFlLHdDQUF3QyxXQUFXLEdBQUcseUNBQXlDLFFBQVEsR0FBRyxjQUFjLGtCQUFrQixHQUFHLEVBQWtDLGtCQUFrQixxQ0FBcUMsT0FBTyx3R0FBd0csUUFBUSxXQUFXLFdBQVcsdUNBQXVDLHdDQUFFLElBQUksdUNBQUUsRUFBRSxjQUFjLHlEQUFFLFdBQVcsTUFBTSw4QkFBOEIsTUFBTSwyQ0FBMkMsMkNBQTJDLEVBQUUsRUFBRSwwQ0FBMEMsZUFBZSxLQUFLLGtEQUFDLHFCQUFxQiw4QkFBOEIsTUFBTSwyREFBMkQsMkNBQTJDLEVBQUUsRUFBRSxnQ0FBZ0MsSUFBSSwrQkFBK0IsTUFBTSx3QkFBd0IsYUFBYSxXQUFXLEVBQUUsV0FBVyxLQUFLLGtEQUFDLHVCQUF1QixJQUFJLG9CQUFvQix5QkFBeUIsNkVBQTZFLEVBQUUsUUFBUSw4QkFBOEIsUUFBUSw2REFBNkQsc0ZBQXNGLEVBQUUsRUFBRSxvRUFBb0UsV0FBVyxPQUFPLEtBQUssa0RBQUMsbUJBQW1CLElBQUksWUFBWSx5QkFBeUIseUVBQXlFLEVBQUUsUUFBUSw4QkFBOEIsUUFBUSx5REFBeUQsc0ZBQXNGLEVBQUUsRUFBRSx3Q0FBd0MsTUFBTSxvQ0FBb0MsNkNBQTZDLEVBQUUsT0FBTyxLQUFLLGtEQUFDLGtCQUFr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MkRBQTJELEVBQUUsdURBQXVELE1BQU0sc0NBQXNDLDJEQUEyRCxFQUFFLElBQUksUUFBUSxpREFBaUQsK0NBQStDLGNBQWMsa0NBQWtDLFNBQVMsY0FBYyxpQ0FBaUMsVUFBVSw4RUFBOEUsNkRBQTZELEdBQUcsNklBQTZJLDhEQUE4RCxHQUFHLG1GQUFtRixtREFBbUQsR0FBRyxJQUFJLGVBQWUsb0NBQW9DLFVBQVUsZ0JBQWdCLDhFQUE4RSw2REFBNkQsR0FBRyw2SUFBNkksOERBQThELEdBQUcsbUZBQW1GLG1EQUFtRCxHQUFHLElBQUksZUFBZSw4QkFBOEIsTUFBTSxtRkFBbUYsbURBQW1ELEdBQUcsSUFBSSxZQUFZLDJCQUEyQixNQUFNLGdGQUFnRixtREFBbUQsR0FBRyxJQUFJLHdDQUF3QyxNQUFNLHNDQUFzQyxpREFBQyxHQUFHLG1DQUFtQyxvR0FBb0csbURBQUUsc0VBQXNFLHNCQUFzQixlQUFlLE1BQU0sU0FBUyx5Q0FBeUMsc0RBQXNELEVBQUUsZUFBZSxPQUFPLDRCQUE0QixnQkFBZ0IsNkRBQTZELDZEQUE2RCxjQUFjLE1BQU0saUhBQWlILFdBQVcsOENBQThDLE9BQU8sc0NBQXNDLGNBQWtQO0FBQ2o3ZiIsInNvdXJjZXMiOlsiL2hvbWUvY2V0ZWMvTm9kZVByb2plY3RzL2FndWlfdGVzdC9ub2RlX21vZHVsZXMvQGFnLXVpL2NsaWVudC9kaXN0L2luZGV4Lm1qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgbmU9T2JqZWN0LmRlZmluZVByb3BlcnR5LGFlPU9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzO3ZhciBzZT1PYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yczt2YXIgVz1PYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzO3ZhciBvZT1PYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LHJlPU9iamVjdC5wcm90b3R5cGUucHJvcGVydHlJc0VudW1lcmFibGU7dmFyIFY9KHUsbyxuKT0+byBpbiB1P25lKHUsbyx7ZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITAsd3JpdGFibGU6ITAsdmFsdWU6bn0pOnVbb109bixMPSh1LG8pPT57Zm9yKHZhciBuIGluIG98fChvPXt9KSlvZS5jYWxsKG8sbikmJlYodSxuLG9bbl0pO2lmKFcpZm9yKHZhciBuIG9mIFcobykpcmUuY2FsbChvLG4pJiZWKHUsbixvW25dKTtyZXR1cm4gdX0sSD0odSxvKT0+YWUodSxzZShvKSk7aW1wb3J0e0V2ZW50VHlwZSBhcyB2fWZyb21cIkBhZy11aS9jb3JlXCI7aW1wb3J0e21lcmdlQWxsIGFzIGllLGRlZmF1bHRJZkVtcHR5IGFzIGxlLGNvbmNhdE1hcCBhcyBnZX1mcm9tXCJyeGpzL29wZXJhdG9yc1wiO2ltcG9ydHtvZiBhcyBjZSxFTVBUWSBhcyBFZX1mcm9tXCJyeGpzXCI7dmFyIEM9dT0+e2lmKHR5cGVvZiBzdHJ1Y3R1cmVkQ2xvbmU9PVwiZnVuY3Rpb25cIilyZXR1cm4gc3RydWN0dXJlZENsb25lKHUpO3RyeXtyZXR1cm4gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSh1KSl9Y2F0Y2gobyl7cmV0dXJuIEwoe30sdSl9fTtpbXBvcnR7YXBwbHlQYXRjaCBhcyB1ZX1mcm9tXCJmYXN0LWpzb24tcGF0Y2hcIjthc3luYyBmdW5jdGlvbiB5KHUsbyxuLGEpe2xldCBlPW8scz1uLGw7Zm9yKGxldCByIG9mIHUpdHJ5e2xldCBpPWF3YWl0IGEocixDKGUpLEMocykpO2lmKGk9PT12b2lkIDApY29udGludWU7aWYoaS5tZXNzYWdlcyE9PXZvaWQgMCYmKGU9aS5tZXNzYWdlcyksaS5zdGF0ZSE9PXZvaWQgMCYmKHM9aS5zdGF0ZSksbD1pLnN0b3BQcm9wYWdhdGlvbixsPT09ITApYnJlYWt9Y2F0Y2goaSl7cHJvY2Vzcy5lbnYuTk9ERV9FTlY9PT1cInRlc3RcInx8cHJvY2Vzcy5lbnYuSkVTVF9XT1JLRVJfSUQhPT12b2lkIDB8fGNvbnNvbGUuZXJyb3IoXCJTdWJzY3JpYmVyIGVycm9yOlwiLGkpO2NvbnRpbnVlfXJldHVybiBMKEwoTCh7fSxKU09OLnN0cmluZ2lmeShlKSE9PUpTT04uc3RyaW5naWZ5KG8pP3ttZXNzYWdlczplfTp7fSksSlNPTi5zdHJpbmdpZnkocykhPT1KU09OLnN0cmluZ2lmeShuKT97c3RhdGU6c306e30pLGwhPT12b2lkIDA/e3N0b3BQcm9wYWdhdGlvbjpsfTp7fSl9aW1wb3J0IHBlIGZyb21cInVudHJ1bmNhdGUtanNvblwiO3ZhciBLPSh1LG8sbixhKT0+e2xldCBlPUModS5tZXNzYWdlcykscz1DKHUuc3RhdGUpLGw9e30scj1FPT57RS5tZXNzYWdlcyE9PXZvaWQgMCYmKGU9RS5tZXNzYWdlcyxsLm1lc3NhZ2VzPUUubWVzc2FnZXMpLEUuc3RhdGUhPT12b2lkIDAmJihzPUUuc3RhdGUsbC5zdGF0ZT1FLnN0YXRlKX0saT0oKT0+e2xldCBFPUMobCk7cmV0dXJuIGw9e30sRS5tZXNzYWdlcyE9PXZvaWQgMHx8RS5zdGF0ZSE9PXZvaWQgMD9jZShFKTpFZX07cmV0dXJuIG8ucGlwZShnZShhc3luYyBFPT57dmFyIGQ7bGV0IGg9YXdhaXQgeShhLGUscywoZyx0LFMpPT57dmFyIG07cmV0dXJuKG09Zy5vbkV2ZW50KT09bnVsbD92b2lkIDA6bS5jYWxsKGcse2V2ZW50OkUsYWdlbnQ6bixpbnB1dDp1LG1lc3NhZ2VzOnQsc3RhdGU6U30pfSk7aWYocihoKSxoLnN0b3BQcm9wYWdhdGlvbj09PSEwKXJldHVybiBpKCk7c3dpdGNoKEUudHlwZSl7Y2FzZSB2LlRFWFRfTUVTU0FHRV9TVEFSVDp7bGV0IGc9YXdhaXQgeShhLGUscywodCxTLG0pPT57dmFyIGM7cmV0dXJuKGM9dC5vblRleHRNZXNzYWdlU3RhcnRFdmVudCk9PW51bGw/dm9pZCAwOmMuY2FsbCh0LHtldmVudDpFLG1lc3NhZ2VzOlMsc3RhdGU6bSxhZ2VudDpuLGlucHV0OnV9KX0pO2lmKHIoZyksZy5zdG9wUHJvcGFnYXRpb24hPT0hMCl7bGV0e21lc3NhZ2VJZDp0LHJvbGU6Uz1cImFzc2lzdGFudFwifT1FLG09e2lkOnQscm9sZTpTLGNvbnRlbnQ6XCJcIn07ZS5wdXNoKG0pLHIoe21lc3NhZ2VzOmV9KX1yZXR1cm4gaSgpfWNhc2Ugdi5URVhUX01FU1NBR0VfQ09OVEVOVDp7bGV0e21lc3NhZ2VJZDpnLGRlbHRhOnR9PUUsUz1lLmZpbmQoYz0+Yy5pZD09PWcpO2lmKCFTKXJldHVybiBjb25zb2xlLndhcm4oYFRFWFRfTUVTU0FHRV9DT05URU5UOiBObyBtZXNzYWdlIGZvdW5kIHdpdGggSUQgJyR7Z30nYCksaSgpO2xldCBtPWF3YWl0IHkoYSxlLHMsKGMsVCx4KT0+e3ZhciBPLFA7cmV0dXJuKFA9Yy5vblRleHRNZXNzYWdlQ29udGVudEV2ZW50KT09bnVsbD92b2lkIDA6UC5jYWxsKGMse2V2ZW50OkUsbWVzc2FnZXM6VCxzdGF0ZTp4LGFnZW50Om4saW5wdXQ6dSx0ZXh0TWVzc2FnZUJ1ZmZlcjooTz1TLmNvbnRlbnQpIT1udWxsP086XCJcIn0pfSk7cmV0dXJuIHIobSksbS5zdG9wUHJvcGFnYXRpb24hPT0hMCYmKFMuY29udGVudD0oUy5jb250ZW50fHxcIlwiKSt0LHIoe21lc3NhZ2VzOmV9KSksaSgpfWNhc2Ugdi5URVhUX01FU1NBR0VfRU5EOntsZXR7bWVzc2FnZUlkOmd9PUUsdD1lLmZpbmQobT0+bS5pZD09PWcpO2lmKCF0KXJldHVybiBjb25zb2xlLndhcm4oYFRFWFRfTUVTU0FHRV9FTkQ6IE5vIG1lc3NhZ2UgZm91bmQgd2l0aCBJRCAnJHtnfSdgKSxpKCk7bGV0IFM9YXdhaXQgeShhLGUscywobSxjLFQpPT57dmFyIHgsTztyZXR1cm4oTz1tLm9uVGV4dE1lc3NhZ2VFbmRFdmVudCk9PW51bGw/dm9pZCAwOk8uY2FsbChtLHtldmVudDpFLG1lc3NhZ2VzOmMsc3RhdGU6VCxhZ2VudDpuLGlucHV0OnUsdGV4dE1lc3NhZ2VCdWZmZXI6KHg9dC5jb250ZW50KSE9bnVsbD94OlwiXCJ9KX0pO3JldHVybiByKFMpLGF3YWl0IFByb21pc2UuYWxsKGEubWFwKG09Pnt2YXIgYzsoYz1tLm9uTmV3TWVzc2FnZSk9PW51bGx8fGMuY2FsbChtLHttZXNzYWdlOnQsbWVzc2FnZXM6ZSxzdGF0ZTpzLGFnZW50Om4saW5wdXQ6dX0pfSkpLGkoKX1jYXNlIHYuVE9PTF9DQUxMX1NUQVJUOntsZXQgZz1hd2FpdCB5KGEsZSxzLCh0LFMsbSk9Pnt2YXIgYztyZXR1cm4oYz10Lm9uVG9vbENhbGxTdGFydEV2ZW50KT09bnVsbD92b2lkIDA6Yy5jYWxsKHQse2V2ZW50OkUsbWVzc2FnZXM6UyxzdGF0ZTptLGFnZW50Om4saW5wdXQ6dX0pfSk7aWYocihnKSxnLnN0b3BQcm9wYWdhdGlvbiE9PSEwKXtsZXR7dG9vbENhbGxJZDp0LHRvb2xDYWxsTmFtZTpTLHBhcmVudE1lc3NhZ2VJZDptfT1FLGM7bSYmZS5sZW5ndGg+MCYmZVtlLmxlbmd0aC0xXS5pZD09PW0/Yz1lW2UubGVuZ3RoLTFdOihjPXtpZDptfHx0LHJvbGU6XCJhc3Npc3RhbnRcIix0b29sQ2FsbHM6W119LGUucHVzaChjKSksKGQ9Yy50b29sQ2FsbHMpIT1udWxsfHwoYy50b29sQ2FsbHM9W10pLGMudG9vbENhbGxzLnB1c2goe2lkOnQsdHlwZTpcImZ1bmN0aW9uXCIsZnVuY3Rpb246e25hbWU6Uyxhcmd1bWVudHM6XCJcIn19KSxyKHttZXNzYWdlczplfSl9cmV0dXJuIGkoKX1jYXNlIHYuVE9PTF9DQUxMX0FSR1M6e2xldHt0b29sQ2FsbElkOmcsZGVsdGE6dH09RSxTPWUuZmluZChUPT57dmFyIHg7cmV0dXJuKHg9VC50b29sQ2FsbHMpPT1udWxsP3ZvaWQgMDp4LnNvbWUoTz0+Ty5pZD09PWcpfSk7aWYoIVMpcmV0dXJuIGNvbnNvbGUud2FybihgVE9PTF9DQUxMX0FSR1M6IE5vIG1lc3NhZ2UgZm91bmQgY29udGFpbmluZyB0b29sIGNhbGwgd2l0aCBJRCAnJHtnfSdgKSxpKCk7bGV0IG09Uy50b29sQ2FsbHMuZmluZChUPT5ULmlkPT09Zyk7aWYoIW0pcmV0dXJuIGNvbnNvbGUud2FybihgVE9PTF9DQUxMX0FSR1M6IE5vIHRvb2wgY2FsbCBmb3VuZCB3aXRoIElEICcke2d9J2ApLGkoKTtsZXQgYz1hd2FpdCB5KGEsZSxzLChULHgsTyk9Pnt2YXIgaztsZXQgUD1tLmZ1bmN0aW9uLmFyZ3VtZW50cyxGPW0uZnVuY3Rpb24ubmFtZSxEPXt9O3RyeXtEPXBlKFApfWNhdGNoKHFlKXt9cmV0dXJuKGs9VC5vblRvb2xDYWxsQXJnc0V2ZW50KT09bnVsbD92b2lkIDA6ay5jYWxsKFQse2V2ZW50OkUsbWVzc2FnZXM6eCxzdGF0ZTpPLGFnZW50Om4saW5wdXQ6dSx0b29sQ2FsbEJ1ZmZlcjpQLHRvb2xDYWxsTmFtZTpGLHBhcnRpYWxUb29sQ2FsbEFyZ3M6RH0pfSk7cmV0dXJuIHIoYyksYy5zdG9wUHJvcGFnYXRpb24hPT0hMCYmKG0uZnVuY3Rpb24uYXJndW1lbnRzKz10LHIoe21lc3NhZ2VzOmV9KSksaSgpfWNhc2Ugdi5UT09MX0NBTExfRU5EOntsZXR7dG9vbENhbGxJZDpnfT1FLHQ9ZS5maW5kKGM9Pnt2YXIgVDtyZXR1cm4oVD1jLnRvb2xDYWxscyk9PW51bGw/dm9pZCAwOlQuc29tZSh4PT54LmlkPT09Zyl9KTtpZighdClyZXR1cm4gY29uc29sZS53YXJuKGBUT09MX0NBTExfRU5EOiBObyBtZXNzYWdlIGZvdW5kIGNvbnRhaW5pbmcgdG9vbCBjYWxsIHdpdGggSUQgJyR7Z30nYCksaSgpO2xldCBTPXQudG9vbENhbGxzLmZpbmQoYz0+Yy5pZD09PWcpO2lmKCFTKXJldHVybiBjb25zb2xlLndhcm4oYFRPT0xfQ0FMTF9FTkQ6IE5vIHRvb2wgY2FsbCBmb3VuZCB3aXRoIElEICcke2d9J2ApLGkoKTtsZXQgbT1hd2FpdCB5KGEsZSxzLChjLFQseCk9Pnt2YXIgRDtsZXQgTz1TLmZ1bmN0aW9uLmFyZ3VtZW50cyxQPVMuZnVuY3Rpb24ubmFtZSxGPXt9O3RyeXtGPUpTT04ucGFyc2UoTyl9Y2F0Y2goayl7fXJldHVybihEPWMub25Ub29sQ2FsbEVuZEV2ZW50KT09bnVsbD92b2lkIDA6RC5jYWxsKGMse2V2ZW50OkUsbWVzc2FnZXM6VCxzdGF0ZTp4LGFnZW50Om4saW5wdXQ6dSx0b29sQ2FsbE5hbWU6UCx0b29sQ2FsbEFyZ3M6Rn0pfSk7cmV0dXJuIHIobSksYXdhaXQgUHJvbWlzZS5hbGwoYS5tYXAoYz0+e3ZhciBUOyhUPWMub25OZXdUb29sQ2FsbCk9PW51bGx8fFQuY2FsbChjLHt0b29sQ2FsbDpTLG1lc3NhZ2VzOmUsc3RhdGU6cyxhZ2VudDpuLGlucHV0OnV9KX0pKSxpKCl9Y2FzZSB2LlRPT0xfQ0FMTF9SRVNVTFQ6e2xldCBnPWF3YWl0IHkoYSxlLHMsKHQsUyxtKT0+e3ZhciBjO3JldHVybihjPXQub25Ub29sQ2FsbFJlc3VsdEV2ZW50KT09bnVsbD92b2lkIDA6Yy5jYWxsKHQse2V2ZW50OkUsbWVzc2FnZXM6UyxzdGF0ZTptLGFnZW50Om4saW5wdXQ6dX0pfSk7aWYocihnKSxnLnN0b3BQcm9wYWdhdGlvbiE9PSEwKXtsZXR7bWVzc2FnZUlkOnQsdG9vbENhbGxJZDpTLGNvbnRlbnQ6bSxyb2xlOmN9PUUsVD17aWQ6dCx0b29sQ2FsbElkOlMscm9sZTpjfHxcInRvb2xcIixjb250ZW50Om19O2UucHVzaChUKSxhd2FpdCBQcm9taXNlLmFsbChhLm1hcCh4PT57dmFyIE87KE89eC5vbk5ld01lc3NhZ2UpPT1udWxsfHxPLmNhbGwoeCx7bWVzc2FnZTpULG1lc3NhZ2VzOmUsc3RhdGU6cyxhZ2VudDpuLGlucHV0OnV9KX0pKSxyKHttZXNzYWdlczplfSl9cmV0dXJuIGkoKX1jYXNlIHYuU1RBVEVfU05BUFNIT1Q6e2xldCBnPWF3YWl0IHkoYSxlLHMsKHQsUyxtKT0+e3ZhciBjO3JldHVybihjPXQub25TdGF0ZVNuYXBzaG90RXZlbnQpPT1udWxsP3ZvaWQgMDpjLmNhbGwodCx7ZXZlbnQ6RSxtZXNzYWdlczpTLHN0YXRlOm0sYWdlbnQ6bixpbnB1dDp1fSl9KTtpZihyKGcpLGcuc3RvcFByb3BhZ2F0aW9uIT09ITApe2xldHtzbmFwc2hvdDp0fT1FO3M9dCxyKHtzdGF0ZTpzfSl9cmV0dXJuIGkoKX1jYXNlIHYuU1RBVEVfREVMVEE6e2xldCBnPWF3YWl0IHkoYSxlLHMsKHQsUyxtKT0+e3ZhciBjO3JldHVybihjPXQub25TdGF0ZURlbHRhRXZlbnQpPT1udWxsP3ZvaWQgMDpjLmNhbGwodCx7ZXZlbnQ6RSxtZXNzYWdlczpTLHN0YXRlOm0sYWdlbnQ6bixpbnB1dDp1fSl9KTtpZihyKGcpLGcuc3RvcFByb3BhZ2F0aW9uIT09ITApe2xldHtkZWx0YTp0fT1FO3RyeXtzPXVlKHMsdCwhMCwhMSkubmV3RG9jdW1lbnQscih7c3RhdGU6c30pfWNhdGNoKFMpe2xldCBtPVMgaW5zdGFuY2VvZiBFcnJvcj9TLm1lc3NhZ2U6U3RyaW5nKFMpO2NvbnNvbGUud2FybihgRmFpbGVkIHRvIGFwcGx5IHN0YXRlIHBhdGNoOlxuQ3VycmVudCBzdGF0ZTogJHtKU09OLnN0cmluZ2lmeShzLG51bGwsMil9XG5QYXRjaCBvcGVyYXRpb25zOiAke0pTT04uc3RyaW5naWZ5KHQsbnVsbCwyKX1cbkVycm9yOiAke219YCl9fXJldHVybiBpKCl9Y2FzZSB2Lk1FU1NBR0VTX1NOQVBTSE9UOntsZXQgZz1hd2FpdCB5KGEsZSxzLCh0LFMsbSk9Pnt2YXIgYztyZXR1cm4oYz10Lm9uTWVzc2FnZXNTbmFwc2hvdEV2ZW50KT09bnVsbD92b2lkIDA6Yy5jYWxsKHQse2V2ZW50OkUsbWVzc2FnZXM6UyxzdGF0ZTptLGFnZW50Om4saW5wdXQ6dX0pfSk7aWYocihnKSxnLnN0b3BQcm9wYWdhdGlvbiE9PSEwKXtsZXR7bWVzc2FnZXM6dH09RTtlPXQscih7bWVzc2FnZXM6ZX0pfXJldHVybiBpKCl9Y2FzZSB2LlJBVzp7bGV0IGc9YXdhaXQgeShhLGUscywodCxTLG0pPT57dmFyIGM7cmV0dXJuKGM9dC5vblJhd0V2ZW50KT09bnVsbD92b2lkIDA6Yy5jYWxsKHQse2V2ZW50OkUsbWVzc2FnZXM6UyxzdGF0ZTptLGFnZW50Om4saW5wdXQ6dX0pfSk7cmV0dXJuIHIoZyksaSgpfWNhc2Ugdi5DVVNUT006e2xldCBnPWF3YWl0IHkoYSxlLHMsKHQsUyxtKT0+e3ZhciBjO3JldHVybihjPXQub25DdXN0b21FdmVudCk9PW51bGw/dm9pZCAwOmMuY2FsbCh0LHtldmVudDpFLG1lc3NhZ2VzOlMsc3RhdGU6bSxhZ2VudDpuLGlucHV0OnV9KX0pO3JldHVybiByKGcpLGkoKX1jYXNlIHYuUlVOX1NUQVJURUQ6e2xldCBnPWF3YWl0IHkoYSxlLHMsKHQsUyxtKT0+e3ZhciBjO3JldHVybihjPXQub25SdW5TdGFydGVkRXZlbnQpPT1udWxsP3ZvaWQgMDpjLmNhbGwodCx7ZXZlbnQ6RSxtZXNzYWdlczpTLHN0YXRlOm0sYWdlbnQ6bixpbnB1dDp1fSl9KTtyZXR1cm4gcihnKSxpKCl9Y2FzZSB2LlJVTl9GSU5JU0hFRDp7bGV0IGc9YXdhaXQgeShhLGUscywodCxTLG0pPT57dmFyIGM7cmV0dXJuKGM9dC5vblJ1bkZpbmlzaGVkRXZlbnQpPT1udWxsP3ZvaWQgMDpjLmNhbGwodCx7ZXZlbnQ6RSxtZXNzYWdlczpTLHN0YXRlOm0sYWdlbnQ6bixpbnB1dDp1LHJlc3VsdDpFLnJlc3VsdH0pfSk7cmV0dXJuIHIoZyksaSgpfWNhc2Ugdi5SVU5fRVJST1I6e2xldCBnPWF3YWl0IHkoYSxlLHMsKHQsUyxtKT0+e3ZhciBjO3JldHVybihjPXQub25SdW5FcnJvckV2ZW50KT09bnVsbD92b2lkIDA6Yy5jYWxsKHQse2V2ZW50OkUsbWVzc2FnZXM6UyxzdGF0ZTptLGFnZW50Om4saW5wdXQ6dX0pfSk7cmV0dXJuIHIoZyksaSgpfWNhc2Ugdi5TVEVQX1NUQVJURUQ6e2xldCBnPWF3YWl0IHkoYSxlLHMsKHQsUyxtKT0+e3ZhciBjO3JldHVybihjPXQub25TdGVwU3RhcnRlZEV2ZW50KT09bnVsbD92b2lkIDA6Yy5jYWxsKHQse2V2ZW50OkUsbWVzc2FnZXM6UyxzdGF0ZTptLGFnZW50Om4saW5wdXQ6dX0pfSk7cmV0dXJuIHIoZyksaSgpfWNhc2Ugdi5TVEVQX0ZJTklTSEVEOntsZXQgZz1hd2FpdCB5KGEsZSxzLCh0LFMsbSk9Pnt2YXIgYztyZXR1cm4oYz10Lm9uU3RlcEZpbmlzaGVkRXZlbnQpPT1udWxsP3ZvaWQgMDpjLmNhbGwodCx7ZXZlbnQ6RSxtZXNzYWdlczpTLHN0YXRlOm0sYWdlbnQ6bixpbnB1dDp1fSl9KTtyZXR1cm4gcihnKSxpKCl9Y2FzZSB2LlRFWFRfTUVTU0FHRV9DSFVOSzp0aHJvdyBuZXcgRXJyb3IoXCJURVhUX01FU1NBR0VfQ0hVTksgbXVzdCBiZSB0cmFuZm9ybWVkIGJlZm9yZSBiZWluZyBhcHBsaWVkXCIpO2Nhc2Ugdi5UT09MX0NBTExfQ0hVTks6dGhyb3cgbmV3IEVycm9yKFwiVE9PTF9DQUxMX0NIVU5LIG11c3QgYmUgdHJhbmZvcm1lZCBiZWZvcmUgYmVpbmcgYXBwbGllZFwiKTtjYXNlIHYuVEhJTktJTkdfU1RBUlQ6cmV0dXJuIGkoKTtjYXNlIHYuVEhJTktJTkdfRU5EOnJldHVybiBpKCk7Y2FzZSB2LlRISU5LSU5HX1RFWFRfTUVTU0FHRV9TVEFSVDpyZXR1cm4gaSgpO2Nhc2Ugdi5USElOS0lOR19URVhUX01FU1NBR0VfQ09OVEVOVDpyZXR1cm4gaSgpO2Nhc2Ugdi5USElOS0lOR19URVhUX01FU1NBR0VfRU5EOnJldHVybiBpKCl9bGV0IHc9RS50eXBlO3JldHVybiBpKCl9KSxpZSgpLGEubGVuZ3RoPjA/bGUoe30pOkU9PkUpfTtpbXBvcnR7RXZlbnRUeXBlIGFzIE0sQUdVSUVycm9yIGFzIFJ9ZnJvbVwiQGFnLXVpL2NvcmVcIjtpbXBvcnR7dGhyb3dFcnJvciBhcyBfLG9mIGFzIE59ZnJvbVwicnhqc1wiO2ltcG9ydHttZXJnZU1hcCBhcyBtZX1mcm9tXCJyeGpzL29wZXJhdG9yc1wiO3ZhciBVPXU9Pm89PntsZXQgbj1uZXcgTWFwLGE9bmV3IE1hcCxlPSExLHM9ITEsbD0hMSxyPW5ldyBNYXAsaT0hMSxFPSExLGg9ITEsdz0oKT0+e24uY2xlYXIoKSxhLmNsZWFyKCksci5jbGVhcigpLGk9ITEsRT0hMSxlPSExLHM9ITEsaD0hMH07cmV0dXJuIG8ucGlwZShtZShkPT57bGV0IGc9ZC50eXBlO2lmKHUmJmNvbnNvbGUuZGVidWcoXCJbVkVSSUZZXTpcIixKU09OLnN0cmluZ2lmeShkKSkscylyZXR1cm4gXygoKT0+bmV3IFIoYENhbm5vdCBzZW5kIGV2ZW50IHR5cGUgJyR7Z30nOiBUaGUgcnVuIGhhcyBhbHJlYWR5IGVycm9yZWQgd2l0aCAnUlVOX0VSUk9SJy4gTm8gZnVydGhlciBldmVudHMgY2FuIGJlIHNlbnQuYCkpO2lmKGUmJmchPT1NLlJVTl9FUlJPUiYmZyE9PU0uUlVOX1NUQVJURUQpcmV0dXJuIF8oKCk9Pm5ldyBSKGBDYW5ub3Qgc2VuZCBldmVudCB0eXBlICcke2d9JzogVGhlIHJ1biBoYXMgYWxyZWFkeSBmaW5pc2hlZCB3aXRoICdSVU5fRklOSVNIRUQnLiBTdGFydCBhIG5ldyBydW4gd2l0aCAnUlVOX1NUQVJURUQnLmApKTtpZihsKXtpZihnPT09TS5SVU5fU1RBUlRFRCl7aWYoaCYmIWUpcmV0dXJuIF8oKCk9Pm5ldyBSKFwiQ2Fubm90IHNlbmQgJ1JVTl9TVEFSVEVEJyB3aGlsZSBhIHJ1biBpcyBzdGlsbCBhY3RpdmUuIFRoZSBwcmV2aW91cyBydW4gbXVzdCBiZSBmaW5pc2hlZCB3aXRoICdSVU5fRklOSVNIRUQnIGJlZm9yZSBzdGFydGluZyBhIG5ldyBydW4uXCIpKTtlJiZ3KCl9fWVsc2UgaWYobD0hMCxnIT09TS5SVU5fU1RBUlRFRCYmZyE9PU0uUlVOX0VSUk9SKXJldHVybiBfKCgpPT5uZXcgUihcIkZpcnN0IGV2ZW50IG11c3QgYmUgJ1JVTl9TVEFSVEVEJ1wiKSk7c3dpdGNoKGcpe2Nhc2UgTS5URVhUX01FU1NBR0VfU1RBUlQ6e2xldCB0PWQubWVzc2FnZUlkO3JldHVybiBuLmhhcyh0KT9fKCgpPT5uZXcgUihgQ2Fubm90IHNlbmQgJ1RFWFRfTUVTU0FHRV9TVEFSVCcgZXZlbnQ6IEEgdGV4dCBtZXNzYWdlIHdpdGggSUQgJyR7dH0nIGlzIGFscmVhZHkgaW4gcHJvZ3Jlc3MuIENvbXBsZXRlIGl0IHdpdGggJ1RFWFRfTUVTU0FHRV9FTkQnIGZpcnN0LmApKToobi5zZXQodCwhMCksTihkKSl9Y2FzZSBNLlRFWFRfTUVTU0FHRV9DT05URU5UOntsZXQgdD1kLm1lc3NhZ2VJZDtyZXR1cm4gbi5oYXModCk/TihkKTpfKCgpPT5uZXcgUihgQ2Fubm90IHNlbmQgJ1RFWFRfTUVTU0FHRV9DT05URU5UJyBldmVudDogTm8gYWN0aXZlIHRleHQgbWVzc2FnZSBmb3VuZCB3aXRoIElEICcke3R9Jy4gU3RhcnQgYSB0ZXh0IG1lc3NhZ2Ugd2l0aCAnVEVYVF9NRVNTQUdFX1NUQVJUJyBmaXJzdC5gKSl9Y2FzZSBNLlRFWFRfTUVTU0FHRV9FTkQ6e2xldCB0PWQubWVzc2FnZUlkO3JldHVybiBuLmhhcyh0KT8obi5kZWxldGUodCksTihkKSk6XygoKT0+bmV3IFIoYENhbm5vdCBzZW5kICdURVhUX01FU1NBR0VfRU5EJyBldmVudDogTm8gYWN0aXZlIHRleHQgbWVzc2FnZSBmb3VuZCB3aXRoIElEICcke3R9Jy4gQSAnVEVYVF9NRVNTQUdFX1NUQVJUJyBldmVudCBtdXN0IGJlIHNlbnQgZmlyc3QuYCkpfWNhc2UgTS5UT09MX0NBTExfU1RBUlQ6e2xldCB0PWQudG9vbENhbGxJZDtyZXR1cm4gYS5oYXModCk/XygoKT0+bmV3IFIoYENhbm5vdCBzZW5kICdUT09MX0NBTExfU1RBUlQnIGV2ZW50OiBBIHRvb2wgY2FsbCB3aXRoIElEICcke3R9JyBpcyBhbHJlYWR5IGluIHByb2dyZXNzLiBDb21wbGV0ZSBpdCB3aXRoICdUT09MX0NBTExfRU5EJyBmaXJzdC5gKSk6KGEuc2V0KHQsITApLE4oZCkpfWNhc2UgTS5UT09MX0NBTExfQVJHUzp7bGV0IHQ9ZC50b29sQ2FsbElkO3JldHVybiBhLmhhcyh0KT9OKGQpOl8oKCk9Pm5ldyBSKGBDYW5ub3Qgc2VuZCAnVE9PTF9DQUxMX0FSR1MnIGV2ZW50OiBObyBhY3RpdmUgdG9vbCBjYWxsIGZvdW5kIHdpdGggSUQgJyR7dH0nLiBTdGFydCBhIHRvb2wgY2FsbCB3aXRoICdUT09MX0NBTExfU1RBUlQnIGZpcnN0LmApKX1jYXNlIE0uVE9PTF9DQUxMX0VORDp7bGV0IHQ9ZC50b29sQ2FsbElkO3JldHVybiBhLmhhcyh0KT8oYS5kZWxldGUodCksTihkKSk6XygoKT0+bmV3IFIoYENhbm5vdCBzZW5kICdUT09MX0NBTExfRU5EJyBldmVudDogTm8gYWN0aXZlIHRvb2wgY2FsbCBmb3VuZCB3aXRoIElEICcke3R9Jy4gQSAnVE9PTF9DQUxMX1NUQVJUJyBldmVudCBtdXN0IGJlIHNlbnQgZmlyc3QuYCkpfWNhc2UgTS5TVEVQX1NUQVJURUQ6e2xldCB0PWQuc3RlcE5hbWU7cmV0dXJuIHIuaGFzKHQpP18oKCk9Pm5ldyBSKGBTdGVwIFwiJHt0fVwiIGlzIGFscmVhZHkgYWN0aXZlIGZvciAnU1RFUF9TVEFSVEVEJ2ApKTooci5zZXQodCwhMCksTihkKSl9Y2FzZSBNLlNURVBfRklOSVNIRUQ6e2xldCB0PWQuc3RlcE5hbWU7cmV0dXJuIHIuaGFzKHQpPyhyLmRlbGV0ZSh0KSxOKGQpKTpfKCgpPT5uZXcgUihgQ2Fubm90IHNlbmQgJ1NURVBfRklOSVNIRUQnIGZvciBzdGVwIFwiJHt0fVwiIHRoYXQgd2FzIG5vdCBzdGFydGVkYCkpfWNhc2UgTS5SVU5fU1RBUlRFRDpyZXR1cm4gaD0hMCxOKGQpO2Nhc2UgTS5SVU5fRklOSVNIRUQ6e2lmKHIuc2l6ZT4wKXtsZXQgdD1BcnJheS5mcm9tKHIua2V5cygpKS5qb2luKFwiLCBcIik7cmV0dXJuIF8oKCk9Pm5ldyBSKGBDYW5ub3Qgc2VuZCAnUlVOX0ZJTklTSEVEJyB3aGlsZSBzdGVwcyBhcmUgc3RpbGwgYWN0aXZlOiAke3R9YCkpfWlmKG4uc2l6ZT4wKXtsZXQgdD1BcnJheS5mcm9tKG4ua2V5cygpKS5qb2luKFwiLCBcIik7cmV0dXJuIF8oKCk9Pm5ldyBSKGBDYW5ub3Qgc2VuZCAnUlVOX0ZJTklTSEVEJyB3aGlsZSB0ZXh0IG1lc3NhZ2VzIGFyZSBzdGlsbCBhY3RpdmU6ICR7dH1gKSl9aWYoYS5zaXplPjApe2xldCB0PUFycmF5LmZyb20oYS5rZXlzKCkpLmpvaW4oXCIsIFwiKTtyZXR1cm4gXygoKT0+bmV3IFIoYENhbm5vdCBzZW5kICdSVU5fRklOSVNIRUQnIHdoaWxlIHRvb2wgY2FsbHMgYXJlIHN0aWxsIGFjdGl2ZTogJHt0fWApKX1yZXR1cm4gZT0hMCxOKGQpfWNhc2UgTS5SVU5fRVJST1I6cmV0dXJuIHM9ITAsTihkKTtjYXNlIE0uQ1VTVE9NOnJldHVybiBOKGQpO2Nhc2UgTS5USElOS0lOR19URVhUX01FU1NBR0VfU1RBUlQ6cmV0dXJuIGk/RT9fKCgpPT5uZXcgUihcIkNhbm5vdCBzZW5kICdUSElOS0lOR19URVhUX01FU1NBR0VfU1RBUlQnIGV2ZW50OiBBIHRoaW5raW5nIG1lc3NhZ2UgaXMgYWxyZWFkeSBpbiBwcm9ncmVzcy4gQ29tcGxldGUgaXQgd2l0aCAnVEhJTktJTkdfVEVYVF9NRVNTQUdFX0VORCcgZmlyc3QuXCIpKTooRT0hMCxOKGQpKTpfKCgpPT5uZXcgUihcIkNhbm5vdCBzZW5kICdUSElOS0lOR19URVhUX01FU1NBR0VfU1RBUlQnIGV2ZW50OiBBIHRoaW5raW5nIHN0ZXAgaXMgbm90IGluIHByb2dyZXNzLiBDcmVhdGUgb25lIHdpdGggJ1RISU5LSU5HX1NUQVJUJyBmaXJzdC5cIikpO2Nhc2UgTS5USElOS0lOR19URVhUX01FU1NBR0VfQ09OVEVOVDpyZXR1cm4gRT9OKGQpOl8oKCk9Pm5ldyBSKFwiQ2Fubm90IHNlbmQgJ1RISU5LSU5HX1RFWFRfTUVTU0FHRV9DT05URU5UJyBldmVudDogTm8gYWN0aXZlIHRoaW5raW5nIG1lc3NhZ2UgZm91bmQuIFN0YXJ0IGEgbWVzc2FnZSB3aXRoICdUSElOS0lOR19URVhUX01FU1NBR0VfU1RBUlQnIGZpcnN0LlwiKSk7Y2FzZSBNLlRISU5LSU5HX1RFWFRfTUVTU0FHRV9FTkQ6cmV0dXJuIEU/KEU9ITEsTihkKSk6XygoKT0+bmV3IFIoXCJDYW5ub3Qgc2VuZCAnVEhJTktJTkdfVEVYVF9NRVNTQUdFX0VORCcgZXZlbnQ6IE5vIGFjdGl2ZSB0aGlua2luZyBtZXNzYWdlIGZvdW5kLiBBICdUSElOS0lOR19URVhUX01FU1NBR0VfU1RBUlQnIGV2ZW50IG11c3QgYmUgc2VudCBmaXJzdC5cIikpO2Nhc2UgTS5USElOS0lOR19TVEFSVDpyZXR1cm4gaT9fKCgpPT5uZXcgUihcIkNhbm5vdCBzZW5kICdUSElOS0lOR19TVEFSVCcgZXZlbnQ6IEEgdGhpbmtpbmcgc3RlcCBpcyBhbHJlYWR5IGluIHByb2dyZXNzLiBFbmQgaXQgd2l0aCAnVEhJTktJTkdfRU5EJyBmaXJzdC5cIikpOihpPSEwLE4oZCkpO2Nhc2UgTS5USElOS0lOR19FTkQ6cmV0dXJuIGk/KGk9ITEsTihkKSk6XygoKT0+bmV3IFIoXCJDYW5ub3Qgc2VuZCAnVEhJTktJTkdfRU5EJyBldmVudDogTm8gYWN0aXZlIHRoaW5raW5nIHN0ZXAgZm91bmQuIEEgJ1RISU5LSU5HX1NUQVJUJyBldmVudCBtdXN0IGJlIHNlbnQgZmlyc3QuXCIpKTtkZWZhdWx0OnJldHVybiBOKGQpfX0pKX07aW1wb3J0e0V2ZW50U2NoZW1hcyBhcyBoZX1mcm9tXCJAYWctdWkvY29yZVwiO2ltcG9ydHtTdWJqZWN0IGFzIHllLFJlcGxheVN1YmplY3QgYXMgTWV9ZnJvbVwicnhqc1wiO2ltcG9ydHtPYnNlcnZhYmxlIGFzIFNlLGZyb20gYXMgWSxkZWZlciBhcyBkZSx0aHJvd0Vycm9yIGFzIFF9ZnJvbVwicnhqc1wiO2ltcG9ydHttZXJnZU1hcCBhcyBmZSxzd2l0Y2hNYXAgYXMgVGV9ZnJvbVwicnhqcy9vcGVyYXRvcnNcIjt2YXIgaj0odSxvKT0+ZGUoKCk9PlkoZmV0Y2godSxvKSkpLnBpcGUoVGUobj0+e3ZhciBzO2lmKCFuLm9rKXtsZXQgbD1uLmhlYWRlcnMuZ2V0KFwiY29udGVudC10eXBlXCIpfHxcIlwiO3JldHVybiBZKG4udGV4dCgpKS5waXBlKGZlKHI9PntsZXQgaT1yO2lmKGwuaW5jbHVkZXMoXCJhcHBsaWNhdGlvbi9qc29uXCIpKXRyeXtpPUpTT04ucGFyc2Uocil9Y2F0Y2goaCl7fWxldCBFPW5ldyBFcnJvcihgSFRUUCAke24uc3RhdHVzfTogJHt0eXBlb2YgaT09XCJzdHJpbmdcIj9pOkpTT04uc3RyaW5naWZ5KGkpfWApO3JldHVybiBFLnN0YXR1cz1uLnN0YXR1cyxFLnBheWxvYWQ9aSxRKCgpPT5FKX0pKX1sZXQgYT17dHlwZTpcImhlYWRlcnNcIixzdGF0dXM6bi5zdGF0dXMsaGVhZGVyczpuLmhlYWRlcnN9LGU9KHM9bi5ib2R5KT09bnVsbD92b2lkIDA6cy5nZXRSZWFkZXIoKTtyZXR1cm4gZT9uZXcgU2UobD0+KGwubmV4dChhKSwoYXN5bmMoKT0+e3RyeXtmb3IoOzspe2xldHtkb25lOnIsdmFsdWU6aX09YXdhaXQgZS5yZWFkKCk7aWYocilicmVhaztsZXQgRT17dHlwZTpcImRhdGFcIixkYXRhOml9O2wubmV4dChFKX1sLmNvbXBsZXRlKCl9Y2F0Y2gocil7bC5lcnJvcihyKX19KSgpLCgpPT57ZS5jYW5jZWwoKX0pKTpRKCgpPT5uZXcgRXJyb3IoXCJGYWlsZWQgdG8gZ2V0UmVhZGVyKCkgZnJvbSByZXNwb25zZVwiKSl9KSk7aW1wb3J0e1N1YmplY3QgYXMgQWV9ZnJvbVwicnhqc1wiO3ZhciB6PXU9PntsZXQgbz1uZXcgQWUsbj1uZXcgVGV4dERlY29kZXIoXCJ1dGYtOFwiLHtmYXRhbDohMX0pLGE9XCJcIjt1LnN1YnNjcmliZSh7bmV4dDpzPT57aWYocy50eXBlIT09XCJoZWFkZXJzXCImJnMudHlwZT09PVwiZGF0YVwiJiZzLmRhdGEpe2xldCBsPW4uZGVjb2RlKHMuZGF0YSx7c3RyZWFtOiEwfSk7YSs9bDtsZXQgcj1hLnNwbGl0KC9cXG5cXG4vKTthPXIucG9wKCl8fFwiXCI7Zm9yKGxldCBpIG9mIHIpZShpKX19LGVycm9yOnM9Pm8uZXJyb3IocyksY29tcGxldGU6KCk9PnthJiYoYSs9bi5kZWNvZGUoKSxlKGEpKSxvLmNvbXBsZXRlKCl9fSk7ZnVuY3Rpb24gZShzKXtsZXQgbD1zLnNwbGl0KGBcbmApLHI9W107Zm9yKGxldCBpIG9mIGwpaS5zdGFydHNXaXRoKFwiZGF0YTogXCIpJiZyLnB1c2goaS5zbGljZSg2KSk7aWYoci5sZW5ndGg+MCl0cnl7bGV0IGk9ci5qb2luKGBcbmApLEU9SlNPTi5wYXJzZShpKTtvLm5leHQoRSl9Y2F0Y2goaSl7by5lcnJvcihpKX19cmV0dXJuIG8uYXNPYnNlcnZhYmxlKCl9O2ltcG9ydHtTdWJqZWN0IGFzIHZlfWZyb21cInJ4anNcIjtpbXBvcnQqYXMgWiBmcm9tXCJAYWctdWkvcHJvdG9cIjt2YXIgQj11PT57bGV0IG89bmV3IHZlLG49bmV3IFVpbnQ4QXJyYXkoMCk7dS5zdWJzY3JpYmUoe25leHQ6ZT0+e2lmKGUudHlwZSE9PVwiaGVhZGVyc1wiJiZlLnR5cGU9PT1cImRhdGFcIiYmZS5kYXRhKXtsZXQgcz1uZXcgVWludDhBcnJheShuLmxlbmd0aCtlLmRhdGEubGVuZ3RoKTtzLnNldChuLDApLHMuc2V0KGUuZGF0YSxuLmxlbmd0aCksbj1zLGEoKX19LGVycm9yOmU9Pm8uZXJyb3IoZSksY29tcGxldGU6KCk9PntpZihuLmxlbmd0aD4wKXRyeXthKCl9Y2F0Y2goZSl7Y29uc29sZS53YXJuKFwiSW5jb21wbGV0ZSBvciBpbnZhbGlkIHByb3RvY29sIGJ1ZmZlciBkYXRhIGF0IHN0cmVhbSBlbmRcIil9by5jb21wbGV0ZSgpfX0pO2Z1bmN0aW9uIGEoKXtmb3IoO24ubGVuZ3RoPj00Oyl7bGV0IGw9NCtuZXcgRGF0YVZpZXcobi5idWZmZXIsbi5ieXRlT2Zmc2V0LDQpLmdldFVpbnQzMigwLCExKTtpZihuLmxlbmd0aDxsKWJyZWFrO3RyeXtsZXQgcj1uLnNsaWNlKDQsbCksaT1aLmRlY29kZShyKTtvLm5leHQoaSksbj1uLnNsaWNlKGwpfWNhdGNoKHIpe2xldCBpPXIgaW5zdGFuY2VvZiBFcnJvcj9yLm1lc3NhZ2U6U3RyaW5nKHIpO28uZXJyb3IobmV3IEVycm9yKGBGYWlsZWQgdG8gZGVjb2RlIHByb3RvY29sIGJ1ZmZlciBtZXNzYWdlOiAke2l9YCkpO3JldHVybn19fXJldHVybiBvLmFzT2JzZXJ2YWJsZSgpfTtpbXBvcnQqYXMgZWUgZnJvbVwiQGFnLXVpL3Byb3RvXCI7dmFyIEo9dT0+e2xldCBvPW5ldyB5ZSxuPW5ldyBNZSxhPSExO3JldHVybiB1LnN1YnNjcmliZSh7bmV4dDplPT57bi5uZXh0KGUpLGUudHlwZT09PVwiaGVhZGVyc1wiJiYhYT8oYT0hMCxlLmhlYWRlcnMuZ2V0KFwiY29udGVudC10eXBlXCIpPT09ZWUuQUdVSV9NRURJQV9UWVBFP0Iobikuc3Vic2NyaWJlKHtuZXh0Omw9Pm8ubmV4dChsKSxlcnJvcjpsPT5vLmVycm9yKGwpLGNvbXBsZXRlOigpPT5vLmNvbXBsZXRlKCl9KTp6KG4pLnN1YnNjcmliZSh7bmV4dDpsPT57dHJ5e2xldCByPWhlLnBhcnNlKGwpO28ubmV4dChyKX1jYXRjaChyKXtvLmVycm9yKHIpfX0sZXJyb3I6bD0+by5lcnJvcihsKSxjb21wbGV0ZTooKT0+by5jb21wbGV0ZSgpfSkpOmF8fG8uZXJyb3IobmV3IEVycm9yKFwiTm8gaGVhZGVycyBldmVudCByZWNlaXZlZCBiZWZvcmUgZGF0YSBldmVudHNcIikpfSxlcnJvcjplPT57bi5lcnJvcihlKSxvLmVycm9yKGUpfSxjb21wbGV0ZTooKT0+e24uY29tcGxldGUoKX19KSxvLmFzT2JzZXJ2YWJsZSgpfTtpbXBvcnR7bWVyZ2VNYXAgYXMgSGV9ZnJvbVwicnhqcy9vcGVyYXRvcnNcIjtpbXBvcnR7YXBwbHlQYXRjaCBhcyBHZX1mcm9tXCJmYXN0LWpzb24tcGF0Y2hcIjtpbXBvcnR7RXZlbnRUeXBlIGFzIEl9ZnJvbVwiQGFnLXVpL2NvcmVcIjtpbXBvcnR7eiBhcyBwfWZyb21cInpvZFwiO3ZhciBBPXAuZW51bShbXCJUZXh0TWVzc2FnZVN0YXJ0XCIsXCJUZXh0TWVzc2FnZUNvbnRlbnRcIixcIlRleHRNZXNzYWdlRW5kXCIsXCJBY3Rpb25FeGVjdXRpb25TdGFydFwiLFwiQWN0aW9uRXhlY3V0aW9uQXJnc1wiLFwiQWN0aW9uRXhlY3V0aW9uRW5kXCIsXCJBY3Rpb25FeGVjdXRpb25SZXN1bHRcIixcIkFnZW50U3RhdGVNZXNzYWdlXCIsXCJNZXRhRXZlbnRcIixcIlJ1blN0YXJ0ZWRcIixcIlJ1bkZpbmlzaGVkXCIsXCJSdW5FcnJvclwiLFwiTm9kZVN0YXJ0ZWRcIixcIk5vZGVGaW5pc2hlZFwiXSksQ2U9cC5lbnVtKFtcIkxhbmdHcmFwaEludGVycnVwdEV2ZW50XCIsXCJQcmVkaWN0U3RhdGVcIixcIkV4aXRcIl0pLFJlPXAub2JqZWN0KHt0eXBlOnAubGl0ZXJhbChBLmVudW0uVGV4dE1lc3NhZ2VTdGFydCksbWVzc2FnZUlkOnAuc3RyaW5nKCkscGFyZW50TWVzc2FnZUlkOnAuc3RyaW5nKCkub3B0aW9uYWwoKSxyb2xlOnAuc3RyaW5nKCkub3B0aW9uYWwoKX0pLF9lPXAub2JqZWN0KHt0eXBlOnAubGl0ZXJhbChBLmVudW0uVGV4dE1lc3NhZ2VDb250ZW50KSxtZXNzYWdlSWQ6cC5zdHJpbmcoKSxjb250ZW50OnAuc3RyaW5nKCl9KSxOZT1wLm9iamVjdCh7dHlwZTpwLmxpdGVyYWwoQS5lbnVtLlRleHRNZXNzYWdlRW5kKSxtZXNzYWdlSWQ6cC5zdHJpbmcoKX0pLHhlPXAub2JqZWN0KHt0eXBlOnAubGl0ZXJhbChBLmVudW0uQWN0aW9uRXhlY3V0aW9uU3RhcnQpLGFjdGlvbkV4ZWN1dGlvbklkOnAuc3RyaW5nKCksYWN0aW9uTmFtZTpwLnN0cmluZygpLHBhcmVudE1lc3NhZ2VJZDpwLnN0cmluZygpLm9wdGlvbmFsKCl9KSxJZT1wLm9iamVjdCh7dHlwZTpwLmxpdGVyYWwoQS5lbnVtLkFjdGlvbkV4ZWN1dGlvbkFyZ3MpLGFjdGlvbkV4ZWN1dGlvbklkOnAuc3RyaW5nKCksYXJnczpwLnN0cmluZygpfSksTGU9cC5vYmplY3Qoe3R5cGU6cC5saXRlcmFsKEEuZW51bS5BY3Rpb25FeGVjdXRpb25FbmQpLGFjdGlvbkV4ZWN1dGlvbklkOnAuc3RyaW5nKCl9KSxPZT1wLm9iamVjdCh7dHlwZTpwLmxpdGVyYWwoQS5lbnVtLkFjdGlvbkV4ZWN1dGlvblJlc3VsdCksYWN0aW9uTmFtZTpwLnN0cmluZygpLGFjdGlvbkV4ZWN1dGlvbklkOnAuc3RyaW5nKCkscmVzdWx0OnAuc3RyaW5nKCl9KSx3ZT1wLm9iamVjdCh7dHlwZTpwLmxpdGVyYWwoQS5lbnVtLkFnZW50U3RhdGVNZXNzYWdlKSx0aHJlYWRJZDpwLnN0cmluZygpLGFnZW50TmFtZTpwLnN0cmluZygpLG5vZGVOYW1lOnAuc3RyaW5nKCkscnVuSWQ6cC5zdHJpbmcoKSxhY3RpdmU6cC5ib29sZWFuKCkscm9sZTpwLnN0cmluZygpLHN0YXRlOnAuc3RyaW5nKCkscnVubmluZzpwLmJvb2xlYW4oKX0pLFBlPXAub2JqZWN0KHt0eXBlOnAubGl0ZXJhbChBLmVudW0uTWV0YUV2ZW50KSxuYW1lOkNlLHZhbHVlOnAuYW55KCl9KSxEZT1wLm9iamVjdCh7dHlwZTpwLmxpdGVyYWwoQS5lbnVtLlJ1bkVycm9yKSxtZXNzYWdlOnAuc3RyaW5nKCksY29kZTpwLnN0cmluZygpLm9wdGlvbmFsKCl9KSxmbj1wLmRpc2NyaW1pbmF0ZWRVbmlvbihcInR5cGVcIixbUmUsX2UsTmUseGUsSWUsTGUsT2Usd2UsUGUsRGVdKSxUbj1wLm9iamVjdCh7aWQ6cC5zdHJpbmcoKSxyb2xlOnAuc3RyaW5nKCksY29udGVudDpwLnN0cmluZygpLHBhcmVudE1lc3NhZ2VJZDpwLnN0cmluZygpLm9wdGlvbmFsKCl9KSxBbj1wLm9iamVjdCh7aWQ6cC5zdHJpbmcoKSxuYW1lOnAuc3RyaW5nKCksYXJndW1lbnRzOnAuYW55KCkscGFyZW50TWVzc2FnZUlkOnAuc3RyaW5nKCkub3B0aW9uYWwoKX0pLHZuPXAub2JqZWN0KHtpZDpwLnN0cmluZygpLHJlc3VsdDpwLmFueSgpLGFjdGlvbkV4ZWN1dGlvbklkOnAuc3RyaW5nKCksYWN0aW9uTmFtZTpwLnN0cmluZygpfSk7aW1wb3J0IEZlIGZyb21cInVudHJ1bmNhdGUtanNvblwiO3ZhciAkPSh1LG8sbik9PmE9PntsZXQgZT17fSxzPSEwLGw9ITAscj1cIlwiLGk9bnVsbCxFPW51bGwsaD1bXSx3PXt9LGQ9Zz0+e3R5cGVvZiBnPT1cIm9iamVjdFwiJiZnIT09bnVsbCYmKFwibWVzc2FnZXNcImluIGcmJmRlbGV0ZSBnLm1lc3NhZ2VzLGU9Zyl9O3JldHVybiBhLnBpcGUoSGUoZz0+e3N3aXRjaChnLnR5cGUpe2Nhc2UgSS5URVhUX01FU1NBR0VfU1RBUlQ6e2xldCB0PWc7cmV0dXJuW3t0eXBlOkEuZW51bS5UZXh0TWVzc2FnZVN0YXJ0LG1lc3NhZ2VJZDp0Lm1lc3NhZ2VJZCxyb2xlOnQucm9sZX1dfWNhc2UgSS5URVhUX01FU1NBR0VfQ09OVEVOVDp7bGV0IHQ9ZztyZXR1cm5be3R5cGU6QS5lbnVtLlRleHRNZXNzYWdlQ29udGVudCxtZXNzYWdlSWQ6dC5tZXNzYWdlSWQsY29udGVudDp0LmRlbHRhfV19Y2FzZSBJLlRFWFRfTUVTU0FHRV9FTkQ6e2xldCB0PWc7cmV0dXJuW3t0eXBlOkEuZW51bS5UZXh0TWVzc2FnZUVuZCxtZXNzYWdlSWQ6dC5tZXNzYWdlSWR9XX1jYXNlIEkuVE9PTF9DQUxMX1NUQVJUOntsZXQgdD1nO3JldHVybiBoLnB1c2goe2lkOnQudG9vbENhbGxJZCx0eXBlOlwiZnVuY3Rpb25cIixmdW5jdGlvbjp7bmFtZTp0LnRvb2xDYWxsTmFtZSxhcmd1bWVudHM6XCJcIn19KSxsPSEwLHdbdC50b29sQ2FsbElkXT10LnRvb2xDYWxsTmFtZSxbe3R5cGU6QS5lbnVtLkFjdGlvbkV4ZWN1dGlvblN0YXJ0LGFjdGlvbkV4ZWN1dGlvbklkOnQudG9vbENhbGxJZCxhY3Rpb25OYW1lOnQudG9vbENhbGxOYW1lLHBhcmVudE1lc3NhZ2VJZDp0LnBhcmVudE1lc3NhZ2VJZH1dfWNhc2UgSS5UT09MX0NBTExfQVJHUzp7bGV0IHQ9ZyxTPWguZmluZChjPT5jLmlkPT09dC50b29sQ2FsbElkKTtpZighUylyZXR1cm4gY29uc29sZS53YXJuKGBUT09MX0NBTExfQVJHUzogTm8gdG9vbCBjYWxsIGZvdW5kIHdpdGggSUQgJyR7dC50b29sQ2FsbElkfSdgKSxbXTtTLmZ1bmN0aW9uLmFyZ3VtZW50cys9dC5kZWx0YTtsZXQgbT0hMTtpZihFKXtsZXQgYz1FLmZpbmQoVD0+VC50b29sPT1TLmZ1bmN0aW9uLm5hbWUpO2lmKGMpdHJ5e2xldCBUPUpTT04ucGFyc2UoRmUoUy5mdW5jdGlvbi5hcmd1bWVudHMpKTtjLnRvb2xfYXJndW1lbnQmJmMudG9vbF9hcmd1bWVudCBpbiBUPyhkKEgoTCh7fSxlKSx7W2Muc3RhdGVfa2V5XTpUW2MudG9vbF9hcmd1bWVudF19KSksbT0hMCk6Yy50b29sX2FyZ3VtZW50fHwoZChIKEwoe30sZSkse1tjLnN0YXRlX2tleV06VH0pKSxtPSEwKX1jYXRjaChUKXt9fXJldHVyblt7dHlwZTpBLmVudW0uQWN0aW9uRXhlY3V0aW9uQXJncyxhY3Rpb25FeGVjdXRpb25JZDp0LnRvb2xDYWxsSWQsYXJnczp0LmRlbHRhfSwuLi5tP1t7dHlwZTpBLmVudW0uQWdlbnRTdGF0ZU1lc3NhZ2UsdGhyZWFkSWQ6dSxhZ2VudE5hbWU6bixub2RlTmFtZTpyLHJ1bklkOm8scnVubmluZzpzLHJvbGU6XCJhc3Npc3RhbnRcIixzdGF0ZTpKU09OLnN0cmluZ2lmeShlKSxhY3RpdmU6bH1dOltdXX1jYXNlIEkuVE9PTF9DQUxMX0VORDp7bGV0IHQ9ZztyZXR1cm5be3R5cGU6QS5lbnVtLkFjdGlvbkV4ZWN1dGlvbkVuZCxhY3Rpb25FeGVjdXRpb25JZDp0LnRvb2xDYWxsSWR9XX1jYXNlIEkuVE9PTF9DQUxMX1JFU1VMVDp7bGV0IHQ9ZztyZXR1cm5be3R5cGU6QS5lbnVtLkFjdGlvbkV4ZWN1dGlvblJlc3VsdCxhY3Rpb25FeGVjdXRpb25JZDp0LnRvb2xDYWxsSWQscmVzdWx0OnQuY29udGVudCxhY3Rpb25OYW1lOndbdC50b29sQ2FsbElkXXx8XCJ1bmtub3duXCJ9XX1jYXNlIEkuUkFXOnJldHVybltdO2Nhc2UgSS5DVVNUT006e2xldCB0PWc7c3dpdGNoKHQubmFtZSl7Y2FzZVwiRXhpdFwiOnM9ITE7YnJlYWs7Y2FzZVwiUHJlZGljdFN0YXRlXCI6RT10LnZhbHVlO2JyZWFrfXJldHVyblt7dHlwZTpBLmVudW0uTWV0YUV2ZW50LG5hbWU6dC5uYW1lLHZhbHVlOnQudmFsdWV9XX1jYXNlIEkuU1RBVEVfU05BUFNIT1Q6cmV0dXJuIGQoZy5zbmFwc2hvdCksW3t0eXBlOkEuZW51bS5BZ2VudFN0YXRlTWVzc2FnZSx0aHJlYWRJZDp1LGFnZW50TmFtZTpuLG5vZGVOYW1lOnIscnVuSWQ6byxydW5uaW5nOnMscm9sZTpcImFzc2lzdGFudFwiLHN0YXRlOkpTT04uc3RyaW5naWZ5KGUpLGFjdGl2ZTpsfV07Y2FzZSBJLlNUQVRFX0RFTFRBOntsZXQgUz1HZShlLGcuZGVsdGEsITAsITEpO3JldHVybiBTPyhkKFMubmV3RG9jdW1lbnQpLFt7dHlwZTpBLmVudW0uQWdlbnRTdGF0ZU1lc3NhZ2UsdGhyZWFkSWQ6dSxhZ2VudE5hbWU6bixub2RlTmFtZTpyLHJ1bklkOm8scnVubmluZzpzLHJvbGU6XCJhc3Npc3RhbnRcIixzdGF0ZTpKU09OLnN0cmluZ2lmeShlKSxhY3RpdmU6bH1dKTpbXX1jYXNlIEkuTUVTU0FHRVNfU05BUFNIT1Q6cmV0dXJuIGk9Zy5tZXNzYWdlcyxbe3R5cGU6QS5lbnVtLkFnZW50U3RhdGVNZXNzYWdlLHRocmVhZElkOnUsYWdlbnROYW1lOm4sbm9kZU5hbWU6cixydW5JZDpvLHJ1bm5pbmc6cyxyb2xlOlwiYXNzaXN0YW50XCIsc3RhdGU6SlNPTi5zdHJpbmdpZnkoTChMKHt9LGUpLGk/e21lc3NhZ2VzOml9Ont9KSksYWN0aXZlOiEwfV07Y2FzZSBJLlJVTl9TVEFSVEVEOnJldHVybltdO2Nhc2UgSS5SVU5fRklOSVNIRUQ6cmV0dXJuIGkmJihlLm1lc3NhZ2VzPWkpLE9iamVjdC5rZXlzKGUpLmxlbmd0aD09PTA/W106W3t0eXBlOkEuZW51bS5BZ2VudFN0YXRlTWVzc2FnZSx0aHJlYWRJZDp1LGFnZW50TmFtZTpuLG5vZGVOYW1lOnIscnVuSWQ6byxydW5uaW5nOnMscm9sZTpcImFzc2lzdGFudFwiLHN0YXRlOkpTT04uc3RyaW5naWZ5KEwoTCh7fSxlKSxpP3ttZXNzYWdlczpVZShpKX06e30pKSxhY3RpdmU6ITF9XTtjYXNlIEkuUlVOX0VSUk9SOntsZXQgdD1nO3JldHVyblt7dHlwZTpBLmVudW0uUnVuRXJyb3IsbWVzc2FnZTp0Lm1lc3NhZ2UsY29kZTp0LmNvZGV9XX1jYXNlIEkuU1RFUF9TVEFSVEVEOnJldHVybiByPWcuc3RlcE5hbWUsaD1bXSxFPW51bGwsW3t0eXBlOkEuZW51bS5BZ2VudFN0YXRlTWVzc2FnZSx0aHJlYWRJZDp1LGFnZW50TmFtZTpuLG5vZGVOYW1lOnIscnVuSWQ6byxydW5uaW5nOnMscm9sZTpcImFzc2lzdGFudFwiLHN0YXRlOkpTT04uc3RyaW5naWZ5KGUpLGFjdGl2ZTohMH1dO2Nhc2UgSS5TVEVQX0ZJTklTSEVEOnJldHVybiBoPVtdLEU9bnVsbCxbe3R5cGU6QS5lbnVtLkFnZW50U3RhdGVNZXNzYWdlLHRocmVhZElkOnUsYWdlbnROYW1lOm4sbm9kZU5hbWU6cixydW5JZDpvLHJ1bm5pbmc6cyxyb2xlOlwiYXNzaXN0YW50XCIsc3RhdGU6SlNPTi5zdHJpbmdpZnkoZSksYWN0aXZlOiExfV07ZGVmYXVsdDpyZXR1cm5bXX19KSl9O2Z1bmN0aW9uIFVlKHUpe3ZhciBuO2xldCBvPVtdO2ZvcihsZXQgYSBvZiB1KWlmKGEucm9sZT09PVwiYXNzaXN0YW50XCJ8fGEucm9sZT09PVwidXNlclwifHxhLnJvbGU9PT1cInN5c3RlbVwiKXtpZihhLmNvbnRlbnQpe2xldCBlPXtpZDphLmlkLHJvbGU6YS5yb2xlLGNvbnRlbnQ6YS5jb250ZW50fTtvLnB1c2goZSl9aWYoYS5yb2xlPT09XCJhc3Npc3RhbnRcIiYmYS50b29sQ2FsbHMmJmEudG9vbENhbGxzLmxlbmd0aD4wKWZvcihsZXQgZSBvZiBhLnRvb2xDYWxscyl7bGV0IHM9e2lkOmUuaWQsbmFtZTplLmZ1bmN0aW9uLm5hbWUsYXJndW1lbnRzOkpTT04ucGFyc2UoZS5mdW5jdGlvbi5hcmd1bWVudHMpLHBhcmVudE1lc3NhZ2VJZDphLmlkfTtvLnB1c2gocyl9fWVsc2UgaWYoYS5yb2xlPT09XCJ0b29sXCIpe2xldCBlPVwidW5rbm93blwiO2ZvcihsZXQgbCBvZiB1KWlmKGwucm9sZT09PVwiYXNzaXN0YW50XCImJigobj1sLnRvb2xDYWxscykhPW51bGwmJm4ubGVuZ3RoKSl7Zm9yKGxldCByIG9mIGwudG9vbENhbGxzKWlmKHIuaWQ9PT1hLnRvb2xDYWxsSWQpe2U9ci5mdW5jdGlvbi5uYW1lO2JyZWFrfX1sZXQgcz17aWQ6YS5pZCxyZXN1bHQ6YS5jb250ZW50LGFjdGlvbkV4ZWN1dGlvbklkOmEudG9vbENhbGxJZCxhY3Rpb25OYW1lOmV9O28ucHVzaChzKX1yZXR1cm4gb31pbXBvcnR7djQgYXMgWH1mcm9tXCJ1dWlkXCI7aW1wb3J0e2NhdGNoRXJyb3IgYXMgS2UsbWFwIGFzIHRlLHRhcCBhcyBqZX1mcm9tXCJyeGpzL29wZXJhdG9yc1wiO2ltcG9ydHtmaW5hbGl6ZSBhcyB6ZX1mcm9tXCJyeGpzL29wZXJhdG9yc1wiO2ltcG9ydHtwaXBlIGFzIEJlLGZyb20gYXMgSmUsb2YgYXMgJGV9ZnJvbVwicnhqc1wiO2ltcG9ydHtsYXN0VmFsdWVGcm9tIGFzIGJlfWZyb21cInJ4anNcIjtpbXBvcnR7bWVyZ2VNYXAgYXMgWGUsZmluYWxpemUgYXMga2V9ZnJvbVwicnhqc1wiO2ltcG9ydHtFdmVudFR5cGUgYXMgZn1mcm9tXCJAYWctdWkvY29yZVwiO3ZhciBiPXU9Pm89PntsZXQgbixhLGUscz0oKT0+e2lmKCFufHxlIT09XCJ0ZXh0XCIpdGhyb3cgbmV3IEVycm9yKFwiTm8gdGV4dCBtZXNzYWdlIHRvIGNsb3NlXCIpO2xldCBpPXt0eXBlOmYuVEVYVF9NRVNTQUdFX0VORCxtZXNzYWdlSWQ6bi5tZXNzYWdlSWR9O3JldHVybiBlPXZvaWQgMCxuPXZvaWQgMCx1JiZjb25zb2xlLmRlYnVnKFwiW1RSQU5TRk9STV06IFRFWFRfTUVTU0FHRV9FTkRcIixKU09OLnN0cmluZ2lmeShpKSksaX0sbD0oKT0+e2lmKCFhfHxlIT09XCJ0b29sXCIpdGhyb3cgbmV3IEVycm9yKFwiTm8gdG9vbCBjYWxsIHRvIGNsb3NlXCIpO2xldCBpPXt0eXBlOmYuVE9PTF9DQUxMX0VORCx0b29sQ2FsbElkOmEudG9vbENhbGxJZH07cmV0dXJuIGU9dm9pZCAwLGE9dm9pZCAwLHUmJmNvbnNvbGUuZGVidWcoXCJbVFJBTlNGT1JNXTogVE9PTF9DQUxMX0VORFwiLEpTT04uc3RyaW5naWZ5KGkpKSxpfSxyPSgpPT5lPT09XCJ0ZXh0XCI/W3MoKV06ZT09PVwidG9vbFwiP1tsKCldOltdO3JldHVybiBvLnBpcGUoWGUoaT0+e3N3aXRjaChpLnR5cGUpe2Nhc2UgZi5URVhUX01FU1NBR0VfU1RBUlQ6Y2FzZSBmLlRFWFRfTUVTU0FHRV9DT05URU5UOmNhc2UgZi5URVhUX01FU1NBR0VfRU5EOmNhc2UgZi5UT09MX0NBTExfU1RBUlQ6Y2FzZSBmLlRPT0xfQ0FMTF9BUkdTOmNhc2UgZi5UT09MX0NBTExfRU5EOmNhc2UgZi5UT09MX0NBTExfUkVTVUxUOmNhc2UgZi5TVEFURV9TTkFQU0hPVDpjYXNlIGYuU1RBVEVfREVMVEE6Y2FzZSBmLk1FU1NBR0VTX1NOQVBTSE9UOmNhc2UgZi5DVVNUT006Y2FzZSBmLlJVTl9TVEFSVEVEOmNhc2UgZi5SVU5fRklOSVNIRUQ6Y2FzZSBmLlJVTl9FUlJPUjpjYXNlIGYuU1RFUF9TVEFSVEVEOmNhc2UgZi5TVEVQX0ZJTklTSEVEOmNhc2UgZi5USElOS0lOR19TVEFSVDpjYXNlIGYuVEhJTktJTkdfRU5EOmNhc2UgZi5USElOS0lOR19URVhUX01FU1NBR0VfU1RBUlQ6Y2FzZSBmLlRISU5LSU5HX1RFWFRfTUVTU0FHRV9DT05URU5UOmNhc2UgZi5USElOS0lOR19URVhUX01FU1NBR0VfRU5EOnJldHVyblsuLi5yKCksaV07Y2FzZSBmLlJBVzpyZXR1cm5baV07Y2FzZSBmLlRFWFRfTUVTU0FHRV9DSFVOSzpsZXQgaD1pLHc9W107aWYoKGUhPT1cInRleHRcInx8aC5tZXNzYWdlSWQhPT12b2lkIDAmJmgubWVzc2FnZUlkIT09KG49PW51bGw/dm9pZCAwOm4ubWVzc2FnZUlkKSkmJncucHVzaCguLi5yKCkpLGUhPT1cInRleHRcIil7aWYoaC5tZXNzYWdlSWQ9PT12b2lkIDApdGhyb3cgbmV3IEVycm9yKFwiRmlyc3QgVEVYVF9NRVNTQUdFX0NIVU5LIG11c3QgaGF2ZSBhIG1lc3NhZ2VJZFwiKTtuPXttZXNzYWdlSWQ6aC5tZXNzYWdlSWR9LGU9XCJ0ZXh0XCI7bGV0IHQ9e3R5cGU6Zi5URVhUX01FU1NBR0VfU1RBUlQsbWVzc2FnZUlkOmgubWVzc2FnZUlkLHJvbGU6aC5yb2xlfHxcImFzc2lzdGFudFwifTt3LnB1c2godCksdSYmY29uc29sZS5kZWJ1ZyhcIltUUkFOU0ZPUk1dOiBURVhUX01FU1NBR0VfU1RBUlRcIixKU09OLnN0cmluZ2lmeSh0KSl9aWYoaC5kZWx0YSE9PXZvaWQgMCl7bGV0IHQ9e3R5cGU6Zi5URVhUX01FU1NBR0VfQ09OVEVOVCxtZXNzYWdlSWQ6bi5tZXNzYWdlSWQsZGVsdGE6aC5kZWx0YX07dy5wdXNoKHQpLHUmJmNvbnNvbGUuZGVidWcoXCJbVFJBTlNGT1JNXTogVEVYVF9NRVNTQUdFX0NPTlRFTlRcIixKU09OLnN0cmluZ2lmeSh0KSl9cmV0dXJuIHc7Y2FzZSBmLlRPT0xfQ0FMTF9DSFVOSzpsZXQgZD1pLGc9W107aWYoKGUhPT1cInRvb2xcInx8ZC50b29sQ2FsbElkIT09dm9pZCAwJiZkLnRvb2xDYWxsSWQhPT0oYT09bnVsbD92b2lkIDA6YS50b29sQ2FsbElkKSkmJmcucHVzaCguLi5yKCkpLGUhPT1cInRvb2xcIil7aWYoZC50b29sQ2FsbElkPT09dm9pZCAwKXRocm93IG5ldyBFcnJvcihcIkZpcnN0IFRPT0xfQ0FMTF9DSFVOSyBtdXN0IGhhdmUgYSB0b29sQ2FsbElkXCIpO2lmKGQudG9vbENhbGxOYW1lPT09dm9pZCAwKXRocm93IG5ldyBFcnJvcihcIkZpcnN0IFRPT0xfQ0FMTF9DSFVOSyBtdXN0IGhhdmUgYSB0b29sQ2FsbE5hbWVcIik7YT17dG9vbENhbGxJZDpkLnRvb2xDYWxsSWQsdG9vbENhbGxOYW1lOmQudG9vbENhbGxOYW1lLHBhcmVudE1lc3NhZ2VJZDpkLnBhcmVudE1lc3NhZ2VJZH0sZT1cInRvb2xcIjtsZXQgdD17dHlwZTpmLlRPT0xfQ0FMTF9TVEFSVCx0b29sQ2FsbElkOmQudG9vbENhbGxJZCx0b29sQ2FsbE5hbWU6ZC50b29sQ2FsbE5hbWUscGFyZW50TWVzc2FnZUlkOmQucGFyZW50TWVzc2FnZUlkfTtnLnB1c2godCksdSYmY29uc29sZS5kZWJ1ZyhcIltUUkFOU0ZPUk1dOiBUT09MX0NBTExfU1RBUlRcIixKU09OLnN0cmluZ2lmeSh0KSl9aWYoZC5kZWx0YSE9PXZvaWQgMCl7bGV0IHQ9e3R5cGU6Zi5UT09MX0NBTExfQVJHUyx0b29sQ2FsbElkOmEudG9vbENhbGxJZCxkZWx0YTpkLmRlbHRhfTtnLnB1c2godCksdSYmY29uc29sZS5kZWJ1ZyhcIltUUkFOU0ZPUk1dOiBUT09MX0NBTExfQVJHU1wiLEpTT04uc3RyaW5naWZ5KHQpKX1yZXR1cm4gZ31sZXQgRT1pLnR5cGV9KSxrZSgoKT0+cigpKSl9O3ZhciBHPWNsYXNze2NvbnN0cnVjdG9yKHthZ2VudElkOm8sZGVzY3JpcHRpb246bix0aHJlYWRJZDphLGluaXRpYWxNZXNzYWdlczplLGluaXRpYWxTdGF0ZTpzLGRlYnVnOmx9PXt9KXt0aGlzLmRlYnVnPSExO3RoaXMuc3Vic2NyaWJlcnM9W107dGhpcy5hZ2VudElkPW8sdGhpcy5kZXNjcmlwdGlvbj1uIT1udWxsP246XCJcIix0aGlzLnRocmVhZElkPWEhPW51bGw/YTpYKCksdGhpcy5tZXNzYWdlcz1DKGUhPW51bGw/ZTpbXSksdGhpcy5zdGF0ZT1DKHMhPW51bGw/czp7fSksdGhpcy5kZWJ1Zz1sIT1udWxsP2w6ITF9c3Vic2NyaWJlKG8pe3JldHVybiB0aGlzLnN1YnNjcmliZXJzLnB1c2gobykse3Vuc3Vic2NyaWJlOigpPT57dGhpcy5zdWJzY3JpYmVycz10aGlzLnN1YnNjcmliZXJzLmZpbHRlcihuPT5uIT09byl9fX1hc3luYyBydW5BZ2VudChvLG4pe3ZhciBpO3RoaXMuYWdlbnRJZD0oaT10aGlzLmFnZW50SWQpIT1udWxsP2k6WCgpO2xldCBhPXRoaXMucHJlcGFyZVJ1bkFnZW50SW5wdXQobyksZSxzPW5ldyBTZXQodGhpcy5tZXNzYWdlcy5tYXAoRT0+RS5pZCkpLGw9W3tvblJ1bkZpbmlzaGVkRXZlbnQ6RT0+e2U9RS5yZXN1bHR9fSwuLi50aGlzLnN1YnNjcmliZXJzLG4hPW51bGw/bjp7fV07YXdhaXQgdGhpcy5vbkluaXRpYWxpemUoYSxsKTtsZXQgcj1CZSgoKT0+dGhpcy5ydW4oYSksYih0aGlzLmRlYnVnKSxVKHRoaXMuZGVidWcpLEU9PnRoaXMuYXBwbHkoYSxFLGwpLEU9PnRoaXMucHJvY2Vzc0FwcGx5RXZlbnRzKGEsRSxsKSxLZShFPT50aGlzLm9uRXJyb3IoYSxFLGwpKSx6ZSgoKT0+e3RoaXMub25GaW5hbGl6ZShhLGwpfSkpO3JldHVybiBiZShyKCRlKG51bGwpKSkudGhlbigoKT0+e2xldCBFPUModGhpcy5tZXNzYWdlcykuZmlsdGVyKGg9PiFzLmhhcyhoLmlkKSk7cmV0dXJue3Jlc3VsdDplLG5ld01lc3NhZ2VzOkV9fSl9YWJvcnRSdW4oKXt9YXBwbHkobyxuLGEpe3JldHVybiBLKG8sbix0aGlzLGEpfXByb2Nlc3NBcHBseUV2ZW50cyhvLG4sYSl7cmV0dXJuIG4ucGlwZShqZShlPT57ZS5tZXNzYWdlcyYmKHRoaXMubWVzc2FnZXM9ZS5tZXNzYWdlcyxhLmZvckVhY2gocz0+e3ZhciBsOyhsPXMub25NZXNzYWdlc0NoYW5nZWQpPT1udWxsfHxsLmNhbGwocyx7bWVzc2FnZXM6dGhpcy5tZXNzYWdlcyxzdGF0ZTp0aGlzLnN0YXRlLGFnZW50OnRoaXMsaW5wdXQ6b30pfSkpLGUuc3RhdGUmJih0aGlzLnN0YXRlPWUuc3RhdGUsYS5mb3JFYWNoKHM9Pnt2YXIgbDsobD1zLm9uU3RhdGVDaGFuZ2VkKT09bnVsbHx8bC5jYWxsKHMse3N0YXRlOnRoaXMuc3RhdGUsbWVzc2FnZXM6dGhpcy5tZXNzYWdlcyxhZ2VudDp0aGlzLGlucHV0Om99KX0pKX0pKX1wcmVwYXJlUnVuQWdlbnRJbnB1dChvKXt2YXIgbixhLGU7cmV0dXJue3RocmVhZElkOnRoaXMudGhyZWFkSWQscnVuSWQ6KG89PW51bGw/dm9pZCAwOm8ucnVuSWQpfHxYKCksdG9vbHM6Qygobj1vPT1udWxsP3ZvaWQgMDpvLnRvb2xzKSE9bnVsbD9uOltdKSxjb250ZXh0OkMoKGE9bz09bnVsbD92b2lkIDA6by5jb250ZXh0KSE9bnVsbD9hOltdKSxmb3J3YXJkZWRQcm9wczpDKChlPW89PW51bGw/dm9pZCAwOm8uZm9yd2FyZGVkUHJvcHMpIT1udWxsP2U6e30pLHN0YXRlOkModGhpcy5zdGF0ZSksbWVzc2FnZXM6Qyh0aGlzLm1lc3NhZ2VzKX19YXN5bmMgb25Jbml0aWFsaXplKG8sbil7bGV0IGE9YXdhaXQgeShuLHRoaXMubWVzc2FnZXMsdGhpcy5zdGF0ZSwoZSxzLGwpPT57dmFyIHI7cmV0dXJuKHI9ZS5vblJ1bkluaXRpYWxpemVkKT09bnVsbD92b2lkIDA6ci5jYWxsKGUse21lc3NhZ2VzOnMsc3RhdGU6bCxhZ2VudDp0aGlzLGlucHV0Om99KX0pOyhhLm1lc3NhZ2VzIT09dm9pZCAwfHxhLnN0YXRlIT09dm9pZCAwKSYmKGEubWVzc2FnZXMmJih0aGlzLm1lc3NhZ2VzPWEubWVzc2FnZXMsby5tZXNzYWdlcz1hLm1lc3NhZ2VzLG4uZm9yRWFjaChlPT57dmFyIHM7KHM9ZS5vbk1lc3NhZ2VzQ2hhbmdlZCk9PW51bGx8fHMuY2FsbChlLHttZXNzYWdlczp0aGlzLm1lc3NhZ2VzLHN0YXRlOnRoaXMuc3RhdGUsYWdlbnQ6dGhpcyxpbnB1dDpvfSl9KSksYS5zdGF0ZSYmKHRoaXMuc3RhdGU9YS5zdGF0ZSxvLnN0YXRlPWEuc3RhdGUsbi5mb3JFYWNoKGU9Pnt2YXIgczsocz1lLm9uU3RhdGVDaGFuZ2VkKT09bnVsbHx8cy5jYWxsKGUse3N0YXRlOnRoaXMuc3RhdGUsbWVzc2FnZXM6dGhpcy5tZXNzYWdlcyxhZ2VudDp0aGlzLGlucHV0Om99KX0pKSl9b25FcnJvcihvLG4sYSl7cmV0dXJuIEplKHkoYSx0aGlzLm1lc3NhZ2VzLHRoaXMuc3RhdGUsKGUscyxsKT0+e3ZhciByO3JldHVybihyPWUub25SdW5GYWlsZWQpPT1udWxsP3ZvaWQgMDpyLmNhbGwoZSx7ZXJyb3I6bixtZXNzYWdlczpzLHN0YXRlOmwsYWdlbnQ6dGhpcyxpbnB1dDpvfSl9KSkucGlwZSh0ZShlPT57bGV0IHM9ZTtpZigocy5tZXNzYWdlcyE9PXZvaWQgMHx8cy5zdGF0ZSE9PXZvaWQgMCkmJihzLm1lc3NhZ2VzIT09dm9pZCAwJiYodGhpcy5tZXNzYWdlcz1zLm1lc3NhZ2VzLGEuZm9yRWFjaChsPT57dmFyIHI7KHI9bC5vbk1lc3NhZ2VzQ2hhbmdlZCk9PW51bGx8fHIuY2FsbChsLHttZXNzYWdlczp0aGlzLm1lc3NhZ2VzLHN0YXRlOnRoaXMuc3RhdGUsYWdlbnQ6dGhpcyxpbnB1dDpvfSl9KSkscy5zdGF0ZSE9PXZvaWQgMCYmKHRoaXMuc3RhdGU9cy5zdGF0ZSxhLmZvckVhY2gobD0+e3ZhciByOyhyPWwub25TdGF0ZUNoYW5nZWQpPT1udWxsfHxyLmNhbGwobCx7c3RhdGU6dGhpcy5zdGF0ZSxtZXNzYWdlczp0aGlzLm1lc3NhZ2VzLGFnZW50OnRoaXMsaW5wdXQ6b30pfSkpKSxzLnN0b3BQcm9wYWdhdGlvbiE9PSEwKXRocm93IGNvbnNvbGUuZXJyb3IoXCJBZ2VudCBleGVjdXRpb24gZmFpbGVkOlwiLG4pLG47cmV0dXJue319KSl9YXN5bmMgb25GaW5hbGl6ZShvLG4pe2xldCBhPWF3YWl0IHkobix0aGlzLm1lc3NhZ2VzLHRoaXMuc3RhdGUsKGUscyxsKT0+e3ZhciByO3JldHVybihyPWUub25SdW5GaW5hbGl6ZWQpPT1udWxsP3ZvaWQgMDpyLmNhbGwoZSx7bWVzc2FnZXM6cyxzdGF0ZTpsLGFnZW50OnRoaXMsaW5wdXQ6b30pfSk7KGEubWVzc2FnZXMhPT12b2lkIDB8fGEuc3RhdGUhPT12b2lkIDApJiYoYS5tZXNzYWdlcyE9PXZvaWQgMCYmKHRoaXMubWVzc2FnZXM9YS5tZXNzYWdlcyxuLmZvckVhY2goZT0+e3ZhciBzOyhzPWUub25NZXNzYWdlc0NoYW5nZWQpPT1udWxsfHxzLmNhbGwoZSx7bWVzc2FnZXM6dGhpcy5tZXNzYWdlcyxzdGF0ZTp0aGlzLnN0YXRlLGFnZW50OnRoaXMsaW5wdXQ6b30pfSkpLGEuc3RhdGUhPT12b2lkIDAmJih0aGlzLnN0YXRlPWEuc3RhdGUsbi5mb3JFYWNoKGU9Pnt2YXIgczsocz1lLm9uU3RhdGVDaGFuZ2VkKT09bnVsbHx8cy5jYWxsKGUse3N0YXRlOnRoaXMuc3RhdGUsbWVzc2FnZXM6dGhpcy5tZXNzYWdlcyxhZ2VudDp0aGlzLGlucHV0Om99KX0pKSl9Y2xvbmUoKXtsZXQgbz1PYmplY3QuY3JlYXRlKE9iamVjdC5nZXRQcm90b3R5cGVPZih0aGlzKSk7Zm9yKGxldCBuIG9mIE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKHRoaXMpKXtsZXQgYT10aGlzW25dO3R5cGVvZiBhIT1cImZ1bmN0aW9uXCImJihvW25dPUMoYSkpfXJldHVybiBvfWFkZE1lc3NhZ2Uobyl7dGhpcy5tZXNzYWdlcy5wdXNoKG8pLChhc3luYygpPT57dmFyIG4sYSxlO2ZvcihsZXQgcyBvZiB0aGlzLnN1YnNjcmliZXJzKWF3YWl0KChuPXMub25OZXdNZXNzYWdlKT09bnVsbD92b2lkIDA6bi5jYWxsKHMse21lc3NhZ2U6byxtZXNzYWdlczp0aGlzLm1lc3NhZ2VzLHN0YXRlOnRoaXMuc3RhdGUsYWdlbnQ6dGhpc30pKTtpZihvLnJvbGU9PT1cImFzc2lzdGFudFwiJiZvLnRvb2xDYWxscylmb3IobGV0IHMgb2Ygby50b29sQ2FsbHMpZm9yKGxldCBsIG9mIHRoaXMuc3Vic2NyaWJlcnMpYXdhaXQoKGE9bC5vbk5ld1Rvb2xDYWxsKT09bnVsbD92b2lkIDA6YS5jYWxsKGwse3Rvb2xDYWxsOnMsbWVzc2FnZXM6dGhpcy5tZXNzYWdlcyxzdGF0ZTp0aGlzLnN0YXRlLGFnZW50OnRoaXN9KSk7Zm9yKGxldCBzIG9mIHRoaXMuc3Vic2NyaWJlcnMpYXdhaXQoKGU9cy5vbk1lc3NhZ2VzQ2hhbmdlZCk9PW51bGw/dm9pZCAwOmUuY2FsbChzLHttZXNzYWdlczp0aGlzLm1lc3NhZ2VzLHN0YXRlOnRoaXMuc3RhdGUsYWdlbnQ6dGhpc30pKX0pKCl9YWRkTWVzc2FnZXMobyl7dGhpcy5tZXNzYWdlcy5wdXNoKC4uLm8pLChhc3luYygpPT57dmFyIG4sYSxlO2ZvcihsZXQgcyBvZiBvKXtmb3IobGV0IGwgb2YgdGhpcy5zdWJzY3JpYmVycylhd2FpdCgobj1sLm9uTmV3TWVzc2FnZSk9PW51bGw/dm9pZCAwOm4uY2FsbChsLHttZXNzYWdlOnMsbWVzc2FnZXM6dGhpcy5tZXNzYWdlcyxzdGF0ZTp0aGlzLnN0YXRlLGFnZW50OnRoaXN9KSk7aWYocy5yb2xlPT09XCJhc3Npc3RhbnRcIiYmcy50b29sQ2FsbHMpZm9yKGxldCBsIG9mIHMudG9vbENhbGxzKWZvcihsZXQgciBvZiB0aGlzLnN1YnNjcmliZXJzKWF3YWl0KChhPXIub25OZXdUb29sQ2FsbCk9PW51bGw/dm9pZCAwOmEuY2FsbChyLHt0b29sQ2FsbDpsLG1lc3NhZ2VzOnRoaXMubWVzc2FnZXMsc3RhdGU6dGhpcy5zdGF0ZSxhZ2VudDp0aGlzfSkpfWZvcihsZXQgcyBvZiB0aGlzLnN1YnNjcmliZXJzKWF3YWl0KChlPXMub25NZXNzYWdlc0NoYW5nZWQpPT1udWxsP3ZvaWQgMDplLmNhbGwocyx7bWVzc2FnZXM6dGhpcy5tZXNzYWdlcyxzdGF0ZTp0aGlzLnN0YXRlLGFnZW50OnRoaXN9KSl9KSgpfXNldE1lc3NhZ2VzKG8pe3RoaXMubWVzc2FnZXM9QyhvKSwoYXN5bmMoKT0+e3ZhciBuO2ZvcihsZXQgYSBvZiB0aGlzLnN1YnNjcmliZXJzKWF3YWl0KChuPWEub25NZXNzYWdlc0NoYW5nZWQpPT1udWxsP3ZvaWQgMDpuLmNhbGwoYSx7bWVzc2FnZXM6dGhpcy5tZXNzYWdlcyxzdGF0ZTp0aGlzLnN0YXRlLGFnZW50OnRoaXN9KSl9KSgpfXNldFN0YXRlKG8pe3RoaXMuc3RhdGU9QyhvKSwoYXN5bmMoKT0+e3ZhciBuO2ZvcihsZXQgYSBvZiB0aGlzLnN1YnNjcmliZXJzKWF3YWl0KChuPWEub25TdGF0ZUNoYW5nZWQpPT1udWxsP3ZvaWQgMDpuLmNhbGwoYSx7bWVzc2FnZXM6dGhpcy5tZXNzYWdlcyxzdGF0ZTp0aGlzLnN0YXRlLGFnZW50OnRoaXN9KSl9KSgpfWxlZ2FjeV90b19iZV9yZW1vdmVkX3J1bkFnZW50QnJpZGdlZChvKXt2YXIgYTt0aGlzLmFnZW50SWQ9KGE9dGhpcy5hZ2VudElkKSE9bnVsbD9hOlgoKTtsZXQgbj10aGlzLnByZXBhcmVSdW5BZ2VudElucHV0KG8pO3JldHVybiB0aGlzLnJ1bihuKS5waXBlKGIodGhpcy5kZWJ1ZyksVSh0aGlzLmRlYnVnKSwkKHRoaXMudGhyZWFkSWQsbi5ydW5JZCx0aGlzLmFnZW50SWQpLGU9PmUucGlwZSh0ZShzPT4odGhpcy5kZWJ1ZyYmY29uc29sZS5kZWJ1ZyhcIltMRUdBQ1ldOlwiLEpTT04uc3RyaW5naWZ5KHMpKSxzKSkpKX19O3ZhciBxPWNsYXNzIGV4dGVuZHMgR3tjb25zdHJ1Y3RvcihuKXt2YXIgYTtzdXBlcihuKTt0aGlzLmFib3J0Q29udHJvbGxlcj1uZXcgQWJvcnRDb250cm9sbGVyO3RoaXMudXJsPW4udXJsLHRoaXMuaGVhZGVycz1DKChhPW4uaGVhZGVycykhPW51bGw/YTp7fSl9cmVxdWVzdEluaXQobil7cmV0dXJue21ldGhvZDpcIlBPU1RcIixoZWFkZXJzOkgoTCh7fSx0aGlzLmhlYWRlcnMpLHtcIkNvbnRlbnQtVHlwZVwiOlwiYXBwbGljYXRpb24vanNvblwiLEFjY2VwdDpcInRleHQvZXZlbnQtc3RyZWFtXCJ9KSxib2R5OkpTT04uc3RyaW5naWZ5KG4pLHNpZ25hbDp0aGlzLmFib3J0Q29udHJvbGxlci5zaWduYWx9fXJ1bkFnZW50KG4sYSl7dmFyIGU7cmV0dXJuIHRoaXMuYWJvcnRDb250cm9sbGVyPShlPW49PW51bGw/dm9pZCAwOm4uYWJvcnRDb250cm9sbGVyKSE9bnVsbD9lOm5ldyBBYm9ydENvbnRyb2xsZXIsc3VwZXIucnVuQWdlbnQobixhKX1hYm9ydFJ1bigpe3RoaXMuYWJvcnRDb250cm9sbGVyLmFib3J0KCksc3VwZXIuYWJvcnRSdW4oKX1ydW4obil7bGV0IGE9aih0aGlzLnVybCx0aGlzLnJlcXVlc3RJbml0KG4pKTtyZXR1cm4gSihhKX19O2V4cG9ydCpmcm9tXCJAYWctdWkvY29yZVwiO2V4cG9ydHtHIGFzIEFic3RyYWN0QWdlbnQscSBhcyBIdHRwQWdlbnQsJCBhcyBjb252ZXJ0VG9MZWdhY3lFdmVudHMsSyBhcyBkZWZhdWx0QXBwbHlFdmVudHMsQiBhcyBwYXJzZVByb3RvU3RyZWFtLHogYXMgcGFyc2VTU0VTdHJlYW0saiBhcyBydW5IdHRwUmVxdWVzdCxKIGFzIHRyYW5zZm9ybUh0dHBFdmVudFN0cmVhbSxVIGFzIHZlcmlmeUV2ZW50c307XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleC5tanMubWFwIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@ag-ui/client/dist/index.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/@ag-ui/core/dist/index.mjs":
/*!*************************************************!*\
  !*** ./node_modules/@ag-ui/core/dist/index.mjs ***!
  \*************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AGUIError: () => (/* binding */ AGUIError),\n/* harmony export */   AssistantMessageSchema: () => (/* binding */ AssistantMessageSchema),\n/* harmony export */   BaseEventSchema: () => (/* binding */ BaseEventSchema),\n/* harmony export */   BaseMessageSchema: () => (/* binding */ BaseMessageSchema),\n/* harmony export */   ContextSchema: () => (/* binding */ ContextSchema),\n/* harmony export */   CustomEventSchema: () => (/* binding */ CustomEventSchema),\n/* harmony export */   DeveloperMessageSchema: () => (/* binding */ DeveloperMessageSchema),\n/* harmony export */   EventSchemas: () => (/* binding */ EventSchemas),\n/* harmony export */   EventType: () => (/* binding */ EventType),\n/* harmony export */   FunctionCallSchema: () => (/* binding */ FunctionCallSchema),\n/* harmony export */   MessageSchema: () => (/* binding */ MessageSchema),\n/* harmony export */   MessagesSnapshotEventSchema: () => (/* binding */ MessagesSnapshotEventSchema),\n/* harmony export */   RawEventSchema: () => (/* binding */ RawEventSchema),\n/* harmony export */   RoleSchema: () => (/* binding */ RoleSchema),\n/* harmony export */   RunAgentInputSchema: () => (/* binding */ RunAgentInputSchema),\n/* harmony export */   RunErrorEventSchema: () => (/* binding */ RunErrorEventSchema),\n/* harmony export */   RunFinishedEventSchema: () => (/* binding */ RunFinishedEventSchema),\n/* harmony export */   RunStartedEventSchema: () => (/* binding */ RunStartedEventSchema),\n/* harmony export */   StateDeltaEventSchema: () => (/* binding */ StateDeltaEventSchema),\n/* harmony export */   StateSchema: () => (/* binding */ StateSchema),\n/* harmony export */   StateSnapshotEventSchema: () => (/* binding */ StateSnapshotEventSchema),\n/* harmony export */   StepFinishedEventSchema: () => (/* binding */ StepFinishedEventSchema),\n/* harmony export */   StepStartedEventSchema: () => (/* binding */ StepStartedEventSchema),\n/* harmony export */   SystemMessageSchema: () => (/* binding */ SystemMessageSchema),\n/* harmony export */   TextMessageChunkEventSchema: () => (/* binding */ TextMessageChunkEventSchema),\n/* harmony export */   TextMessageContentEventSchema: () => (/* binding */ TextMessageContentEventSchema),\n/* harmony export */   TextMessageEndEventSchema: () => (/* binding */ TextMessageEndEventSchema),\n/* harmony export */   TextMessageStartEventSchema: () => (/* binding */ TextMessageStartEventSchema),\n/* harmony export */   ThinkingEndEventSchema: () => (/* binding */ ThinkingEndEventSchema),\n/* harmony export */   ThinkingStartEventSchema: () => (/* binding */ ThinkingStartEventSchema),\n/* harmony export */   ThinkingTextMessageContentEventSchema: () => (/* binding */ ThinkingTextMessageContentEventSchema),\n/* harmony export */   ThinkingTextMessageEndEventSchema: () => (/* binding */ ThinkingTextMessageEndEventSchema),\n/* harmony export */   ThinkingTextMessageStartEventSchema: () => (/* binding */ ThinkingTextMessageStartEventSchema),\n/* harmony export */   ToolCallArgsEventSchema: () => (/* binding */ ToolCallArgsEventSchema),\n/* harmony export */   ToolCallChunkEventSchema: () => (/* binding */ ToolCallChunkEventSchema),\n/* harmony export */   ToolCallEndEventSchema: () => (/* binding */ ToolCallEndEventSchema),\n/* harmony export */   ToolCallResultEventSchema: () => (/* binding */ ToolCallResultEventSchema),\n/* harmony export */   ToolCallSchema: () => (/* binding */ ToolCallSchema),\n/* harmony export */   ToolCallStartEventSchema: () => (/* binding */ ToolCallStartEventSchema),\n/* harmony export */   ToolMessageSchema: () => (/* binding */ ToolMessageSchema),\n/* harmony export */   ToolSchema: () => (/* binding */ ToolSchema),\n/* harmony export */   UserMessageSchema: () => (/* binding */ UserMessageSchema)\n/* harmony export */ });\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/zod/v3/types.js\");\n// src/types.ts\n\nvar FunctionCallSchema = zod__WEBPACK_IMPORTED_MODULE_0__.object({\n  name: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  arguments: zod__WEBPACK_IMPORTED_MODULE_0__.string()\n});\nvar ToolCallSchema = zod__WEBPACK_IMPORTED_MODULE_0__.object({\n  id: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"function\"),\n  function: FunctionCallSchema\n});\nvar BaseMessageSchema = zod__WEBPACK_IMPORTED_MODULE_0__.object({\n  id: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  role: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  content: zod__WEBPACK_IMPORTED_MODULE_0__.string().optional(),\n  name: zod__WEBPACK_IMPORTED_MODULE_0__.string().optional()\n});\nvar DeveloperMessageSchema = BaseMessageSchema.extend({\n  role: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"developer\"),\n  content: zod__WEBPACK_IMPORTED_MODULE_0__.string()\n});\nvar SystemMessageSchema = BaseMessageSchema.extend({\n  role: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"system\"),\n  content: zod__WEBPACK_IMPORTED_MODULE_0__.string()\n});\nvar AssistantMessageSchema = BaseMessageSchema.extend({\n  role: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"assistant\"),\n  content: zod__WEBPACK_IMPORTED_MODULE_0__.string().optional(),\n  toolCalls: zod__WEBPACK_IMPORTED_MODULE_0__.array(ToolCallSchema).optional()\n});\nvar UserMessageSchema = BaseMessageSchema.extend({\n  role: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"user\"),\n  content: zod__WEBPACK_IMPORTED_MODULE_0__.string()\n});\nvar ToolMessageSchema = zod__WEBPACK_IMPORTED_MODULE_0__.object({\n  id: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  content: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  role: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"tool\"),\n  toolCallId: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  error: zod__WEBPACK_IMPORTED_MODULE_0__.string().optional()\n});\nvar MessageSchema = zod__WEBPACK_IMPORTED_MODULE_0__.discriminatedUnion(\"role\", [\n  DeveloperMessageSchema,\n  SystemMessageSchema,\n  AssistantMessageSchema,\n  UserMessageSchema,\n  ToolMessageSchema\n]);\nvar RoleSchema = zod__WEBPACK_IMPORTED_MODULE_0__.union([\n  zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"developer\"),\n  zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"system\"),\n  zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"assistant\"),\n  zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"user\"),\n  zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"tool\")\n]);\nvar ContextSchema = zod__WEBPACK_IMPORTED_MODULE_0__.object({\n  description: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  value: zod__WEBPACK_IMPORTED_MODULE_0__.string()\n});\nvar ToolSchema = zod__WEBPACK_IMPORTED_MODULE_0__.object({\n  name: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  description: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  parameters: zod__WEBPACK_IMPORTED_MODULE_0__.any()\n  // JSON Schema for the tool parameters\n});\nvar RunAgentInputSchema = zod__WEBPACK_IMPORTED_MODULE_0__.object({\n  threadId: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  runId: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  state: zod__WEBPACK_IMPORTED_MODULE_0__.any(),\n  messages: zod__WEBPACK_IMPORTED_MODULE_0__.array(MessageSchema),\n  tools: zod__WEBPACK_IMPORTED_MODULE_0__.array(ToolSchema),\n  context: zod__WEBPACK_IMPORTED_MODULE_0__.array(ContextSchema),\n  forwardedProps: zod__WEBPACK_IMPORTED_MODULE_0__.any()\n});\nvar StateSchema = zod__WEBPACK_IMPORTED_MODULE_0__.any();\nvar AGUIError = class extends Error {\n  constructor(message) {\n    super(message);\n  }\n};\n\n// src/events.ts\n\nvar TextMessageRoleSchema = zod__WEBPACK_IMPORTED_MODULE_0__.union([\n  zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"developer\"),\n  zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"system\"),\n  zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"assistant\"),\n  zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"user\")\n]);\nvar EventType = /* @__PURE__ */ ((EventType2) => {\n  EventType2[\"TEXT_MESSAGE_START\"] = \"TEXT_MESSAGE_START\";\n  EventType2[\"TEXT_MESSAGE_CONTENT\"] = \"TEXT_MESSAGE_CONTENT\";\n  EventType2[\"TEXT_MESSAGE_END\"] = \"TEXT_MESSAGE_END\";\n  EventType2[\"TEXT_MESSAGE_CHUNK\"] = \"TEXT_MESSAGE_CHUNK\";\n  EventType2[\"THINKING_TEXT_MESSAGE_START\"] = \"THINKING_TEXT_MESSAGE_START\";\n  EventType2[\"THINKING_TEXT_MESSAGE_CONTENT\"] = \"THINKING_TEXT_MESSAGE_CONTENT\";\n  EventType2[\"THINKING_TEXT_MESSAGE_END\"] = \"THINKING_TEXT_MESSAGE_END\";\n  EventType2[\"TOOL_CALL_START\"] = \"TOOL_CALL_START\";\n  EventType2[\"TOOL_CALL_ARGS\"] = \"TOOL_CALL_ARGS\";\n  EventType2[\"TOOL_CALL_END\"] = \"TOOL_CALL_END\";\n  EventType2[\"TOOL_CALL_CHUNK\"] = \"TOOL_CALL_CHUNK\";\n  EventType2[\"TOOL_CALL_RESULT\"] = \"TOOL_CALL_RESULT\";\n  EventType2[\"THINKING_START\"] = \"THINKING_START\";\n  EventType2[\"THINKING_END\"] = \"THINKING_END\";\n  EventType2[\"STATE_SNAPSHOT\"] = \"STATE_SNAPSHOT\";\n  EventType2[\"STATE_DELTA\"] = \"STATE_DELTA\";\n  EventType2[\"MESSAGES_SNAPSHOT\"] = \"MESSAGES_SNAPSHOT\";\n  EventType2[\"RAW\"] = \"RAW\";\n  EventType2[\"CUSTOM\"] = \"CUSTOM\";\n  EventType2[\"RUN_STARTED\"] = \"RUN_STARTED\";\n  EventType2[\"RUN_FINISHED\"] = \"RUN_FINISHED\";\n  EventType2[\"RUN_ERROR\"] = \"RUN_ERROR\";\n  EventType2[\"STEP_STARTED\"] = \"STEP_STARTED\";\n  EventType2[\"STEP_FINISHED\"] = \"STEP_FINISHED\";\n  return EventType2;\n})(EventType || {});\nvar BaseEventSchema = zod__WEBPACK_IMPORTED_MODULE_0__.object({\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.nativeEnum(EventType),\n  timestamp: zod__WEBPACK_IMPORTED_MODULE_0__.number().optional(),\n  rawEvent: zod__WEBPACK_IMPORTED_MODULE_0__.any().optional()\n});\nvar TextMessageStartEventSchema = BaseEventSchema.extend({\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"TEXT_MESSAGE_START\" /* TEXT_MESSAGE_START */),\n  messageId: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  role: TextMessageRoleSchema.default(\"assistant\")\n});\nvar TextMessageContentEventSchema = BaseEventSchema.extend({\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"TEXT_MESSAGE_CONTENT\" /* TEXT_MESSAGE_CONTENT */),\n  messageId: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  delta: zod__WEBPACK_IMPORTED_MODULE_0__.string().refine((s) => s.length > 0, \"Delta must not be an empty string\")\n});\nvar TextMessageEndEventSchema = BaseEventSchema.extend({\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"TEXT_MESSAGE_END\" /* TEXT_MESSAGE_END */),\n  messageId: zod__WEBPACK_IMPORTED_MODULE_0__.string()\n});\nvar TextMessageChunkEventSchema = BaseEventSchema.extend({\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"TEXT_MESSAGE_CHUNK\" /* TEXT_MESSAGE_CHUNK */),\n  messageId: zod__WEBPACK_IMPORTED_MODULE_0__.string().optional(),\n  role: TextMessageRoleSchema.optional(),\n  delta: zod__WEBPACK_IMPORTED_MODULE_0__.string().optional()\n});\nvar ThinkingTextMessageStartEventSchema = BaseEventSchema.extend({\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"THINKING_TEXT_MESSAGE_START\" /* THINKING_TEXT_MESSAGE_START */)\n});\nvar ThinkingTextMessageContentEventSchema = TextMessageContentEventSchema.omit({\n  messageId: true,\n  type: true\n}).extend({\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"THINKING_TEXT_MESSAGE_CONTENT\" /* THINKING_TEXT_MESSAGE_CONTENT */)\n});\nvar ThinkingTextMessageEndEventSchema = BaseEventSchema.extend({\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"THINKING_TEXT_MESSAGE_END\" /* THINKING_TEXT_MESSAGE_END */)\n});\nvar ToolCallStartEventSchema = BaseEventSchema.extend({\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"TOOL_CALL_START\" /* TOOL_CALL_START */),\n  toolCallId: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  toolCallName: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  parentMessageId: zod__WEBPACK_IMPORTED_MODULE_0__.string().optional()\n});\nvar ToolCallArgsEventSchema = BaseEventSchema.extend({\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"TOOL_CALL_ARGS\" /* TOOL_CALL_ARGS */),\n  toolCallId: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  delta: zod__WEBPACK_IMPORTED_MODULE_0__.string()\n});\nvar ToolCallEndEventSchema = BaseEventSchema.extend({\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"TOOL_CALL_END\" /* TOOL_CALL_END */),\n  toolCallId: zod__WEBPACK_IMPORTED_MODULE_0__.string()\n});\nvar ToolCallResultEventSchema = BaseEventSchema.extend({\n  messageId: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"TOOL_CALL_RESULT\" /* TOOL_CALL_RESULT */),\n  toolCallId: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  content: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  role: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"tool\").optional()\n});\nvar ToolCallChunkEventSchema = BaseEventSchema.extend({\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"TOOL_CALL_CHUNK\" /* TOOL_CALL_CHUNK */),\n  toolCallId: zod__WEBPACK_IMPORTED_MODULE_0__.string().optional(),\n  toolCallName: zod__WEBPACK_IMPORTED_MODULE_0__.string().optional(),\n  parentMessageId: zod__WEBPACK_IMPORTED_MODULE_0__.string().optional(),\n  delta: zod__WEBPACK_IMPORTED_MODULE_0__.string().optional()\n});\nvar ThinkingStartEventSchema = BaseEventSchema.extend({\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"THINKING_START\" /* THINKING_START */),\n  title: zod__WEBPACK_IMPORTED_MODULE_0__.string().optional()\n});\nvar ThinkingEndEventSchema = BaseEventSchema.extend({\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"THINKING_END\" /* THINKING_END */)\n});\nvar StateSnapshotEventSchema = BaseEventSchema.extend({\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"STATE_SNAPSHOT\" /* STATE_SNAPSHOT */),\n  snapshot: StateSchema\n});\nvar StateDeltaEventSchema = BaseEventSchema.extend({\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"STATE_DELTA\" /* STATE_DELTA */),\n  delta: zod__WEBPACK_IMPORTED_MODULE_0__.array(zod__WEBPACK_IMPORTED_MODULE_0__.any())\n  // JSON Patch (RFC 6902)\n});\nvar MessagesSnapshotEventSchema = BaseEventSchema.extend({\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"MESSAGES_SNAPSHOT\" /* MESSAGES_SNAPSHOT */),\n  messages: zod__WEBPACK_IMPORTED_MODULE_0__.array(MessageSchema)\n});\nvar RawEventSchema = BaseEventSchema.extend({\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"RAW\" /* RAW */),\n  event: zod__WEBPACK_IMPORTED_MODULE_0__.any(),\n  source: zod__WEBPACK_IMPORTED_MODULE_0__.string().optional()\n});\nvar CustomEventSchema = BaseEventSchema.extend({\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"CUSTOM\" /* CUSTOM */),\n  name: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  value: zod__WEBPACK_IMPORTED_MODULE_0__.any()\n});\nvar RunStartedEventSchema = BaseEventSchema.extend({\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"RUN_STARTED\" /* RUN_STARTED */),\n  threadId: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  runId: zod__WEBPACK_IMPORTED_MODULE_0__.string()\n});\nvar RunFinishedEventSchema = BaseEventSchema.extend({\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"RUN_FINISHED\" /* RUN_FINISHED */),\n  threadId: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  runId: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  result: zod__WEBPACK_IMPORTED_MODULE_0__.any().optional()\n});\nvar RunErrorEventSchema = BaseEventSchema.extend({\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"RUN_ERROR\" /* RUN_ERROR */),\n  message: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  code: zod__WEBPACK_IMPORTED_MODULE_0__.string().optional()\n});\nvar StepStartedEventSchema = BaseEventSchema.extend({\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"STEP_STARTED\" /* STEP_STARTED */),\n  stepName: zod__WEBPACK_IMPORTED_MODULE_0__.string()\n});\nvar StepFinishedEventSchema = BaseEventSchema.extend({\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"STEP_FINISHED\" /* STEP_FINISHED */),\n  stepName: zod__WEBPACK_IMPORTED_MODULE_0__.string()\n});\nvar EventSchemas = zod__WEBPACK_IMPORTED_MODULE_0__.discriminatedUnion(\"type\", [\n  TextMessageStartEventSchema,\n  TextMessageContentEventSchema,\n  TextMessageEndEventSchema,\n  TextMessageChunkEventSchema,\n  ThinkingStartEventSchema,\n  ThinkingEndEventSchema,\n  ThinkingTextMessageStartEventSchema,\n  ThinkingTextMessageContentEventSchema,\n  ThinkingTextMessageEndEventSchema,\n  ToolCallStartEventSchema,\n  ToolCallArgsEventSchema,\n  ToolCallEndEventSchema,\n  ToolCallChunkEventSchema,\n  ToolCallResultEventSchema,\n  StateSnapshotEventSchema,\n  StateDeltaEventSchema,\n  MessagesSnapshotEventSchema,\n  RawEventSchema,\n  CustomEventSchema,\n  RunStartedEventSchema,\n  RunFinishedEventSchema,\n  RunErrorEventSchema,\n  StepStartedEventSchema,\n  StepFinishedEventSchema\n]);\n\n//# sourceMappingURL=index.mjs.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQGFnLXVpL2NvcmUvZGlzdC9pbmRleC5tanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQ3dCO0FBQ3hCLHlCQUF5Qix1Q0FBUTtBQUNqQyxRQUFRLHVDQUFRO0FBQ2hCLGFBQWEsdUNBQVE7QUFDckIsQ0FBQztBQUNELHFCQUFxQix1Q0FBUTtBQUM3QixNQUFNLHVDQUFRO0FBQ2QsUUFBUSx3Q0FBUztBQUNqQjtBQUNBLENBQUM7QUFDRCx3QkFBd0IsdUNBQVE7QUFDaEMsTUFBTSx1Q0FBUTtBQUNkLFFBQVEsdUNBQVE7QUFDaEIsV0FBVyx1Q0FBUTtBQUNuQixRQUFRLHVDQUFRO0FBQ2hCLENBQUM7QUFDRDtBQUNBLFFBQVEsd0NBQVM7QUFDakIsV0FBVyx1Q0FBUTtBQUNuQixDQUFDO0FBQ0Q7QUFDQSxRQUFRLHdDQUFTO0FBQ2pCLFdBQVcsdUNBQVE7QUFDbkIsQ0FBQztBQUNEO0FBQ0EsUUFBUSx3Q0FBUztBQUNqQixXQUFXLHVDQUFRO0FBQ25CLGFBQWEsc0NBQU87QUFDcEIsQ0FBQztBQUNEO0FBQ0EsUUFBUSx3Q0FBUztBQUNqQixXQUFXLHVDQUFRO0FBQ25CLENBQUM7QUFDRCx3QkFBd0IsdUNBQVE7QUFDaEMsTUFBTSx1Q0FBUTtBQUNkLFdBQVcsdUNBQVE7QUFDbkIsUUFBUSx3Q0FBUztBQUNqQixjQUFjLHVDQUFRO0FBQ3RCLFNBQVMsdUNBQVE7QUFDakIsQ0FBQztBQUNELG9CQUFvQixtREFBb0I7QUFDeEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLHNDQUFPO0FBQ3hCLEVBQUUsd0NBQVM7QUFDWCxFQUFFLHdDQUFTO0FBQ1gsRUFBRSx3Q0FBUztBQUNYLEVBQUUsd0NBQVM7QUFDWCxFQUFFLHdDQUFTO0FBQ1g7QUFDQSxvQkFBb0IsdUNBQVE7QUFDNUIsZUFBZSx1Q0FBUTtBQUN2QixTQUFTLHVDQUFRO0FB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LENBQUM7QUFDRDtBQUNBLFFBQVEsd0NBQVU7QUFDbEIsWUFBWSx1Q0FBUztBQUNyQixTQUFTLHVDQUFTO0FBQ2xCLFVBQVUsb0NBQU07QUFDaEIsQ0FBQztBQUNEO0FBQ0EsUUFBUSx3Q0FBVTtBQUNsQixXQUFXLHVDQUFTO0FBQ3BCLFFBQVEsdUNBQVM7QUFDakIsQ0FBQztBQUNEO0FBQ0EsUUFBUSx3Q0FBVTtBQUNsQixZQUFZLHVDQUFTO0FBQ3JCLENBQUM7QUFDRDtBQUNBLFFBQVEsd0NBQVU7QUFDbEIsWUFBWSx1Q0FBUztBQUNyQixDQUFDO0FBQ0QsbUJBQW1CLG1EQUFxQjtBQUN4QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQTRDRTtBQUNGIiwic291cmNlcyI6WyIvaG9tZS9jZXRlYy9Ob2RlUHJvamVjdHMvYWd1aV90ZXN0L25vZGVfbW9kdWxlcy9AYWctdWkvY29yZS9kaXN0L2luZGV4Lm1qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBzcmMvdHlwZXMudHNcbmltcG9ydCB7IHogfSBmcm9tIFwiem9kXCI7XG52YXIgRnVuY3Rpb25DYWxsU2NoZW1hID0gei5vYmplY3Qoe1xuICBuYW1lOiB6LnN0cmluZygpLFxuICBhcmd1bWVudHM6IHouc3RyaW5nKClcbn0pO1xudmFyIFRvb2xDYWxsU2NoZW1hID0gei5vYmplY3Qoe1xuICBpZDogei5zdHJpbmcoKSxcbiAgdHlwZTogei5saXRlcmFsKFwiZnVuY3Rpb25cIiksXG4gIGZ1bmN0aW9uOiBGdW5jdGlvbkNhbGxTY2hlbWFcbn0pO1xudmFyIEJhc2VNZXNzYWdlU2NoZW1hID0gei5vYmplY3Qoe1xuICBpZDogei5zdHJpbmcoKSxcbiAgcm9sZTogei5zdHJpbmcoKSxcbiAgY29udGVudDogei5zdHJpbmcoKS5vcHRpb25hbCgpLFxuICBuYW1lOiB6LnN0cmluZygpLm9wdGlvbmFsKClcbn0pO1xudmFyIERldmVsb3Blck1lc3NhZ2VTY2hlbWEgPSBCYXNlTWVzc2FnZVNjaGVtYS5leHRlbmQoe1xuICByb2xlOiB6LmxpdGVyYWwoXCJkZXZlbG9wZXJcIiksXG4gIGNvbnRlbnQ6IHouc3RyaW5nKClcbn0pO1xudmFyIFN5c3RlbU1lc3NhZ2VTY2hlbWEgPSBCYXNlTWVzc2FnZVNjaGVtYS5leHRlbmQoe1xuICByb2xlOiB6LmxpdGVyYWwoXCJzeXN0ZW1cIiksXG4gIGNvbnRlbnQ6IHouc3RyaW5nKClcbn0pO1xudmFyIEFzc2lzdGFudE1lc3NhZ2VTY2hlbWEgPSBCYXNlTWVzc2FnZVNjaGVtYS5leHRlbmQoe1xuICByb2xlOiB6LmxpdGVyYWwoXCJhc3Npc3RhbnRcIiksXG4gIGNvbnRlbnQ6IHouc3RyaW5nKCkub3B0aW9uYWwoKSxcbiAgdG9vbENhbGxzOiB6LmFycmF5KFRvb2xDYWxsU2NoZW1hKS5vcHRpb25hbCgpXG59KTtcbnZhciBVc2VyTWVzc2FnZVNjaGVtYSA9IEJhc2VNZXNzYWdlU2NoZW1hLmV4dGVuZCh7XG4gIHJvbGU6IHoubGl0ZXJhbChcInVzZXJcIiksXG4gIGNvbnRlbnQ6IHouc3RyaW5nKClcbn0pO1xudmFyIFRvb2xNZXNzYWdlU2NoZW1hID0gei5vYmplY3Qoe1xuICBpZDogei5zdHJpbmcoKSxcbiAgY29udGVudDogei5zdHJpbmcoKSxcbiAgcm9sZTogei5saXRlcmFsKFwidG9vbFwiKSxcbiAgdG9vbENhbGxJZDogei5zdHJpbmcoKSxcbiAgZXJyb3I6IHouc3RyaW5nKCkub3B0aW9uYWwoKVxufSk7XG52YXIgTWVzc2FnZVNjaGVtYSA9IHouZGlzY3JpbWluYXRlZFVuaW9uKFwicm9sZVwiLCBbXG4gIERldmVsb3Blck1lc3NhZ2VTY2hlbWEsXG4gIFN5c3RlbU1lc3NhZ2VTY2hlbWEsXG4gIEFzc2lzdGFudE1lc3NhZ2VTY2hlbWEsXG4gIFVzZXJNZXNzYWdlU2NoZW1hLFxuICBUb29sTWVzc2FnZVNjaGVtYVxuXSk7XG52YXIgUm9sZVNjaGVtYSA9IHoudW5pb24oW1xuICB6LmxpdGVyYWwoXCJkZXZlbG9wZXJcIiksXG4gIHoubGl0ZXJhbChcInN5c3RlbVwiKSxcbiAgei5saXRlcmFsKFwiYXNzaXN0YW50XCIpLFxuICB6LmxpdGVyYWwoXCJ1c2VyXCIpLFxuICB6LmxpdGVyYWwoXCJ0b29sXCIpXG5dKTtcbnZhciBDb250ZXh0U2NoZW1hID0gei5vYmplY3Qoe1xuICBkZXNjcmlwdGlvbjogei5zdHJpbmcoKSxcbiAgdmFsdWU6IHouc3RyaW5nKClcbn0pO1xudmFyIFRvb2xTY2hlbWEgPSB6Lm9iamVjdCh7XG4gIG5hbWU6IHouc3RyaW5nKCksXG4gIGRlc2NyaXB0aW9uOiB6LnN0cmluZygpLFxuICBwYXJhbWV0ZXJzOiB6LmFueSgpXG4gIC8vIEpTT04gU2NoZW1hIGZvciB0aGUgdG9vbCBwYXJhbWV0ZXJzXG59KTtcbnZhciBSdW5BZ2VudElucHV0U2NoZW1hID0gei5vYmplY3Qoe1xuICB0aHJlYWRJZDogei5zdHJpbmcoKSxcbiAgcnVuSWQ6IHouc3RyaW5nKCksXG4gIHN0YXRlOiB6LmFueSgpLFxuICBtZXNzYWdlczogei5hcnJheShNZXNzYWdlU2NoZW1hKSxcbiAgdG9vbHM6IHouYXJyYXkoVG9vbFNjaGVtYSksXG4gIGNvbnRleHQ6IHouYXJyYXkoQ29udGV4dFNjaGVtYSksXG4gIGZvcndhcmRlZFByb3BzOiB6LmFueSgpXG59KTtcbnZhciBTdGF0ZVNjaGVtYSA9IHouYW55KCk7XG52YXIgQUdVSUVycm9yID0gY2xhc3MgZXh0ZW5kcyBFcnJvciB7XG4gIGNvbnN0cnVjdG9yKG1lc3NhZ2UpIHtcbiAgICBzdXBlcihtZXNzYWdlKTtcbiAgfVxufTtcblxuLy8gc3JjL2V2ZW50cy50c1xuaW1wb3J0IHsgeiBhcyB6MiB9IGZyb20gXCJ6b2RcIjtcbnZhciBUZXh0TWVzc2FnZVJvbGVTY2hlbWEgPSB6Mi51bmlvbihbXG4gIHoyLmxpdGVyYWwoXCJkZXZlbG9wZXJcIiksXG4gIHoyLmxpdGVyYWwoXCJzeXN0ZW1cIiksXG4gIHoyLmxpdGVyYWwoXCJhc3Npc3RhbnRcIiksXG4gIHoyLmxpdGVyYWwoXCJ1c2VyXCIpXG5dKTtcbnZhciBFdmVudFR5cGUgPSAvKiBAX19QVVJFX18gKi8gKChFdmVudFR5cGUyKSA9PiB7XG4gIEV2ZW50VHlwZTJbXCJURVhUX01FU1NBR0VfU1RBUlRcIl0gPSBcIlRFWFRfTUVTU0FHRV9TVEFSVFwiO1xuICBFdmVudFR5cGUyW1wiVEVYVF9NRVNTQUdFX0NPTlRFTlRcIl0gPSBcIlRFWFRfTUVTU0FHRV9DT05URU5UXCI7XG4gIEV2ZW50VHlwZTJbXCJURVhUX01FU1NBR0VfRU5EXCJdID0gXCJURVhUX01FU1NBR0VfRU5EXCI7XG4gIEV2ZW50VHlwZTJbXCJURVhUX01FU1NBR0VfQ0hVTktcIl0gPSBcIlRFWFRfTUVTU0FHRV9DSFVOS1wiO1xuICBFdmVudFR5cGUyW1wiVEhJTktJTkdfVEVYVF9NRVNTQUdFX1NUQVJUXCJdID0gXCJUSElOS0lOR19URVhUX01FU1NBR0VfU1RBUlRcIjtcbiAgRXZlbnRUeXBlMltcIlRISU5LSU5HX1RFWFRfTUVTU0FHRV9DT05URU5UXCJdID0gXCJUSElOS0lOR19URVhUX01FU1NBR0VfQ09OVEVOVFwiO1xuICBFdmVudFR5cGUyW1wiVEhJTktJTkdfVEVYVF9NRVNTQUdFX0VORFwiXSA9IFwiVEhJTktJTkdfVEVYVF9NRVNTQUdFX0VORFwiO1xuICBFdmVudFR5cGUyW1wiVE9PTF9DQUxMX1NUQVJUXCJdID0gXCJUT09MX0NBTExfU1RBUlRcIjtcbiAgRXZlbnRUeXBlMltcIlRPT0xfQ0FMTF9BUkdTXCJdID0gXCJUT09MX0NBTExfQVJHU1wiO1xuICBFdmVudFR5cGUyW1wiVE9PTF9DQUxMX0VORFwiXSA9IFwiVE9PTF9DQUxMX0VORFwiO1xuICBFdmVudFR5cGUyW1wiVE9PTF9DQUxMX0NIVU5LXCJdID0gXCJUT09MX0NBTExfQ0hVTktcIjtcbiAgRXZlbnRUeXBlMltcIlRPT0xfQ0FMTF9SRVNVTFRcIl0gPSBcIlRPT0xfQ0FMTF9SRVNVTFRcIjtcbiAgRXZlbnRUeXBlMltcIlRISU5LSU5HX1NUQVJUXCJdID0gXCJUSElOS0lOR19TVEFSVFwiO1xuICBFdmVudFR5cGUyW1wiVEhJTktJTkdfRU5EXCJdID0gXCJUSElOS0lOR19FTkRcIjtcbiAgRXZlbnRUeXBlMltcIlNUQVRFX1NOQVBTSE9UXCJdID0gXCJTVEFURV9TTkFQU0hPVFwiO1xuICBFdmVudFR5cGUyW1wiU1RBVEVfREVMVEFcIl0gPSBcIlNUQVRFX0RFTFRBXCI7XG4gIEV2ZW50VHlwZTJbXCJNRVNTQUdFU19TTkFQU0hPVFwiXSA9IFwiTUVTU0FHRVNfU05BUFNIT1RcIjtcbiAgRXZlbnRUeXBlMltcIlJBV1wiXSA9IFwiUkFXXCI7XG4gIEV2ZW50VHlwZTJbXCJDVVNUT01cIl0gPSBcIkNVU1RPTVwiO1xuICBFdmVudFR5cGUyW1wiUlVOX1NUQVJURURcIl0gPSBcIlJVTl9TVEFSVEVEXCI7XG4gIEV2ZW50VHlwZTJbXCJSVU5fRklOSVNIRURcIl0gPSBcIlJVTl9GSU5JU0hFRFwiO1xuICBFdmVudFR5cGUyW1wiUlVOX0VSUk9SXCJdID0gXCJSVU5fRVJST1JcIjtcbiAgRXZlbnRUeXBlMltcIlNURVBfU1RBUlRFRFwiXSA9IFwiU1RFUF9TVEFSVEVEXCI7XG4gIEV2ZW50VHlwZTJbXCJTVEVQX0ZJTklTSEVEXCJdID0gXCJTVEVQX0ZJTklTSEVEXCI7XG4gIHJldHVybiBFdmVudFR5cGUyO1xufSkoRXZlbnRUeXBlIHx8IHt9KTtcbnZhciBCYXNlRXZlbnRTY2hlbWEgPSB6Mi5vYmplY3Qoe1xuICB0eXBlOiB6Mi5uYXRpdmVFbnVtKEV2ZW50VHlwZSksXG4gIHRpbWVzdGFtcDogejIubnVtYmVyKCkub3B0aW9uYWwoKSxcbiAgcmF3RXZlbnQ6IHoyLmFueSgpLm9wdGlvbmFsKClcbn0pO1xudmFyIFRleHRNZXNzYWdlU3RhcnRFdmVudFNjaGVtYSA9IEJhc2VFdmVudFNjaGVtYS5leHRlbmQoe1xuICB0eXBlOiB6Mi5saXRlcmFsKFwiVEVYVF9NRVNTQUdFX1NUQVJUXCIgLyogVEVYVF9NRVNTQUdFX1NUQVJUICovKSxcbiAgbWVzc2FnZUlkOiB6Mi5zdHJpbmcoKSxcbiAgcm9sZTogVGV4dE1lc3NhZ2VSb2xlU2NoZW1hLmRlZmF1bHQoXCJhc3Npc3RhbnRcIilcbn0pO1xudmFyIFRleHRNZXNzYWdlQ29udGVudEV2ZW50U2NoZW1hID0gQmFzZUV2ZW50U2NoZW1hLmV4dGVuZCh7XG4gIHR5cGU6IHoyLmxpdGVyYWwoXCJURVhUX01FU1NBR0VfQ09OVEVOVFwiIC8qIFRFWFRfTUVTU0FHRV9DT05URU5UICovKSxcbiAgbWVzc2FnZUlkOiB6Mi5zdHJpbmcoKSxcbiAgZGVsdGE6IHoyLnN0cmluZygpLnJlZmluZSgocykgPT4gcy5sZW5ndGggPiAwLCBcIkRlbHRhIG11c3Qgbm90IGJlIGFuIGVtcHR5IHN0cmluZ1wiKVxufSk7XG52YXIgVGV4dE1lc3NhZ2VFbmRFdmVudFNjaGVtYSA9IEJhc2VFdmVudFNjaGVtYS5leHRlbmQoe1xuICB0eXBlOiB6Mi5saXRlcmFsKFwiVEVYVF9NRVNTQUdFX0VORFwiIC8qIFRFWFRfTUVTU0FHRV9FTkQgKi8pLFxuICBtZXNzYWdlSWQ6IHoyLnN0cmluZygpXG59KTtcbnZhciBUZXh0TWVzc2FnZUNodW5rRXZlbnRTY2hlbWEgPSBCYXNlRXZlbnRTY2hlbWEuZXh0ZW5kKHtcbiAgdHlwZTogejIubGl0ZXJhbChcIlRFWFRfTUVTU0FHRV9DSFVOS1wiIC8qIFRFWFRfTUVTU0FHRV9DSFVOSyAqLyksXG4gIG1lc3NhZ2VJZDogejIuc3RyaW5nKCkub3B0aW9uYWwoKSxcbiAgcm9sZTogVGV4dE1lc3NhZ2VSb2xlU2NoZW1hLm9wdGlvbmFsKCksXG4gIGRlbHRhOiB6Mi5zdHJpbmcoKS5vcHRpb25hbCgpXG59KTtcbnZhciBUaGlua2luZ1RleHRNZXNzYWdlU3RhcnRFdmVudFNjaGVtYSA9IEJhc2VFdmVudFNjaGVtYS5leHRlbmQoe1xuICB0eXBlOiB6Mi5saXRlcmFsKFwiVEhJTktJTkdfVEVYVF9NRVNTQUdFX1NUQVJUXCIgLyogVEhJTktJTkdfVEVYVF9NRVNTQUdFX1NUQVJUICovKVxufSk7XG52YXIgVGhpbmtpbmdUZXh0TWVzc2FnZUNvbnRlbnRFdmVudFNjaGVtYSA9IFRleHRNZXNzYWdlQ29udGVudEV2ZW50U2NoZW1hLm9taXQoe1xuICBtZXNzYWdlSWQ6IHRydWUsXG4gIHR5cGU6IHRydWVcbn0pLmV4dGVuZCh7XG4gIHR5cGU6IHoyLmxpdGVyYWwoXCJUSElOS0lOR19URVhUX01FU1NBR0VfQ09OVEVOVFwiIC8qIFRISU5LSU5HX1RFWFRfTUVTU0FHRV9DT05URU5UICovKVxufSk7XG52YXIgVGhpbmtpbmdUZXh0TWVzc2FnZUVuZEV2ZW50U2NoZW1hID0gQmFzZUV2ZW50U2NoZW1hLmV4dGVuZCh7XG4gIHR5cGU6IHoyLmxpdGVyYWwoXCJUSElOS0lOR19URVhUX01FU1NBR0VfRU5EXCIgLyogVEhJTktJTkdfVEVYVF9NRVNTQUdFX0VORCAqLylcbn0pO1xudmFyIFRvb2xDYWxsU3RhcnRFdmVudFNjaGVtYSA9IEJhc2VFdmVudFNjaGVtYS5leHRlbmQoe1xuICB0eXBlOiB6Mi5saXRlcmFsKFwiVE9PTF9DQUxMX1NUQVJUXCIgLyogVE9PTF9DQUxMX1NUQVJUICovKSxcbiAgdG9vbENhbGxJZDogejIuc3RyaW5nKCksXG4gIHRvb2xDYWxsTmFtZTogejIuc3RyaW5nKCksXG4gIHBhcmVudE1lc3NhZ2VJZDogejIuc3RyaW5nKCkub3B0aW9uYWwoKVxufSk7XG52YXIgVG9vbENhbGxBcmdzRXZlbnRTY2hlbWEgPSBCYXNlRXZlbnRTY2hlbWEuZXh0ZW5kKHtcbiAgdHlwZTogejIubGl0ZXJhbChcIlRPT0xfQ0FMTF9BUkdTXCIgLyogVE9PTF9DQUxMX0FSR1MgKi8pLFxuICB0b29sQ2FsbElkOiB6Mi5zdHJpbmcoKSxcbiAgZGVsdGE6IHoyLnN0cmluZygpXG59KTtcbnZhciBUb29sQ2FsbEVuZEV2ZW50U2NoZW1hID0gQmFzZUV2ZW50U2NoZW1hLmV4dGVuZCh7XG4gIHR5cGU6IHoyLmxpdGVyYWwoXCJUT09MX0NBTExfRU5EXCIgLyogVE9PTF9DQUxMX0VORCAqLyksXG4gIHRvb2xDYWxsSWQ6IHoyLnN0cmluZygpXG59KTtcbnZhciBUb29sQ2FsbFJlc3VsdEV2ZW50U2NoZW1hID0gQmFzZUV2ZW50U2NoZW1hLmV4dGVuZCh7XG4gIG1lc3NhZ2VJZDogejIuc3RyaW5nKCksXG4gIHR5cGU6IHoyLmxpdGVyYWwoXCJUT09MX0NBTExfUkVTVUxUXCIgLyogVE9PTF9DQUxMX1JFU1VMVCAqLyksXG4gIHRvb2xDYWxsSWQ6IHoyLnN0cmluZygpLFxuICBjb250ZW50OiB6Mi5zdHJpbmcoKSxcbiAgcm9sZTogejIubGl0ZXJhbChcInRvb2xcIikub3B0aW9uYWwoKVxufSk7XG52YXIgVG9vbENhbGxDaHVua0V2ZW50U2NoZW1hID0gQmFzZUV2ZW50U2NoZW1hLmV4dGVuZCh7XG4gIHR5cGU6IHoyLmxpdGVyYWwoXCJUT09MX0NBTExfQ0hVTktcIiAvKiBUT09MX0NBTExfQ0hVTksgKi8pLFxuICB0b29sQ2FsbElkOiB6Mi5zdHJpbmcoKS5vcHRpb25hbCgpLFxuICB0b29sQ2FsbE5hbWU6IHoyLnN0cmluZygpLm9wdGlvbmFsKCksXG4gIHBhcmVudE1lc3NhZ2VJZDogejIuc3RyaW5nKCkub3B0aW9uYWwoKSxcbiAgZGVsdGE6IHoyLnN0cmluZygpLm9wdGlvbmFsKClcbn0pO1xudmFyIFRoaW5raW5nU3RhcnRFdmVudFNjaGVtYSA9IEJhc2VFdmVudFNjaGVtYS5leHRlbmQoe1xuICB0eXBlOiB6Mi5saXRlcmFsKFwiVEhJTktJTkdfU1RBUlRcIiAvKiBUSElOS0lOR19TVEFSVCAqLyksXG4gIHRpdGxlOiB6Mi5zdHJpbmcoKS5vcHRpb25hbCgpXG59KTtcbnZhciBUaGlua2luZ0VuZEV2ZW50U2NoZW1hID0gQmFzZUV2ZW50U2NoZW1hLmV4dGVuZCh7XG4gIHR5cGU6IHoyLmxpdGVyYWwoXCJUSElOS0lOR19FTkRcIiAvKiBUSElOS0lOR19FTkQgKi8pXG59KTtcbnZhciBTdGF0ZVNuYXBzaG90RXZlbnRTY2hlbWEgPSBCYXNlRXZlbnRTY2hlbWEuZXh0ZW5kKHtcbiAgdHlwZTogejIubGl0ZXJhbChcIlNUQVRFX1NOQVBTSE9UXCIgLyogU1RBVEVfU05BUFNIT1QgKi8pLFxuICBzbmFwc2hvdDogU3RhdGVTY2hlbWFcbn0pO1xudmFyIFN0YXRlRGVsdGFFdmVudFNjaGVtYSA9IEJhc2VFdmVudFNjaGVtYS5leHRlbmQoe1xuICB0eXBlOiB6Mi5saXRlcmFsKFwiU1RBVEVfREVMVEFcIiAvKiBTVEFURV9ERUxUQSAqLyksXG4gIGRlbHRhOiB6Mi5hcnJheSh6Mi5hbnkoKSlcbiAgLy8gSlNPTiBQYXRjaCAoUkZDIDY5MDIpXG59KTtcbnZhciBNZXNzYWdlc1NuYXBzaG90RXZlbnRTY2hlbWEgPSBCYXNlRXZlbnRTY2hlbWEuZXh0ZW5kKHtcbiAgdHlwZTogejIubGl0ZXJhbChcIk1FU1NBR0VTX1NOQVBTSE9UXCIgLyogTUVTU0FHRVNfU05BUFNIT1QgKi8pLFxuICBtZXNzYWdlczogejIuYXJyYXkoTWVzc2FnZVNjaGVtYSlcbn0pO1xudmFyIFJhd0V2ZW50U2NoZW1hID0gQmFzZUV2ZW50U2NoZW1hLmV4dGVuZCh7XG4gIHR5cGU6IHoyLmxpdGVyYWwoXCJSQVdcIiAvKiBSQVcgKi8pLFxuICBldmVudDogejIuYW55KCksXG4gIHNvdXJjZTogejIuc3RyaW5nKCkub3B0aW9uYWwoKVxufSk7XG52YXIgQ3VzdG9tRXZlbnRTY2hlbWEgPSBCYXNlRXZlbnRTY2hlbWEuZXh0ZW5kKHtcbiAgdHlwZTogejIubGl0ZXJhbChcIkNVU1RPTVwiIC8qIENVU1RPTSAqLyksXG4gIG5hbWU6IHoyLnN0cmluZygpLFxuICB2YWx1ZTogejIuYW55KClcbn0pO1xudmFyIFJ1blN0YXJ0ZWRFdmVudFNjaGVtYSA9IEJhc2VFdmVudFNjaGVtYS5leHRlbmQoe1xuICB0eXBlOiB6Mi5saXRlcmFsKFwiUlVOX1NUQVJURURcIiAvKiBSVU5fU1RBUlRFRCAqLyksXG4gIHRocmVhZElkOiB6Mi5zdHJpbmcoKSxcbiAgcnVuSWQ6IHoyLnN0cmluZygpXG59KTtcbnZhciBSdW5GaW5pc2hlZEV2ZW50U2NoZW1hID0gQmFzZUV2ZW50U2NoZW1hLmV4dGVuZCh7XG4gIHR5cGU6IHoyLmxpdGVyYWwoXCJSVU5fRklOSVNIRURcIiAvKiBSVU5fRklOSVNIRUQgKi8pLFxuICB0aHJlYWRJZDogejIuc3RyaW5nKCksXG4gIHJ1bklkOiB6Mi5zdHJpbmcoKSxcbiAgcmVzdWx0OiB6Mi5hbnkoKS5vcHRpb25hbCgpXG59KTtcbnZhciBSdW5FcnJvckV2ZW50U2NoZW1hID0gQmFzZUV2ZW50U2NoZW1hLmV4dGVuZCh7XG4gIHR5cGU6IHoyLmxpdGVyYWwoXCJSVU5fRVJST1JcIiAvKiBSVU5fRVJST1IgKi8pLFxuICBtZXNzYWdlOiB6Mi5zdHJpbmcoKSxcbiAgY29kZTogejIuc3RyaW5nKCkub3B0aW9uYWwoKVxufSk7XG52YXIgU3RlcFN0YXJ0ZWRFdmVudFNjaGVtYSA9IEJhc2VFdmVudFNjaGVtYS5leHRlbmQoe1xuICB0eXBlOiB6Mi5saXRlcmFsKFwiU1RFUF9TVEFSVEVEXCIgLyogU1RFUF9TVEFSVEVEICovKSxcbiAgc3RlcE5hbWU6IHoyLnN0cmluZygpXG59KTtcbnZhciBTdGVwRmluaXNoZWRFdmVudFNjaGVtYSA9IEJhc2VFdmVudFNjaGVtYS5leHRlbmQoe1xuICB0eXBlOiB6Mi5saXRlcmFsKFwiU1RFUF9GSU5JU0hFRFwiIC8qIFNURVBfRklOSVNIRUQgKi8pLFxuICBzdGVwTmFtZTogejIuc3RyaW5nKClcbn0pO1xudmFyIEV2ZW50U2NoZW1hcyA9IHoyLmRpc2NyaW1pbmF0ZWRVbmlvbihcInR5cGVcIiwgW1xuICBUZXh0TWVzc2FnZVN0YXJ0RXZlbnRTY2hlbWEsXG4gIFRleHRNZXNzYWdlQ29udGVudEV2ZW50U2NoZW1hLFxuICBUZXh0TWVzc2FnZUVuZEV2ZW50U2NoZW1hLFxuICBUZXh0TWVzc2FnZUNodW5rRXZlbnRTY2hlbWEsXG4gIFRoaW5raW5nU3RhcnRFdmVudFNjaGVtYSxcbiAgVGhpbmtpbmdFbmRFdmVudFNjaGVtYSxcbiAgVGhpbmtpbmdUZXh0TWVzc2FnZVN0YXJ0RXZlbnRTY2hlbWEsXG4gIFRoaW5raW5nVGV4dE1lc3NhZ2VDb250ZW50RXZlbnRTY2hlbWEsXG4gIFRoaW5raW5nVGV4dE1lc3NhZ2VFbmRFdmVudFNjaGVtYSxcbiAgVG9vbENhbGxTdGFydEV2ZW50U2NoZW1hLFxuICBUb29sQ2FsbEFyZ3NFdmVudFNjaGVtYSxcbiAgVG9vbENhbGxFbmRFdmVudFNjaGVtYSxcbiAgVG9vbENhbGxDaHVua0V2ZW50U2NoZW1hLFxuICBUb29sQ2FsbFJlc3VsdEV2ZW50U2NoZW1hLFxuICBTdGF0ZVNuYXBzaG90RXZlbnRTY2hlbWEsXG4gIFN0YXRlRGVsdGFFdmVudFNjaGVtYSxcbiAgTWVzc2FnZXNTbmFwc2hvdEV2ZW50U2NoZW1hLFxuICBSYXdFdmVudFNjaGVtYSxcbiAgQ3VzdG9tRXZlbnRTY2hlbWEsXG4gIFJ1blN0YXJ0ZWRFdmVudFNjaGVtYSxcbiAgUnVuRmluaXNoZWRFdmVudFNjaGVtYSxcbiAgUnVuRXJyb3JFdmVudFNjaGVtYSxcbiAgU3RlcFN0YXJ0ZWRFdmVudFNjaGVtYSxcbiAgU3RlcEZpbmlzaGVkRXZlbnRTY2hlbWFcbl0pO1xuZXhwb3J0IHtcbiAgQUdVSUVycm9yLFxuICBBc3Npc3RhbnRNZXNzYWdlU2NoZW1hLFxuICBCYXNlRXZlbnRTY2hlbWEsXG4gIEJhc2VNZXNzYWdlU2NoZW1hLFxuICBDb250ZXh0U2NoZW1hLFxuICBDdXN0b21FdmVudFNjaGVtYSxcbiAgRGV2ZWxvcGVyTWVzc2FnZVNjaGVtYSxcbiAgRXZlbnRTY2hlbWFzLFxuICBFdmVudFR5cGUsXG4gIEZ1bmN0aW9uQ2FsbFNjaGVtYSxcbiAgTWVzc2FnZVNjaGVtYSxcbiAgTWVzc2FnZXNTbmFwc2hvdEV2ZW50U2NoZW1hLFxuICBSYXdFdmVudFNjaGVtYSxcbiAgUm9sZVNjaGVtYSxcbiAgUnVuQWdlbnRJbnB1dFNjaGVtYSxcbiAgUnVuRXJyb3JFdmVudFNjaGVtYSxcbiAgUnVuRmluaXNoZWRFdmVudFNjaGVtYSxcbiAgUnVuU3RhcnRlZEV2ZW50U2NoZW1hLFxuICBTdGF0ZURlbHRhRXZlbnRTY2hlbWEsXG4gIFN0YXRlU2NoZW1hLFxuICBTdGF0ZVNuYXBzaG90RXZlbnRTY2hlbWEsXG4gIFN0ZXBGaW5pc2hlZEV2ZW50U2NoZW1hLFxuICBTdGVwU3RhcnRlZEV2ZW50U2NoZW1hLFxuICBTeXN0ZW1NZXNzYWdlU2NoZW1hLFxuICBUZXh0TWVzc2FnZUNodW5rRXZlbnRTY2hlbWEsXG4gIFRleHRNZXNzYWdlQ29udGVudEV2ZW50U2NoZW1hLFxuICBUZXh0TWVzc2FnZUVuZEV2ZW50U2NoZW1hLFxuICBUZXh0TWVzc2FnZVN0YXJ0RXZlbnRTY2hlbWEsXG4gIFRoaW5raW5nRW5kRXZlbnRTY2hlbWEsXG4gIFRoaW5raW5nU3RhcnRFdmVudFNjaGVtYSxcbiAgVGhpbmtpbmdUZXh0TWVzc2FnZUNvbnRlbnRFdmVudFNjaGVtYSxcbiAgVGhpbmtpbmdUZXh0TWVzc2FnZUVuZEV2ZW50U2NoZW1hLFxuICBUaGlua2luZ1RleHRNZXNzYWdlU3RhcnRFdmVudFNjaGVtYSxcbiAgVG9vbENhbGxBcmdzRXZlbnRTY2hlbWEsXG4gIFRvb2xDYWxsQ2h1bmtFdmVudFNjaGVtYSxcbiAgVG9vbENhbGxFbmRFdmVudFNjaGVtYSxcbiAgVG9vbENhbGxSZXN1bHRFdmVudFNjaGVtYSxcbiAgVG9vbENhbGxTY2hlbWEsXG4gIFRvb2xDYWxsU3RhcnRFdmVudFNjaGVtYSxcbiAgVG9vbE1lc3NhZ2VTY2hlbWEsXG4gIFRvb2xTY2hlbWEsXG4gIFVzZXJNZXNzYWdlU2NoZW1hXG59O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXgubWpzLm1hcCJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@ag-ui/core/dist/index.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/@ag-ui/langgraph/dist/index.mjs":
/*!******************************************************!*\
  !*** ./node_modules/@ag-ui/langgraph/dist/index.mjs ***!
  \******************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   CustomEventNames: () => (/* binding */ pt),\n/* harmony export */   LangGraphAgent: () => (/* binding */ rt),\n/* harmony export */   LangGraphEventTypes: () => (/* binding */ ut),\n/* harmony export */   LangGraphHttpAgent: () => (/* binding */ ot)\n/* harmony export */ });\n/* harmony import */ var _ag_ui_client__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @ag-ui/client */ \"(rsc)/./node_modules/@ag-ui/client/dist/index.mjs\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! rxjs */ \"(rsc)/./node_modules/rxjs/dist/esm5/internal/Observable.js\");\n/* harmony import */ var _langchain_langgraph_sdk__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @langchain/langgraph-sdk */ \"(rsc)/./node_modules/@ag-ui/langgraph/node_modules/@langchain/langgraph-sdk/index.js\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! crypto */ \"crypto\");\n/* harmony import */ var _ag_ui_client__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @ag-ui/client */ \"(rsc)/./node_modules/@ag-ui/core/dist/index.mjs\");\nvar dt=Object.defineProperty,ct=Object.defineProperties;var gt=Object.getOwnPropertyDescriptors;var J=Object.getOwnPropertySymbols;var Q=Object.prototype.hasOwnProperty,Z=Object.prototype.propertyIsEnumerable;var q=(n,a)=>(a=Symbol[n])?a:Symbol.for(\"Symbol.\"+n);var z=(n,a,t)=>a in n?dt(n,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[a]=t,p=(n,a)=>{for(var t in a||(a={}))Q.call(a,t)&&z(n,t,a[t]);if(J)for(var t of J(a))Z.call(a,t)&&z(n,t,a[t]);return n},f=(n,a)=>ct(n,gt(a));var tt=(n,a)=>{var t={};for(var e in n)Q.call(n,e)&&a.indexOf(e)<0&&(t[e]=n[e]);if(n!=null&&J)for(var e of J(n))a.indexOf(e)<0&&Z.call(n,e)&&(t[e]=n[e]);return t};var et=(n,a,t)=>(a=n[q(\"asyncIterator\")])?a.call(n):(n=n[q(\"iterator\")](),a={},t=(e,s)=>(s=n[e])&&(a[e]=i=>new Promise((l,o,g)=>(i=s.call(n,i),g=i.done,Promise.resolve(i.value).then(d=>l({value:d,done:g}),o)))),t(\"next\"),t(\"return\"),a);var ut=(c=>(c.OnChainStart=\"on_chain_start\",c.OnChainStream=\"on_chain_stream\",c.OnChainEnd=\"on_chain_end\",c.OnChatModelStart=\"on_chat_model_start\",c.OnChatModelStream=\"on_chat_model_stream\",c.OnChatModelEnd=\"on_chat_model_end\",c.OnToolStart=\"on_tool_start\",c.OnToolEnd=\"on_tool_end\",c.OnCustomEvent=\"on_custom_event\",c.OnInterrupt=\"on_interrupt\",c))(ut||{}),pt=(s=>(s.ManuallyEmitMessage=\"manually_emit_message\",s.ManuallyEmitToolCall=\"manually_emit_tool_call\",s.ManuallyEmitState=\"manually_emit_state\",s.Exit=\"exit\",s))(pt||{});var j=[\"messages\",\"tools\"];function F(n,a){return Object.fromEntries(Object.entries(n).filter(([t])=>a.includes(t)))}function st({mode:n,state:a,schemaKeys:t}){let e=n===\"start\"?a:null;return e&&(t!=null&&t.input)&&(e=F(e,[...j,...t.input])),e}function at(n){return n.map(a=>{var t;switch(a.type){case\"human\":return{id:a.id,role:\"user\",content:X(O(a.content))};case\"ai\":let e=O(a.content);return{id:a.id,role:\"assistant\",content:e?X(e):\"\",toolCalls:(t=a.tool_calls)==null?void 0:t.map(s=>({id:s.id,type:\"function\",function:{name:s.name,arguments:JSON.stringify(s.args)}}))};case\"system\":return{id:a.id,role:\"system\",content:X(O(a.content))};case\"tool\":return{id:a.id,role:\"tool\",content:X(O(a.content)),toolCallId:a.tool_call_id};default:throw new Error(\"message type returned from LangGraph is not supported.\")}})}function $(n){return n.map((a,t)=>{var e,s;switch(a.role){case\"user\":return{id:a.id,role:a.role,content:a.content,type:\"human\"};case\"assistant\":return{id:a.id,type:\"ai\",role:a.role,content:(e=a.content)!=null?e:\"\",tool_calls:((s=a.toolCalls)!=null?s:[]).map(i=>({id:i.id,name:i.function.name,args:JSON.parse(i.function.arguments),type:\"tool_call\"}))};case\"system\":return{id:a.id,role:a.role,content:a.content,type:\"system\"};case\"tool\":return{content:a.content,role:a.role,type:a.role,tool_call_id:a.toolCallId,id:a.id};default:throw console.error(`Message role ${a.role} is not implemented`),new Error(\"message role is not supported.\")}})}function X(n){return typeof n==\"string\"?n:JSON.stringify(n)}function nt(n){var t,e,s,i,l;let a=(t=n.chunk)==null?void 0:t.content;if(a&&Array.isArray(a)&&a.length&&a[0])return a[0].thinking?{text:a[0].thinking,type:\"text\",index:a[0].index}:null;if((i=(s=(e=n.chunk.additional_kwargs)==null?void 0:e.reasoning)==null?void 0:s.summary)!=null&&i[0]){let o=(l=n.chunk.additional_kwargs)==null?void 0:l.reasoning.summary[0];return!o||!o.text?null:{type:\"text\",text:o.text,index:o.index}}return null}function O(n){var a;if(!n)return null;if(typeof n==\"string\")return n;if(Array.isArray(n)&&n.length){let t=(a=n.find(e=>e.type===\"text\"))==null?void 0:a.text;return t!=null?t:null}return null}var rt=class n extends _ag_ui_client__WEBPACK_IMPORTED_MODULE_2__.AbstractAgent{constructor(t){var e,s;super(t);this.constantSchemaKeys=j;this.config=t,this.messagesInProcess={},this.agentName=t.agentName,this.graphId=t.graphId,this.assistantConfig=t.assistantConfig,this.thinkingProcess=null,this.client=(s=t==null?void 0:t.client)!=null?s:new _langchain_langgraph_sdk__WEBPACK_IMPORTED_MODULE_0__.Client({apiUrl:t.deploymentUrl,apiKey:t.langsmithApiKey,defaultHeaders:p({},(e=t.propertyHeaders)!=null?e:{})})}clone(){return new n(this.config)}dispatchEvent(t){return this.subscriber.next(t),!0}run(t){return new rxjs__WEBPACK_IMPORTED_MODULE_3__.Observable(e=>(this.runAgentStream(t,e),()=>{}))}async runAgentStream(t,e){var o,g,d;this.activeRun={id:t.runId,threadId:t.threadId},this.subscriber=e,this.assistant||(this.assistant=await this.getAssistant());let s=(o=t.threadId)!=null?o:(0,crypto__WEBPACK_IMPORTED_MODULE_1__.randomUUID)(),i=(d=(g=t.forwardedProps)==null?void 0:g.streamMode)!=null?d:[\"events\",\"values\",\"updates\"],l=await this.prepareStream(f(p({},t),{threadId:s}),i);if(!l)return e.error(\"No stream to regenerate\");await this.handleStreamEvents(l,s,e,t,i)}async prepareRegenerateStream(t,e){var c,r,S;let{threadId:s,messageCheckpoint:i,tools:l}=t,o=await this.getCheckpointByMessage(i.id,s);if(this.assistant||(this.assistant=await this.getAssistant()),!o)return this.subscriber.error(\"No checkpoint found for message\");let g=await this.client.threads.updateState(s,{values:this.langGraphDefaultMergeState(o.values,[],l),checkpointId:o.checkpoint.checkpoint_id,asNode:(r=(c=o.next)==null?void 0:c[0])!=null?r:\"__start__\"}),d=f(p({},(S=t.forwardedProps)!=null?S:{}),{input:this.langGraphDefaultMergeState(o.values,[i],l),checkpointId:g.checkpoint.checkpoint_id,streamMode:e});return{streamResponse:this.client.runs.stream(s,this.assistant.assistant_id,d),state:o,streamMode:e}}async prepareStream(t,e){var w,b,G,L,C,k,U,B;let{threadId:s,state:i,messages:l,tools:o,context:g,forwardedProps:d}=t;this.activeRun.manuallyEmittedState=null;let c=d==null?void 0:d.nodeName;this.activeRun.nodeName=c,this.activeRun.nodeName===\"__end__\"&&(this.activeRun.nodeName=void 0);let r=s!=null?s:(0,crypto__WEBPACK_IMPORTED_MODULE_1__.randomUUID)();this.assistant||(this.assistant=await this.getAssistant());let S=await this.getOrCreateThread(r,d==null?void 0:d.threadMetadata);this.activeRun.threadId=S.thread_id;let u=(w=await this.client.threads.getState(S.thread_id))!=null?w:{values:{}},T=(b=u.values.messages)!=null?b:[],M=$(l),y=this.langGraphDefaultMergeState(f(p({},i),{messages:T}),M,o),_=f(p({},u),{values:f(p({},y),{messages:[...T,...y.messages]})}),v=_.values;if(this.activeRun.schemaKeys=await this.getSchemaKeys(),((G=u.values.messages)!=null?G:[]).length>l.filter(E=>E.role!==\"system\").length){let E=null;for(let m=l.length-1;m>=0;m--)if(l[m].role===\"user\"){E=$([l[m]])[0];break}return E?this.prepareRegenerateStream(f(p({},t),{messageCheckpoint:E}),e):this.subscriber.error(\"No user message found in messages to regenerate\")}this.activeRun.graphInfo=await this.client.assistants.getGraph(this.assistant.assistant_id);let R=!((L=d==null?void 0:d.command)!=null&&L.resume)&&r&&this.activeRun.nodeName!=\"__end__\"&&this.activeRun.nodeName?\"continue\":\"start\";if(R===\"continue\"){let E=this.activeRun.graphInfo.edges.find(m=>m.target===this.activeRun.nodeName);await this.client.threads.updateState(r,{values:i,asNode:E==null?void 0:E.source})}let N=st({mode:R,state:v,schemaKeys:this.activeRun.schemaKeys}),A,I=[this.assistantConfig,d==null?void 0:d.config].filter(Boolean);I.length&&(A=await this.mergeConfigs({configs:I,assistant:this.assistant,schemaKeys:this.activeRun.schemaKeys}));let H=f(p({},d),{streamMode:e,input:N,config:A}),x=(U=(k=(C=u.tasks)==null?void 0:C[0])==null?void 0:k.interrupts)!=null?U:[];return x!=null&&x.length&&!((B=d==null?void 0:d.command)!=null&&B.resume)?(this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.RUN_STARTED,threadId:r,runId:t.runId}),x.forEach(E=>{this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.CUSTOM,name:\"on_interrupt\",value:typeof E.value==\"string\"?E.value:JSON.stringify(E.value),rawEvent:E})}),this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.RUN_FINISHED,threadId:r,runId:t.runId}),this.subscriber.complete()):{streamResponse:this.client.runs.stream(r,this.assistant.assistant_id,H),state:_}}async handleStreamEvents(t,e,s,i,l){var T,M,y,_,v,H,x,w,b,G,L;let{forwardedProps:o}=i,g=o==null?void 0:o.nodeName;this.subscriber=s;let d=!1;if(!t)return;let{streamResponse:c,state:r}=t;this.activeRun.prevNodeName=null;let S={},u=r;try{this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.RUN_STARTED,threadId:e,runId:this.activeRun.id}),(T=o==null?void 0:o.command)!=null&&T.resume&&this.activeRun.nodeName&&this.startStep(this.activeRun.nodeName);try{for(var R=et(c),N,A,I;N=!(A=await R.next()).done;N=!1){let m=A.value;let W=(M=i.forwardedProps)==null?void 0:M.streamSubgraphs,lt=W&&(m.event.startsWith(\"events\")||m.event.startsWith(\"values\"));if(!l.includes(m.event)&&!lt)continue;let D=m;if(m.event===\"error\"){this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.RUN_ERROR,message:m.data.message,rawEvent:m});break}if(m.event===\"updates\")continue;if(m.event===\"values\"){S=D.data;continue}else if(W&&D.event.startsWith(\"values|\")){S=p(p({},S),D.data);continue}let K=D.data,V=(y=K.metadata)!=null?y:{},P=V.langgraph_node,Y=K.event;if(this.activeRun.id=V.run_id,P&&P!==this.activeRun.nodeName&&(this.activeRun.nodeName&&this.activeRun.nodeName!==g&&this.endStep(),this.startStep(P)),d=d||Y===\"on_custom_event\"&&K.name===\"exit\",this.activeRun.exitingNode=this.activeRun.nodeName===P&&Y===\"on_chain_end\",this.activeRun.exitingNode&&(this.activeRun.manuallyEmittedState=null),(_=this.activeRun.graphInfo)!=null&&_.nodes.some(ht=>ht.id===P)&&(this.activeRun.nodeName=P),u.values=(v=this.activeRun.manuallyEmittedState)!=null?v:S,!this.activeRun.nodeName)continue;(JSON.stringify(u)!==JSON.stringify(r)||this.activeRun.prevNodeName!=this.activeRun.nodeName||this.activeRun.exitingNode)&&!this.getMessageInProgress(this.activeRun.id)&&(r=u,this.activeRun.prevNodeName=this.activeRun.nodeName,this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.STATE_SNAPSHOT,snapshot:this.getStateSnapshot(r),rawEvent:D})),this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.RAW,event:K}),this.handleSingleEvent(K)}}catch(A){I=[A]}finally{try{N&&(A=R.return)&&await A.call(R)}finally{if(I)throw I[0]}}r=await this.client.threads.getState(e);let C=r.tasks,k=(x=(H=C==null?void 0:C[0])==null?void 0:H.interrupts)!=null?x:[],U=r.next.length===0,B=(b=(w=r.metadata)==null?void 0:w.writes)!=null?b:{},E=this.activeRun.nodeName;return k!=null&&k.length||(E=U?\"__end__\":(G=r.next[0])!=null?G:Object.keys(B)[0]),k.forEach(m=>{this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.CUSTOM,name:\"on_interrupt\",value:typeof m.value==\"string\"?m.value:JSON.stringify(m.value),rawEvent:m})}),this.activeRun.nodeName!=E&&(this.endStep(),this.startStep(E)),this.endStep(),this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.STATE_SNAPSHOT,snapshot:this.getStateSnapshot(r)}),this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.MESSAGES_SNAPSHOT,messages:at((L=r.values.messages)!=null?L:[])}),this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.RUN_FINISHED,threadId:e,runId:this.activeRun.id}),this.activeRun=void 0,s.complete()}catch(C){return s.error(C)}}handleSingleEvent(t){var e,s,i,l,o,g;switch(t.event){case\"on_chat_model_stream\":let d=(e=t.metadata[\"emit-messages\"])!=null?e:!0,c=(s=t.metadata[\"emit-tool-calls\"])!=null?s:!0;if(t.data.chunk.response_metadata.finish_reason)return;let r=this.getMessageInProgress(this.activeRun.id),S=!!(r!=null&&r.id),u=(i=t.data.chunk.tool_call_chunks)==null?void 0:i[0],T=(l=t.metadata.predict_state)==null?void 0:l.some(I=>I.tool===(u==null?void 0:u.name)),M=!S&&(u==null?void 0:u.name),y=S&&(r==null?void 0:r.toolCallId)&&(u==null?void 0:u.args),_=S&&(r==null?void 0:r.toolCallId)&&!u,v=nt(t.data),R=O(t.data.chunk.content),N=!!(!u&&R),A=S&&!(r!=null&&r.toolCallId)&&!N;if(v){this.handleThinkingEvent(v);break}if(!v&&this.thinkingProcess&&(this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.THINKING_TEXT_MESSAGE_END}),this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.THINKING_END}),this.thinkingProcess=null),T&&this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.CUSTOM,name:\"PredictState\",value:t.metadata.predict_state}),_){this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.TOOL_CALL_END,toolCallId:r==null?void 0:r.toolCallId,rawEvent:t})&&(this.messagesInProcess[this.activeRun.id]=null);break}if(A){this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.TEXT_MESSAGE_END,messageId:r.id,rawEvent:t})&&(this.messagesInProcess[this.activeRun.id]=null);break}if(M&&c){this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.TOOL_CALL_START,toolCallId:u.id,toolCallName:u.name,parentMessageId:t.data.chunk.id,rawEvent:t})&&this.setMessageInProgress(this.activeRun.id,{id:t.data.chunk.id,toolCallId:u.id,toolCallName:u.name});break}if(y&&c){this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.TOOL_CALL_ARGS,toolCallId:r==null?void 0:r.toolCallId,delta:u.args,rawEvent:t});break}if(N&&d){r||(this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.TEXT_MESSAGE_START,role:\"assistant\",messageId:t.data.chunk.id,rawEvent:t}),this.setMessageInProgress(this.activeRun.id,{id:t.data.chunk.id,toolCallId:null,toolCallName:null}),r=this.getMessageInProgress(this.activeRun.id)),this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.TEXT_MESSAGE_CONTENT,messageId:r.id,delta:R,rawEvent:t});break}break;case\"on_chat_model_end\":if((o=this.getMessageInProgress(this.activeRun.id))!=null&&o.toolCallId){this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.TOOL_CALL_END,toolCallId:this.getMessageInProgress(this.activeRun.id).toolCallId,rawEvent:t})&&(this.messagesInProcess[this.activeRun.id]=null);break}if((g=this.getMessageInProgress(this.activeRun.id))!=null&&g.id){this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.TEXT_MESSAGE_END,messageId:this.getMessageInProgress(this.activeRun.id).id,rawEvent:t})&&(this.messagesInProcess[this.activeRun.id]=null);break}break;case\"on_custom_event\":if(t.name===\"manually_emit_message\"){this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.TEXT_MESSAGE_START,role:\"assistant\",messageId:t.data.message_id,rawEvent:t}),this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.TEXT_MESSAGE_CONTENT,messageId:t.data.message_id,delta:t.data.message,rawEvent:t}),this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.TEXT_MESSAGE_END,messageId:t.data.message_id,rawEvent:t});break}if(t.name===\"manually_emit_tool_call\"){this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.TOOL_CALL_START,toolCallId:t.data.id,toolCallName:t.data.name,parentMessageId:t.data.id,rawEvent:t}),this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.TOOL_CALL_ARGS,toolCallId:t.data.id,delta:t.data.args,rawEvent:t}),this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.TOOL_CALL_END,toolCallId:t.data.id,rawEvent:t});break}t.name===\"manually_emit_state\"&&(this.activeRun.manuallyEmittedState=t.data,this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.STATE_SNAPSHOT,snapshot:this.getStateSnapshot({values:this.activeRun.manuallyEmittedState}),rawEvent:t})),this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.CUSTOM,name:t.name,value:t.data,rawEvent:t});break}}handleThinkingEvent(t){var s;if(!t||!t.type||!t.text)return;let e=t.index;(s=this.thinkingProcess)!=null&&s.index&&this.thinkingProcess.index!==e&&(this.thinkingProcess.type&&this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.THINKING_TEXT_MESSAGE_END}),this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.THINKING_END}),this.thinkingProcess=null),this.thinkingProcess||(this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.THINKING_START}),this.thinkingProcess={index:e}),this.thinkingProcess.type!==t.type&&(this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.THINKING_TEXT_MESSAGE_START}),this.thinkingProcess.type=t.type),this.thinkingProcess.type&&this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.THINKING_TEXT_MESSAGE_CONTENT,delta:t.text})}getStateSnapshot(t){let e=t.values,s=this.activeRun.schemaKeys;return s!=null&&s.output&&(e=F(e,[...this.constantSchemaKeys,...s.output])),e}async getOrCreateThread(t,e){let s;try{try{s=await this.getThread(t)}catch(i){s=await this.createThread({threadId:t,metadata:e})}}catch(i){throw new Error(`Failed to create thread: ${i.message}`)}return s}async getThread(t){return this.client.threads.get(t)}async createThread(t){return this.client.threads.create(t)}async mergeConfigs({configs:t,assistant:e,schemaKeys:s}){return t.reduce((i,l)=>{var S;let o=i.configurable;l.configurable&&(o=s!=null&&s.config?F(l==null?void 0:l.configurable,[...this.constantSchemaKeys,...(S=s==null?void 0:s.config)!=null?S:[]]):l==null?void 0:l.configurable);let g=f(p(p({},i),l),{configurable:o}),d=i.recursion_limit==null&&l.recursion_limit===25,c=JSON.stringify(g)!==JSON.stringify(i),r=d&&JSON.stringify(f(p({},g),{recursion_limit:null}))===JSON.stringify(f(p({},i),{recursion_limit:null}));return c&&!r?p(p({},i),g):i},e.config)}getMessageInProgress(t){return this.messagesInProcess[t]}setMessageInProgress(t,e){this.messagesInProcess=f(p({},this.messagesInProcess),{[t]:p(p({},this.messagesInProcess[t]),e)})}async getAssistant(){let t=await this.client.assistants.search(),e=t.find(s=>s.graph_id===this.graphId);if(!e)throw console.error(`\n      No agent found with graph ID ${this.graphId} found..\n\n      \n      These are the available agents: [${t.map(s=>`${s.graph_id} (ID: ${s.assistant_id})`).join(\", \")}]\n      `),new Error(\"No agent id found\");return e}async getSchemaKeys(){var t,e,s;try{let i=await this.client.assistants.getSchemas(this.assistant.assistant_id),l=null;if((t=i.config_schema)!=null&&t.properties&&(l=Object.keys(i.config_schema.properties)),!((e=i.input_schema)!=null&&e.properties)||!((s=i.output_schema)!=null&&s.properties))return{config:[],input:null,output:null};let o=Object.keys(i.input_schema.properties),g=Object.keys(i.output_schema.properties);return{input:o&&o.length?[...o,...this.constantSchemaKeys]:null,output:g&&g.length?[...g,...this.constantSchemaKeys]:null,config:l}}catch(i){return{config:[],input:this.constantSchemaKeys,output:this.constantSchemaKeys}}}langGraphDefaultMergeState(t,e,s){var d;e.length>0&&\"role\"in e[0]&&e[0].role===\"system\"&&(e=e.slice(1));let i=t.messages||[],l=new Set(i.map(c=>c.id)),o=e.filter(c=>!l.has(c.id)),g=[...(d=t.tools)!=null?d:[],...s!=null?s:[]].map(c=>c.type?c:{type:\"function\",function:{name:c.name,description:c.description,parameters:c.parameters}});return f(p({},t),{messages:o,tools:g})}startStep(t){this.activeStep&&this.endStep(),this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.STEP_STARTED,stepName:t}),this.activeRun.nodeName=t,this.activeStep=t}endStep(){var t;if(!this.activeStep)throw new Error(\"No active step to end\");this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.STEP_FINISHED,stepName:(t=this.activeRun.nodeName)!=null?t:this.activeStep}),this.activeRun.nodeName=void 0,this.activeStep=void 0}async getCheckpointByMessage(t,e,s){var y,v;let i=s!=null&&s.checkpoint_id?{checkpoint:{checkpoint_id:s.checkpoint_id}}:void 0,o=[...await this.client.threads.getHistory(e,i)].reverse(),g=o.find(R=>{var N;return(N=R.values.messages)==null?void 0:N.some(A=>A.id===t)});if(!g)throw new Error(\"Message not found\");let d=(y=g.values.messages)!=null?y:[],c=d.findIndex(R=>R.id===t);if(d.slice(c+1).length)return this.getCheckpointByMessage(t,e,g.parent_checkpoint);let S=o.indexOf(g),_=g.values,{messages:u}=_,T=tt(_,[\"messages\"]),M=(v=o[S-1])!=null?v:f(p({},g),{values:{}});return f(p({},M),{values:p(p({},M.values),T)})}};var ot=class extends _ag_ui_client__WEBPACK_IMPORTED_MODULE_2__.HttpAgent{};\n//# sourceMappingURL=index.mjs.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQGFnLXVpL2xhbmdncmFwaC9kaXN0L2luZGV4Lm1qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7QUFBQSx3REFBd0Qsd0NBQXdDLG1DQUFtQyw4RUFBOEUscURBQXFELDhCQUE4QixrREFBa0QsbUJBQW1CLHFCQUFxQiwyQkFBMkIsZ0RBQWdELFNBQVMsc0JBQXNCLGVBQWUsU0FBUyx3REFBd0QseUVBQXlFLFVBQVUsOEVBQThFLDhHQUE4RyxlQUFlLGlDQUF1TSxvV0FBb1csMktBQTJLLEVBQWdFLDJCQUEyQixnQkFBZ0IsMEVBQTBFLGFBQWEsNEJBQTRCLEVBQUUseUJBQXlCLDJEQUEyRCxlQUFlLGlCQUFpQixNQUFNLGVBQWUsbUJBQW1CLDZDQUE2Qyw0QkFBNEIsT0FBTyw4RkFBOEYsa0NBQWtDLDhDQUE4QyxJQUFJLG9CQUFvQiwrQ0FBK0Msa0JBQWtCLHVFQUF1RSxtRkFBbUYsRUFBRSxjQUFjLHFCQUFxQixRQUFRLGVBQWUsa0JBQWtCLG9EQUFvRCx1QkFBdUIsZ0hBQWdILG9GQUFvRixJQUFJLG9CQUFvQixxREFBcUQsa0JBQWtCLDZFQUE2RSw0Q0FBNEMsUUFBUSxrRUFBa0UsRUFBRSxjQUFjLDhDQUE4QyxlQUFlLGNBQWMseUNBQXlDLDZEQUE2RCxnREFBZ0QsTUFBTSxzR0FBc0csd0VBQXdFLHdCQUF3Qix1Q0FBdUMsWUFBWSxjQUFjLE1BQU0sa0JBQWtCLCtCQUErQiwrQkFBK0IseURBQXlELHNCQUFzQixZQUFZLHVCQUF1Qix3REFBRSxDQUFDLGVBQWUsUUFBUSxTQUFTLDBCQUEwQix1Q0FBdUMsd0tBQXdLLDREQUFFLEVBQUUsbUVBQW1FLGlDQUFpQyxFQUFFLEVBQUUsUUFBUSwwQkFBMEIsaUJBQWlCLGtDQUFrQyxPQUFPLFdBQVcsNENBQUUsb0NBQW9DLEdBQUcsMEJBQTBCLFVBQVUsZ0JBQWdCLCtCQUErQiw4RUFBOEUsNkJBQTZCLGtEQUFFLCtIQUErSCxLQUFLLFdBQVcsS0FBSyxnREFBZ0QseUNB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YSxLQUFLLGFBQWEsY0FBYyxJQUFJLHFCQUFxQixvREFBRSxHQUEwRztBQUMzb0UiLCJzb3VyY2VzIjpbIi9ob21lL2NldGVjL05vZGVQcm9qZWN0cy9hZ3VpX3Rlc3Qvbm9kZV9tb2R1bGVzL0BhZy11aS9sYW5nZ3JhcGgvZGlzdC9pbmRleC5tanMiXSwic291cmNlc0NvbnRlbnQiOlsidmFyIGR0PU9iamVjdC5kZWZpbmVQcm9wZXJ0eSxjdD1PYmplY3QuZGVmaW5lUHJvcGVydGllczt2YXIgZ3Q9T2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnM7dmFyIEo9T2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9sczt2YXIgUT1PYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LFo9T2JqZWN0LnByb3RvdHlwZS5wcm9wZXJ0eUlzRW51bWVyYWJsZTt2YXIgcT0obixhKT0+KGE9U3ltYm9sW25dKT9hOlN5bWJvbC5mb3IoXCJTeW1ib2wuXCIrbik7dmFyIHo9KG4sYSx0KT0+YSBpbiBuP2R0KG4sYSx7ZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITAsd3JpdGFibGU6ITAsdmFsdWU6dH0pOm5bYV09dCxwPShuLGEpPT57Zm9yKHZhciB0IGluIGF8fChhPXt9KSlRLmNhbGwoYSx0KSYmeihuLHQsYVt0XSk7aWYoSilmb3IodmFyIHQgb2YgSihhKSlaLmNhbGwoYSx0KSYmeihuLHQsYVt0XSk7cmV0dXJuIG59LGY9KG4sYSk9PmN0KG4sZ3QoYSkpO3ZhciB0dD0obixhKT0+e3ZhciB0PXt9O2Zvcih2YXIgZSBpbiBuKVEuY2FsbChuLGUpJiZhLmluZGV4T2YoZSk8MCYmKHRbZV09bltlXSk7aWYobiE9bnVsbCYmSilmb3IodmFyIGUgb2YgSihuKSlhLmluZGV4T2YoZSk8MCYmWi5jYWxsKG4sZSkmJih0W2VdPW5bZV0pO3JldHVybiB0fTt2YXIgZXQ9KG4sYSx0KT0+KGE9bltxKFwiYXN5bmNJdGVyYXRvclwiKV0pP2EuY2FsbChuKToobj1uW3EoXCJpdGVyYXRvclwiKV0oKSxhPXt9LHQ9KGUscyk9PihzPW5bZV0pJiYoYVtlXT1pPT5uZXcgUHJvbWlzZSgobCxvLGcpPT4oaT1zLmNhbGwobixpKSxnPWkuZG9uZSxQcm9taXNlLnJlc29sdmUoaS52YWx1ZSkudGhlbihkPT5sKHt2YWx1ZTpkLGRvbmU6Z30pLG8pKSkpLHQoXCJuZXh0XCIpLHQoXCJyZXR1cm5cIiksYSk7aW1wb3J0e0h0dHBBZ2VudCBhcyBmdH1mcm9tXCJAYWctdWkvY2xpZW50XCI7aW1wb3J0e09ic2VydmFibGUgYXMgbXR9ZnJvbVwicnhqc1wiO2ltcG9ydHtDbGllbnQgYXMgU3R9ZnJvbVwiQGxhbmdjaGFpbi9sYW5nZ3JhcGgtc2RrXCI7aW1wb3J0e3JhbmRvbVVVSUQgYXMgaXR9ZnJvbVwiY3J5cHRvXCI7dmFyIHV0PShjPT4oYy5PbkNoYWluU3RhcnQ9XCJvbl9jaGFpbl9zdGFydFwiLGMuT25DaGFpblN0cmVhbT1cIm9uX2NoYWluX3N0cmVhbVwiLGMuT25DaGFpbkVuZD1cIm9uX2NoYWluX2VuZFwiLGMuT25DaGF0TW9kZWxTdGFydD1cIm9uX2NoYXRfbW9kZWxfc3RhcnRcIixjLk9uQ2hhdE1vZGVsU3RyZWFtPVwib25fY2hhdF9tb2RlbF9zdHJlYW1cIixjLk9uQ2hhdE1vZGVsRW5kPVwib25fY2hhdF9tb2RlbF9lbmRcIixjLk9uVG9vbFN0YXJ0PVwib25fdG9vbF9zdGFydFwiLGMuT25Ub29sRW5kPVwib25fdG9vbF9lbmRcIixjLk9uQ3VzdG9tRXZlbnQ9XCJvbl9jdXN0b21fZXZlbnRcIixjLk9uSW50ZXJydXB0PVwib25faW50ZXJydXB0XCIsYykpKHV0fHx7fSkscHQ9KHM9PihzLk1hbnVhbGx5RW1pdE1lc3NhZ2U9XCJtYW51YWxseV9lbWl0X21lc3NhZ2VcIixzLk1hbnVhbGx5RW1pdFRvb2xDYWxsPVwibWFudWFsbHlfZW1pdF90b29sX2NhbGxcIixzLk1hbnVhbGx5RW1pdFN0YXRlPVwibWFudWFsbHlfZW1pdF9zdGF0ZVwiLHMuRXhpdD1cImV4aXRcIixzKSkocHR8fHt9KTtpbXBvcnR7QWJzdHJhY3RBZ2VudCBhcyBFdCxFdmVudFR5cGUgYXMgaH1mcm9tXCJAYWctdWkvY2xpZW50XCI7dmFyIGo9W1wibWVzc2FnZXNcIixcInRvb2xzXCJdO2Z1bmN0aW9uIEYobixhKXtyZXR1cm4gT2JqZWN0LmZyb21FbnRyaWVzKE9iamVjdC5lbnRyaWVzKG4pLmZpbHRlcigoW3RdKT0+YS5pbmNsdWRlcyh0KSkpfWZ1bmN0aW9uIHN0KHttb2RlOm4sc3RhdGU6YSxzY2hlbWFLZXlzOnR9KXtsZXQgZT1uPT09XCJzdGFydFwiP2E6bnVsbDtyZXR1cm4gZSYmKHQhPW51bGwmJnQuaW5wdXQpJiYoZT1GKGUsWy4uLmosLi4udC5pbnB1dF0pKSxlfWZ1bmN0aW9uIGF0KG4pe3JldHVybiBuLm1hcChhPT57dmFyIHQ7c3dpdGNoKGEudHlwZSl7Y2FzZVwiaHVtYW5cIjpyZXR1cm57aWQ6YS5pZCxyb2xlOlwidXNlclwiLGNvbnRlbnQ6WChPKGEuY29udGVudCkpfTtjYXNlXCJhaVwiOmxldCBlPU8oYS5jb250ZW50KTtyZXR1cm57aWQ6YS5pZCxyb2xlOlwiYXNzaXN0YW50XCIsY29udGVudDplP1goZSk6XCJcIix0b29sQ2FsbHM6KHQ9YS50b29sX2NhbGxzKT09bnVsbD92b2lkIDA6dC5tYXAocz0+KHtpZDpzLmlkLHR5cGU6XCJmdW5jdGlvblwiLGZ1bmN0aW9uOntuYW1lOnMubmFtZSxhcmd1bWVudHM6SlNPTi5zdHJpbmdpZnkocy5hcmdzKX19KSl9O2Nhc2VcInN5c3RlbVwiOnJldHVybntpZDphLmlkLHJvbGU6XCJzeXN0ZW1cIixjb250ZW50OlgoTyhhLmNvbnRlbnQpKX07Y2FzZVwidG9vbFwiOnJldHVybntpZDphLmlkLHJvbGU6XCJ0b29sXCIsY29udGVudDpYKE8oYS5jb250ZW50KSksdG9vbENhbGxJZDphLnRvb2xfY2FsbF9pZH07ZGVmYXVsdDp0aHJvdyBuZXcgRXJyb3IoXCJtZXNzYWdlIHR5cGUgcmV0dXJuZWQgZnJvbSBMYW5nR3JhcGggaXMgbm90IHN1cHBvcnRlZC5cIil9fSl9ZnVuY3Rpb24gJChuKXtyZXR1cm4gbi5tYXAoKGEsdCk9Pnt2YXIgZSxzO3N3aXRjaChhLnJvbGUpe2Nhc2VcInVzZXJcIjpyZXR1cm57aWQ6YS5pZCxyb2xlOmEucm9sZSxjb250ZW50OmEuY29udGVudCx0eXBlOlwiaHVtYW5cIn07Y2FzZVwiYXNzaXN0YW50XCI6cmV0dXJue2lkOmEuaWQsdHlwZTpcImFpXCIscm9sZTphLnJvbGUsY29udGVudDooZT1hLmNvbnRlbnQpIT1udWxsP2U6XCJcIix0b29sX2NhbGxzOigocz1hLnRvb2xDYWxscykhPW51bGw/czpbXSkubWFwKGk9Pih7aWQ6aS5pZCxuYW1lOmkuZnVuY3Rpb24ubmFtZSxhcmdzOkpTT04ucGFyc2UoaS5mdW5jdGlvbi5hcmd1bWVudHMpLHR5cGU6XCJ0b29sX2NhbGxcIn0pKX07Y2FzZVwic3lzdGVtXCI6cmV0dXJue2lkOmEuaWQscm9sZTphLnJvbGUsY29udGVudDphLmNvbnRlbnQsdHlwZTpcInN5c3RlbVwifTtjYXNlXCJ0b29sXCI6cmV0dXJue2NvbnRlbnQ6YS5jb250ZW50LHJvbGU6YS5yb2xlLHR5cGU6YS5yb2xlLHRvb2xfY2FsbF9pZDphLnRvb2xDYWxsSWQsaWQ6YS5pZH07ZGVmYXVsdDp0aHJvdyBjb25zb2xlLmVycm9yKGBNZXNzYWdlIHJvbGUgJHthLnJvbGV9IGlzIG5vdCBpbXBsZW1lbnRlZGApLG5ldyBFcnJvcihcIm1lc3NhZ2Ugcm9sZSBpcyBub3Qgc3VwcG9ydGVkLlwiKX19KX1mdW5jdGlvbiBYKG4pe3JldHVybiB0eXBlb2Ygbj09XCJzdHJpbmdcIj9uOkpTT04uc3RyaW5naWZ5KG4pfWZ1bmN0aW9uIG50KG4pe3ZhciB0LGUscyxpLGw7bGV0IGE9KHQ9bi5jaHVuayk9PW51bGw/dm9pZCAwOnQuY29udGVudDtpZihhJiZBcnJheS5pc0FycmF5KGEpJiZhLmxlbmd0aCYmYVswXSlyZXR1cm4gYVswXS50aGlua2luZz97dGV4dDphWzBdLnRoaW5raW5nLHR5cGU6XCJ0ZXh0XCIsaW5kZXg6YVswXS5pbmRleH06bnVsbDtpZigoaT0ocz0oZT1uLmNodW5rLmFkZGl0aW9uYWxfa3dhcmdzKT09bnVsbD92b2lkIDA6ZS5yZWFzb25pbmcpPT1udWxsP3ZvaWQgMDpzLnN1bW1hcnkpIT1udWxsJiZpWzBdKXtsZXQgbz0obD1uLmNodW5rLmFkZGl0aW9uYWxfa3dhcmdzKT09bnVsbD92b2lkIDA6bC5yZWFzb25pbmcuc3VtbWFyeVswXTtyZXR1cm4hb3x8IW8udGV4dD9udWxsOnt0eXBlOlwidGV4dFwiLHRleHQ6by50ZXh0LGluZGV4Om8uaW5kZXh9fXJldHVybiBudWxsfWZ1bmN0aW9uIE8obil7dmFyIGE7aWYoIW4pcmV0dXJuIG51bGw7aWYodHlwZW9mIG49PVwic3RyaW5nXCIpcmV0dXJuIG47aWYoQXJyYXkuaXNBcnJheShuKSYmbi5sZW5ndGgpe2xldCB0PShhPW4uZmluZChlPT5lLnR5cGU9PT1cInRleHRcIikpPT1udWxsP3ZvaWQgMDphLnRleHQ7cmV0dXJuIHQhPW51bGw/dDpudWxsfXJldHVybiBudWxsfXZhciBydD1jbGFzcyBuIGV4dGVuZHMgRXR7Y29uc3RydWN0b3IodCl7dmFyIGUscztzdXBlcih0KTt0aGlzLmNvbnN0YW50U2NoZW1hS2V5cz1qO3RoaXMuY29uZmlnPXQsdGhpcy5tZXNzYWdlc0luUHJvY2Vzcz17fSx0aGlzLmFnZW50TmFtZT10LmFnZW50TmFtZSx0aGlzLmdyYXBoSWQ9dC5ncmFwaElkLHRoaXMuYXNzaXN0YW50Q29uZmlnPXQuYXNzaXN0YW50Q29uZmlnLHRoaXMudGhpbmtpbmdQcm9jZXNzPW51bGwsdGhpcy5jbGllbnQ9KHM9dD09bnVsbD92b2lkIDA6dC5jbGllbnQpIT1udWxsP3M6bmV3IFN0KHthcGlVcmw6dC5kZXBsb3ltZW50VXJsLGFwaUtleTp0LmxhbmdzbWl0aEFwaUtleSxkZWZhdWx0SGVhZGVyczpwKHt9LChlPXQucHJvcGVydHlIZWFkZXJzKSE9bnVsbD9lOnt9KX0pfWNsb25lKCl7cmV0dXJuIG5ldyBuKHRoaXMuY29uZmlnKX1kaXNwYXRjaEV2ZW50KHQpe3JldHVybiB0aGlzLnN1YnNjcmliZXIubmV4dCh0KSwhMH1ydW4odCl7cmV0dXJuIG5ldyBtdChlPT4odGhpcy5ydW5BZ2VudFN0cmVhbSh0LGUpLCgpPT57fSkpfWFzeW5jIHJ1bkFnZW50U3RyZWFtKHQsZSl7dmFyIG8sZyxkO3RoaXMuYWN0aXZlUnVuPXtpZDp0LnJ1bklkLHRocmVhZElkOnQudGhyZWFkSWR9LHRoaXMuc3Vic2NyaWJlcj1lLHRoaXMuYXNzaXN0YW50fHwodGhpcy5hc3Npc3RhbnQ9YXdhaXQgdGhpcy5nZXRBc3Npc3RhbnQoKSk7bGV0IHM9KG89dC50aHJlYWRJZCkhPW51bGw/bzppdCgpLGk9KGQ9KGc9dC5mb3J3YXJkZWRQcm9wcyk9PW51bGw/dm9pZCAwOmcuc3RyZWFtTW9kZSkhPW51bGw/ZDpbXCJldmVudHNcIixcInZhbHVlc1wiLFwidXBkYXRlc1wiXSxsPWF3YWl0IHRoaXMucHJlcGFyZVN0cmVhbShmKHAoe30sdCkse3RocmVhZElkOnN9KSxpKTtpZighbClyZXR1cm4gZS5lcnJvcihcIk5vIHN0cmVhbSB0byByZWdlbmVyYXRlXCIpO2F3YWl0IHRoaXMuaGFuZGxlU3RyZWFtRXZlbnRzKGwscyxlLHQsaSl9YXN5bmMgcHJlcGFyZVJlZ2VuZXJhdGVTdHJlYW0odCxlKXt2YXIgYyxyLFM7bGV0e3RocmVhZElkOnMsbWVzc2FnZUNoZWNrcG9pbnQ6aSx0b29sczpsfT10LG89YXdhaXQgdGhpcy5nZXRDaGVja3BvaW50QnlNZXNzYWdlKGkuaWQscyk7aWYodGhpcy5hc3Npc3RhbnR8fCh0aGlzLmFzc2lzdGFudD1hd2FpdCB0aGlzLmdldEFzc2lzdGFudCgpKSwhbylyZXR1cm4gdGhpcy5zdWJzY3JpYmVyLmVycm9yKFwiTm8gY2hlY2twb2ludCBmb3VuZCBmb3IgbWVzc2FnZVwiKTtsZXQgZz1hd2FpdCB0aGlzLmNsaWVudC50aHJlYWRzLnVwZGF0ZVN0YXRlKHMse3ZhbHVlczp0aGlzLmxhbmdHcmFwaERlZmF1bHRNZXJnZVN0YXRlKG8udmFsdWVzLFtdLGwpLGNoZWNrcG9pbnRJZDpvLmNoZWNrcG9pbnQuY2hlY2twb2ludF9pZCxhc05vZGU6KHI9KGM9by5uZXh0KT09bnVsbD92b2lkIDA6Y1swXSkhPW51bGw/cjpcIl9fc3RhcnRfX1wifSksZD1mKHAoe30sKFM9dC5mb3J3YXJkZWRQcm9wcykhPW51bGw/Uzp7fSkse2lucHV0OnRoaXMubGFuZ0dyYXBoRGVmYXVsdE1lcmdlU3RhdGUoby52YWx1ZXMsW2ldLGwpLGNoZWNrcG9pbnRJZDpnLmNoZWNrcG9pbnQuY2hlY2twb2ludF9pZCxzdHJlYW1Nb2RlOmV9KTtyZXR1cm57c3RyZWFtUmVzcG9uc2U6dGhpcy5jbGllbnQucnVucy5zdHJlYW0ocyx0aGlzLmFzc2lzdGFudC5hc3Npc3RhbnRfaWQsZCksc3RhdGU6byxzdHJlYW1Nb2RlOmV9fWFzeW5jIHByZXBhcmVTdHJlYW0odCxlKXt2YXIgdyxiLEcsTCxDLGssVSxCO2xldHt0aHJlYWRJZDpzLHN0YXRlOmksbWVzc2FnZXM6bCx0b29sczpvLGNvbnRleHQ6Zyxmb3J3YXJkZWRQcm9wczpkfT10O3RoaXMuYWN0aXZlUnVuLm1hbnVhbGx5RW1pdHRlZFN0YXRlPW51bGw7bGV0IGM9ZD09bnVsbD92b2lkIDA6ZC5ub2RlTmFtZTt0aGlzLmFjdGl2ZVJ1bi5ub2RlTmFtZT1jLHRoaXMuYWN0aXZlUnVuLm5vZGVOYW1lPT09XCJfX2VuZF9fXCImJih0aGlzLmFjdGl2ZVJ1bi5ub2RlTmFtZT12b2lkIDApO2xldCByPXMhPW51bGw/czppdCgpO3RoaXMuYXNzaXN0YW50fHwodGhpcy5hc3Npc3RhbnQ9YXdhaXQgdGhpcy5nZXRBc3Npc3RhbnQoKSk7bGV0IFM9YXdhaXQgdGhpcy5nZXRPckNyZWF0ZVRocmVhZChyLGQ9PW51bGw/dm9pZCAwOmQudGhyZWFkTWV0YWRhdGEpO3RoaXMuYWN0aXZlUnVuLnRocmVhZElkPVMudGhyZWFkX2lkO2xldCB1PSh3PWF3YWl0IHRoaXMuY2xpZW50LnRocmVhZHMuZ2V0U3RhdGUoUy50aHJlYWRfaWQpKSE9bnVsbD93Ont2YWx1ZXM6e319LFQ9KGI9dS52YWx1ZXMubWVzc2FnZXMpIT1udWxsP2I6W10sTT0kKGwpLHk9dGhpcy5sYW5nR3JhcGhEZWZhdWx0TWVyZ2VTdGF0ZShmKHAoe30saSkse21lc3NhZ2VzOlR9KSxNLG8pLF89ZihwKHt9LHUpLHt2YWx1ZXM6ZihwKHt9LHkpLHttZXNzYWdlczpbLi4uVCwuLi55Lm1lc3NhZ2VzXX0pfSksdj1fLnZhbHVlcztpZih0aGlzLmFjdGl2ZVJ1bi5zY2hlbWFLZXlzPWF3YWl0IHRoaXMuZ2V0U2NoZW1hS2V5cygpLCgoRz11LnZhbHVlcy5tZXNzYWdlcykhPW51bGw/RzpbXSkubGVuZ3RoPmwuZmlsdGVyKEU9PkUucm9sZSE9PVwic3lzdGVtXCIpLmxlbmd0aCl7bGV0IEU9bnVsbDtmb3IobGV0IG09bC5sZW5ndGgtMTttPj0wO20tLSlpZihsW21dLnJvbGU9PT1cInVzZXJcIil7RT0kKFtsW21dXSlbMF07YnJlYWt9cmV0dXJuIEU/dGhpcy5wcmVwYXJlUmVnZW5lcmF0ZVN0cmVhbShmKHAoe30sdCkse21lc3NhZ2VDaGVja3BvaW50OkV9KSxlKTp0aGlzLnN1YnNjcmliZXIuZXJyb3IoXCJObyB1c2VyIG1lc3NhZ2UgZm91bmQgaW4gbWVzc2FnZXMgdG8gcmVnZW5lcmF0ZVwiKX10aGlzLmFjdGl2ZVJ1bi5ncmFwaEluZm89YXdhaXQgdGhpcy5jbGllbnQuYXNzaXN0YW50cy5nZXRHcmFwaCh0aGlzLmFzc2lzdGFudC5hc3Npc3RhbnRfaWQpO2xldCBSPSEoKEw9ZD09bnVsbD92b2lkIDA6ZC5jb21tYW5kKSE9bnVsbCYmTC5yZXN1bWUpJiZyJiZ0aGlzLmFjdGl2ZVJ1bi5ub2RlTmFtZSE9XCJfX2VuZF9fXCImJnRoaXMuYWN0aXZlUnVuLm5vZGVOYW1lP1wiY29udGludWVcIjpcInN0YXJ0XCI7aWYoUj09PVwiY29udGludWVcIil7bGV0IEU9dGhpcy5hY3RpdmVSdW4uZ3JhcGhJbmZvLmVkZ2VzLmZpbmQobT0+bS50YXJnZXQ9PT10aGlzLmFjdGl2ZVJ1bi5ub2RlTmFtZSk7YXdhaXQgdGhpcy5jbGllbnQudGhyZWFkcy51cGRhdGVTdGF0ZShyLHt2YWx1ZXM6aSxhc05vZGU6RT09bnVsbD92b2lkIDA6RS5zb3VyY2V9KX1sZXQgTj1zdCh7bW9kZTpSLHN0YXRlOnYsc2NoZW1hS2V5czp0aGlzLmFjdGl2ZVJ1bi5zY2hlbWFLZXlzfSksQSxJPVt0aGlzLmFzc2lzdGFudENvbmZpZyxkPT1udWxsP3ZvaWQgMDpkLmNvbmZpZ10uZmlsdGVyKEJvb2xlYW4pO0kubGVuZ3RoJiYoQT1hd2FpdCB0aGlzLm1lcmdlQ29uZmlncyh7Y29uZmlnczpJLGFzc2lzdGFudDp0aGlzLmFzc2lzdGFudCxzY2hlbWFLZXlzOnRoaXMuYWN0aXZlUnVuLnNjaGVtYUtleXN9KSk7bGV0IEg9ZihwKHt9LGQpLHtzdHJlYW1Nb2RlOmUsaW5wdXQ6Tixjb25maWc6QX0pLHg9KFU9KGs9KEM9dS50YXNrcyk9PW51bGw/dm9pZCAwOkNbMF0pPT1udWxsP3ZvaWQgMDprLmludGVycnVwdHMpIT1udWxsP1U6W107cmV0dXJuIHghPW51bGwmJngubGVuZ3RoJiYhKChCPWQ9PW51bGw/dm9pZCAwOmQuY29tbWFuZCkhPW51bGwmJkIucmVzdW1lKT8odGhpcy5kaXNwYXRjaEV2ZW50KHt0eXBlOmguUlVOX1NUQVJURUQsdGhyZWFkSWQ6cixydW5JZDp0LnJ1bklkfSkseC5mb3JFYWNoKEU9Pnt0aGlzLmRpc3BhdGNoRXZlbnQoe3R5cGU6aC5DVVNUT00sbmFtZTpcIm9uX2ludGVycnVwdFwiLHZhbHVlOnR5cGVvZiBFLnZhbHVlPT1cInN0cmluZ1wiP0UudmFsdWU6SlNPTi5zdHJpbmdpZnkoRS52YWx1ZSkscmF3RXZlbnQ6RX0pfSksdGhpcy5kaXNwYXRjaEV2ZW50KHt0eXBlOmguUlVOX0ZJTklTSEVELHRocmVhZElkOnIscnVuSWQ6dC5ydW5JZH0pLHRoaXMuc3Vic2NyaWJlci5jb21wbGV0ZSgpKTp7c3RyZWFtUmVzcG9uc2U6dGhpcy5jbGllbnQucnVucy5zdHJlYW0ocix0aGlzLmFzc2lzdGFudC5hc3Npc3RhbnRfaWQsSCksc3RhdGU6X319YXN5bmMgaGFuZGxlU3RyZWFtRXZlbnRzKHQsZSxzLGksbCl7dmFyIFQsTSx5LF8sdixILHgsdyxiLEcsTDtsZXR7Zm9yd2FyZGVkUHJvcHM6b309aSxnPW89PW51bGw/dm9pZCAwOm8ubm9kZU5hbWU7dGhpcy5zdWJzY3JpYmVyPXM7bGV0IGQ9ITE7aWYoIXQpcmV0dXJuO2xldHtzdHJlYW1SZXNwb25zZTpjLHN0YXRlOnJ9PXQ7dGhpcy5hY3RpdmVSdW4ucHJldk5vZGVOYW1lPW51bGw7bGV0IFM9e30sdT1yO3RyeXt0aGlzLmRpc3BhdGNoRXZlbnQoe3R5cGU6aC5SVU5fU1RBUlRFRCx0aHJlYWRJZDplLHJ1bklkOnRoaXMuYWN0aXZlUnVuLmlkfSksKFQ9bz09bnVsbD92b2lkIDA6by5jb21tYW5kKSE9bnVsbCYmVC5yZXN1bWUmJnRoaXMuYWN0aXZlUnVuLm5vZGVOYW1lJiZ0aGlzLnN0YXJ0U3RlcCh0aGlzLmFjdGl2ZVJ1bi5ub2RlTmFtZSk7dHJ5e2Zvcih2YXIgUj1ldChjKSxOLEEsSTtOPSEoQT1hd2FpdCBSLm5leHQoKSkuZG9uZTtOPSExKXtsZXQgbT1BLnZhbHVlO2xldCBXPShNPWkuZm9yd2FyZGVkUHJvcHMpPT1udWxsP3ZvaWQgMDpNLnN0cmVhbVN1YmdyYXBocyxsdD1XJiYobS5ldmVudC5zdGFydHNXaXRoKFwiZXZlbnRzXCIpfHxtLmV2ZW50LnN0YXJ0c1dpdGgoXCJ2YWx1ZXNcIikpO2lmKCFsLmluY2x1ZGVzKG0uZXZlbnQpJiYhbHQpY29udGludWU7bGV0IEQ9bTtpZihtLmV2ZW50PT09XCJlcnJvclwiKXt0aGlzLmRpc3BhdGNoRXZlbnQoe3R5cGU6aC5SVU5fRVJST1IsbWVzc2FnZTptLmRhdGEubWVzc2FnZSxyYXdFdmVudDptfSk7YnJlYWt9aWYobS5ldmVudD09PVwidXBkYXRlc1wiKWNvbnRpbnVlO2lmKG0uZXZlbnQ9PT1cInZhbHVlc1wiKXtTPUQuZGF0YTtjb250aW51ZX1lbHNlIGlmKFcmJkQuZXZlbnQuc3RhcnRzV2l0aChcInZhbHVlc3xcIikpe1M9cChwKHt9LFMpLEQuZGF0YSk7Y29udGludWV9bGV0IEs9RC5kYXRhLFY9KHk9Sy5tZXRhZGF0YSkhPW51bGw/eTp7fSxQPVYubGFuZ2dyYXBoX25vZGUsWT1LLmV2ZW50O2lmKHRoaXMuYWN0aXZlUnVuLmlkPVYucnVuX2lkLFAmJlAhPT10aGlzLmFjdGl2ZVJ1bi5ub2RlTmFtZSYmKHRoaXMuYWN0aXZlUnVuLm5vZGVOYW1lJiZ0aGlzLmFjdGl2ZVJ1bi5ub2RlTmFtZSE9PWcmJnRoaXMuZW5kU3RlcCgpLHRoaXMuc3RhcnRTdGVwKFApKSxkPWR8fFk9PT1cIm9uX2N1c3RvbV9ldmVudFwiJiZLLm5hbWU9PT1cImV4aXRcIix0aGlzLmFjdGl2ZVJ1bi5leGl0aW5nTm9kZT10aGlzLmFjdGl2ZVJ1bi5ub2RlTmFtZT09PVAmJlk9PT1cIm9uX2NoYWluX2VuZFwiLHRoaXMuYWN0aXZlUnVuLmV4aXRpbmdOb2RlJiYodGhpcy5hY3RpdmVSdW4ubWFudWFsbHlFbWl0dGVkU3RhdGU9bnVsbCksKF89dGhpcy5hY3RpdmVSdW4uZ3JhcGhJbmZvKSE9bnVsbCYmXy5ub2Rlcy5zb21lKGh0PT5odC5pZD09PVApJiYodGhpcy5hY3RpdmVSdW4ubm9kZU5hbWU9UCksdS52YWx1ZXM9KHY9dGhpcy5hY3RpdmVSdW4ubWFudWFsbHlFbWl0dGVkU3RhdGUpIT1udWxsP3Y6UywhdGhpcy5hY3RpdmVSdW4ubm9kZU5hbWUpY29udGludWU7KEpTT04uc3RyaW5naWZ5KHUpIT09SlNPTi5zdHJpbmdpZnkocil8fHRoaXMuYWN0aXZlUnVuLnByZXZOb2RlTmFtZSE9dGhpcy5hY3RpdmVSdW4ubm9kZU5hbWV8fHRoaXMuYWN0aXZlUnVuLmV4aXRpbmdOb2RlKSYmIXRoaXMuZ2V0TWVzc2FnZUluUHJvZ3Jlc3ModGhpcy5hY3RpdmVSdW4uaWQpJiYocj11LHRoaXMuYWN0aXZlUnVuLnByZXZOb2RlTmFtZT10aGlzLmFjdGl2ZVJ1bi5ub2RlTmFtZSx0aGlzLmRpc3BhdGNoRXZlbnQoe3R5cGU6aC5TVEFURV9TTkFQU0hPVCxzbmFwc2hvdDp0aGlzLmdldFN0YXRlU25hcHNob3QocikscmF3RXZlbnQ6RH0pKSx0aGlzLmRpc3BhdGNoRXZlbnQoe3R5cGU6aC5SQVcsZXZlbnQ6S30pLHRoaXMuaGFuZGxlU2luZ2xlRXZlbnQoSyl9fWNhdGNoKEEpe0k9W0FdfWZpbmFsbHl7dHJ5e04mJihBPVIucmV0dXJuKSYmYXdhaXQgQS5jYWxsKFIpfWZpbmFsbHl7aWYoSSl0aHJvdyBJWzBdfX1yPWF3YWl0IHRoaXMuY2xpZW50LnRocmVhZHMuZ2V0U3RhdGUoZSk7bGV0IEM9ci50YXNrcyxrPSh4PShIPUM9PW51bGw/dm9pZCAwOkNbMF0pPT1udWxsP3ZvaWQgMDpILmludGVycnVwdHMpIT1udWxsP3g6W10sVT1yLm5leHQubGVuZ3RoPT09MCxCPShiPSh3PXIubWV0YWRhdGEpPT1udWxsP3ZvaWQgMDp3LndyaXRlcykhPW51bGw/Yjp7fSxFPXRoaXMuYWN0aXZlUnVuLm5vZGVOYW1lO3JldHVybiBrIT1udWxsJiZrLmxlbmd0aHx8KEU9VT9cIl9fZW5kX19cIjooRz1yLm5leHRbMF0pIT1udWxsP0c6T2JqZWN0LmtleXMoQilbMF0pLGsuZm9yRWFjaChtPT57dGhpcy5kaXNwYXRjaEV2ZW50KHt0eXBlOmguQ1VTVE9NLG5hbWU6XCJvbl9pbnRlcnJ1cHRcIix2YWx1ZTp0eXBlb2YgbS52YWx1ZT09XCJzdHJpbmdcIj9tLnZhbHVlOkpTT04uc3RyaW5naWZ5KG0udmFsdWUpLHJhd0V2ZW50Om19KX0pLHRoaXMuYWN0aXZlUnVuLm5vZGVOYW1lIT1FJiYodGhpcy5lbmRTdGVwKCksdGhpcy5zdGFydFN0ZXAoRSkpLHRoaXMuZW5kU3RlcCgpLHRoaXMuZGlzcGF0Y2hFdmVudCh7dHlwZTpoLlNUQVRFX1NOQVBTSE9ULHNuYXBzaG90OnRoaXMuZ2V0U3RhdGVTbmFwc2hvdChyKX0pLHRoaXMuZGlzcGF0Y2hFdmVudCh7dHlwZTpoLk1FU1NBR0VTX1NOQVBTSE9ULG1lc3NhZ2VzOmF0KChMPXIudmFsdWVzLm1lc3NhZ2VzKSE9bnVsbD9MOltdKX0pLHRoaXMuZGlzcGF0Y2hFdmVudCh7dHlwZTpoLlJVTl9GSU5JU0hFRCx0aHJlYWRJZDplLHJ1bklkOnRoaXMuYWN0aXZlUnVuLmlkfSksdGhpcy5hY3RpdmVSdW49dm9pZCAwLHMuY29tcGxldGUoKX1jYXRjaChDKXtyZXR1cm4gcy5lcnJvcihDKX19aGFuZGxlU2luZ2xlRXZlbnQodCl7dmFyIGUscyxpLGwsbyxnO3N3aXRjaCh0LmV2ZW50KXtjYXNlXCJvbl9jaGF0X21vZGVsX3N0cmVhbVwiOmxldCBkPShlPXQubWV0YWRhdGFbXCJlbWl0LW1lc3NhZ2VzXCJdKSE9bnVsbD9lOiEwLGM9KHM9dC5tZXRhZGF0YVtcImVtaXQtdG9vbC1jYWxsc1wiXSkhPW51bGw/czohMDtpZih0LmRhdGEuY2h1bmsucmVzcG9uc2VfbWV0YWRhdGEuZmluaXNoX3JlYXNvbilyZXR1cm47bGV0IHI9dGhpcy5nZXRNZXNzYWdlSW5Qcm9ncmVzcyh0aGlzLmFjdGl2ZVJ1bi5pZCksUz0hIShyIT1udWxsJiZyLmlkKSx1PShpPXQuZGF0YS5jaHVuay50b29sX2NhbGxfY2h1bmtzKT09bnVsbD92b2lkIDA6aVswXSxUPShsPXQubWV0YWRhdGEucHJlZGljdF9zdGF0ZSk9PW51bGw/dm9pZCAwOmwuc29tZShJPT5JLnRvb2w9PT0odT09bnVsbD92b2lkIDA6dS5uYW1lKSksTT0hUyYmKHU9PW51bGw/dm9pZCAwOnUubmFtZSkseT1TJiYocj09bnVsbD92b2lkIDA6ci50b29sQ2FsbElkKSYmKHU9PW51bGw/dm9pZCAwOnUuYXJncyksXz1TJiYocj09bnVsbD92b2lkIDA6ci50b29sQ2FsbElkKSYmIXUsdj1udCh0LmRhdGEpLFI9Tyh0LmRhdGEuY2h1bmsuY29udGVudCksTj0hISghdSYmUiksQT1TJiYhKHIhPW51bGwmJnIudG9vbENhbGxJZCkmJiFOO2lmKHYpe3RoaXMuaGFuZGxlVGhpbmtpbmdFdmVudCh2KTticmVha31pZighdiYmdGhpcy50aGlua2luZ1Byb2Nlc3MmJih0aGlzLmRpc3BhdGNoRXZlbnQoe3R5cGU6aC5USElOS0lOR19URVhUX01FU1NBR0VfRU5EfSksdGhpcy5kaXNwYXRjaEV2ZW50KHt0eXBlOmguVEhJTktJTkdfRU5EfSksdGhpcy50aGlua2luZ1Byb2Nlc3M9bnVsbCksVCYmdGhpcy5kaXNwYXRjaEV2ZW50KHt0eXBlOmguQ1VTVE9NLG5hbWU6XCJQcmVkaWN0U3RhdGVcIix2YWx1ZTp0Lm1ldGFkYXRhLnByZWRpY3Rfc3RhdGV9KSxfKXt0aGlzLmRpc3BhdGNoRXZlbnQoe3R5cGU6aC5UT09MX0NBTExfRU5ELHRvb2xDYWxsSWQ6cj09bnVsbD92b2lkIDA6ci50b29sQ2FsbElkLHJhd0V2ZW50OnR9KSYmKHRoaXMubWVzc2FnZXNJblByb2Nlc3NbdGhpcy5hY3RpdmVSdW4uaWRdPW51bGwpO2JyZWFrfWlmKEEpe3RoaXMuZGlzcGF0Y2hFdmVudCh7dHlwZTpoLlRFWFRfTUVTU0FHRV9FTkQsbWVzc2FnZUlkOnIuaWQscmF3RXZlbnQ6dH0pJiYodGhpcy5tZXNzYWdlc0luUHJvY2Vzc1t0aGlzLmFjdGl2ZVJ1bi5pZF09bnVsbCk7YnJlYWt9aWYoTSYmYyl7dGhpcy5kaXNwYXRjaEV2ZW50KHt0eXBlOmguVE9PTF9DQUxMX1NUQVJULHRvb2xDYWxsSWQ6dS5pZCx0b29sQ2FsbE5hbWU6dS5uYW1lLHBhcmVudE1lc3NhZ2VJZDp0LmRhdGEuY2h1bmsuaWQscmF3RXZlbnQ6dH0pJiZ0aGlzLnNldE1lc3NhZ2VJblByb2dyZXNzKHRoaXMuYWN0aXZlUnVuLmlkLHtpZDp0LmRhdGEuY2h1bmsuaWQsdG9vbENhbGxJZDp1LmlkLHRvb2xDYWxsTmFtZTp1Lm5hbWV9KTticmVha31pZih5JiZjKXt0aGlzLmRpc3BhdGNoRXZlbnQoe3R5cGU6aC5UT09MX0NBTExfQVJHUyx0b29sQ2FsbElkOnI9PW51bGw/dm9pZCAwOnIudG9vbENhbGxJZCxkZWx0YTp1LmFyZ3MscmF3RXZlbnQ6dH0pO2JyZWFrfWlmKE4mJmQpe3J8fCh0aGlzLmRpc3BhdGNoRXZlbnQoe3R5cGU6aC5URVhUX01FU1NBR0VfU1RBUlQscm9sZTpcImFzc2lzdGFudFwiLG1lc3NhZ2VJZDp0LmRhdGEuY2h1bmsuaWQscmF3RXZlbnQ6dH0pLHRoaXMuc2V0TWVzc2FnZUluUHJvZ3Jlc3ModGhpcy5hY3RpdmVSdW4uaWQse2lkOnQuZGF0YS5jaHVuay5pZCx0b29sQ2FsbElkOm51bGwsdG9vbENhbGxOYW1lOm51bGx9KSxyPXRoaXMuZ2V0TWVzc2FnZUluUHJvZ3Jlc3ModGhpcy5hY3RpdmVSdW4uaWQpKSx0aGlzLmRpc3BhdGNoRXZlbnQoe3R5cGU6aC5URVhUX01FU1NBR0VfQ09OVEVOVCxtZXNzYWdlSWQ6ci5pZCxkZWx0YTpSLHJhd0V2ZW50OnR9KTticmVha31icmVhaztjYXNlXCJvbl9jaGF0X21vZGVsX2VuZFwiOmlmKChvPXRoaXMuZ2V0TWVzc2FnZUluUHJvZ3Jlc3ModGhpcy5hY3RpdmVSdW4uaWQpKSE9bnVsbCYmby50b29sQ2FsbElkKXt0aGlzLmRpc3BhdGNoRXZlbnQoe3R5cGU6aC5UT09MX0NBTExfRU5ELHRvb2xDYWxsSWQ6dGhpcy5nZXRNZXNzYWdlSW5Qcm9ncmVzcyh0aGlzLmFjdGl2ZVJ1bi5pZCkudG9vbENhbGxJZCxyYXdFdmVudDp0fSkmJih0aGlzLm1lc3NhZ2VzSW5Qcm9jZXNzW3RoaXMuYWN0aXZlUnVuLmlkXT1udWxsKTticmVha31pZigoZz10aGlzLmdldE1lc3NhZ2VJblByb2dyZXNzKHRoaXMuYWN0aXZlUnVuLmlkKSkhPW51bGwmJmcuaWQpe3RoaXMuZGlzcGF0Y2hFdmVudCh7dHlwZTpoLlRFWFRfTUVTU0FHRV9FTkQsbWVzc2FnZUlkOnRoaXMuZ2V0TWVzc2FnZUluUHJvZ3Jlc3ModGhpcy5hY3RpdmVSdW4uaWQpLmlkLHJhd0V2ZW50OnR9KSYmKHRoaXMubWVzc2FnZXNJblByb2Nlc3NbdGhpcy5hY3RpdmVSdW4uaWRdPW51bGwpO2JyZWFrfWJyZWFrO2Nhc2VcIm9uX2N1c3RvbV9ldmVudFwiOmlmKHQubmFtZT09PVwibWFudWFsbHlfZW1pdF9tZXNzYWdlXCIpe3RoaXMuZGlzcGF0Y2hFdmVudCh7dHlwZTpoLlRFWFRfTUVTU0FHRV9TVEFSVCxyb2xlOlwiYXNzaXN0YW50XCIsbWVzc2FnZUlkOnQuZGF0YS5tZXNzYWdlX2lkLHJhd0V2ZW50OnR9KSx0aGlzLmRpc3BhdGNoRXZlbnQoe3R5cGU6aC5URVhUX01FU1NBR0VfQ09OVEVOVCxtZXNzYWdlSWQ6dC5kYXRhLm1lc3NhZ2VfaWQsZGVsdGE6dC5kYXRhLm1lc3NhZ2UscmF3RXZlbnQ6dH0pLHRoaXMuZGlzcGF0Y2hFdmVudCh7dHlwZTpoLlRFWFRfTUVTU0FHRV9FTkQsbWVzc2FnZUlkOnQuZGF0YS5tZXNzYWdlX2lkLHJhd0V2ZW50OnR9KTticmVha31pZih0Lm5hbWU9PT1cIm1hbnVhbGx5X2VtaXRfdG9vbF9jYWxsXCIpe3RoaXMuZGlzcGF0Y2hFdmVudCh7dHlwZTpoLlRPT0xfQ0FMTF9TVEFSVCx0b29sQ2FsbElkOnQuZGF0YS5pZCx0b29sQ2FsbE5hbWU6dC5kYXRhLm5hbWUscGFyZW50TWVzc2FnZUlkOnQuZGF0YS5pZCxyYXdFdmVudDp0fSksdGhpcy5kaXNwYXRjaEV2ZW50KHt0eXBlOmguVE9PTF9DQUxMX0FSR1MsdG9vbENhbGxJZDp0LmRhdGEuaWQsZGVsdGE6dC5kYXRhLmFyZ3MscmF3RXZlbnQ6dH0pLHRoaXMuZGlzcGF0Y2hFdmVudCh7dHlwZTpoLlRPT0xfQ0FMTF9FTkQsdG9vbENhbGxJZDp0LmRhdGEuaWQscmF3RXZlbnQ6dH0pO2JyZWFrfXQubmFtZT09PVwibWFudWFsbHlfZW1pdF9zdGF0ZVwiJiYodGhpcy5hY3RpdmVSdW4ubWFudWFsbHlFbWl0dGVkU3RhdGU9dC5kYXRhLHRoaXMuZGlzcGF0Y2hFdmVudCh7dHlwZTpoLlNUQVRFX1NOQVBTSE9ULHNuYXBzaG90OnRoaXMuZ2V0U3RhdGVTbmFwc2hvdCh7dmFsdWVzOnRoaXMuYWN0aXZlUnVuLm1hbnVhbGx5RW1pdHRlZFN0YXRlfSkscmF3RXZlbnQ6dH0pKSx0aGlzLmRpc3BhdGNoRXZlbnQoe3R5cGU6aC5DVVNUT00sbmFtZTp0Lm5hbWUsdmFsdWU6dC5kYXRhLHJhd0V2ZW50OnR9KTticmVha319aGFuZGxlVGhpbmtpbmdFdmVudCh0KXt2YXIgcztpZighdHx8IXQudHlwZXx8IXQudGV4dClyZXR1cm47bGV0IGU9dC5pbmRleDsocz10aGlzLnRoaW5raW5nUHJvY2VzcykhPW51bGwmJnMuaW5kZXgmJnRoaXMudGhpbmtpbmdQcm9jZXNzLmluZGV4IT09ZSYmKHRoaXMudGhpbmtpbmdQcm9jZXNzLnR5cGUmJnRoaXMuZGlzcGF0Y2hFdmVudCh7dHlwZTpoLlRISU5LSU5HX1RFWFRfTUVTU0FHRV9FTkR9KSx0aGlzLmRpc3BhdGNoRXZlbnQoe3R5cGU6aC5USElOS0lOR19FTkR9KSx0aGlzLnRoaW5raW5nUHJvY2Vzcz1udWxsKSx0aGlzLnRoaW5raW5nUHJvY2Vzc3x8KHRoaXMuZGlzcGF0Y2hFdmVudCh7dHlwZTpoLlRISU5LSU5HX1NUQVJUfSksdGhpcy50aGlua2luZ1Byb2Nlc3M9e2luZGV4OmV9KSx0aGlzLnRoaW5raW5nUHJvY2Vzcy50eXBlIT09dC50eXBlJiYodGhpcy5kaXNwYXRjaEV2ZW50KHt0eXBlOmguVEhJTktJTkdfVEVYVF9NRVNTQUdFX1NUQVJUfSksdGhpcy50aGlua2luZ1Byb2Nlc3MudHlwZT10LnR5cGUpLHRoaXMudGhpbmtpbmdQcm9jZXNzLnR5cGUmJnRoaXMuZGlzcGF0Y2hFdmVudCh7dHlwZTpoLlRISU5LSU5HX1RFWFRfTUVTU0FHRV9DT05URU5ULGRlbHRhOnQudGV4dH0pfWdldFN0YXRlU25hcHNob3QodCl7bGV0IGU9dC52YWx1ZXMscz10aGlzLmFjdGl2ZVJ1bi5zY2hlbWFLZXlzO3JldHVybiBzIT1udWxsJiZzLm91dHB1dCYmKGU9RihlLFsuLi50aGlzLmNvbnN0YW50U2NoZW1hS2V5cywuLi5zLm91dHB1dF0pKSxlfWFzeW5jIGdldE9yQ3JlYXRlVGhyZWFkKHQsZSl7bGV0IHM7dHJ5e3RyeXtzPWF3YWl0IHRoaXMuZ2V0VGhyZWFkKHQpfWNhdGNoKGkpe3M9YXdhaXQgdGhpcy5jcmVhdGVUaHJlYWQoe3RocmVhZElkOnQsbWV0YWRhdGE6ZX0pfX1jYXRjaChpKXt0aHJvdyBuZXcgRXJyb3IoYEZhaWxlZCB0byBjcmVhdGUgdGhyZWFkOiAke2kubWVzc2FnZX1gKX1yZXR1cm4gc31hc3luYyBnZXRUaHJlYWQodCl7cmV0dXJuIHRoaXMuY2xpZW50LnRocmVhZHMuZ2V0KHQpfWFzeW5jIGNyZWF0ZVRocmVhZCh0KXtyZXR1cm4gdGhpcy5jbGllbnQudGhyZWFkcy5jcmVhdGUodCl9YXN5bmMgbWVyZ2VDb25maWdzKHtjb25maWdzOnQsYXNzaXN0YW50OmUsc2NoZW1hS2V5czpzfSl7cmV0dXJuIHQucmVkdWNlKChpLGwpPT57dmFyIFM7bGV0IG89aS5jb25maWd1cmFibGU7bC5jb25maWd1cmFibGUmJihvPXMhPW51bGwmJnMuY29uZmlnP0YobD09bnVsbD92b2lkIDA6bC5jb25maWd1cmFibGUsWy4uLnRoaXMuY29uc3RhbnRTY2hlbWFLZXlzLC4uLihTPXM9PW51bGw/dm9pZCAwOnMuY29uZmlnKSE9bnVsbD9TOltdXSk6bD09bnVsbD92b2lkIDA6bC5jb25maWd1cmFibGUpO2xldCBnPWYocChwKHt9LGkpLGwpLHtjb25maWd1cmFibGU6b30pLGQ9aS5yZWN1cnNpb25fbGltaXQ9PW51bGwmJmwucmVjdXJzaW9uX2xpbWl0PT09MjUsYz1KU09OLnN0cmluZ2lmeShnKSE9PUpTT04uc3RyaW5naWZ5KGkpLHI9ZCYmSlNPTi5zdHJpbmdpZnkoZihwKHt9LGcpLHtyZWN1cnNpb25fbGltaXQ6bnVsbH0pKT09PUpTT04uc3RyaW5naWZ5KGYocCh7fSxpKSx7cmVjdXJzaW9uX2xpbWl0Om51bGx9KSk7cmV0dXJuIGMmJiFyP3AocCh7fSxpKSxnKTppfSxlLmNvbmZpZyl9Z2V0TWVzc2FnZUluUHJvZ3Jlc3ModCl7cmV0dXJuIHRoaXMubWVzc2FnZXNJblByb2Nlc3NbdF19c2V0TWVzc2FnZUluUHJvZ3Jlc3ModCxlKXt0aGlzLm1lc3NhZ2VzSW5Qcm9jZXNzPWYocCh7fSx0aGlzLm1lc3NhZ2VzSW5Qcm9jZXNzKSx7W3RdOnAocCh7fSx0aGlzLm1lc3NhZ2VzSW5Qcm9jZXNzW3RdKSxlKX0pfWFzeW5jIGdldEFzc2lzdGFudCgpe2xldCB0PWF3YWl0IHRoaXMuY2xpZW50LmFzc2lzdGFudHMuc2VhcmNoKCksZT10LmZpbmQocz0+cy5ncmFwaF9pZD09PXRoaXMuZ3JhcGhJZCk7aWYoIWUpdGhyb3cgY29uc29sZS5lcnJvcihgXG4gICAgICBObyBhZ2VudCBmb3VuZCB3aXRoIGdyYXBoIElEICR7dGhpcy5ncmFwaElkfSBmb3VuZC4uXG5cbiAgICAgIFxuICAgICAgVGhlc2UgYXJlIHRoZSBhdmFpbGFibGUgYWdlbnRzOiBbJHt0Lm1hcChzPT5gJHtzLmdyYXBoX2lkfSAoSUQ6ICR7cy5hc3Npc3RhbnRfaWR9KWApLmpvaW4oXCIsIFwiKX1dXG4gICAgICBgKSxuZXcgRXJyb3IoXCJObyBhZ2VudCBpZCBmb3VuZFwiKTtyZXR1cm4gZX1hc3luYyBnZXRTY2hlbWFLZXlzKCl7dmFyIHQsZSxzO3RyeXtsZXQgaT1hd2FpdCB0aGlzLmNsaWVudC5hc3Npc3RhbnRzLmdldFNjaGVtYXModGhpcy5hc3Npc3RhbnQuYXNzaXN0YW50X2lkKSxsPW51bGw7aWYoKHQ9aS5jb25maWdfc2NoZW1hKSE9bnVsbCYmdC5wcm9wZXJ0aWVzJiYobD1PYmplY3Qua2V5cyhpLmNvbmZpZ19zY2hlbWEucHJvcGVydGllcykpLCEoKGU9aS5pbnB1dF9zY2hlbWEpIT1udWxsJiZlLnByb3BlcnRpZXMpfHwhKChzPWkub3V0cHV0X3NjaGVtYSkhPW51bGwmJnMucHJvcGVydGllcykpcmV0dXJue2NvbmZpZzpbXSxpbnB1dDpudWxsLG91dHB1dDpudWxsfTtsZXQgbz1PYmplY3Qua2V5cyhpLmlucHV0X3NjaGVtYS5wcm9wZXJ0aWVzKSxnPU9iamVjdC5rZXlzKGkub3V0cHV0X3NjaGVtYS5wcm9wZXJ0aWVzKTtyZXR1cm57aW5wdXQ6byYmby5sZW5ndGg/Wy4uLm8sLi4udGhpcy5jb25zdGFudFNjaGVtYUtleXNdOm51bGwsb3V0cHV0OmcmJmcubGVuZ3RoP1suLi5nLC4uLnRoaXMuY29uc3RhbnRTY2hlbWFLZXlzXTpudWxsLGNvbmZpZzpsfX1jYXRjaChpKXtyZXR1cm57Y29uZmlnOltdLGlucHV0OnRoaXMuY29uc3RhbnRTY2hlbWFLZXlzLG91dHB1dDp0aGlzLmNvbnN0YW50U2NoZW1hS2V5c319fWxhbmdHcmFwaERlZmF1bHRNZXJnZVN0YXRlKHQsZSxzKXt2YXIgZDtlLmxlbmd0aD4wJiZcInJvbGVcImluIGVbMF0mJmVbMF0ucm9sZT09PVwic3lzdGVtXCImJihlPWUuc2xpY2UoMSkpO2xldCBpPXQubWVzc2FnZXN8fFtdLGw9bmV3IFNldChpLm1hcChjPT5jLmlkKSksbz1lLmZpbHRlcihjPT4hbC5oYXMoYy5pZCkpLGc9Wy4uLihkPXQudG9vbHMpIT1udWxsP2Q6W10sLi4ucyE9bnVsbD9zOltdXS5tYXAoYz0+Yy50eXBlP2M6e3R5cGU6XCJmdW5jdGlvblwiLGZ1bmN0aW9uOntuYW1lOmMubmFtZSxkZXNjcmlwdGlvbjpjLmRlc2NyaXB0aW9uLHBhcmFtZXRlcnM6Yy5wYXJhbWV0ZXJzfX0pO3JldHVybiBmKHAoe30sdCkse21lc3NhZ2VzOm8sdG9vbHM6Z30pfXN0YXJ0U3RlcCh0KXt0aGlzLmFjdGl2ZVN0ZXAmJnRoaXMuZW5kU3RlcCgpLHRoaXMuZGlzcGF0Y2hFdmVudCh7dHlwZTpoLlNURVBfU1RBUlRFRCxzdGVwTmFtZTp0fSksdGhpcy5hY3RpdmVSdW4ubm9kZU5hbWU9dCx0aGlzLmFjdGl2ZVN0ZXA9dH1lbmRTdGVwKCl7dmFyIHQ7aWYoIXRoaXMuYWN0aXZlU3RlcCl0aHJvdyBuZXcgRXJyb3IoXCJObyBhY3RpdmUgc3RlcCB0byBlbmRcIik7dGhpcy5kaXNwYXRjaEV2ZW50KHt0eXBlOmguU1RFUF9GSU5JU0hFRCxzdGVwTmFtZToodD10aGlzLmFjdGl2ZVJ1bi5ub2RlTmFtZSkhPW51bGw/dDp0aGlzLmFjdGl2ZVN0ZXB9KSx0aGlzLmFjdGl2ZVJ1bi5ub2RlTmFtZT12b2lkIDAsdGhpcy5hY3RpdmVTdGVwPXZvaWQgMH1hc3luYyBnZXRDaGVja3BvaW50QnlNZXNzYWdlKHQsZSxzKXt2YXIgeSx2O2xldCBpPXMhPW51bGwmJnMuY2hlY2twb2ludF9pZD97Y2hlY2twb2ludDp7Y2hlY2twb2ludF9pZDpzLmNoZWNrcG9pbnRfaWR9fTp2b2lkIDAsbz1bLi4uYXdhaXQgdGhpcy5jbGllbnQudGhyZWFkcy5nZXRIaXN0b3J5KGUsaSldLnJldmVyc2UoKSxnPW8uZmluZChSPT57dmFyIE47cmV0dXJuKE49Ui52YWx1ZXMubWVzc2FnZXMpPT1udWxsP3ZvaWQgMDpOLnNvbWUoQT0+QS5pZD09PXQpfSk7aWYoIWcpdGhyb3cgbmV3IEVycm9yKFwiTWVzc2FnZSBub3QgZm91bmRcIik7bGV0IGQ9KHk9Zy52YWx1ZXMubWVzc2FnZXMpIT1udWxsP3k6W10sYz1kLmZpbmRJbmRleChSPT5SLmlkPT09dCk7aWYoZC5zbGljZShjKzEpLmxlbmd0aClyZXR1cm4gdGhpcy5nZXRDaGVja3BvaW50QnlNZXNzYWdlKHQsZSxnLnBhcmVudF9jaGVja3BvaW50KTtsZXQgUz1vLmluZGV4T2YoZyksXz1nLnZhbHVlcyx7bWVzc2FnZXM6dX09XyxUPXR0KF8sW1wibWVzc2FnZXNcIl0pLE09KHY9b1tTLTFdKSE9bnVsbD92OmYocCh7fSxnKSx7dmFsdWVzOnt9fSk7cmV0dXJuIGYocCh7fSxNKSx7dmFsdWVzOnAocCh7fSxNLnZhbHVlcyksVCl9KX19O3ZhciBvdD1jbGFzcyBleHRlbmRzIGZ0e307ZXhwb3J0e3B0IGFzIEN1c3RvbUV2ZW50TmFtZXMscnQgYXMgTGFuZ0dyYXBoQWdlbnQsdXQgYXMgTGFuZ0dyYXBoRXZlbnRUeXBlcyxvdCBhcyBMYW5nR3JhcGhIdHRwQWdlbnR9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXgubWpzLm1hcCJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@ag-ui/langgraph/dist/index.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/@ag-ui/langgraph/node_modules/@langchain/langgraph-sdk/dist/client.js":
/*!********************************************************************************************!*\
  !*** ./node_modules/@ag-ui/langgraph/node_modules/@langchain/langgraph-sdk/dist/client.js ***!
  \********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AssistantsClient: () => (/* binding */ AssistantsClient),\n/* harmony export */   Client: () => (/* binding */ Client),\n/* harmony export */   CronsClient: () => (/* binding */ CronsClient),\n/* harmony export */   RunsClient: () => (/* binding */ RunsClient),\n/* harmony export */   StoreClient: () => (/* binding */ StoreClient),\n/* harmony export */   ThreadsClient: () => (/* binding */ ThreadsClient),\n/* harmony export */   getApiKey: () => (/* binding */ getApiKey),\n/* harmony export */   getClientConfigHash: () => (/* binding */ getClientConfigHash)\n/* harmony export */ });\n/* harmony import */ var _utils_async_caller_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./utils/async_caller.js */ \"(rsc)/./node_modules/@ag-ui/langgraph/node_modules/@langchain/langgraph-sdk/dist/utils/async_caller.js\");\n/* harmony import */ var _utils_env_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./utils/env.js */ \"(rsc)/./node_modules/@ag-ui/langgraph/node_modules/@langchain/langgraph-sdk/dist/utils/env.js\");\n/* harmony import */ var _utils_signals_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./utils/signals.js */ \"(rsc)/./node_modules/@ag-ui/langgraph/node_modules/@langchain/langgraph-sdk/dist/utils/signals.js\");\n/* harmony import */ var _utils_sse_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./utils/sse.js */ \"(rsc)/./node_modules/@ag-ui/langgraph/node_modules/@langchain/langgraph-sdk/dist/utils/sse.js\");\n/* harmony import */ var _utils_stream_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./utils/stream.js */ \"(rsc)/./node_modules/@ag-ui/langgraph/node_modules/@langchain/langgraph-sdk/dist/utils/stream.js\");\n\n\n\n\n\nfunction* iterateHeaders(headers) {\n    let iter;\n    let shouldClear = false;\n    // eslint-disable-next-line no-instanceof/no-instanceof\n    if (headers instanceof Headers) {\n        const entries = [];\n        headers.forEach((value, name) => {\n            entries.push([name, value]);\n        });\n        iter = entries;\n    }\n    else if (Array.isArray(headers)) {\n        iter = headers;\n    }\n    else {\n        shouldClear = true;\n        iter = Object.entries(headers ?? {});\n    }\n    for (const item of iter) {\n        const name = item[0];\n        if (typeof name !== \"string\")\n            throw new TypeError(`Expected header name to be a string, got ${typeof name}`);\n        const values = Array.isArray(item[1]) ? item[1] : [item[1]];\n        let didClear = false;\n        for (const value of values) {\n            if (value === undefined)\n                continue;\n            // New object keys should always overwrite older headers\n            // Yield a null to clear the header in the headers object\n            // before adding the new value\n            if (shouldClear && !didClear) {\n                didClear = true;\n                yield [name, null];\n            }\n            yield [name, value];\n        }\n    }\n}\nfunction mergeHeaders(...headerObjects) {\n    const outputHeaders = new Headers();\n    for (const headers of headerObjects) {\n        if (!headers)\n            continue;\n        for (const [name, value] of iterateHeaders(headers)) {\n            if (value === null)\n                outputHeaders.delete(name);\n            else\n                outputHeaders.append(name, value);\n        }\n    }\n    const headerEntries = [];\n    outputHeaders.forEach((value, name) => {\n        headerEntries.push([name, value]);\n    });\n    return Object.fromEntries(headerEntries);\n}\n/**\n * Get the API key from the environment.\n * Precedence:\n *   1. explicit argument\n *   2. LANGGRAPH_API_KEY\n *   3. LANGSMITH_API_KEY\n *   4. LANGCHAIN_API_KEY\n *\n * @param apiKey - Optional API key provided as an argument\n * @returns The API key if found, otherwise undefined\n */\nfunction getApiKey(apiKey) {\n    if (apiKey) {\n        return apiKey;\n    }\n    const prefixes = [\"LANGGRAPH\", \"LANGSMITH\", \"LANGCHAIN\"];\n    for (const prefix of prefixes) {\n        const envKey = (0,_utils_env_js__WEBPACK_IMPORTED_MODULE_1__.getEnvironmentVariable)(`${prefix}_API_KEY`);\n        if (envKey) {\n            // Remove surrounding quotes\n            return envKey.trim().replace(/^[\"']|[\"']$/g, \"\");\n        }\n    }\n    return undefined;\n}\nconst REGEX_RUN_METADATA = /(\\/threads\\/(?<thread_id>.+))?\\/runs\\/(?<run_id>.+)/;\nfunction getRunMetadataFromResponse(response) {\n    const contentLocation = response.headers.get(\"Content-Location\");\n    if (!contentLocation)\n        return undefined;\n    const match = REGEX_RUN_METADATA.exec(contentLocation);\n    if (!match?.groups?.run_id)\n        return undefined;\n    return {\n        run_id: match.groups.run_id,\n        thread_id: match.groups.thread_id || undefined,\n    };\n}\nclass BaseClient {\n    constructor(config) {\n        Object.defineProperty(this, \"asyncCaller\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"timeoutMs\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"apiUrl\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"defaultHeaders\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"onRequest\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        const callerOptions = {\n            maxRetries: 4,\n            maxConcurrency: 4,\n            ...config?.callerOptions,\n        };\n        let defaultApiUrl = \"http://localhost:8123\";\n        if (!config?.apiUrl &&\n            typeof globalThis === \"object\" &&\n            globalThis != null) {\n            const fetchSmb = Symbol.for(\"langgraph_api:fetch\");\n            const urlSmb = Symbol.for(\"langgraph_api:url\");\n            const global = globalThis;\n            if (global[fetchSmb])\n                callerOptions.fetch ??= global[fetchSmb];\n            if (global[urlSmb])\n                defaultApiUrl = global[urlSmb];\n        }\n        this.asyncCaller = new _utils_async_caller_js__WEBPACK_IMPORTED_MODULE_0__.AsyncCaller(callerOptions);\n        this.timeoutMs = config?.timeoutMs;\n        // default limit being capped by Chrome\n        // https://github.com/nodejs/undici/issues/1373\n        // Regex to remove trailing slash, if present\n        this.apiUrl = config?.apiUrl?.replace(/\\/$/, \"\") || defaultApiUrl;\n        this.defaultHeaders = config?.defaultHeaders || {};\n        this.onRequest = config?.onRequest;\n        const apiKey = getApiKey(config?.apiKey);\n        if (apiKey) {\n            this.defaultHeaders[\"x-api-key\"] = apiKey;\n        }\n    }\n    prepareFetchOptions(path, options) {\n        const mutatedOptions = {\n            ...options,\n            headers: mergeHeaders(this.defaultHeaders, options?.headers),\n        };\n        if (mutatedOptions.json) {\n            mutatedOptions.body = JSON.stringify(mutatedOptions.json);\n            mutatedOptions.headers = mergeHeaders(mutatedOptions.headers, {\n                \"content-type\": \"application/json\",\n            });\n            delete mutatedOptions.json;\n        }\n        if (mutatedOptions.withResponse) {\n            delete mutatedOptions.withResponse;\n        }\n        let timeoutSignal = null;\n        if (typeof options?.timeoutMs !== \"undefined\") {\n            if (options.timeoutMs != null) {\n                timeoutSignal = AbortSignal.timeout(options.timeoutMs);\n            }\n        }\n        else if (this.timeoutMs != null) {\n            timeoutSignal = AbortSignal.timeout(this.timeoutMs);\n        }\n        mutatedOptions.signal = (0,_utils_signals_js__WEBPACK_IMPORTED_MODULE_2__.mergeSignals)(timeoutSignal, mutatedOptions.signal);\n        const targetUrl = new URL(`${this.apiUrl}${path}`);\n        if (mutatedOptions.params) {\n            for (const [key, value] of Object.entries(mutatedOptions.params)) {\n                if (value == null)\n                    continue;\n                const strValue = typeof value === \"string\" || typeof value === \"number\"\n                    ? value.toString()\n                    : JSON.stringify(value);\n                targetUrl.searchParams.append(key, strValue);\n            }\n            delete mutatedOptions.params;\n        }\n        return [targetUrl, mutatedOptions];\n    }\n    async fetch(path, options) {\n        const [url, init] = this.prepareFetchOptions(path, options);\n        let finalInit = init;\n        if (this.onRequest) {\n            finalInit = await this.onRequest(url, init);\n        }\n        const response = await this.asyncCaller.fetch(url, finalInit);\n        const body = (() => {\n            if (response.status === 202 || response.status === 204) {\n                return undefined;\n            }\n            return response.json();\n        })();\n        if (options?.withResponse) {\n            return [await body, response];\n        }\n        return body;\n    }\n}\nclass CronsClient extends BaseClient {\n    /**\n     *\n     * @param threadId The ID of the thread.\n     * @param assistantId Assistant ID to use for this cron job.\n     * @param payload Payload for creating a cron job.\n     * @returns The created background run.\n     */\n    async createForThread(threadId, assistantId, payload) {\n        const json = {\n            schedule: payload?.schedule,\n            input: payload?.input,\n            config: payload?.config,\n            context: payload?.context,\n            metadata: payload?.metadata,\n            assistant_id: assistantId,\n            interrupt_before: payload?.interruptBefore,\n            interrupt_after: payload?.interruptAfter,\n            webhook: payload?.webhook,\n            multitask_strategy: payload?.multitaskStrategy,\n            if_not_exists: payload?.ifNotExists,\n            checkpoint_during: payload?.checkpointDuring,\n        };\n        return this.fetch(`/threads/${threadId}/runs/crons`, {\n            method: \"POST\",\n            json,\n        });\n    }\n    /**\n     *\n     * @param assistantId Assistant ID to use for this cron job.\n     * @param payload Payload for creating a cron job.\n     * @returns\n     */\n    async create(assistantId, payload) {\n        const json = {\n            schedule: payload?.schedule,\n            input: payload?.input,\n            config: payload?.config,\n            context: payload?.context,\n            metadata: payload?.metadata,\n            assistant_id: assistantId,\n            interrupt_before: payload?.interruptBefore,\n            interrupt_after: payload?.interruptAfter,\n            webhook: payload?.webhook,\n            multitask_strategy: payload?.multitaskStrategy,\n            if_not_exists: payload?.ifNotExists,\n            checkpoint_during: payload?.checkpointDuring,\n        };\n        return this.fetch(`/runs/crons`, {\n            method: \"POST\",\n            json,\n        });\n    }\n    /**\n     *\n     * @param cronId Cron ID of Cron job to delete.\n     */\n    async delete(cronId) {\n        await this.fetch(`/runs/crons/${cronId}`, {\n            method: \"DELETE\",\n        });\n    }\n    /**\n     *\n     * @param query Query options.\n     * @returns List of crons.\n     */\n    async search(query) {\n        return this.fetch(\"/runs/crons/search\", {\n            method: \"POST\",\n            json: {\n                assistant_id: query?.assistantId ?? undefined,\n                thread_id: query?.threadId ?? undefined,\n                limit: query?.limit ?? 10,\n                offset: query?.offset ?? 0,\n                sort_by: query?.sortBy ?? undefined,\n                sort_order: query?.sortOrder ?? undefined,\n            },\n        });\n    }\n}\nclass AssistantsClient extends BaseClient {\n    /**\n     * Get an assistant by ID.\n     *\n     * @param assistantId The ID of the assistant.\n     * @returns Assistant\n     */\n    async get(assistantId) {\n        return this.fetch(`/assistants/${assistantId}`);\n    }\n    /**\n     * Get the JSON representation of the graph assigned to a runnable\n     * @param assistantId The ID of the assistant.\n     * @param options.xray Whether to include subgraphs in the serialized graph representation. If an integer value is provided, only subgraphs with a depth less than or equal to the value will be included.\n     * @returns Serialized graph\n     */\n    async getGraph(assistantId, options) {\n        return this.fetch(`/assistants/${assistantId}/graph`, {\n            params: { xray: options?.xray },\n        });\n    }\n    /**\n     * Get the state and config schema of the graph assigned to a runnable\n     * @param assistantId The ID of the assistant.\n     * @returns Graph schema\n     */\n    async getSchemas(assistantId) {\n        return this.fetch(`/assistants/${assistantId}/schemas`);\n    }\n    /**\n     * Get the schemas of an assistant by ID.\n     *\n     * @param assistantId The ID of the assistant to get the schema of.\n     * @param options Additional options for getting subgraphs, such as namespace or recursion extraction.\n     * @returns The subgraphs of the assistant.\n     */\n    async getSubgraphs(assistantId, options) {\n        if (options?.namespace) {\n            return this.fetch(`/assistants/${assistantId}/subgraphs/${options.namespace}`, { params: { recurse: options?.recurse } });\n        }\n        return this.fetch(`/assistants/${assistantId}/subgraphs`, {\n            params: { recurse: options?.recurse },\n        });\n    }\n    /**\n     * Create a new assistant.\n     * @param payload Payload for creating an assistant.\n     * @returns The created assistant.\n     */\n    async create(payload) {\n        return this.fetch(\"/assistants\", {\n            method: \"POST\",\n            json: {\n                graph_id: payload.graphId,\n                config: payload.config,\n                context: payload.context,\n                metadata: payload.metadata,\n                assistant_id: payload.assistantId,\n                if_exists: payload.ifExists,\n                name: payload.name,\n                description: payload.description,\n            },\n        });\n    }\n    /**\n     * Update an assistant.\n     * @param assistantId ID of the assistant.\n     * @param payload Payload for updating the assistant.\n     * @returns The updated assistant.\n     */\n    async update(assistantId, payload) {\n        return this.fetch(`/assistants/${assistantId}`, {\n            method: \"PATCH\",\n            json: {\n                graph_id: payload.graphId,\n                config: payload.config,\n                context: payload.context,\n                metadata: payload.metadata,\n                name: payload.name,\n                description: payload.description,\n            },\n        });\n    }\n    /**\n     * Delete an assistant.\n     *\n     * @param assistantId ID of the assistant.\n     */\n    async delete(assistantId) {\n        return this.fetch(`/assistants/${assistantId}`, {\n            method: \"DELETE\",\n        });\n    }\n    /**\n     * List assistants.\n     * @param query Query options.\n     * @returns List of assistants.\n     */\n    async search(query) {\n        return this.fetch(\"/assistants/search\", {\n            method: \"POST\",\n            json: {\n                graph_id: query?.graphId ?? undefined,\n                metadata: query?.metadata ?? undefined,\n                limit: query?.limit ?? 10,\n                offset: query?.offset ?? 0,\n                sort_by: query?.sortBy ?? undefined,\n                sort_order: query?.sortOrder ?? undefined,\n            },\n        });\n    }\n    /**\n     * List all versions of an assistant.\n     *\n     * @param assistantId ID of the assistant.\n     * @returns List of assistant versions.\n     */\n    async getVersions(assistantId, payload) {\n        return this.fetch(`/assistants/${assistantId}/versions`, {\n            method: \"POST\",\n            json: {\n                metadata: payload?.metadata ?? undefined,\n                limit: payload?.limit ?? 10,\n                offset: payload?.offset ?? 0,\n            },\n        });\n    }\n    /**\n     * Change the version of an assistant.\n     *\n     * @param assistantId ID of the assistant.\n     * @param version The version to change to.\n     * @returns The updated assistant.\n     */\n    async setLatest(assistantId, version) {\n        return this.fetch(`/assistants/${assistantId}/latest`, {\n            method: \"POST\",\n            json: { version },\n        });\n    }\n}\nclass ThreadsClient extends BaseClient {\n    /**\n     * Get a thread by ID.\n     *\n     * @param threadId ID of the thread.\n     * @returns The thread.\n     */\n    async get(threadId) {\n        return this.fetch(`/threads/${threadId}`);\n    }\n    /**\n     * Create a new thread.\n     *\n     * @param payload Payload for creating a thread.\n     * @returns The created thread.\n     */\n    async create(payload) {\n        return this.fetch(`/threads`, {\n            method: \"POST\",\n            json: {\n                metadata: {\n                    ...payload?.metadata,\n                    graph_id: payload?.graphId,\n                },\n                thread_id: payload?.threadId,\n                if_exists: payload?.ifExists,\n                supersteps: payload?.supersteps?.map((s) => ({\n                    updates: s.updates.map((u) => ({\n                        values: u.values,\n                        command: u.command,\n                        as_node: u.asNode,\n                    })),\n                })),\n            },\n        });\n    }\n    /**\n     * Copy an existing thread\n     * @param threadId ID of the thread to be copied\n     * @returns Newly copied thread\n     */\n    async copy(threadId) {\n        return this.fetch(`/threads/${threadId}/copy`, {\n            method: \"POST\",\n        });\n    }\n    /**\n     * Update a thread.\n     *\n     * @param threadId ID of the thread.\n     * @param payload Payload for updating the thread.\n     * @returns The updated thread.\n     */\n    async update(threadId, payload) {\n        return this.fetch(`/threads/${threadId}`, {\n            method: \"PATCH\",\n            json: { metadata: payload?.metadata },\n        });\n    }\n    /**\n     * Delete a thread.\n     *\n     * @param threadId ID of the thread.\n     */\n    async delete(threadId) {\n        return this.fetch(`/threads/${threadId}`, {\n            method: \"DELETE\",\n        });\n    }\n    /**\n     * List threads\n     *\n     * @param query Query options\n     * @returns List of threads\n     */\n    async search(query) {\n        return this.fetch(\"/threads/search\", {\n            method: \"POST\",\n            json: {\n                metadata: query?.metadata ?? undefined,\n                limit: query?.limit ?? 10,\n                offset: query?.offset ?? 0,\n                status: query?.status,\n                sort_by: query?.sortBy,\n                sort_order: query?.sortOrder,\n            },\n        });\n    }\n    /**\n     * Get state for a thread.\n     *\n     * @param threadId ID of the thread.\n     * @returns Thread state.\n     */\n    async getState(threadId, checkpoint, options) {\n        if (checkpoint != null) {\n            if (typeof checkpoint !== \"string\") {\n                return this.fetch(`/threads/${threadId}/state/checkpoint`, {\n                    method: \"POST\",\n                    json: { checkpoint, subgraphs: options?.subgraphs },\n                });\n            }\n            // deprecated\n            return this.fetch(`/threads/${threadId}/state/${checkpoint}`, { params: { subgraphs: options?.subgraphs } });\n        }\n        return this.fetch(`/threads/${threadId}/state`, {\n            params: { subgraphs: options?.subgraphs },\n        });\n    }\n    /**\n     * Add state to a thread.\n     *\n     * @param threadId The ID of the thread.\n     * @returns\n     */\n    async updateState(threadId, options) {\n        return this.fetch(`/threads/${threadId}/state`, {\n            method: \"POST\",\n            json: {\n                values: options.values,\n                checkpoint_id: options.checkpointId,\n                checkpoint: options.checkpoint,\n                as_node: options?.asNode,\n            },\n        });\n    }\n    /**\n     * Patch the metadata of a thread.\n     *\n     * @param threadIdOrConfig Thread ID or config to patch the state of.\n     * @param metadata Metadata to patch the state with.\n     */\n    async patchState(threadIdOrConfig, metadata) {\n        let threadId;\n        if (typeof threadIdOrConfig !== \"string\") {\n            if (typeof threadIdOrConfig.configurable?.thread_id !== \"string\") {\n                throw new Error(\"Thread ID is required when updating state with a config.\");\n            }\n            threadId = threadIdOrConfig.configurable.thread_id;\n        }\n        else {\n            threadId = threadIdOrConfig;\n        }\n        return this.fetch(`/threads/${threadId}/state`, {\n            method: \"PATCH\",\n            json: { metadata },\n        });\n    }\n    /**\n     * Get all past states for a thread.\n     *\n     * @param threadId ID of the thread.\n     * @param options Additional options.\n     * @returns List of thread states.\n     */\n    async getHistory(threadId, options) {\n        return this.fetch(`/threads/${threadId}/history`, {\n            method: \"POST\",\n            json: {\n                limit: options?.limit ?? 10,\n                before: options?.before,\n                metadata: options?.metadata,\n                checkpoint: options?.checkpoint,\n            },\n        });\n    }\n}\nclass RunsClient extends BaseClient {\n    /**\n     * Create a run and stream the results.\n     *\n     * @param threadId The ID of the thread.\n     * @param assistantId Assistant ID to use for this run.\n     * @param payload Payload for creating a run.\n     */\n    async *stream(threadId, assistantId, payload) {\n        const json = {\n            input: payload?.input,\n            command: payload?.command,\n            config: payload?.config,\n            context: payload?.context,\n            metadata: payload?.metadata,\n            stream_mode: payload?.streamMode,\n            stream_subgraphs: payload?.streamSubgraphs,\n            stream_resumable: payload?.streamResumable,\n            feedback_keys: payload?.feedbackKeys,\n            assistant_id: assistantId,\n            interrupt_before: payload?.interruptBefore,\n            interrupt_after: payload?.interruptAfter,\n            checkpoint: payload?.checkpoint,\n            checkpoint_id: payload?.checkpointId,\n            webhook: payload?.webhook,\n            multitask_strategy: payload?.multitaskStrategy,\n            on_completion: payload?.onCompletion,\n            on_disconnect: payload?.onDisconnect,\n            after_seconds: payload?.afterSeconds,\n            if_not_exists: payload?.ifNotExists,\n            checkpoint_during: payload?.checkpointDuring,\n        };\n        const endpoint = threadId == null ? `/runs/stream` : `/threads/${threadId}/runs/stream`;\n        const response = await this.asyncCaller.fetch(...this.prepareFetchOptions(endpoint, {\n            method: \"POST\",\n            json,\n            timeoutMs: null,\n            signal: payload?.signal,\n        }));\n        const runMetadata = getRunMetadataFromResponse(response);\n        if (runMetadata)\n            payload?.onRunCreated?.(runMetadata);\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        const stream = (response.body || new ReadableStream({ start: (ctrl) => ctrl.close() }))\n            .pipeThrough((0,_utils_sse_js__WEBPACK_IMPORTED_MODULE_3__.BytesLineDecoder)())\n            .pipeThrough((0,_utils_sse_js__WEBPACK_IMPORTED_MODULE_3__.SSEDecoder)());\n        yield* _utils_stream_js__WEBPACK_IMPORTED_MODULE_4__.IterableReadableStream.fromReadableStream(stream);\n    }\n    /**\n     * Create a run.\n     *\n     * @param threadId The ID of the thread.\n     * @param assistantId Assistant ID to use for this run.\n     * @param payload Payload for creating a run.\n     * @returns The created run.\n     */\n    async create(threadId, assistantId, payload) {\n        const json = {\n            input: payload?.input,\n            command: payload?.command,\n            config: payload?.config,\n            context: payload?.context,\n            metadata: payload?.metadata,\n            stream_mode: payload?.streamMode,\n            stream_subgraphs: payload?.streamSubgraphs,\n            stream_resumable: payload?.streamResumable,\n            assistant_id: assistantId,\n            interrupt_before: payload?.interruptBefore,\n            interrupt_after: payload?.interruptAfter,\n            webhook: payload?.webhook,\n            checkpoint: payload?.checkpoint,\n            checkpoint_id: payload?.checkpointId,\n            multitask_strategy: payload?.multitaskStrategy,\n            after_seconds: payload?.afterSeconds,\n            if_not_exists: payload?.ifNotExists,\n            checkpoint_during: payload?.checkpointDuring,\n            langsmith_tracer: payload?._langsmithTracer\n                ? {\n                    project_name: payload?._langsmithTracer?.projectName,\n                    example_id: payload?._langsmithTracer?.exampleId,\n                }\n                : undefined,\n        };\n        const [run, response] = await this.fetch(`/threads/${threadId}/runs`, {\n            method: \"POST\",\n            json,\n            signal: payload?.signal,\n            withResponse: true,\n        });\n        const runMetadata = getRunMetadataFromResponse(response);\n        if (runMetadata)\n            payload?.onRunCreated?.(runMetadata);\n        return run;\n    }\n    /**\n     * Create a batch of stateless background runs.\n     *\n     * @param payloads An array of payloads for creating runs.\n     * @returns An array of created runs.\n     */\n    async createBatch(payloads) {\n        const filteredPayloads = payloads\n            .map((payload) => ({ ...payload, assistant_id: payload.assistantId }))\n            .map((payload) => {\n            return Object.fromEntries(Object.entries(payload).filter(([_, v]) => v !== undefined));\n        });\n        return this.fetch(\"/runs/batch\", {\n            method: \"POST\",\n            json: filteredPayloads,\n        });\n    }\n    /**\n     * Create a run and wait for it to complete.\n     *\n     * @param threadId The ID of the thread.\n     * @param assistantId Assistant ID to use for this run.\n     * @param payload Payload for creating a run.\n     * @returns The last values chunk of the thread.\n     */\n    async wait(threadId, assistantId, payload) {\n        const json = {\n            input: payload?.input,\n            command: payload?.command,\n            config: payload?.config,\n            context: payload?.context,\n            metadata: payload?.metadata,\n            assistant_id: assistantId,\n            interrupt_before: payload?.interruptBefore,\n            interrupt_after: payload?.interruptAfter,\n            checkpoint: payload?.checkpoint,\n            checkpoint_id: payload?.checkpointId,\n            webhook: payload?.webhook,\n            multitask_strategy: payload?.multitaskStrategy,\n            on_completion: payload?.onCompletion,\n            on_disconnect: payload?.onDisconnect,\n            after_seconds: payload?.afterSeconds,\n            if_not_exists: payload?.ifNotExists,\n            checkpoint_during: payload?.checkpointDuring,\n            langsmith_tracer: payload?._langsmithTracer\n                ? {\n                    project_name: payload?._langsmithTracer?.projectName,\n                    example_id: payload?._langsmithTracer?.exampleId,\n                }\n                : undefined,\n        };\n        const endpoint = threadId == null ? `/runs/wait` : `/threads/${threadId}/runs/wait`;\n        const [run, response] = await this.fetch(endpoint, {\n            method: \"POST\",\n            json,\n            timeoutMs: null,\n            signal: payload?.signal,\n            withResponse: true,\n        });\n        const runMetadata = getRunMetadataFromResponse(response);\n        if (runMetadata)\n            payload?.onRunCreated?.(runMetadata);\n        const raiseError = payload?.raiseError !== undefined ? payload.raiseError : true;\n        if (raiseError &&\n            \"__error__\" in run &&\n            typeof run.__error__ === \"object\" &&\n            run.__error__ &&\n            \"error\" in run.__error__ &&\n            \"message\" in run.__error__) {\n            throw new Error(`${run.__error__?.error}: ${run.__error__?.message}`);\n        }\n        return run;\n    }\n    /**\n     * List all runs for a thread.\n     *\n     * @param threadId The ID of the thread.\n     * @param options Filtering and pagination options.\n     * @returns List of runs.\n     */\n    async list(threadId, options) {\n        return this.fetch(`/threads/${threadId}/runs`, {\n            params: {\n                limit: options?.limit ?? 10,\n                offset: options?.offset ?? 0,\n                status: options?.status ?? undefined,\n            },\n        });\n    }\n    /**\n     * Get a run by ID.\n     *\n     * @param threadId The ID of the thread.\n     * @param runId The ID of the run.\n     * @returns The run.\n     */\n    async get(threadId, runId) {\n        return this.fetch(`/threads/${threadId}/runs/${runId}`);\n    }\n    /**\n     * Cancel a run.\n     *\n     * @param threadId The ID of the thread.\n     * @param runId The ID of the run.\n     * @param wait Whether to block when canceling\n     * @param action Action to take when cancelling the run. Possible values are `interrupt` or `rollback`. Default is `interrupt`.\n     * @returns\n     */\n    async cancel(threadId, runId, wait = false, action = \"interrupt\") {\n        return this.fetch(`/threads/${threadId}/runs/${runId}/cancel`, {\n            method: \"POST\",\n            params: {\n                wait: wait ? \"1\" : \"0\",\n                action,\n            },\n        });\n    }\n    /**\n     * Block until a run is done.\n     *\n     * @param threadId The ID of the thread.\n     * @param runId The ID of the run.\n     * @returns\n     */\n    async join(threadId, runId, options) {\n        return this.fetch(`/threads/${threadId}/runs/${runId}/join`, {\n            timeoutMs: null,\n            signal: options?.signal,\n        });\n    }\n    /**\n     * Stream output from a run in real-time, until the run is done.\n     *\n     * @param threadId The ID of the thread. Can be set to `null` | `undefined` for stateless runs.\n     * @param runId The ID of the run.\n     * @param options Additional options for controlling the stream behavior:\n     *   - signal: An AbortSignal that can be used to cancel the stream request\n     *   - lastEventId: The ID of the last event received. Can be used to reconnect to a stream without losing events.\n     *   - cancelOnDisconnect: When true, automatically cancels the run if the client disconnects from the stream\n     *   - streamMode: Controls what types of events to receive from the stream (can be a single mode or array of modes)\n     *        Must be a subset of the stream modes passed when creating the run. Background runs default to having the union of all\n     *        stream modes enabled.\n     * @returns An async generator yielding stream parts.\n     */\n    async *joinStream(threadId, runId, options\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    ) {\n        const opts = typeof options === \"object\" &&\n            options != null &&\n            // eslint-disable-next-line no-instanceof/no-instanceof\n            options instanceof AbortSignal\n            ? { signal: options }\n            : options;\n        const response = await this.asyncCaller.fetch(...this.prepareFetchOptions(threadId != null\n            ? `/threads/${threadId}/runs/${runId}/stream`\n            : `/runs/${runId}/stream`, {\n            method: \"GET\",\n            timeoutMs: null,\n            signal: opts?.signal,\n            headers: opts?.lastEventId\n                ? { \"Last-Event-ID\": opts.lastEventId }\n                : undefined,\n            params: {\n                cancel_on_disconnect: opts?.cancelOnDisconnect ? \"1\" : \"0\",\n                stream_mode: opts?.streamMode,\n            },\n        }));\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        const stream = (response.body || new ReadableStream({ start: (ctrl) => ctrl.close() }))\n            .pipeThrough((0,_utils_sse_js__WEBPACK_IMPORTED_MODULE_3__.BytesLineDecoder)())\n            .pipeThrough((0,_utils_sse_js__WEBPACK_IMPORTED_MODULE_3__.SSEDecoder)());\n        yield* _utils_stream_js__WEBPACK_IMPORTED_MODULE_4__.IterableReadableStream.fromReadableStream(stream);\n    }\n    /**\n     * Delete a run.\n     *\n     * @param threadId The ID of the thread.\n     * @param runId The ID of the run.\n     * @returns\n     */\n    async delete(threadId, runId) {\n        return this.fetch(`/threads/${threadId}/runs/${runId}`, {\n            method: \"DELETE\",\n        });\n    }\n}\nclass StoreClient extends BaseClient {\n    /**\n     * Store or update an item.\n     *\n     * @param namespace A list of strings representing the namespace path.\n     * @param key The unique identifier for the item within the namespace.\n     * @param value A dictionary containing the item's data.\n     * @param options.index Controls search indexing - null (use defaults), false (disable), or list of field paths to index.\n     * @param options.ttl Optional time-to-live in minutes for the item, or null for no expiration.\n     * @returns Promise<void>\n     *\n     * @example\n     * ```typescript\n     * await client.store.putItem(\n     *   [\"documents\", \"user123\"],\n     *   \"item456\",\n     *   { title: \"My Document\", content: \"Hello World\" },\n     *   { ttl: 60 } // expires in 60 minutes\n     * );\n     * ```\n     */\n    async putItem(namespace, key, value, options) {\n        namespace.forEach((label) => {\n            if (label.includes(\".\")) {\n                throw new Error(`Invalid namespace label '${label}'. Namespace labels cannot contain periods ('.')`);\n            }\n        });\n        const payload = {\n            namespace,\n            key,\n            value,\n            index: options?.index,\n            ttl: options?.ttl,\n        };\n        return this.fetch(\"/store/items\", {\n            method: \"PUT\",\n            json: payload,\n        });\n    }\n    /**\n     * Retrieve a single item.\n     *\n     * @param namespace A list of strings representing the namespace path.\n     * @param key The unique identifier for the item.\n     * @param options.refreshTtl Whether to refresh the TTL on this read operation. If null, uses the store's default behavior.\n     * @returns Promise<Item>\n     *\n     * @example\n     * ```typescript\n     * const item = await client.store.getItem(\n     *   [\"documents\", \"user123\"],\n     *   \"item456\",\n     *   { refreshTtl: true }\n     * );\n     * console.log(item);\n     * // {\n     * //   namespace: [\"documents\", \"user123\"],\n     * //   key: \"item456\",\n     * //   value: { title: \"My Document\", content: \"Hello World\" },\n     * //   createdAt: \"2024-07-30T12:00:00Z\",\n     * //   updatedAt: \"2024-07-30T12:00:00Z\"\n     * // }\n     * ```\n     */\n    async getItem(namespace, key, options) {\n        namespace.forEach((label) => {\n            if (label.includes(\".\")) {\n                throw new Error(`Invalid namespace label '${label}'. Namespace labels cannot contain periods ('.')`);\n            }\n        });\n        const params = {\n            namespace: namespace.join(\".\"),\n            key,\n        };\n        if (options?.refreshTtl !== undefined) {\n            params.refresh_ttl = options.refreshTtl;\n        }\n        const response = await this.fetch(\"/store/items\", {\n            params,\n        });\n        return response\n            ? {\n                ...response,\n                createdAt: response.created_at,\n                updatedAt: response.updated_at,\n            }\n            : null;\n    }\n    /**\n     * Delete an item.\n     *\n     * @param namespace A list of strings representing the namespace path.\n     * @param key The unique identifier for the item.\n     * @returns Promise<void>\n     */\n    async deleteItem(namespace, key) {\n        namespace.forEach((label) => {\n            if (label.includes(\".\")) {\n                throw new Error(`Invalid namespace label '${label}'. Namespace labels cannot contain periods ('.')`);\n            }\n        });\n        return this.fetch(\"/store/items\", {\n            method: \"DELETE\",\n            json: { namespace, key },\n        });\n    }\n    /**\n     * Search for items within a namespace prefix.\n     *\n     * @param namespacePrefix List of strings representing the namespace prefix.\n     * @param options.filter Optional dictionary of key-value pairs to filter results.\n     * @param options.limit Maximum number of items to return (default is 10).\n     * @param options.offset Number of items to skip before returning results (default is 0).\n     * @param options.query Optional search query.\n     * @param options.refreshTtl Whether to refresh the TTL on items returned by this search. If null, uses the store's default behavior.\n     * @returns Promise<SearchItemsResponse>\n     *\n     * @example\n     * ```typescript\n     * const results = await client.store.searchItems(\n     *   [\"documents\"],\n     *   {\n     *     filter: { author: \"John Doe\" },\n     *     limit: 5,\n     *     refreshTtl: true\n     *   }\n     * );\n     * console.log(results);\n     * // {\n     * //   items: [\n     * //     {\n     * //       namespace: [\"documents\", \"user123\"],\n     * //       key: \"item789\",\n     * //       value: { title: \"Another Document\", author: \"John Doe\" },\n     * //       createdAt: \"2024-07-30T12:00:00Z\",\n     * //       updatedAt: \"2024-07-30T12:00:00Z\"\n     * //     },\n     * //     // ... additional items ...\n     * //   ]\n     * // }\n     * ```\n     */\n    async searchItems(namespacePrefix, options) {\n        const payload = {\n            namespace_prefix: namespacePrefix,\n            filter: options?.filter,\n            limit: options?.limit ?? 10,\n            offset: options?.offset ?? 0,\n            query: options?.query,\n            refresh_ttl: options?.refreshTtl,\n        };\n        const response = await this.fetch(\"/store/items/search\", {\n            method: \"POST\",\n            json: payload,\n        });\n        return {\n            items: response.items.map((item) => ({\n                ...item,\n                createdAt: item.created_at,\n                updatedAt: item.updated_at,\n            })),\n        };\n    }\n    /**\n     * List namespaces with optional match conditions.\n     *\n     * @param options.prefix Optional list of strings representing the prefix to filter namespaces.\n     * @param options.suffix Optional list of strings representing the suffix to filter namespaces.\n     * @param options.maxDepth Optional integer specifying the maximum depth of namespaces to return.\n     * @param options.limit Maximum number of namespaces to return (default is 100).\n     * @param options.offset Number of namespaces to skip before returning results (default is 0).\n     * @returns Promise<ListNamespaceResponse>\n     */\n    async listNamespaces(options) {\n        const payload = {\n            prefix: options?.prefix,\n            suffix: options?.suffix,\n            max_depth: options?.maxDepth,\n            limit: options?.limit ?? 100,\n            offset: options?.offset ?? 0,\n        };\n        return this.fetch(\"/store/namespaces\", {\n            method: \"POST\",\n            json: payload,\n        });\n    }\n}\nclass UiClient extends BaseClient {\n    static getOrCached(key, fn) {\n        if (UiClient.promiseCache[key] != null) {\n            return UiClient.promiseCache[key];\n        }\n        const promise = fn();\n        UiClient.promiseCache[key] = promise;\n        return promise;\n    }\n    async getComponent(assistantId, agentName) {\n        return UiClient.getOrCached(`${this.apiUrl}-${assistantId}-${agentName}`, async () => {\n            const response = await this.asyncCaller.fetch(...this.prepareFetchOptions(`/ui/${assistantId}`, {\n                headers: {\n                    Accept: \"text/html\",\n                    \"Content-Type\": \"application/json\",\n                },\n                method: \"POST\",\n                json: { name: agentName },\n            }));\n            return response.text();\n        });\n    }\n}\nObject.defineProperty(UiClient, \"promiseCache\", {\n    enumerable: true,\n    configurable: true,\n    writable: true,\n    value: {}\n});\nclass Client {\n    constructor(config) {\n        /**\n         * The client for interacting with assistants.\n         */\n        Object.defineProperty(this, \"assistants\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        /**\n         * The client for interacting with threads.\n         */\n        Object.defineProperty(this, \"threads\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        /**\n         * The client for interacting with runs.\n         */\n        Object.defineProperty(this, \"runs\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        /**\n         * The client for interacting with cron runs.\n         */\n        Object.defineProperty(this, \"crons\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        /**\n         * The client for interacting with the KV store.\n         */\n        Object.defineProperty(this, \"store\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        /**\n         * The client for interacting with the UI.\n         * @internal Used by LoadExternalComponent and the API might change in the future.\n         */\n        Object.defineProperty(this, \"~ui\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        /**\n         * @internal Used to obtain a stable key representing the client.\n         */\n        Object.defineProperty(this, \"~configHash\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        this[\"~configHash\"] = (() => JSON.stringify({\n            apiUrl: config?.apiUrl,\n            apiKey: config?.apiKey,\n            timeoutMs: config?.timeoutMs,\n            defaultHeaders: config?.defaultHeaders,\n            maxConcurrency: config?.callerOptions?.maxConcurrency,\n            maxRetries: config?.callerOptions?.maxRetries,\n            callbacks: {\n                onFailedResponseHook: config?.callerOptions?.onFailedResponseHook != null,\n                onRequest: config?.onRequest != null,\n                fetch: config?.callerOptions?.fetch != null,\n            },\n        }))();\n        this.assistants = new AssistantsClient(config);\n        this.threads = new ThreadsClient(config);\n        this.runs = new RunsClient(config);\n        this.crons = new CronsClient(config);\n        this.store = new StoreClient(config);\n        this[\"~ui\"] = new UiClient(config);\n    }\n}\n/**\n * @internal Used to obtain a stable key representing the client.\n */\nfunction getClientConfigHash(client) {\n    return client[\"~configHash\"];\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQGFnLXVpL2xhbmdncmFwaC9ub2RlX21vZHVsZXMvQGxhbmdjaGFpbi9sYW5nZ3JhcGgtc2RrL2Rpc3QvY2xpZW50LmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBc0Q7QUFDRTtBQUNOO0FBQ1k7QUFDSDtBQUMzRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkNBQTJDO0FBQzNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEVBQTRFLFlBQVk7QUFDeEY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIscUVBQXNCLElBQUksT0FBTztBQUN4RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0JBQStCLCtEQUFXO0FBQzFDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0NBQWdDLCtEQUFZO0FBQzVDLHFDQUFxQyxZQUFZLEVBQUUsS0FBSztBQUN4RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0NBQXNDLFNBQVM7QUFDL0M7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3Q0FBd0MsT0FBTztBQUMvQztBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNB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O0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0EiLCJzb3VyY2VzIjpbIi9ob21lL2NldGVjL05vZGVQcm9qZWN0cy9hZ3VpX3Rlc3Qvbm9kZV9tb2R1bGVzL0BhZy11aS9sYW5nZ3JhcGgvbm9kZV9tb2R1bGVzL0BsYW5nY2hhaW4vbGFuZ2dyYXBoLXNkay9kaXN0L2NsaWVudC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBc3luY0NhbGxlciB9IGZyb20gXCIuL3V0aWxzL2FzeW5jX2NhbGxlci5qc1wiO1xuaW1wb3J0IHsgZ2V0RW52aXJvbm1lbnRWYXJpYWJsZSB9IGZyb20gXCIuL3V0aWxzL2Vudi5qc1wiO1xuaW1wb3J0IHsgbWVyZ2VTaWduYWxzIH0gZnJvbSBcIi4vdXRpbHMvc2lnbmFscy5qc1wiO1xuaW1wb3J0IHsgQnl0ZXNMaW5lRGVjb2RlciwgU1NFRGVjb2RlciB9IGZyb20gXCIuL3V0aWxzL3NzZS5qc1wiO1xuaW1wb3J0IHsgSXRlcmFibGVSZWFkYWJsZVN0cmVhbSB9IGZyb20gXCIuL3V0aWxzL3N0cmVhbS5qc1wiO1xuZnVuY3Rpb24qIGl0ZXJhdGVIZWFkZXJzKGhlYWRlcnMpIHtcbiAgICBsZXQgaXRlcjtcbiAgICBsZXQgc2hvdWxkQ2xlYXIgPSBmYWxzZTtcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8taW5zdGFuY2VvZi9uby1pbnN0YW5jZW9mXG4gICAgaWYgKGhlYWRlcnMgaW5zdGFuY2VvZiBIZWFkZXJzKSB7XG4gICAgICAgIGNvbnN0IGVudHJpZXMgPSBbXTtcbiAgICAgICAgaGVhZGVycy5mb3JFYWNoKCh2YWx1ZSwgbmFtZSkgPT4ge1xuICAgICAgICAgICAgZW50cmllcy5wdXNoKFtuYW1lLCB2YWx1ZV0pO1xuICAgICAgICB9KTtcbiAgICAgICAgaXRlciA9IGVudHJpZXM7XG4gICAgfVxuICAgIGVsc2UgaWYgKEFycmF5LmlzQXJyYXkoaGVhZGVycykpIHtcbiAgICAgICAgaXRlciA9IGhlYWRlcnM7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBzaG91bGRDbGVhciA9IHRydWU7XG4gICAgICAgIGl0ZXIgPSBPYmplY3QuZW50cmllcyhoZWFkZXJzID8/IHt9KTtcbiAgICB9XG4gICAgZm9yIChjb25zdCBpdGVtIG9mIGl0ZXIpIHtcbiAgICAgICAgY29uc3QgbmFtZSA9IGl0ZW1bMF07XG4gICAgICAgIGlmICh0eXBlb2YgbmFtZSAhPT0gXCJzdHJpbmdcIilcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoYEV4cGVjdGVkIGhlYWRlciBuYW1lIHRvIGJlIGEgc3RyaW5nLCBnb3QgJHt0eXBlb2YgbmFtZX1gKTtcbiAgICAgICAgY29uc3QgdmFsdWVzID0gQXJyYXkuaXNBcnJheShpdGVtWzFdKSA/IGl0ZW1bMV0gOiBbaXRlbVsxXV07XG4gICAgICAgIGxldCBkaWRDbGVhciA9IGZhbHNlO1xuICAgICAgICBmb3IgKGNvbnN0IHZhbHVlIG9mIHZhbHVlcykge1xuICAgICAgICAgICAgaWYgKHZhbHVlID09PSB1bmRlZmluZWQpXG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAvLyBOZXcgb2JqZWN0IGtleXMgc2hvdWxkIGFsd2F5cyBvdmVyd3JpdGUgb2xkZXIgaGVhZGVyc1xuICAgICAgICAgICAgLy8gWWllbGQgYSBudWxsIHRvIGNsZWFyIHRoZSBoZWFkZXIgaW4gdGhlIGhlYWRlcnMgb2JqZWN0XG4gICAgICAgICAgICAvLyBiZWZvcmUgYWRkaW5nIHRoZSBuZXcgdmFsdWVcbiAgICAgICAgICAgIGlmIChzaG91bGRDbGVhciAmJiAhZGlkQ2xlYXIpIHtcbiAgICAgICAgICAgICAgICBkaWRDbGVhciA9IHRydWU7XG4gICAgICAgICAgICAgICAgeWllbGQgW25hbWUsIG51bGxdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgeWllbGQgW25hbWUsIHZhbHVlXTtcbiAgICAgICAgfVxuICAgIH1cbn1cbmZ1bmN0aW9uIG1lcmdlSGVhZGVycyguLi5oZWFkZXJPYmplY3RzKSB7XG4gICAgY29uc3Qgb3V0cHV0SGVhZGVycyA9IG5ldyBIZWFkZXJzKCk7XG4gICAgZm9yIChjb25zdCBoZWFkZXJzIG9mIGhlYWRlck9iamVjdHMpIHtcbiAgICAgICAgaWYgKCFoZWFkZXJzKVxuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgIGZvciAoY29uc3QgW25hbWUsIHZhbHVlXSBvZiBpdGVyYXRlSGVhZGVycyhoZWFkZXJzKSkge1xuICAgICAgICAgICAgaWYgKHZhbHVlID09PSBudWxsKVxuICAgICAgICAgICAgICAgIG91dHB1dEhlYWRlcnMuZGVsZXRlKG5hbWUpO1xuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgIG91dHB1dEhlYWRlcnMuYXBwZW5kKG5hbWUsIHZhbHVlKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBjb25zdCBoZWFkZXJFbnRyaWVzID0gW107XG4gICAgb3V0cHV0SGVhZGVycy5mb3JFYWNoKCh2YWx1ZSwgbmFtZSkgPT4ge1xuICAgICAgICBoZWFkZXJFbnRyaWVzLnB1c2goW25hbWUsIHZhbHVlXSk7XG4gICAgfSk7XG4gICAgcmV0dXJuIE9iamVjdC5mcm9tRW50cmllcyhoZWFkZXJFbnRyaWVzKTtcbn1cbi8qKlxuICogR2V0IHRoZSBBUEkga2V5IGZyb20gdGhlIGVudmlyb25tZW50LlxuICogUHJlY2VkZW5jZTpcbiAqICAgMS4gZXhwbGljaXQgYXJndW1lbnRcbiAqICAgMi4gTEFOR0dSQVBIX0FQSV9LRVlcbiAqICAgMy4gTEFOR1NNSVRIX0FQSV9LRVlcbiAqICAgNC4gTEFOR0NIQUlOX0FQSV9LRVlcbiAqXG4gKiBAcGFyYW0gYXBpS2V5IC0gT3B0aW9uYWwgQVBJIGtleSBwcm92aWRlZCBhcyBhbiBhcmd1bWVudFxuICogQHJldHVybnMgVGhlIEFQSSBrZXkgaWYgZm91bmQsIG90aGVyd2lzZSB1bmRlZmluZWRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEFwaUtleShhcGlLZXkpIHtcbiAgICBpZiAoYXBpS2V5KSB7XG4gICAgICAgIHJldHVybiBhcGlLZXk7XG4gICAgfVxuICAgIGNvbnN0IHByZWZpeGVzID0gW1wiTEFOR0dSQVBIXCIsIFwiTEFOR1NNSVRIXCIsIFwiTEFOR0NIQUlOXCJdO1xuICAgIGZvciAoY29uc3QgcHJlZml4IG9mIHByZWZpeGVzKSB7XG4gICAgICAgIGNvbnN0IGVudktleSA9IGdldEVudmlyb25tZW50VmFyaWFibGUoYCR7cHJlZml4fV9BUElfS0VZYCk7XG4gICAgICAgIGlmIChlbnZLZXkpIHtcbiAgICAgICAgICAgIC8vIFJlbW92ZSBzdXJyb3VuZGluZyBxdW90ZXNcbiAgICAgICAgICAgIHJldHVybiBlbnZLZXkudHJpbSgpLnJlcGxhY2UoL15bXCInXXxbXCInXSQvZywgXCJcIik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbn1cbmNvbnN0IFJFR0VYX1JVTl9NRVRBREFUQSA9IC8oXFwvdGhyZWFkc1xcLyg/PHRocmVhZF9pZD4uKykpP1xcL3J1bnNcXC8oPzxydW5faWQ+LispLztcbmZ1bmN0aW9uIGdldFJ1bk1ldGFkYXRhRnJvbVJlc3BvbnNlKHJlc3BvbnNlKSB7XG4gICAgY29uc3QgY29udGVudExvY2F0aW9uID0gcmVzcG9uc2UuaGVhZGVycy5nZXQoXCJDb250ZW50LUxvY2F0aW9uXCIpO1xuICAgIGlmICghY29udGVudExvY2F0aW9uKVxuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIGNvbnN0IG1hdGNoID0gUkVHRVhfUlVOX01FVEFEQVRBLmV4ZWMoY29udGVudExvY2F0aW9uKTtcbiAgICBpZiAoIW1hdGNoPy5ncm91cHM/LnJ1bl9pZClcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICByZXR1cm4ge1xuICAgICAgICBydW5faWQ6IG1hdGNoLmdyb3Vwcy5ydW5faWQsXG4gICAgICAgIHRocmVhZF9pZDogbWF0Y2guZ3JvdXBzLnRocmVhZF9pZCB8fCB1bmRlZmluZWQsXG4gICAgfTtcbn1cbmNsYXNzIEJhc2VDbGllbnQge1xuICAgIGNvbnN0cnVjdG9yKGNvbmZpZykge1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJhc3luY0NhbGxlclwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogdm9pZCAwXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJ0aW1lb3V0TXNcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IHZvaWQgMFxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiYXBpVXJsXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDBcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImRlZmF1bHRIZWFkZXJzXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDBcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcIm9uUmVxdWVzdFwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogdm9pZCAwXG4gICAgICAgIH0pO1xuICAgICAgICBjb25zdCBjYWxsZXJPcHRpb25zID0ge1xuICAgICAgICAgICAgbWF4UmV0cmllczogNCxcbiAgICAgICAgICAgIG1heENvbmN1cnJlbmN5OiA0LFxuICAgICAgICAgICAgLi4uY29uZmlnPy5jYWxsZXJPcHRpb25zLFxuICAgICAgICB9O1xuICAgICAgICBsZXQgZGVmYXVsdEFwaVVybCA9IFwiaHR0cDovL2xvY2FsaG9zdDo4MTIzXCI7XG4gICAgICAgIGlmICghY29uZmlnPy5hcGlVcmwgJiZcbiAgICAgICAgICAgIHR5cGVvZiBnbG9iYWxUaGlzID09PSBcIm9iamVjdFwiICYmXG4gICAgICAgICAgICBnbG9iYWxUaGlzICE9IG51bGwpIHtcbiAgICAgICAgICAgIGNvbnN0IGZldGNoU21iID0gU3ltYm9sLmZvcihcImxhbmdncmFwaF9hcGk6ZmV0Y2hcIik7XG4gICAgICAgICAgICBjb25zdCB1cmxTbWIgPSBTeW1ib2wuZm9yKFwibGFuZ2dyYXBoX2FwaTp1cmxcIik7XG4gICAgICAgICAgICBjb25zdCBnbG9iYWwgPSBnbG9iYWxUaGlzO1xuICAgICAgICAgICAgaWYgKGdsb2JhbFtmZXRjaFNtYl0pXG4gICAgICAgICAgICAgICAgY2FsbGVyT3B0aW9ucy5mZXRjaCA/Pz0gZ2xvYmFsW2ZldGNoU21iXTtcbiAgICAgICAgICAgIGlmIChnbG9iYWxbdXJsU21iXSlcbiAgICAgICAgICAgICAgICBkZWZhdWx0QXBpVXJsID0gZ2xvYmFsW3VybFNtYl07XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5hc3luY0NhbGxlciA9IG5ldyBBc3luY0NhbGxlcihjYWxsZXJPcHRpb25zKTtcbiAgICAgICAgdGhpcy50aW1lb3V0TXMgPSBjb25maWc/LnRpbWVvdXRNcztcbiAgICAgICAgLy8gZGVmYXVsdCBsaW1pdCBiZWluZyBjYXBwZWQgYnkgQ2hyb21lXG4gICAgICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9ub2RlanMvdW5kaWNpL2lzc3Vlcy8xMzczXG4gICAgICAgIC8vIFJlZ2V4IHRvIHJlbW92ZSB0cmFpbGluZyBzbGFzaCwgaWYgcHJlc2VudFxuICAgICAgICB0aGlzLmFwaVVybCA9IGNvbmZpZz8uYXBpVXJsPy5yZXBsYWNlKC9cXC8kLywgXCJcIikgfHwgZGVmYXVsdEFwaVVybDtcbiAgICAgICAgdGhpcy5kZWZhdWx0SGVhZGVycyA9IGNvbmZpZz8uZGVmYXVsdEhlYWRlcnMgfHwge307XG4gICAgICAgIHRoaXMub25SZXF1ZXN0ID0gY29uZmlnPy5vblJlcXVlc3Q7XG4gICAgICAgIGNvbnN0IGFwaUtleSA9IGdldEFwaUtleShjb25maWc/LmFwaUtleSk7XG4gICAgICAgIGlmIChhcGlLZXkpIHtcbiAgICAgICAgICAgIHRoaXMuZGVmYXVsdEhlYWRlcnNbXCJ4LWFwaS1rZXlcIl0gPSBhcGlLZXk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcHJlcGFyZUZldGNoT3B0aW9ucyhwYXRoLCBvcHRpb25zKSB7XG4gICAgICAgIGNvbnN0IG11dGF0ZWRPcHRpb25zID0ge1xuICAgICAgICAgICAgLi4ub3B0aW9ucyxcbiAgICAgICAgICAgIGhlYWRlcnM6IG1lcmdlSGVhZGVycyh0aGlzLmRlZmF1bHRIZWFkZXJzLCBvcHRpb25zPy5oZWFkZXJzKSxcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKG11dGF0ZWRPcHRpb25zLmpzb24pIHtcbiAgICAgICAgICAgIG11dGF0ZWRPcHRpb25zLmJvZHkgPSBKU09OLnN0cmluZ2lmeShtdXRhdGVkT3B0aW9ucy5qc29uKTtcbiAgICAgICAgICAgIG11dGF0ZWRPcHRpb25zLmhlYWRlcnMgPSBtZXJnZUhlYWRlcnMobXV0YXRlZE9wdGlvbnMuaGVhZGVycywge1xuICAgICAgICAgICAgICAgIFwiY29udGVudC10eXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBkZWxldGUgbXV0YXRlZE9wdGlvbnMuanNvbjtcbiAgICAgICAgfVxuICAgICAgICBpZiAobXV0YXRlZE9wdGlvbnMud2l0aFJlc3BvbnNlKSB7XG4gICAgICAgICAgICBkZWxldGUgbXV0YXRlZE9wdGlvbnMud2l0aFJlc3BvbnNlO1xuICAgICAgICB9XG4gICAgICAgIGxldCB0aW1lb3V0U2lnbmFsID0gbnVsbDtcbiAgICAgICAgaWYgKHR5cGVvZiBvcHRpb25zPy50aW1lb3V0TXMgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgICAgIGlmIChvcHRpb25zLnRpbWVvdXRNcyAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgdGltZW91dFNpZ25hbCA9IEFib3J0U2lnbmFsLnRpbWVvdXQob3B0aW9ucy50aW1lb3V0TXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHRoaXMudGltZW91dE1zICE9IG51bGwpIHtcbiAgICAgICAgICAgIHRpbWVvdXRTaWduYWwgPSBBYm9ydFNpZ25hbC50aW1lb3V0KHRoaXMudGltZW91dE1zKTtcbiAgICAgICAgfVxuICAgICAgICBtdXRhdGVkT3B0aW9ucy5zaWduYWwgPSBtZXJnZVNpZ25hbHModGltZW91dFNpZ25hbCwgbXV0YXRlZE9wdGlvbnMuc2lnbmFsKTtcbiAgICAgICAgY29uc3QgdGFyZ2V0VXJsID0gbmV3IFVSTChgJHt0aGlzLmFwaVVybH0ke3BhdGh9YCk7XG4gICAgICAgIGlmIChtdXRhdGVkT3B0aW9ucy5wYXJhbXMpIHtcbiAgICAgICAgICAgIGZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKG11dGF0ZWRPcHRpb25zLnBhcmFtcykpIHtcbiAgICAgICAgICAgICAgICBpZiAodmFsdWUgPT0gbnVsbClcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgY29uc3Qgc3RyVmFsdWUgPSB0eXBlb2YgdmFsdWUgPT09IFwic3RyaW5nXCIgfHwgdHlwZW9mIHZhbHVlID09PSBcIm51bWJlclwiXG4gICAgICAgICAgICAgICAgICAgID8gdmFsdWUudG9TdHJpbmcoKVxuICAgICAgICAgICAgICAgICAgICA6IEpTT04uc3RyaW5naWZ5KHZhbHVlKTtcbiAgICAgICAgICAgICAgICB0YXJnZXRVcmwuc2VhcmNoUGFyYW1zLmFwcGVuZChrZXksIHN0clZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGRlbGV0ZSBtdXRhdGVkT3B0aW9ucy5wYXJhbXM7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFt0YXJnZXRVcmwsIG11dGF0ZWRPcHRpb25zXTtcbiAgICB9XG4gICAgYXN5bmMgZmV0Y2gocGF0aCwgb3B0aW9ucykge1xuICAgICAgICBjb25zdCBbdXJsLCBpbml0XSA9IHRoaXMucHJlcGFyZUZldGNoT3B0aW9ucyhwYXRoLCBvcHRpb25zKTtcbiAgICAgICAgbGV0IGZpbmFsSW5pdCA9IGluaXQ7XG4gICAgICAgIGlmICh0aGlzLm9uUmVxdWVzdCkge1xuICAgICAgICAgICAgZmluYWxJbml0ID0gYXdhaXQgdGhpcy5vblJlcXVlc3QodXJsLCBpbml0KTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMuYXN5bmNDYWxsZXIuZmV0Y2godXJsLCBmaW5hbEluaXQpO1xuICAgICAgICBjb25zdCBib2R5ID0gKCgpID0+IHtcbiAgICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDIwMiB8fCByZXNwb25zZS5zdGF0dXMgPT09IDIwNCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UuanNvbigpO1xuICAgICAgICB9KSgpO1xuICAgICAgICBpZiAob3B0aW9ucz8ud2l0aFJlc3BvbnNlKSB7XG4gICAgICAgICAgICByZXR1cm4gW2F3YWl0IGJvZHksIHJlc3BvbnNlXTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYm9keTtcbiAgICB9XG59XG5leHBvcnQgY2xhc3MgQ3JvbnNDbGllbnQgZXh0ZW5kcyBCYXNlQ2xpZW50IHtcbiAgICAvKipcbiAgICAgKlxuICAgICAqIEBwYXJhbSB0aHJlYWRJZCBUaGUgSUQgb2YgdGhlIHRocmVhZC5cbiAgICAgKiBAcGFyYW0gYXNzaXN0YW50SWQgQXNzaXN0YW50IElEIHRvIHVzZSBmb3IgdGhpcyBjcm9uIGpvYi5cbiAgICAgKiBAcGFyYW0gcGF5bG9hZCBQYXlsb2FkIGZvciBjcmVhdGluZyBhIGNyb24gam9iLlxuICAgICAqIEByZXR1cm5zIFRoZSBjcmVhdGVkIGJhY2tncm91bmQgcnVuLlxuICAgICAqL1xuICAgIGFzeW5jIGNyZWF0ZUZvclRocmVhZCh0aHJlYWRJZCwgYXNzaXN0YW50SWQsIHBheWxvYWQpIHtcbiAgICAgICAgY29uc3QganNvbiA9IHtcbiAgICAgICAgICAgIHNjaGVkdWxlOiBwYXlsb2FkPy5zY2hlZHVsZSxcbiAgICAgICAgICAgIGlucHV0OiBwYXlsb2FkPy5pbnB1dCxcbiAgICAgICAgICAgIGNvbmZpZzogcGF5bG9hZD8uY29uZmlnLFxuICAgICAgICAgICAgY29udGV4dDogcGF5bG9hZD8uY29udGV4dCxcbiAgICAgICAgICAgIG1ldGFkYXRhOiBwYXlsb2FkPy5tZXRhZGF0YSxcbiAgICAgICAgICAgIGFzc2lzdGFudF9pZDogYXNzaXN0YW50SWQsXG4gICAgICAgICAgICBpbnRlcnJ1cHRfYmVmb3JlOiBwYXlsb2FkPy5pbnRlcnJ1cHRCZWZvcmUsXG4gICAgICAgICAgICBpbnRlcnJ1cHRfYWZ0ZXI6IHBheWxvYWQ/LmludGVycnVwdEFmdGVyLFxuICAgICAgICAgICAgd2ViaG9vazogcGF5bG9hZD8ud2ViaG9vayxcbiAgICAgICAgICAgIG11bHRpdGFza19zdHJhdGVneTogcGF5bG9hZD8ubXVsdGl0YXNrU3RyYXRlZ3ksXG4gICAgICAgICAgICBpZl9ub3RfZXhpc3RzOiBwYXlsb2FkPy5pZk5vdEV4aXN0cyxcbiAgICAgICAgICAgIGNoZWNrcG9pbnRfZHVyaW5nOiBwYXlsb2FkPy5jaGVja3BvaW50RHVyaW5nLFxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gdGhpcy5mZXRjaChgL3RocmVhZHMvJHt0aHJlYWRJZH0vcnVucy9jcm9uc2AsIHtcbiAgICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICAgICAgICBqc29uLFxuICAgICAgICB9KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICpcbiAgICAgKiBAcGFyYW0gYXNzaXN0YW50SWQgQXNzaXN0YW50IElEIHRvIHVzZSBmb3IgdGhpcyBjcm9uIGpvYi5cbiAgICAgKiBAcGFyYW0gcGF5bG9hZCBQYXlsb2FkIGZvciBjcmVhdGluZyBhIGNyb24gam9iLlxuICAgICAqIEByZXR1cm5zXG4gICAgICovXG4gICAgYXN5bmMgY3JlYXRlKGFzc2lzdGFudElkLCBwYXlsb2FkKSB7XG4gICAgICAgIGNvbnN0IGpzb24gPSB7XG4gICAgICAgICAgICBzY2hlZHVsZTogcGF5bG9hZD8uc2NoZWR1bGUsXG4gICAgICAgICAgICBpbnB1dDogcGF5bG9hZD8uaW5wdXQsXG4gICAgICAgICAgICBjb25maWc6IHBheWxvYWQ/LmNvbmZpZyxcbiAgICAgICAgICAgIGNvbnRleHQ6IHBheWxvYWQ/LmNvbnRleHQsXG4gICAgICAgICAgICBtZXRhZGF0YTogcGF5bG9hZD8ubWV0YWRhdGEsXG4gICAgICAgICAgICBhc3Npc3RhbnRfaWQ6IGFzc2lzdGFudElkLFxuICAgICAgICAgICAgaW50ZXJydXB0X2JlZm9yZTogcGF5bG9hZD8uaW50ZXJydXB0QmVmb3JlLFxuICAgICAgICAgICAgaW50ZXJydXB0X2FmdGVyOiBwYXlsb2FkPy5pbnRlcnJ1cHRBZnRlcixcbiAgICAgICAgICAgIHdlYmhvb2s6IHBheWxvYWQ/LndlYmhvb2ssXG4gICAgICAgICAgICBtdWx0aXRhc2tfc3RyYXRlZ3k6IHBheWxvYWQ/Lm11bHRpdGFza1N0cmF0ZWd5LFxuICAgICAgICAgICAgaWZfbm90X2V4aXN0czogcGF5bG9hZD8uaWZOb3RFeGlzdHMsXG4gICAgICAgICAgICBjaGVja3BvaW50X2R1cmluZzogcGF5bG9hZD8uY2hlY2twb2ludER1cmluZyxcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIHRoaXMuZmV0Y2goYC9ydW5zL2Nyb25zYCwge1xuICAgICAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgICAgICAgIGpzb24sXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKlxuICAgICAqIEBwYXJhbSBjcm9uSWQgQ3JvbiBJRCBvZiBDcm9uIGpvYiB0byBkZWxldGUuXG4gICAgICovXG4gICAgYXN5bmMgZGVsZXRlKGNyb25JZCkge1xuICAgICAgICBhd2FpdCB0aGlzLmZldGNoKGAvcnVucy9jcm9ucy8ke2Nyb25JZH1gLCB7XG4gICAgICAgICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKlxuICAgICAqIEBwYXJhbSBxdWVyeSBRdWVyeSBvcHRpb25zLlxuICAgICAqIEByZXR1cm5zIExpc3Qgb2YgY3JvbnMuXG4gICAgICovXG4gICAgYXN5bmMgc2VhcmNoKHF1ZXJ5KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmZldGNoKFwiL3J1bnMvY3JvbnMvc2VhcmNoXCIsIHtcbiAgICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICAgICAgICBqc29uOiB7XG4gICAgICAgICAgICAgICAgYXNzaXN0YW50X2lkOiBxdWVyeT8uYXNzaXN0YW50SWQgPz8gdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgIHRocmVhZF9pZDogcXVlcnk/LnRocmVhZElkID8/IHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICBsaW1pdDogcXVlcnk/LmxpbWl0ID8/IDEwLFxuICAgICAgICAgICAgICAgIG9mZnNldDogcXVlcnk/Lm9mZnNldCA/PyAwLFxuICAgICAgICAgICAgICAgIHNvcnRfYnk6IHF1ZXJ5Py5zb3J0QnkgPz8gdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgIHNvcnRfb3JkZXI6IHF1ZXJ5Py5zb3J0T3JkZXIgPz8gdW5kZWZpbmVkLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgfSk7XG4gICAgfVxufVxuZXhwb3J0IGNsYXNzIEFzc2lzdGFudHNDbGllbnQgZXh0ZW5kcyBCYXNlQ2xpZW50IHtcbiAgICAvKipcbiAgICAgKiBHZXQgYW4gYXNzaXN0YW50IGJ5IElELlxuICAgICAqXG4gICAgICogQHBhcmFtIGFzc2lzdGFudElkIFRoZSBJRCBvZiB0aGUgYXNzaXN0YW50LlxuICAgICAqIEByZXR1cm5zIEFzc2lzdGFudFxuICAgICAqL1xuICAgIGFzeW5jIGdldChhc3Npc3RhbnRJZCkge1xuICAgICAgICByZXR1cm4gdGhpcy5mZXRjaChgL2Fzc2lzdGFudHMvJHthc3Npc3RhbnRJZH1gKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0IHRoZSBKU09OIHJlcHJlc2VudGF0aW9uIG9mIHRoZSBncmFwaCBhc3NpZ25lZCB0byBhIHJ1bm5hYmxlXG4gICAgICogQHBhcmFtIGFzc2lzdGFudElkIFRoZSBJRCBvZiB0aGUgYXNzaXN0YW50LlxuICAgICAqIEBwYXJhbSBvcHRpb25zLnhyYXkgV2hldGhlciB0byBpbmNsdWRlIHN1YmdyYXBocyBpbiB0aGUgc2VyaWFsaXplZCBncmFwaCByZXByZXNlbnRhdGlvbi4gSWYgYW4gaW50ZWdlciB2YWx1ZSBpcyBwcm92aWRlZCwgb25seSBzdWJncmFwaHMgd2l0aCBhIGRlcHRoIGxlc3MgdGhhbiBvciBlcXVhbCB0byB0aGUgdmFsdWUgd2lsbCBiZSBpbmNsdWRlZC5cbiAgICAgKiBAcmV0dXJucyBTZXJpYWxpemVkIGdyYXBoXG4gICAgICovXG4gICAgYXN5bmMgZ2V0R3JhcGgoYXNzaXN0YW50SWQsIG9wdGlvbnMpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZmV0Y2goYC9hc3Npc3RhbnRzLyR7YXNzaXN0YW50SWR9L2dyYXBoYCwge1xuICAgICAgICAgICAgcGFyYW1zOiB7IHhyYXk6IG9wdGlvbnM/LnhyYXkgfSxcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdldCB0aGUgc3RhdGUgYW5kIGNvbmZpZyBzY2hlbWEgb2YgdGhlIGdyYXBoIGFzc2lnbmVkIHRvIGEgcnVubmFibGVcbiAgICAgKiBAcGFyYW0gYXNzaXN0YW50SWQgVGhlIElEIG9mIHRoZSBhc3Npc3RhbnQuXG4gICAgICogQHJldHVybnMgR3JhcGggc2NoZW1hXG4gICAgICovXG4gICAgYXN5bmMgZ2V0U2NoZW1hcyhhc3Npc3RhbnRJZCkge1xuICAgICAgICByZXR1cm4gdGhpcy5mZXRjaChgL2Fzc2lzdGFudHMvJHthc3Npc3RhbnRJZH0vc2NoZW1hc2ApO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXQgdGhlIHNjaGVtYXMgb2YgYW4gYXNzaXN0YW50IGJ5IElELlxuICAgICAqXG4gICAgICogQHBhcmFtIGFzc2lzdGFudElkIFRoZSBJRCBvZiB0aGUgYXNzaXN0YW50IHRvIGdldCB0aGUgc2NoZW1hIG9mLlxuICAgICAqIEBwYXJhbSBvcHRpb25zIEFkZGl0aW9uYWwgb3B0aW9ucyBmb3IgZ2V0dGluZyBzdWJncmFwaHMsIHN1Y2ggYXMgbmFtZXNwYWNlIG9yIHJlY3Vyc2lvbiBleHRyYWN0aW9uLlxuICAgICAqIEByZXR1cm5zIFRoZSBzdWJncmFwaHMgb2YgdGhlIGFzc2lzdGFudC5cbiAgICAgKi9cbiAgICBhc3luYyBnZXRTdWJncmFwaHMoYXNzaXN0YW50SWQsIG9wdGlvbnMpIHtcbiAgICAgICAgaWYgKG9wdGlvbnM/Lm5hbWVzcGFjZSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZmV0Y2goYC9hc3Npc3RhbnRzLyR7YXNzaXN0YW50SWR9L3N1YmdyYXBocy8ke29wdGlvbnMubmFtZXNwYWNlfWAsIHsgcGFyYW1zOiB7IHJlY3Vyc2U6IG9wdGlvbnM/LnJlY3Vyc2UgfSB9KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5mZXRjaChgL2Fzc2lzdGFudHMvJHthc3Npc3RhbnRJZH0vc3ViZ3JhcGhzYCwge1xuICAgICAgICAgICAgcGFyYW1zOiB7IHJlY3Vyc2U6IG9wdGlvbnM/LnJlY3Vyc2UgfSxcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZSBhIG5ldyBhc3Npc3RhbnQuXG4gICAgICogQHBhcmFtIHBheWxvYWQgUGF5bG9hZCBmb3IgY3JlYXRpbmcgYW4gYXNzaXN0YW50LlxuICAgICAqIEByZXR1cm5zIFRoZSBjcmVhdGVkIGFzc2lzdGFudC5cbiAgICAgKi9cbiAgICBhc3luYyBjcmVhdGUocGF5bG9hZCkge1xuICAgICAgICByZXR1cm4gdGhpcy5mZXRjaChcIi9hc3Npc3RhbnRzXCIsIHtcbiAgICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICAgICAgICBqc29uOiB7XG4gICAgICAgICAgICAgICAgZ3JhcGhfaWQ6IHBheWxvYWQuZ3JhcGhJZCxcbiAgICAgICAgICAgICAgICBjb25maWc6IHBheWxvYWQuY29uZmlnLFxuICAgICAgICAgICAgICAgIGNvbnRleHQ6IHBheWxvYWQuY29udGV4dCxcbiAgICAgICAgICAgICAgICBtZXRhZGF0YTogcGF5bG9hZC5tZXRhZGF0YSxcbiAgICAgICAgICAgICAgICBhc3Npc3RhbnRfaWQ6IHBheWxvYWQuYXNzaXN0YW50SWQsXG4gICAgICAgICAgICAgICAgaWZfZXhpc3RzOiBwYXlsb2FkLmlmRXhpc3RzLFxuICAgICAgICAgICAgICAgIG5hbWU6IHBheWxvYWQubmFtZSxcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogcGF5bG9hZC5kZXNjcmlwdGlvbixcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBVcGRhdGUgYW4gYXNzaXN0YW50LlxuICAgICAqIEBwYXJhbSBhc3Npc3RhbnRJZCBJRCBvZiB0aGUgYXNzaXN0YW50LlxuICAgICAqIEBwYXJhbSBwYXlsb2FkIFBheWxvYWQgZm9yIHVwZGF0aW5nIHRoZSBhc3Npc3RhbnQuXG4gICAgICogQHJldHVybnMgVGhlIHVwZGF0ZWQgYXNzaXN0YW50LlxuICAgICAqL1xuICAgIGFzeW5jIHVwZGF0ZShhc3Npc3RhbnRJZCwgcGF5bG9hZCkge1xuICAgICAgICByZXR1cm4gdGhpcy5mZXRjaChgL2Fzc2lzdGFudHMvJHthc3Npc3RhbnRJZH1gLCB7XG4gICAgICAgICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgICAgICAgIGpzb246IHtcbiAgICAgICAgICAgICAgICBncmFwaF9pZDogcGF5bG9hZC5ncmFwaElkLFxuICAgICAgICAgICAgICAgIGNvbmZpZzogcGF5bG9hZC5jb25maWcsXG4gICAgICAgICAgICAgICAgY29udGV4dDogcGF5bG9hZC5jb250ZXh0LFxuICAgICAgICAgICAgICAgIG1ldGFkYXRhOiBwYXlsb2FkLm1ldGFkYXRhLFxuICAgICAgICAgICAgICAgIG5hbWU6IHBheWxvYWQubmFtZSxcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogcGF5bG9hZC5kZXNjcmlwdGlvbixcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBEZWxldGUgYW4gYXNzaXN0YW50LlxuICAgICAqXG4gICAgICogQHBhcmFtIGFzc2lzdGFudElkIElEIG9mIHRoZSBhc3Npc3RhbnQuXG4gICAgICovXG4gICAgYXN5bmMgZGVsZXRlKGFzc2lzdGFudElkKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmZldGNoKGAvYXNzaXN0YW50cy8ke2Fzc2lzdGFudElkfWAsIHtcbiAgICAgICAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIExpc3QgYXNzaXN0YW50cy5cbiAgICAgKiBAcGFyYW0gcXVlcnkgUXVlcnkgb3B0aW9ucy5cbiAgICAgKiBAcmV0dXJucyBMaXN0IG9mIGFzc2lzdGFudHMuXG4gICAgICovXG4gICAgYXN5bmMgc2VhcmNoKHF1ZXJ5KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmZldGNoKFwiL2Fzc2lzdGFudHMvc2VhcmNoXCIsIHtcbiAgICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICAgICAgICBqc29uOiB7XG4gICAgICAgICAgICAgICAgZ3JhcGhfaWQ6IHF1ZXJ5Py5ncmFwaElkID8/IHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICBtZXRhZGF0YTogcXVlcnk/Lm1ldGFkYXRhID8/IHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICBsaW1pdDogcXVlcnk/LmxpbWl0ID8/IDEwLFxuICAgICAgICAgICAgICAgIG9mZnNldDogcXVlcnk/Lm9mZnNldCA/PyAwLFxuICAgICAgICAgICAgICAgIHNvcnRfYnk6IHF1ZXJ5Py5zb3J0QnkgPz8gdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgIHNvcnRfb3JkZXI6IHF1ZXJ5Py5zb3J0T3JkZXIgPz8gdW5kZWZpbmVkLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIExpc3QgYWxsIHZlcnNpb25zIG9mIGFuIGFzc2lzdGFudC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBhc3Npc3RhbnRJZCBJRCBvZiB0aGUgYXNzaXN0YW50LlxuICAgICAqIEByZXR1cm5zIExpc3Qgb2YgYXNzaXN0YW50IHZlcnNpb25zLlxuICAgICAqL1xuICAgIGFzeW5jIGdldFZlcnNpb25zKGFzc2lzdGFudElkLCBwYXlsb2FkKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmZldGNoKGAvYXNzaXN0YW50cy8ke2Fzc2lzdGFudElkfS92ZXJzaW9uc2AsIHtcbiAgICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICAgICAgICBqc29uOiB7XG4gICAgICAgICAgICAgICAgbWV0YWRhdGE6IHBheWxvYWQ/Lm1ldGFkYXRhID8/IHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICBsaW1pdDogcGF5bG9hZD8ubGltaXQgPz8gMTAsXG4gICAgICAgICAgICAgICAgb2Zmc2V0OiBwYXlsb2FkPy5vZmZzZXQgPz8gMCxcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDaGFuZ2UgdGhlIHZlcnNpb24gb2YgYW4gYXNzaXN0YW50LlxuICAgICAqXG4gICAgICogQHBhcmFtIGFzc2lzdGFudElkIElEIG9mIHRoZSBhc3Npc3RhbnQuXG4gICAgICogQHBhcmFtIHZlcnNpb24gVGhlIHZlcnNpb24gdG8gY2hhbmdlIHRvLlxuICAgICAqIEByZXR1cm5zIFRoZSB1cGRhdGVkIGFzc2lzdGFudC5cbiAgICAgKi9cbiAgICBhc3luYyBzZXRMYXRlc3QoYXNzaXN0YW50SWQsIHZlcnNpb24pIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZmV0Y2goYC9hc3Npc3RhbnRzLyR7YXNzaXN0YW50SWR9L2xhdGVzdGAsIHtcbiAgICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICAgICAgICBqc29uOiB7IHZlcnNpb24gfSxcbiAgICAgICAgfSk7XG4gICAgfVxufVxuZXhwb3J0IGNsYXNzIFRocmVhZHNDbGllbnQgZXh0ZW5kcyBCYXNlQ2xpZW50IHtcbiAgICAvKipcbiAgICAgKiBHZXQgYSB0aHJlYWQgYnkgSUQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gdGhyZWFkSWQgSUQgb2YgdGhlIHRocmVhZC5cbiAgICAgKiBAcmV0dXJucyBUaGUgdGhyZWFkLlxuICAgICAqL1xuICAgIGFzeW5jIGdldCh0aHJlYWRJZCkge1xuICAgICAgICByZXR1cm4gdGhpcy5mZXRjaChgL3RocmVhZHMvJHt0aHJlYWRJZH1gKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlIGEgbmV3IHRocmVhZC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBwYXlsb2FkIFBheWxvYWQgZm9yIGNyZWF0aW5nIGEgdGhyZWFkLlxuICAgICAqIEByZXR1cm5zIFRoZSBjcmVhdGVkIHRocmVhZC5cbiAgICAgKi9cbiAgICBhc3luYyBjcmVhdGUocGF5bG9hZCkge1xuICAgICAgICByZXR1cm4gdGhpcy5mZXRjaChgL3RocmVhZHNgLCB7XG4gICAgICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgICAgICAganNvbjoge1xuICAgICAgICAgICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgICAgICAgICAgIC4uLnBheWxvYWQ/Lm1ldGFkYXRhLFxuICAgICAgICAgICAgICAgICAgICBncmFwaF9pZDogcGF5bG9hZD8uZ3JhcGhJZCxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHRocmVhZF9pZDogcGF5bG9hZD8udGhyZWFkSWQsXG4gICAgICAgICAgICAgICAgaWZfZXhpc3RzOiBwYXlsb2FkPy5pZkV4aXN0cyxcbiAgICAgICAgICAgICAgICBzdXBlcnN0ZXBzOiBwYXlsb2FkPy5zdXBlcnN0ZXBzPy5tYXAoKHMpID0+ICh7XG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZXM6IHMudXBkYXRlcy5tYXAoKHUpID0+ICh7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZXM6IHUudmFsdWVzLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29tbWFuZDogdS5jb21tYW5kLFxuICAgICAgICAgICAgICAgICAgICAgICAgYXNfbm9kZTogdS5hc05vZGUsXG4gICAgICAgICAgICAgICAgICAgIH0pKSxcbiAgICAgICAgICAgICAgICB9KSksXG4gICAgICAgICAgICB9LFxuICAgICAgICB9KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ29weSBhbiBleGlzdGluZyB0aHJlYWRcbiAgICAgKiBAcGFyYW0gdGhyZWFkSWQgSUQgb2YgdGhlIHRocmVhZCB0byBiZSBjb3BpZWRcbiAgICAgKiBAcmV0dXJucyBOZXdseSBjb3BpZWQgdGhyZWFkXG4gICAgICovXG4gICAgYXN5bmMgY29weSh0aHJlYWRJZCkge1xuICAgICAgICByZXR1cm4gdGhpcy5mZXRjaChgL3RocmVhZHMvJHt0aHJlYWRJZH0vY29weWAsIHtcbiAgICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBVcGRhdGUgYSB0aHJlYWQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gdGhyZWFkSWQgSUQgb2YgdGhlIHRocmVhZC5cbiAgICAgKiBAcGFyYW0gcGF5bG9hZCBQYXlsb2FkIGZvciB1cGRhdGluZyB0aGUgdGhyZWFkLlxuICAgICAqIEByZXR1cm5zIFRoZSB1cGRhdGVkIHRocmVhZC5cbiAgICAgKi9cbiAgICBhc3luYyB1cGRhdGUodGhyZWFkSWQsIHBheWxvYWQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZmV0Y2goYC90aHJlYWRzLyR7dGhyZWFkSWR9YCwge1xuICAgICAgICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICAgICAgICBqc29uOiB7IG1ldGFkYXRhOiBwYXlsb2FkPy5tZXRhZGF0YSB9LFxuICAgICAgICB9KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogRGVsZXRlIGEgdGhyZWFkLlxuICAgICAqXG4gICAgICogQHBhcmFtIHRocmVhZElkIElEIG9mIHRoZSB0aHJlYWQuXG4gICAgICovXG4gICAgYXN5bmMgZGVsZXRlKHRocmVhZElkKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmZldGNoKGAvdGhyZWFkcy8ke3RocmVhZElkfWAsIHtcbiAgICAgICAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIExpc3QgdGhyZWFkc1xuICAgICAqXG4gICAgICogQHBhcmFtIHF1ZXJ5IFF1ZXJ5IG9wdGlvbnNcbiAgICAgKiBAcmV0dXJucyBMaXN0IG9mIHRocmVhZHNcbiAgICAgKi9cbiAgICBhc3luYyBzZWFyY2gocXVlcnkpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZmV0Y2goXCIvdGhyZWFkcy9zZWFyY2hcIiwge1xuICAgICAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgICAgICAgIGpzb246IHtcbiAgICAgICAgICAgICAgICBtZXRhZGF0YTogcXVlcnk/Lm1ldGFkYXRhID8/IHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICBsaW1pdDogcXVlcnk/LmxpbWl0ID8/IDEwLFxuICAgICAgICAgICAgICAgIG9mZnNldDogcXVlcnk/Lm9mZnNldCA/PyAwLFxuICAgICAgICAgICAgICAgIHN0YXR1czogcXVlcnk/LnN0YXR1cyxcbiAgICAgICAgICAgICAgICBzb3J0X2J5OiBxdWVyeT8uc29ydEJ5LFxuICAgICAgICAgICAgICAgIHNvcnRfb3JkZXI6IHF1ZXJ5Py5zb3J0T3JkZXIsXG4gICAgICAgICAgICB9LFxuICAgICAgICB9KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0IHN0YXRlIGZvciBhIHRocmVhZC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB0aHJlYWRJZCBJRCBvZiB0aGUgdGhyZWFkLlxuICAgICAqIEByZXR1cm5zIFRocmVhZCBzdGF0ZS5cbiAgICAgKi9cbiAgICBhc3luYyBnZXRTdGF0ZSh0aHJlYWRJZCwgY2hlY2twb2ludCwgb3B0aW9ucykge1xuICAgICAgICBpZiAoY2hlY2twb2ludCAhPSBudWxsKSB7XG4gICAgICAgICAgICBpZiAodHlwZW9mIGNoZWNrcG9pbnQgIT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5mZXRjaChgL3RocmVhZHMvJHt0aHJlYWRJZH0vc3RhdGUvY2hlY2twb2ludGAsIHtcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgICAgICAgICAgICAgICAganNvbjogeyBjaGVja3BvaW50LCBzdWJncmFwaHM6IG9wdGlvbnM/LnN1YmdyYXBocyB9LFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gZGVwcmVjYXRlZFxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZmV0Y2goYC90aHJlYWRzLyR7dGhyZWFkSWR9L3N0YXRlLyR7Y2hlY2twb2ludH1gLCB7IHBhcmFtczogeyBzdWJncmFwaHM6IG9wdGlvbnM/LnN1YmdyYXBocyB9IH0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLmZldGNoKGAvdGhyZWFkcy8ke3RocmVhZElkfS9zdGF0ZWAsIHtcbiAgICAgICAgICAgIHBhcmFtczogeyBzdWJncmFwaHM6IG9wdGlvbnM/LnN1YmdyYXBocyB9LFxuICAgICAgICB9KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQWRkIHN0YXRlIHRvIGEgdGhyZWFkLlxuICAgICAqXG4gICAgICogQHBhcmFtIHRocmVhZElkIFRoZSBJRCBvZiB0aGUgdGhyZWFkLlxuICAgICAqIEByZXR1cm5zXG4gICAgICovXG4gICAgYXN5bmMgdXBkYXRlU3RhdGUodGhyZWFkSWQsIG9wdGlvbnMpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZmV0Y2goYC90aHJlYWRzLyR7dGhyZWFkSWR9L3N0YXRlYCwge1xuICAgICAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgICAgICAgIGpzb246IHtcbiAgICAgICAgICAgICAgICB2YWx1ZXM6IG9wdGlvbnMudmFsdWVzLFxuICAgICAgICAgICAgICAgIGNoZWNrcG9pbnRfaWQ6IG9wdGlvbnMuY2hlY2twb2ludElkLFxuICAgICAgICAgICAgICAgIGNoZWNrcG9pbnQ6IG9wdGlvbnMuY2hlY2twb2ludCxcbiAgICAgICAgICAgICAgICBhc19ub2RlOiBvcHRpb25zPy5hc05vZGUsXG4gICAgICAgICAgICB9LFxuICAgICAgICB9KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUGF0Y2ggdGhlIG1ldGFkYXRhIG9mIGEgdGhyZWFkLlxuICAgICAqXG4gICAgICogQHBhcmFtIHRocmVhZElkT3JDb25maWcgVGhyZWFkIElEIG9yIGNvbmZpZyB0byBwYXRjaCB0aGUgc3RhdGUgb2YuXG4gICAgICogQHBhcmFtIG1ldGFkYXRhIE1ldGFkYXRhIHRvIHBhdGNoIHRoZSBzdGF0ZSB3aXRoLlxuICAgICAqL1xuICAgIGFzeW5jIHBhdGNoU3RhdGUodGhyZWFkSWRPckNvbmZpZywgbWV0YWRhdGEpIHtcbiAgICAgICAgbGV0IHRocmVhZElkO1xuICAgICAgICBpZiAodHlwZW9mIHRocmVhZElkT3JDb25maWcgIT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgdGhyZWFkSWRPckNvbmZpZy5jb25maWd1cmFibGU/LnRocmVhZF9pZCAhPT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlRocmVhZCBJRCBpcyByZXF1aXJlZCB3aGVuIHVwZGF0aW5nIHN0YXRlIHdpdGggYSBjb25maWcuXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhyZWFkSWQgPSB0aHJlYWRJZE9yQ29uZmlnLmNvbmZpZ3VyYWJsZS50aHJlYWRfaWQ7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aHJlYWRJZCA9IHRocmVhZElkT3JDb25maWc7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuZmV0Y2goYC90aHJlYWRzLyR7dGhyZWFkSWR9L3N0YXRlYCwge1xuICAgICAgICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICAgICAgICBqc29uOiB7IG1ldGFkYXRhIH0sXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXQgYWxsIHBhc3Qgc3RhdGVzIGZvciBhIHRocmVhZC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB0aHJlYWRJZCBJRCBvZiB0aGUgdGhyZWFkLlxuICAgICAqIEBwYXJhbSBvcHRpb25zIEFkZGl0aW9uYWwgb3B0aW9ucy5cbiAgICAgKiBAcmV0dXJucyBMaXN0IG9mIHRocmVhZCBzdGF0ZXMuXG4gICAgICovXG4gICAgYXN5bmMgZ2V0SGlzdG9yeSh0aHJlYWRJZCwgb3B0aW9ucykge1xuICAgICAgICByZXR1cm4gdGhpcy5mZXRjaChgL3RocmVhZHMvJHt0aHJlYWRJZH0vaGlzdG9yeWAsIHtcbiAgICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICAgICAgICBqc29uOiB7XG4gICAgICAgICAgICAgICAgbGltaXQ6IG9wdGlvbnM/LmxpbWl0ID8/IDEwLFxuICAgICAgICAgICAgICAgIGJlZm9yZTogb3B0aW9ucz8uYmVmb3JlLFxuICAgICAgICAgICAgICAgIG1ldGFkYXRhOiBvcHRpb25zPy5tZXRhZGF0YSxcbiAgICAgICAgICAgICAgICBjaGVja3BvaW50OiBvcHRpb25zPy5jaGVja3BvaW50LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgfSk7XG4gICAgfVxufVxuZXhwb3J0IGNsYXNzIFJ1bnNDbGllbnQgZXh0ZW5kcyBCYXNlQ2xpZW50IHtcbiAgICAvKipcbiAgICAgKiBDcmVhdGUgYSBydW4gYW5kIHN0cmVhbSB0aGUgcmVzdWx0cy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB0aHJlYWRJZCBUaGUgSUQgb2YgdGhlIHRocmVhZC5cbiAgICAgKiBAcGFyYW0gYXNzaXN0YW50SWQgQXNzaXN0YW50IElEIHRvIHVzZSBmb3IgdGhpcyBydW4uXG4gICAgICogQHBhcmFtIHBheWxvYWQgUGF5bG9hZCBmb3IgY3JlYXRpbmcgYSBydW4uXG4gICAgICovXG4gICAgYXN5bmMgKnN0cmVhbSh0aHJlYWRJZCwgYXNzaXN0YW50SWQsIHBheWxvYWQpIHtcbiAgICAgICAgY29uc3QganNvbiA9IHtcbiAgICAgICAgICAgIGlucHV0OiBwYXlsb2FkPy5pbnB1dCxcbiAgICAgICAgICAgIGNvbW1hbmQ6IHBheWxvYWQ/LmNvbW1hbmQsXG4gICAgICAgICAgICBjb25maWc6IHBheWxvYWQ/LmNvbmZpZyxcbiAgICAgICAgICAgIGNvbnRleHQ6IHBheWxvYWQ/LmNvbnRleHQsXG4gICAgICAgICAgICBtZXRhZGF0YTogcGF5bG9hZD8ubWV0YWRhdGEsXG4gICAgICAgICAgICBzdHJlYW1fbW9kZTogcGF5bG9hZD8uc3RyZWFtTW9kZSxcbiAgICAgICAgICAgIHN0cmVhbV9zdWJncmFwaHM6IHBheWxvYWQ/LnN0cmVhbVN1YmdyYXBocyxcbiAgICAgICAgICAgIHN0cmVhbV9yZXN1bWFibGU6IHBheWxvYWQ/LnN0cmVhbVJlc3VtYWJsZSxcbiAgICAgICAgICAgIGZlZWRiYWNrX2tleXM6IHBheWxvYWQ/LmZlZWRiYWNrS2V5cyxcbiAgICAgICAgICAgIGFzc2lzdGFudF9pZDogYXNzaXN0YW50SWQsXG4gICAgICAgICAgICBpbnRlcnJ1cHRfYmVmb3JlOiBwYXlsb2FkPy5pbnRlcnJ1cHRCZWZvcmUsXG4gICAgICAgICAgICBpbnRlcnJ1cHRfYWZ0ZXI6IHBheWxvYWQ/LmludGVycnVwdEFmdGVyLFxuICAgICAgICAgICAgY2hlY2twb2ludDogcGF5bG9hZD8uY2hlY2twb2ludCxcbiAgICAgICAgICAgIGNoZWNrcG9pbnRfaWQ6IHBheWxvYWQ/LmNoZWNrcG9pbnRJZCxcbiAgICAgICAgICAgIHdlYmhvb2s6IHBheWxvYWQ/LndlYmhvb2ssXG4gICAgICAgICAgICBtdWx0aXRhc2tfc3RyYXRlZ3k6IHBheWxvYWQ/Lm11bHRpdGFza1N0cmF0ZWd5LFxuICAgICAgICAgICAgb25fY29tcGxldGlvbjogcGF5bG9hZD8ub25Db21wbGV0aW9uLFxuICAgICAgICAgICAgb25fZGlzY29ubmVjdDogcGF5bG9hZD8ub25EaXNjb25uZWN0LFxuICAgICAgICAgICAgYWZ0ZXJfc2Vjb25kczogcGF5bG9hZD8uYWZ0ZXJTZWNvbmRzLFxuICAgICAgICAgICAgaWZfbm90X2V4aXN0czogcGF5bG9hZD8uaWZOb3RFeGlzdHMsXG4gICAgICAgICAgICBjaGVja3BvaW50X2R1cmluZzogcGF5bG9hZD8uY2hlY2twb2ludER1cmluZyxcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3QgZW5kcG9pbnQgPSB0aHJlYWRJZCA9PSBudWxsID8gYC9ydW5zL3N0cmVhbWAgOiBgL3RocmVhZHMvJHt0aHJlYWRJZH0vcnVucy9zdHJlYW1gO1xuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMuYXN5bmNDYWxsZXIuZmV0Y2goLi4udGhpcy5wcmVwYXJlRmV0Y2hPcHRpb25zKGVuZHBvaW50LCB7XG4gICAgICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgICAgICAganNvbixcbiAgICAgICAgICAgIHRpbWVvdXRNczogbnVsbCxcbiAgICAgICAgICAgIHNpZ25hbDogcGF5bG9hZD8uc2lnbmFsLFxuICAgICAgICB9KSk7XG4gICAgICAgIGNvbnN0IHJ1bk1ldGFkYXRhID0gZ2V0UnVuTWV0YWRhdGFGcm9tUmVzcG9uc2UocmVzcG9uc2UpO1xuICAgICAgICBpZiAocnVuTWV0YWRhdGEpXG4gICAgICAgICAgICBwYXlsb2FkPy5vblJ1bkNyZWF0ZWQ/LihydW5NZXRhZGF0YSk7XG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgIGNvbnN0IHN0cmVhbSA9IChyZXNwb25zZS5ib2R5IHx8IG5ldyBSZWFkYWJsZVN0cmVhbSh7IHN0YXJ0OiAoY3RybCkgPT4gY3RybC5jbG9zZSgpIH0pKVxuICAgICAgICAgICAgLnBpcGVUaHJvdWdoKEJ5dGVzTGluZURlY29kZXIoKSlcbiAgICAgICAgICAgIC5waXBlVGhyb3VnaChTU0VEZWNvZGVyKCkpO1xuICAgICAgICB5aWVsZCogSXRlcmFibGVSZWFkYWJsZVN0cmVhbS5mcm9tUmVhZGFibGVTdHJlYW0oc3RyZWFtKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlIGEgcnVuLlxuICAgICAqXG4gICAgICogQHBhcmFtIHRocmVhZElkIFRoZSBJRCBvZiB0aGUgdGhyZWFkLlxuICAgICAqIEBwYXJhbSBhc3Npc3RhbnRJZCBBc3Npc3RhbnQgSUQgdG8gdXNlIGZvciB0aGlzIHJ1bi5cbiAgICAgKiBAcGFyYW0gcGF5bG9hZCBQYXlsb2FkIGZvciBjcmVhdGluZyBhIHJ1bi5cbiAgICAgKiBAcmV0dXJucyBUaGUgY3JlYXRlZCBydW4uXG4gICAgICovXG4gICAgYXN5bmMgY3JlYXRlKHRocmVhZElkLCBhc3Npc3RhbnRJZCwgcGF5bG9hZCkge1xuICAgICAgICBjb25zdCBqc29uID0ge1xuICAgICAgICAgICAgaW5wdXQ6IHBheWxvYWQ/LmlucHV0LFxuICAgICAgICAgICAgY29tbWFuZDogcGF5bG9hZD8uY29tbWFuZCxcbiAgICAgICAgICAgIGNvbmZpZzogcGF5bG9hZD8uY29uZmlnLFxuICAgICAgICAgICAgY29udGV4dDogcGF5bG9hZD8uY29udGV4dCxcbiAgICAgICAgICAgIG1ldGFkYXRhOiBwYXlsb2FkPy5tZXRhZGF0YSxcbiAgICAgICAgICAgIHN0cmVhbV9tb2RlOiBwYXlsb2FkPy5zdHJlYW1Nb2RlLFxuICAgICAgICAgICAgc3RyZWFtX3N1YmdyYXBoczogcGF5bG9hZD8uc3RyZWFtU3ViZ3JhcGhzLFxuICAgICAgICAgICAgc3RyZWFtX3Jlc3VtYWJsZTogcGF5bG9hZD8uc3RyZWFtUmVzdW1hYmxlLFxuICAgICAgICAgICAgYXNzaXN0YW50X2lkOiBhc3Npc3RhbnRJZCxcbiAgICAgICAgICAgIGludGVycnVwdF9iZWZvcmU6IHBheWxvYWQ/LmludGVycnVwdEJlZm9yZSxcbiAgICAgICAgICAgIGludGVycnVwdF9hZnRlcjogcGF5bG9hZD8uaW50ZXJydXB0QWZ0ZXIsXG4gICAgICAgICAgICB3ZWJob29rOiBwYXlsb2FkPy53ZWJob29rLFxuICAgICAgICAgICAgY2hlY2twb2ludDogcGF5bG9hZD8uY2hlY2twb2ludCxcbiAgICAgICAgICAgIGNoZWNrcG9pbnRfaWQ6IHBheWxvYWQ/LmNoZWNrcG9pbnRJZCxcbiAgICAgICAgICAgIG11bHRpdGFza19zdHJhdGVneTogcGF5bG9hZD8ubXVsdGl0YXNrU3RyYXRlZ3ksXG4gICAgICAgICAgICBhZnRlcl9zZWNvbmRzOiBwYXlsb2FkPy5hZnRlclNlY29uZHMsXG4gICAgICAgICAgICBpZl9ub3RfZXhpc3RzOiBwYXlsb2FkPy5pZk5vdEV4aXN0cyxcbiAgICAgICAgICAgIGNoZWNrcG9pbnRfZHVyaW5nOiBwYXlsb2FkPy5jaGVja3BvaW50RHVyaW5nLFxuICAgICAgICAgICAgbGFuZ3NtaXRoX3RyYWNlcjogcGF5bG9hZD8uX2xhbmdzbWl0aFRyYWNlclxuICAgICAgICAgICAgICAgID8ge1xuICAgICAgICAgICAgICAgICAgICBwcm9qZWN0X25hbWU6IHBheWxvYWQ/Ll9sYW5nc21pdGhUcmFjZXI/LnByb2plY3ROYW1lLFxuICAgICAgICAgICAgICAgICAgICBleGFtcGxlX2lkOiBwYXlsb2FkPy5fbGFuZ3NtaXRoVHJhY2VyPy5leGFtcGxlSWQsXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIDogdW5kZWZpbmVkLFxuICAgICAgICB9O1xuICAgICAgICBjb25zdCBbcnVuLCByZXNwb25zZV0gPSBhd2FpdCB0aGlzLmZldGNoKGAvdGhyZWFkcy8ke3RocmVhZElkfS9ydW5zYCwge1xuICAgICAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgICAgICAgIGpzb24sXG4gICAgICAgICAgICBzaWduYWw6IHBheWxvYWQ/LnNpZ25hbCxcbiAgICAgICAgICAgIHdpdGhSZXNwb25zZTogdHJ1ZSxcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IHJ1bk1ldGFkYXRhID0gZ2V0UnVuTWV0YWRhdGFGcm9tUmVzcG9uc2UocmVzcG9uc2UpO1xuICAgICAgICBpZiAocnVuTWV0YWRhdGEpXG4gICAgICAgICAgICBwYXlsb2FkPy5vblJ1bkNyZWF0ZWQ/LihydW5NZXRhZGF0YSk7XG4gICAgICAgIHJldHVybiBydW47XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZSBhIGJhdGNoIG9mIHN0YXRlbGVzcyBiYWNrZ3JvdW5kIHJ1bnMuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gcGF5bG9hZHMgQW4gYXJyYXkgb2YgcGF5bG9hZHMgZm9yIGNyZWF0aW5nIHJ1bnMuXG4gICAgICogQHJldHVybnMgQW4gYXJyYXkgb2YgY3JlYXRlZCBydW5zLlxuICAgICAqL1xuICAgIGFzeW5jIGNyZWF0ZUJhdGNoKHBheWxvYWRzKSB7XG4gICAgICAgIGNvbnN0IGZpbHRlcmVkUGF5bG9hZHMgPSBwYXlsb2Fkc1xuICAgICAgICAgICAgLm1hcCgocGF5bG9hZCkgPT4gKHsgLi4ucGF5bG9hZCwgYXNzaXN0YW50X2lkOiBwYXlsb2FkLmFzc2lzdGFudElkIH0pKVxuICAgICAgICAgICAgLm1hcCgocGF5bG9hZCkgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIE9iamVjdC5mcm9tRW50cmllcyhPYmplY3QuZW50cmllcyhwYXlsb2FkKS5maWx0ZXIoKFtfLCB2XSkgPT4gdiAhPT0gdW5kZWZpbmVkKSk7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gdGhpcy5mZXRjaChcIi9ydW5zL2JhdGNoXCIsIHtcbiAgICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICAgICAgICBqc29uOiBmaWx0ZXJlZFBheWxvYWRzLFxuICAgICAgICB9KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlIGEgcnVuIGFuZCB3YWl0IGZvciBpdCB0byBjb21wbGV0ZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB0aHJlYWRJZCBUaGUgSUQgb2YgdGhlIHRocmVhZC5cbiAgICAgKiBAcGFyYW0gYXNzaXN0YW50SWQgQXNzaXN0YW50IElEIHRvIHVzZSBmb3IgdGhpcyBydW4uXG4gICAgICogQHBhcmFtIHBheWxvYWQgUGF5bG9hZCBmb3IgY3JlYXRpbmcgYSBydW4uXG4gICAgICogQHJldHVybnMgVGhlIGxhc3QgdmFsdWVzIGNodW5rIG9mIHRoZSB0aHJlYWQuXG4gICAgICovXG4gICAgYXN5bmMgd2FpdCh0aHJlYWRJZCwgYXNzaXN0YW50SWQsIHBheWxvYWQpIHtcbiAgICAgICAgY29uc3QganNvbiA9IHtcbiAgICAgICAgICAgIGlucHV0OiBwYXlsb2FkPy5pbnB1dCxcbiAgICAgICAgICAgIGNvbW1hbmQ6IHBheWxvYWQ/LmNvbW1hbmQsXG4gICAgICAgICAgICBjb25maWc6IHBheWxvYWQ/LmNvbmZpZyxcbiAgICAgICAgICAgIGNvbnRleHQ6IHBheWxvYWQ/LmNvbnRleHQsXG4gICAgICAgICAgICBtZXRhZGF0YTogcGF5bG9hZD8ubWV0YWRhdGEsXG4gICAgICAgICAgICBhc3Npc3RhbnRfaWQ6IGFzc2lzdGFudElkLFxuICAgICAgICAgICAgaW50ZXJydXB0X2JlZm9yZTogcGF5bG9hZD8uaW50ZXJydXB0QmVmb3JlLFxuICAgICAgICAgICAgaW50ZXJydXB0X2FmdGVyOiBwYXlsb2FkPy5pbnRlcnJ1cHRBZnRlcixcbiAgICAgICAgICAgIGNoZWNrcG9pbnQ6IHBheWxvYWQ/LmNoZWNrcG9pbnQsXG4gICAgICAgICAgICBjaGVja3BvaW50X2lkOiBwYXlsb2FkPy5jaGVja3BvaW50SWQsXG4gICAgICAgICAgICB3ZWJob29rOiBwYXlsb2FkPy53ZWJob29rLFxuICAgICAgICAgICAgbXVsdGl0YXNrX3N0cmF0ZWd5OiBwYXlsb2FkPy5tdWx0aXRhc2tTdHJhdGVneSxcbiAgICAgICAgICAgIG9uX2NvbXBsZXRpb246IHBheWxvYWQ/Lm9uQ29tcGxldGlvbixcbiAgICAgICAgICAgIG9uX2Rpc2Nvbm5lY3Q6IHBheWxvYWQ/Lm9uRGlzY29ubmVjdCxcbiAgICAgICAgICAgIGFmdGVyX3NlY29uZHM6IHBheWxvYWQ/LmFmdGVyU2Vjb25kcyxcbiAgICAgICAgICAgIGlmX25vdF9leGlzdHM6IHBheWxvYWQ/LmlmTm90RXhpc3RzLFxuICAgICAgICAgICAgY2hlY2twb2ludF9kdXJpbmc6IHBheWxvYWQ/LmNoZWNrcG9pbnREdXJpbmcsXG4gICAgICAgICAgICBsYW5nc21pdGhfdHJhY2VyOiBwYXlsb2FkPy5fbGFuZ3NtaXRoVHJhY2VyXG4gICAgICAgICAgICAgICAgPyB7XG4gICAgICAgICAgICAgICAgICAgIHByb2plY3RfbmFtZTogcGF5bG9hZD8uX2xhbmdzbWl0aFRyYWNlcj8ucHJvamVjdE5hbWUsXG4gICAgICAgICAgICAgICAgICAgIGV4YW1wbGVfaWQ6IHBheWxvYWQ/Ll9sYW5nc21pdGhUcmFjZXI/LmV4YW1wbGVJZCxcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgOiB1bmRlZmluZWQsXG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IGVuZHBvaW50ID0gdGhyZWFkSWQgPT0gbnVsbCA/IGAvcnVucy93YWl0YCA6IGAvdGhyZWFkcy8ke3RocmVhZElkfS9ydW5zL3dhaXRgO1xuICAgICAgICBjb25zdCBbcnVuLCByZXNwb25zZV0gPSBhd2FpdCB0aGlzLmZldGNoKGVuZHBvaW50LCB7XG4gICAgICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgICAgICAganNvbixcbiAgICAgICAgICAgIHRpbWVvdXRNczogbnVsbCxcbiAgICAgICAgICAgIHNpZ25hbDogcGF5bG9hZD8uc2lnbmFsLFxuICAgICAgICAgICAgd2l0aFJlc3BvbnNlOiB0cnVlLFxuICAgICAgICB9KTtcbiAgICAgICAgY29uc3QgcnVuTWV0YWRhdGEgPSBnZXRSdW5NZXRhZGF0YUZyb21SZXNwb25zZShyZXNwb25zZSk7XG4gICAgICAgIGlmIChydW5NZXRhZGF0YSlcbiAgICAgICAgICAgIHBheWxvYWQ/Lm9uUnVuQ3JlYXRlZD8uKHJ1bk1ldGFkYXRhKTtcbiAgICAgICAgY29uc3QgcmFpc2VFcnJvciA9IHBheWxvYWQ/LnJhaXNlRXJyb3IgIT09IHVuZGVmaW5lZCA/IHBheWxvYWQucmFpc2VFcnJvciA6IHRydWU7XG4gICAgICAgIGlmIChyYWlzZUVycm9yICYmXG4gICAgICAgICAgICBcIl9fZXJyb3JfX1wiIGluIHJ1biAmJlxuICAgICAgICAgICAgdHlwZW9mIHJ1bi5fX2Vycm9yX18gPT09IFwib2JqZWN0XCIgJiZcbiAgICAgICAgICAgIHJ1bi5fX2Vycm9yX18gJiZcbiAgICAgICAgICAgIFwiZXJyb3JcIiBpbiBydW4uX19lcnJvcl9fICYmXG4gICAgICAgICAgICBcIm1lc3NhZ2VcIiBpbiBydW4uX19lcnJvcl9fKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYCR7cnVuLl9fZXJyb3JfXz8uZXJyb3J9OiAke3J1bi5fX2Vycm9yX18/Lm1lc3NhZ2V9YCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJ1bjtcbiAgICB9XG4gICAgLyoqXG4gICAgICogTGlzdCBhbGwgcnVucyBmb3IgYSB0aHJlYWQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gdGhyZWFkSWQgVGhlIElEIG9mIHRoZSB0aHJlYWQuXG4gICAgICogQHBhcmFtIG9wdGlvbnMgRmlsdGVyaW5nIGFuZCBwYWdpbmF0aW9uIG9wdGlvbnMuXG4gICAgICogQHJldHVybnMgTGlzdCBvZiBydW5zLlxuICAgICAqL1xuICAgIGFzeW5jIGxpc3QodGhyZWFkSWQsIG9wdGlvbnMpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZmV0Y2goYC90aHJlYWRzLyR7dGhyZWFkSWR9L3J1bnNgLCB7XG4gICAgICAgICAgICBwYXJhbXM6IHtcbiAgICAgICAgICAgICAgICBsaW1pdDogb3B0aW9ucz8ubGltaXQgPz8gMTAsXG4gICAgICAgICAgICAgICAgb2Zmc2V0OiBvcHRpb25zPy5vZmZzZXQgPz8gMCxcbiAgICAgICAgICAgICAgICBzdGF0dXM6IG9wdGlvbnM/LnN0YXR1cyA/PyB1bmRlZmluZWQsXG4gICAgICAgICAgICB9LFxuICAgICAgICB9KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0IGEgcnVuIGJ5IElELlxuICAgICAqXG4gICAgICogQHBhcmFtIHRocmVhZElkIFRoZSBJRCBvZiB0aGUgdGhyZWFkLlxuICAgICAqIEBwYXJhbSBydW5JZCBUaGUgSUQgb2YgdGhlIHJ1bi5cbiAgICAgKiBAcmV0dXJucyBUaGUgcnVuLlxuICAgICAqL1xuICAgIGFzeW5jIGdldCh0aHJlYWRJZCwgcnVuSWQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZmV0Y2goYC90aHJlYWRzLyR7dGhyZWFkSWR9L3J1bnMvJHtydW5JZH1gKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2FuY2VsIGEgcnVuLlxuICAgICAqXG4gICAgICogQHBhcmFtIHRocmVhZElkIFRoZSBJRCBvZiB0aGUgdGhyZWFkLlxuICAgICAqIEBwYXJhbSBydW5JZCBUaGUgSUQgb2YgdGhlIHJ1bi5cbiAgICAgKiBAcGFyYW0gd2FpdCBXaGV0aGVyIHRvIGJsb2NrIHdoZW4gY2FuY2VsaW5nXG4gICAgICogQHBhcmFtIGFjdGlvbiBBY3Rpb24gdG8gdGFrZSB3aGVuIGNhbmNlbGxpbmcgdGhlIHJ1bi4gUG9zc2libGUgdmFsdWVzIGFyZSBgaW50ZXJydXB0YCBvciBgcm9sbGJhY2tgLiBEZWZhdWx0IGlzIGBpbnRlcnJ1cHRgLlxuICAgICAqIEByZXR1cm5zXG4gICAgICovXG4gICAgYXN5bmMgY2FuY2VsKHRocmVhZElkLCBydW5JZCwgd2FpdCA9IGZhbHNlLCBhY3Rpb24gPSBcImludGVycnVwdFwiKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmZldGNoKGAvdGhyZWFkcy8ke3RocmVhZElkfS9ydW5zLyR7cnVuSWR9L2NhbmNlbGAsIHtcbiAgICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICAgICAgICBwYXJhbXM6IHtcbiAgICAgICAgICAgICAgICB3YWl0OiB3YWl0ID8gXCIxXCIgOiBcIjBcIixcbiAgICAgICAgICAgICAgICBhY3Rpb24sXG4gICAgICAgICAgICB9LFxuICAgICAgICB9KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQmxvY2sgdW50aWwgYSBydW4gaXMgZG9uZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB0aHJlYWRJZCBUaGUgSUQgb2YgdGhlIHRocmVhZC5cbiAgICAgKiBAcGFyYW0gcnVuSWQgVGhlIElEIG9mIHRoZSBydW4uXG4gICAgICogQHJldHVybnNcbiAgICAgKi9cbiAgICBhc3luYyBqb2luKHRocmVhZElkLCBydW5JZCwgb3B0aW9ucykge1xuICAgICAgICByZXR1cm4gdGhpcy5mZXRjaChgL3RocmVhZHMvJHt0aHJlYWRJZH0vcnVucy8ke3J1bklkfS9qb2luYCwge1xuICAgICAgICAgICAgdGltZW91dE1zOiBudWxsLFxuICAgICAgICAgICAgc2lnbmFsOiBvcHRpb25zPy5zaWduYWwsXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTdHJlYW0gb3V0cHV0IGZyb20gYSBydW4gaW4gcmVhbC10aW1lLCB1bnRpbCB0aGUgcnVuIGlzIGRvbmUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gdGhyZWFkSWQgVGhlIElEIG9mIHRoZSB0aHJlYWQuIENhbiBiZSBzZXQgdG8gYG51bGxgIHwgYHVuZGVmaW5lZGAgZm9yIHN0YXRlbGVzcyBydW5zLlxuICAgICAqIEBwYXJhbSBydW5JZCBUaGUgSUQgb2YgdGhlIHJ1bi5cbiAgICAgKiBAcGFyYW0gb3B0aW9ucyBBZGRpdGlvbmFsIG9wdGlvbnMgZm9yIGNvbnRyb2xsaW5nIHRoZSBzdHJlYW0gYmVoYXZpb3I6XG4gICAgICogICAtIHNpZ25hbDogQW4gQWJvcnRTaWduYWwgdGhhdCBjYW4gYmUgdXNlZCB0byBjYW5jZWwgdGhlIHN0cmVhbSByZXF1ZXN0XG4gICAgICogICAtIGxhc3RFdmVudElkOiBUaGUgSUQgb2YgdGhlIGxhc3QgZXZlbnQgcmVjZWl2ZWQuIENhbiBiZSB1c2VkIHRvIHJlY29ubmVjdCB0byBhIHN0cmVhbSB3aXRob3V0IGxvc2luZyBldmVudHMuXG4gICAgICogICAtIGNhbmNlbE9uRGlzY29ubmVjdDogV2hlbiB0cnVlLCBhdXRvbWF0aWNhbGx5IGNhbmNlbHMgdGhlIHJ1biBpZiB0aGUgY2xpZW50IGRpc2Nvbm5lY3RzIGZyb20gdGhlIHN0cmVhbVxuICAgICAqICAgLSBzdHJlYW1Nb2RlOiBDb250cm9scyB3aGF0IHR5cGVzIG9mIGV2ZW50cyB0byByZWNlaXZlIGZyb20gdGhlIHN0cmVhbSAoY2FuIGJlIGEgc2luZ2xlIG1vZGUgb3IgYXJyYXkgb2YgbW9kZXMpXG4gICAgICogICAgICAgIE11c3QgYmUgYSBzdWJzZXQgb2YgdGhlIHN0cmVhbSBtb2RlcyBwYXNzZWQgd2hlbiBjcmVhdGluZyB0aGUgcnVuLiBCYWNrZ3JvdW5kIHJ1bnMgZGVmYXVsdCB0byBoYXZpbmcgdGhlIHVuaW9uIG9mIGFsbFxuICAgICAqICAgICAgICBzdHJlYW0gbW9kZXMgZW5hYmxlZC5cbiAgICAgKiBAcmV0dXJucyBBbiBhc3luYyBnZW5lcmF0b3IgeWllbGRpbmcgc3RyZWFtIHBhcnRzLlxuICAgICAqL1xuICAgIGFzeW5jICpqb2luU3RyZWFtKHRocmVhZElkLCBydW5JZCwgb3B0aW9uc1xuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgKSB7XG4gICAgICAgIGNvbnN0IG9wdHMgPSB0eXBlb2Ygb3B0aW9ucyA9PT0gXCJvYmplY3RcIiAmJlxuICAgICAgICAgICAgb3B0aW9ucyAhPSBudWxsICYmXG4gICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8taW5zdGFuY2VvZi9uby1pbnN0YW5jZW9mXG4gICAgICAgICAgICBvcHRpb25zIGluc3RhbmNlb2YgQWJvcnRTaWduYWxcbiAgICAgICAgICAgID8geyBzaWduYWw6IG9wdGlvbnMgfVxuICAgICAgICAgICAgOiBvcHRpb25zO1xuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMuYXN5bmNDYWxsZXIuZmV0Y2goLi4udGhpcy5wcmVwYXJlRmV0Y2hPcHRpb25zKHRocmVhZElkICE9IG51bGxcbiAgICAgICAgICAgID8gYC90aHJlYWRzLyR7dGhyZWFkSWR9L3J1bnMvJHtydW5JZH0vc3RyZWFtYFxuICAgICAgICAgICAgOiBgL3J1bnMvJHtydW5JZH0vc3RyZWFtYCwge1xuICAgICAgICAgICAgbWV0aG9kOiBcIkdFVFwiLFxuICAgICAgICAgICAgdGltZW91dE1zOiBudWxsLFxuICAgICAgICAgICAgc2lnbmFsOiBvcHRzPy5zaWduYWwsXG4gICAgICAgICAgICBoZWFkZXJzOiBvcHRzPy5sYXN0RXZlbnRJZFxuICAgICAgICAgICAgICAgID8geyBcIkxhc3QtRXZlbnQtSURcIjogb3B0cy5sYXN0RXZlbnRJZCB9XG4gICAgICAgICAgICAgICAgOiB1bmRlZmluZWQsXG4gICAgICAgICAgICBwYXJhbXM6IHtcbiAgICAgICAgICAgICAgICBjYW5jZWxfb25fZGlzY29ubmVjdDogb3B0cz8uY2FuY2VsT25EaXNjb25uZWN0ID8gXCIxXCIgOiBcIjBcIixcbiAgICAgICAgICAgICAgICBzdHJlYW1fbW9kZTogb3B0cz8uc3RyZWFtTW9kZSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0pKTtcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICAgICAgY29uc3Qgc3RyZWFtID0gKHJlc3BvbnNlLmJvZHkgfHwgbmV3IFJlYWRhYmxlU3RyZWFtKHsgc3RhcnQ6IChjdHJsKSA9PiBjdHJsLmNsb3NlKCkgfSkpXG4gICAgICAgICAgICAucGlwZVRocm91Z2goQnl0ZXNMaW5lRGVjb2RlcigpKVxuICAgICAgICAgICAgLnBpcGVUaHJvdWdoKFNTRURlY29kZXIoKSk7XG4gICAgICAgIHlpZWxkKiBJdGVyYWJsZVJlYWRhYmxlU3RyZWFtLmZyb21SZWFkYWJsZVN0cmVhbShzdHJlYW0pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBEZWxldGUgYSBydW4uXG4gICAgICpcbiAgICAgKiBAcGFyYW0gdGhyZWFkSWQgVGhlIElEIG9mIHRoZSB0aHJlYWQuXG4gICAgICogQHBhcmFtIHJ1bklkIFRoZSBJRCBvZiB0aGUgcnVuLlxuICAgICAqIEByZXR1cm5zXG4gICAgICovXG4gICAgYXN5bmMgZGVsZXRlKHRocmVhZElkLCBydW5JZCkge1xuICAgICAgICByZXR1cm4gdGhpcy5mZXRjaChgL3RocmVhZHMvJHt0aHJlYWRJZH0vcnVucy8ke3J1bklkfWAsIHtcbiAgICAgICAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcbiAgICAgICAgfSk7XG4gICAgfVxufVxuZXhwb3J0IGNsYXNzIFN0b3JlQ2xpZW50IGV4dGVuZHMgQmFzZUNsaWVudCB7XG4gICAgLyoqXG4gICAgICogU3RvcmUgb3IgdXBkYXRlIGFuIGl0ZW0uXG4gICAgICpcbiAgICAgKiBAcGFyYW0gbmFtZXNwYWNlIEEgbGlzdCBvZiBzdHJpbmdzIHJlcHJlc2VudGluZyB0aGUgbmFtZXNwYWNlIHBhdGguXG4gICAgICogQHBhcmFtIGtleSBUaGUgdW5pcXVlIGlkZW50aWZpZXIgZm9yIHRoZSBpdGVtIHdpdGhpbiB0aGUgbmFtZXNwYWNlLlxuICAgICAqIEBwYXJhbSB2YWx1ZSBBIGRpY3Rpb25hcnkgY29udGFpbmluZyB0aGUgaXRlbSdzIGRhdGEuXG4gICAgICogQHBhcmFtIG9wdGlvbnMuaW5kZXggQ29udHJvbHMgc2VhcmNoIGluZGV4aW5nIC0gbnVsbCAodXNlIGRlZmF1bHRzKSwgZmFsc2UgKGRpc2FibGUpLCBvciBsaXN0IG9mIGZpZWxkIHBhdGhzIHRvIGluZGV4LlxuICAgICAqIEBwYXJhbSBvcHRpb25zLnR0bCBPcHRpb25hbCB0aW1lLXRvLWxpdmUgaW4gbWludXRlcyBmb3IgdGhlIGl0ZW0sIG9yIG51bGwgZm9yIG5vIGV4cGlyYXRpb24uXG4gICAgICogQHJldHVybnMgUHJvbWlzZTx2b2lkPlxuICAgICAqXG4gICAgICogQGV4YW1wbGVcbiAgICAgKiBgYGB0eXBlc2NyaXB0XG4gICAgICogYXdhaXQgY2xpZW50LnN0b3JlLnB1dEl0ZW0oXG4gICAgICogICBbXCJkb2N1bWVudHNcIiwgXCJ1c2VyMTIzXCJdLFxuICAgICAqICAgXCJpdGVtNDU2XCIsXG4gICAgICogICB7IHRpdGxlOiBcIk15IERvY3VtZW50XCIsIGNvbnRlbnQ6IFwiSGVsbG8gV29ybGRcIiB9LFxuICAgICAqICAgeyB0dGw6IDYwIH0gLy8gZXhwaXJlcyBpbiA2MCBtaW51dGVzXG4gICAgICogKTtcbiAgICAgKiBgYGBcbiAgICAgKi9cbiAgICBhc3luYyBwdXRJdGVtKG5hbWVzcGFjZSwga2V5LCB2YWx1ZSwgb3B0aW9ucykge1xuICAgICAgICBuYW1lc3BhY2UuZm9yRWFjaCgobGFiZWwpID0+IHtcbiAgICAgICAgICAgIGlmIChsYWJlbC5pbmNsdWRlcyhcIi5cIikpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEludmFsaWQgbmFtZXNwYWNlIGxhYmVsICcke2xhYmVsfScuIE5hbWVzcGFjZSBsYWJlbHMgY2Fubm90IGNvbnRhaW4gcGVyaW9kcyAoJy4nKWApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgY29uc3QgcGF5bG9hZCA9IHtcbiAgICAgICAgICAgIG5hbWVzcGFjZSxcbiAgICAgICAgICAgIGtleSxcbiAgICAgICAgICAgIHZhbHVlLFxuICAgICAgICAgICAgaW5kZXg6IG9wdGlvbnM/LmluZGV4LFxuICAgICAgICAgICAgdHRsOiBvcHRpb25zPy50dGwsXG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiB0aGlzLmZldGNoKFwiL3N0b3JlL2l0ZW1zXCIsIHtcbiAgICAgICAgICAgIG1ldGhvZDogXCJQVVRcIixcbiAgICAgICAgICAgIGpzb246IHBheWxvYWQsXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXRyaWV2ZSBhIHNpbmdsZSBpdGVtLlxuICAgICAqXG4gICAgICogQHBhcmFtIG5hbWVzcGFjZSBBIGxpc3Qgb2Ygc3RyaW5ncyByZXByZXNlbnRpbmcgdGhlIG5hbWVzcGFjZSBwYXRoLlxuICAgICAqIEBwYXJhbSBrZXkgVGhlIHVuaXF1ZSBpZGVudGlmaWVyIGZvciB0aGUgaXRlbS5cbiAgICAgKiBAcGFyYW0gb3B0aW9ucy5yZWZyZXNoVHRsIFdoZXRoZXIgdG8gcmVmcmVzaCB0aGUgVFRMIG9uIHRoaXMgcmVhZCBvcGVyYXRpb24uIElmIG51bGwsIHVzZXMgdGhlIHN0b3JlJ3MgZGVmYXVsdCBiZWhhdmlvci5cbiAgICAgKiBAcmV0dXJucyBQcm9taXNlPEl0ZW0+XG4gICAgICpcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIGBgYHR5cGVzY3JpcHRcbiAgICAgKiBjb25zdCBpdGVtID0gYXdhaXQgY2xpZW50LnN0b3JlLmdldEl0ZW0oXG4gICAgICogICBbXCJkb2N1bWVudHNcIiwgXCJ1c2VyMTIzXCJdLFxuICAgICAqICAgXCJpdGVtNDU2XCIsXG4gICAgICogICB7IHJlZnJlc2hUdGw6IHRydWUgfVxuICAgICAqICk7XG4gICAgICogY29uc29sZS5sb2coaXRlbSk7XG4gICAgICogLy8ge1xuICAgICAqIC8vICAgbmFtZXNwYWNlOiBbXCJkb2N1bWVudHNcIiwgXCJ1c2VyMTIzXCJdLFxuICAgICAqIC8vICAga2V5OiBcIml0ZW00NTZcIixcbiAgICAgKiAvLyAgIHZhbHVlOiB7IHRpdGxlOiBcIk15IERvY3VtZW50XCIsIGNvbnRlbnQ6IFwiSGVsbG8gV29ybGRcIiB9LFxuICAgICAqIC8vICAgY3JlYXRlZEF0OiBcIjIwMjQtMDctMzBUMTI6MDA6MDBaXCIsXG4gICAgICogLy8gICB1cGRhdGVkQXQ6IFwiMjAyNC0wNy0zMFQxMjowMDowMFpcIlxuICAgICAqIC8vIH1cbiAgICAgKiBgYGBcbiAgICAgKi9cbiAgICBhc3luYyBnZXRJdGVtKG5hbWVzcGFjZSwga2V5LCBvcHRpb25zKSB7XG4gICAgICAgIG5hbWVzcGFjZS5mb3JFYWNoKChsYWJlbCkgPT4ge1xuICAgICAgICAgICAgaWYgKGxhYmVsLmluY2x1ZGVzKFwiLlwiKSkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgSW52YWxpZCBuYW1lc3BhY2UgbGFiZWwgJyR7bGFiZWx9Jy4gTmFtZXNwYWNlIGxhYmVscyBjYW5ub3QgY29udGFpbiBwZXJpb2RzICgnLicpYCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBjb25zdCBwYXJhbXMgPSB7XG4gICAgICAgICAgICBuYW1lc3BhY2U6IG5hbWVzcGFjZS5qb2luKFwiLlwiKSxcbiAgICAgICAgICAgIGtleSxcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKG9wdGlvbnM/LnJlZnJlc2hUdGwgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcGFyYW1zLnJlZnJlc2hfdHRsID0gb3B0aW9ucy5yZWZyZXNoVHRsO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5mZXRjaChcIi9zdG9yZS9pdGVtc1wiLCB7XG4gICAgICAgICAgICBwYXJhbXMsXG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gcmVzcG9uc2VcbiAgICAgICAgICAgID8ge1xuICAgICAgICAgICAgICAgIC4uLnJlc3BvbnNlLFxuICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogcmVzcG9uc2UuY3JlYXRlZF9hdCxcbiAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IHJlc3BvbnNlLnVwZGF0ZWRfYXQsXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICA6IG51bGw7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIERlbGV0ZSBhbiBpdGVtLlxuICAgICAqXG4gICAgICogQHBhcmFtIG5hbWVzcGFjZSBBIGxpc3Qgb2Ygc3RyaW5ncyByZXByZXNlbnRpbmcgdGhlIG5hbWVzcGFjZSBwYXRoLlxuICAgICAqIEBwYXJhbSBrZXkgVGhlIHVuaXF1ZSBpZGVudGlmaWVyIGZvciB0aGUgaXRlbS5cbiAgICAgKiBAcmV0dXJucyBQcm9taXNlPHZvaWQ+XG4gICAgICovXG4gICAgYXN5bmMgZGVsZXRlSXRlbShuYW1lc3BhY2UsIGtleSkge1xuICAgICAgICBuYW1lc3BhY2UuZm9yRWFjaCgobGFiZWwpID0+IHtcbiAgICAgICAgICAgIGlmIChsYWJlbC5pbmNsdWRlcyhcIi5cIikpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEludmFsaWQgbmFtZXNwYWNlIGxhYmVsICcke2xhYmVsfScuIE5hbWVzcGFjZSBsYWJlbHMgY2Fubm90IGNvbnRhaW4gcGVyaW9kcyAoJy4nKWApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHRoaXMuZmV0Y2goXCIvc3RvcmUvaXRlbXNcIiwge1xuICAgICAgICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgICAgICAgICAganNvbjogeyBuYW1lc3BhY2UsIGtleSB9LFxuICAgICAgICB9KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2VhcmNoIGZvciBpdGVtcyB3aXRoaW4gYSBuYW1lc3BhY2UgcHJlZml4LlxuICAgICAqXG4gICAgICogQHBhcmFtIG5hbWVzcGFjZVByZWZpeCBMaXN0IG9mIHN0cmluZ3MgcmVwcmVzZW50aW5nIHRoZSBuYW1lc3BhY2UgcHJlZml4LlxuICAgICAqIEBwYXJhbSBvcHRpb25zLmZpbHRlciBPcHRpb25hbCBkaWN0aW9uYXJ5IG9mIGtleS12YWx1ZSBwYWlycyB0byBmaWx0ZXIgcmVzdWx0cy5cbiAgICAgKiBAcGFyYW0gb3B0aW9ucy5saW1pdCBNYXhpbXVtIG51bWJlciBvZiBpdGVtcyB0byByZXR1cm4gKGRlZmF1bHQgaXMgMTApLlxuICAgICAqIEBwYXJhbSBvcHRpb25zLm9mZnNldCBOdW1iZXIgb2YgaXRlbXMgdG8gc2tpcCBiZWZvcmUgcmV0dXJuaW5nIHJlc3VsdHMgKGRlZmF1bHQgaXMgMCkuXG4gICAgICogQHBhcmFtIG9wdGlvbnMucXVlcnkgT3B0aW9uYWwgc2VhcmNoIHF1ZXJ5LlxuICAgICAqIEBwYXJhbSBvcHRpb25zLnJlZnJlc2hUdGwgV2hldGhlciB0byByZWZyZXNoIHRoZSBUVEwgb24gaXRlbXMgcmV0dXJuZWQgYnkgdGhpcyBzZWFyY2guIElmIG51bGwsIHVzZXMgdGhlIHN0b3JlJ3MgZGVmYXVsdCBiZWhhdmlvci5cbiAgICAgKiBAcmV0dXJucyBQcm9taXNlPFNlYXJjaEl0ZW1zUmVzcG9uc2U+XG4gICAgICpcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIGBgYHR5cGVzY3JpcHRcbiAgICAgKiBjb25zdCByZXN1bHRzID0gYXdhaXQgY2xpZW50LnN0b3JlLnNlYXJjaEl0ZW1zKFxuICAgICAqICAgW1wiZG9jdW1lbnRzXCJdLFxuICAgICAqICAge1xuICAgICAqICAgICBmaWx0ZXI6IHsgYXV0aG9yOiBcIkpvaG4gRG9lXCIgfSxcbiAgICAgKiAgICAgbGltaXQ6IDUsXG4gICAgICogICAgIHJlZnJlc2hUdGw6IHRydWVcbiAgICAgKiAgIH1cbiAgICAgKiApO1xuICAgICAqIGNvbnNvbGUubG9nKHJlc3VsdHMpO1xuICAgICAqIC8vIHtcbiAgICAgKiAvLyAgIGl0ZW1zOiBbXG4gICAgICogLy8gICAgIHtcbiAgICAgKiAvLyAgICAgICBuYW1lc3BhY2U6IFtcImRvY3VtZW50c1wiLCBcInVzZXIxMjNcIl0sXG4gICAgICogLy8gICAgICAga2V5OiBcIml0ZW03ODlcIixcbiAgICAgKiAvLyAgICAgICB2YWx1ZTogeyB0aXRsZTogXCJBbm90aGVyIERvY3VtZW50XCIsIGF1dGhvcjogXCJKb2huIERvZVwiIH0sXG4gICAgICogLy8gICAgICAgY3JlYXRlZEF0OiBcIjIwMjQtMDctMzBUMTI6MDA6MDBaXCIsXG4gICAgICogLy8gICAgICAgdXBkYXRlZEF0OiBcIjIwMjQtMDctMzBUMTI6MDA6MDBaXCJcbiAgICAgKiAvLyAgICAgfSxcbiAgICAgKiAvLyAgICAgLy8gLi4uIGFkZGl0aW9uYWwgaXRlbXMgLi4uXG4gICAgICogLy8gICBdXG4gICAgICogLy8gfVxuICAgICAqIGBgYFxuICAgICAqL1xuICAgIGFzeW5jIHNlYXJjaEl0ZW1zKG5hbWVzcGFjZVByZWZpeCwgb3B0aW9ucykge1xuICAgICAgICBjb25zdCBwYXlsb2FkID0ge1xuICAgICAgICAgICAgbmFtZXNwYWNlX3ByZWZpeDogbmFtZXNwYWNlUHJlZml4LFxuICAgICAgICAgICAgZmlsdGVyOiBvcHRpb25zPy5maWx0ZXIsXG4gICAgICAgICAgICBsaW1pdDogb3B0aW9ucz8ubGltaXQgPz8gMTAsXG4gICAgICAgICAgICBvZmZzZXQ6IG9wdGlvbnM/Lm9mZnNldCA/PyAwLFxuICAgICAgICAgICAgcXVlcnk6IG9wdGlvbnM/LnF1ZXJ5LFxuICAgICAgICAgICAgcmVmcmVzaF90dGw6IG9wdGlvbnM/LnJlZnJlc2hUdGwsXG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5mZXRjaChcIi9zdG9yZS9pdGVtcy9zZWFyY2hcIiwge1xuICAgICAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgICAgICAgIGpzb246IHBheWxvYWQsXG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgaXRlbXM6IHJlc3BvbnNlLml0ZW1zLm1hcCgoaXRlbSkgPT4gKHtcbiAgICAgICAgICAgICAgICAuLi5pdGVtLFxuICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogaXRlbS5jcmVhdGVkX2F0LFxuICAgICAgICAgICAgICAgIHVwZGF0ZWRBdDogaXRlbS51cGRhdGVkX2F0LFxuICAgICAgICAgICAgfSkpLFxuICAgICAgICB9O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBMaXN0IG5hbWVzcGFjZXMgd2l0aCBvcHRpb25hbCBtYXRjaCBjb25kaXRpb25zLlxuICAgICAqXG4gICAgICogQHBhcmFtIG9wdGlvbnMucHJlZml4IE9wdGlvbmFsIGxpc3Qgb2Ygc3RyaW5ncyByZXByZXNlbnRpbmcgdGhlIHByZWZpeCB0byBmaWx0ZXIgbmFtZXNwYWNlcy5cbiAgICAgKiBAcGFyYW0gb3B0aW9ucy5zdWZmaXggT3B0aW9uYWwgbGlzdCBvZiBzdHJpbmdzIHJlcHJlc2VudGluZyB0aGUgc3VmZml4IHRvIGZpbHRlciBuYW1lc3BhY2VzLlxuICAgICAqIEBwYXJhbSBvcHRpb25zLm1heERlcHRoIE9wdGlvbmFsIGludGVnZXIgc3BlY2lmeWluZyB0aGUgbWF4aW11bSBkZXB0aCBvZiBuYW1lc3BhY2VzIHRvIHJldHVybi5cbiAgICAgKiBAcGFyYW0gb3B0aW9ucy5saW1pdCBNYXhpbXVtIG51bWJlciBvZiBuYW1lc3BhY2VzIHRvIHJldHVybiAoZGVmYXVsdCBpcyAxMDApLlxuICAgICAqIEBwYXJhbSBvcHRpb25zLm9mZnNldCBOdW1iZXIgb2YgbmFtZXNwYWNlcyB0byBza2lwIGJlZm9yZSByZXR1cm5pbmcgcmVzdWx0cyAoZGVmYXVsdCBpcyAwKS5cbiAgICAgKiBAcmV0dXJucyBQcm9taXNlPExpc3ROYW1lc3BhY2VSZXNwb25zZT5cbiAgICAgKi9cbiAgICBhc3luYyBsaXN0TmFtZXNwYWNlcyhvcHRpb25zKSB7XG4gICAgICAgIGNvbnN0IHBheWxvYWQgPSB7XG4gICAgICAgICAgICBwcmVmaXg6IG9wdGlvbnM/LnByZWZpeCxcbiAgICAgICAgICAgIHN1ZmZpeDogb3B0aW9ucz8uc3VmZml4LFxuICAgICAgICAgICAgbWF4X2RlcHRoOiBvcHRpb25zPy5tYXhEZXB0aCxcbiAgICAgICAgICAgIGxpbWl0OiBvcHRpb25zPy5saW1pdCA/PyAxMDAsXG4gICAgICAgICAgICBvZmZzZXQ6IG9wdGlvbnM/Lm9mZnNldCA/PyAwLFxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gdGhpcy5mZXRjaChcIi9zdG9yZS9uYW1lc3BhY2VzXCIsIHtcbiAgICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICAgICAgICBqc29uOiBwYXlsb2FkLFxuICAgICAgICB9KTtcbiAgICB9XG59XG5jbGFzcyBVaUNsaWVudCBleHRlbmRzIEJhc2VDbGllbnQge1xuICAgIHN0YXRpYyBnZXRPckNhY2hlZChrZXksIGZuKSB7XG4gICAgICAgIGlmIChVaUNsaWVudC5wcm9taXNlQ2FjaGVba2V5XSAhPSBudWxsKSB7XG4gICAgICAgICAgICByZXR1cm4gVWlDbGllbnQucHJvbWlzZUNhY2hlW2tleV07XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgcHJvbWlzZSA9IGZuKCk7XG4gICAgICAgIFVpQ2xpZW50LnByb21pc2VDYWNoZVtrZXldID0gcHJvbWlzZTtcbiAgICAgICAgcmV0dXJuIHByb21pc2U7XG4gICAgfVxuICAgIGFzeW5jIGdldENvbXBvbmVudChhc3Npc3RhbnRJZCwgYWdlbnROYW1lKSB7XG4gICAgICAgIHJldHVybiBVaUNsaWVudC5nZXRPckNhY2hlZChgJHt0aGlzLmFwaVVybH0tJHthc3Npc3RhbnRJZH0tJHthZ2VudE5hbWV9YCwgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLmFzeW5jQ2FsbGVyLmZldGNoKC4uLnRoaXMucHJlcGFyZUZldGNoT3B0aW9ucyhgL3VpLyR7YXNzaXN0YW50SWR9YCwge1xuICAgICAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgICAgICAgQWNjZXB0OiBcInRleHQvaHRtbFwiLFxuICAgICAgICAgICAgICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICAgICAgICAgICAganNvbjogeyBuYW1lOiBhZ2VudE5hbWUgfSxcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIHJldHVybiByZXNwb25zZS50ZXh0KCk7XG4gICAgICAgIH0pO1xuICAgIH1cbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShVaUNsaWVudCwgXCJwcm9taXNlQ2FjaGVcIiwge1xuICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgIHZhbHVlOiB7fVxufSk7XG5leHBvcnQgY2xhc3MgQ2xpZW50IHtcbiAgICBjb25zdHJ1Y3Rvcihjb25maWcpIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBjbGllbnQgZm9yIGludGVyYWN0aW5nIHdpdGggYXNzaXN0YW50cy5cbiAgICAgICAgICovXG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImFzc2lzdGFudHNcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IHZvaWQgMFxuICAgICAgICB9KTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBjbGllbnQgZm9yIGludGVyYWN0aW5nIHdpdGggdGhyZWFkcy5cbiAgICAgICAgICovXG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcInRocmVhZHNcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IHZvaWQgMFxuICAgICAgICB9KTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBjbGllbnQgZm9yIGludGVyYWN0aW5nIHdpdGggcnVucy5cbiAgICAgICAgICovXG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcInJ1bnNcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IHZvaWQgMFxuICAgICAgICB9KTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBjbGllbnQgZm9yIGludGVyYWN0aW5nIHdpdGggY3JvbiBydW5zLlxuICAgICAgICAgKi9cbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiY3JvbnNcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IHZvaWQgMFxuICAgICAgICB9KTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBjbGllbnQgZm9yIGludGVyYWN0aW5nIHdpdGggdGhlIEtWIHN0b3JlLlxuICAgICAgICAgKi9cbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwic3RvcmVcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IHZvaWQgMFxuICAgICAgICB9KTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBjbGllbnQgZm9yIGludGVyYWN0aW5nIHdpdGggdGhlIFVJLlxuICAgICAgICAgKiBAaW50ZXJuYWwgVXNlZCBieSBMb2FkRXh0ZXJuYWxDb21wb25lbnQgYW5kIHRoZSBBUEkgbWlnaHQgY2hhbmdlIGluIHRoZSBmdXR1cmUuXG4gICAgICAgICAqL1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJ+dWlcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IHZvaWQgMFxuICAgICAgICB9KTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBpbnRlcm5hbCBVc2VkIHRvIG9idGFpbiBhIHN0YWJsZSBrZXkgcmVwcmVzZW50aW5nIHRoZSBjbGllbnQuXG4gICAgICAgICAqL1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJ+Y29uZmlnSGFzaFwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogdm9pZCAwXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzW1wifmNvbmZpZ0hhc2hcIl0gPSAoKCkgPT4gSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgYXBpVXJsOiBjb25maWc/LmFwaVVybCxcbiAgICAgICAgICAgIGFwaUtleTogY29uZmlnPy5hcGlLZXksXG4gICAgICAgICAgICB0aW1lb3V0TXM6IGNvbmZpZz8udGltZW91dE1zLFxuICAgICAgICAgICAgZGVmYXVsdEhlYWRlcnM6IGNvbmZpZz8uZGVmYXVsdEhlYWRlcnMsXG4gICAgICAgICAgICBtYXhDb25jdXJyZW5jeTogY29uZmlnPy5jYWxsZXJPcHRpb25zPy5tYXhDb25jdXJyZW5jeSxcbiAgICAgICAgICAgIG1heFJldHJpZXM6IGNvbmZpZz8uY2FsbGVyT3B0aW9ucz8ubWF4UmV0cmllcyxcbiAgICAgICAgICAgIGNhbGxiYWNrczoge1xuICAgICAgICAgICAgICAgIG9uRmFpbGVkUmVzcG9uc2VIb29rOiBjb25maWc/LmNhbGxlck9wdGlvbnM/Lm9uRmFpbGVkUmVzcG9uc2VIb29rICE9IG51bGwsXG4gICAgICAgICAgICAgICAgb25SZXF1ZXN0OiBjb25maWc/Lm9uUmVxdWVzdCAhPSBudWxsLFxuICAgICAgICAgICAgICAgIGZldGNoOiBjb25maWc/LmNhbGxlck9wdGlvbnM/LmZldGNoICE9IG51bGwsXG4gICAgICAgICAgICB9LFxuICAgICAgICB9KSkoKTtcbiAgICAgICAgdGhpcy5hc3Npc3RhbnRzID0gbmV3IEFzc2lzdGFudHNDbGllbnQoY29uZmlnKTtcbiAgICAgICAgdGhpcy50aHJlYWRzID0gbmV3IFRocmVhZHNDbGllbnQoY29uZmlnKTtcbiAgICAgICAgdGhpcy5ydW5zID0gbmV3IFJ1bnNDbGllbnQoY29uZmlnKTtcbiAgICAgICAgdGhpcy5jcm9ucyA9IG5ldyBDcm9uc0NsaWVudChjb25maWcpO1xuICAgICAgICB0aGlzLnN0b3JlID0gbmV3IFN0b3JlQ2xpZW50KGNvbmZpZyk7XG4gICAgICAgIHRoaXNbXCJ+dWlcIl0gPSBuZXcgVWlDbGllbnQoY29uZmlnKTtcbiAgICB9XG59XG4vKipcbiAqIEBpbnRlcm5hbCBVc2VkIHRvIG9idGFpbiBhIHN0YWJsZSBrZXkgcmVwcmVzZW50aW5nIHRoZSBjbGllbnQuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRDbGllbnRDb25maWdIYXNoKGNsaWVudCkge1xuICAgIHJldHVybiBjbGllbnRbXCJ+Y29uZmlnSGFzaFwiXTtcbn1cbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@ag-ui/langgraph/node_modules/@langchain/langgraph-sdk/dist/client.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@ag-ui/langgraph/node_modules/@langchain/langgraph-sdk/dist/index.js":
/*!*******************************************************************************************!*\
  !*** ./node_modules/@ag-ui/langgraph/node_modules/@langchain/langgraph-sdk/dist/index.js ***!
  \*******************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Client: () => (/* reexport safe */ _client_js__WEBPACK_IMPORTED_MODULE_0__.Client),\n/* harmony export */   getApiKey: () => (/* reexport safe */ _client_js__WEBPACK_IMPORTED_MODULE_0__.getApiKey),\n/* harmony export */   overrideFetchImplementation: () => (/* reexport safe */ _singletons_fetch_js__WEBPACK_IMPORTED_MODULE_1__.overrideFetchImplementation)\n/* harmony export */ });\n/* harmony import */ var _client_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./client.js */ \"(rsc)/./node_modules/@ag-ui/langgraph/node_modules/@langchain/langgraph-sdk/dist/client.js\");\n/* harmony import */ var _singletons_fetch_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./singletons/fetch.js */ \"(rsc)/./node_modules/@ag-ui/langgraph/node_modules/@langchain/langgraph-sdk/dist/singletons/fetch.js\");\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQGFnLXVpL2xhbmdncmFwaC9ub2RlX21vZHVsZXMvQGxhbmdjaGFpbi9sYW5nZ3JhcGgtc2RrL2Rpc3QvaW5kZXguanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBZ0Q7QUFDb0IiLCJzb3VyY2VzIjpbIi9ob21lL2NldGVjL05vZGVQcm9qZWN0cy9hZ3VpX3Rlc3Qvbm9kZV9tb2R1bGVzL0BhZy11aS9sYW5nZ3JhcGgvbm9kZV9tb2R1bGVzL0BsYW5nY2hhaW4vbGFuZ2dyYXBoLXNkay9kaXN0L2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCB7IENsaWVudCwgZ2V0QXBpS2V5IH0gZnJvbSBcIi4vY2xpZW50LmpzXCI7XG5leHBvcnQgeyBvdmVycmlkZUZldGNoSW1wbGVtZW50YXRpb24gfSBmcm9tIFwiLi9zaW5nbGV0b25zL2ZldGNoLmpzXCI7XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@ag-ui/langgraph/node_modules/@langchain/langgraph-sdk/dist/index.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@ag-ui/langgraph/node_modules/@langchain/langgraph-sdk/dist/singletons/fetch.js":
/*!******************************************************************************************************!*\
  !*** ./node_modules/@ag-ui/langgraph/node_modules/@langchain/langgraph-sdk/dist/singletons/fetch.js ***!
  \******************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   _getFetchImplementation: () => (/* binding */ _getFetchImplementation),\n/* harmony export */   overrideFetchImplementation: () => (/* binding */ overrideFetchImplementation)\n/* harmony export */ });\n/* eslint-disable @typescript-eslint/no-explicit-any */\n// Wrap the default fetch call due to issues with illegal invocations\n// in some environments:\n// https://stackoverflow.com/questions/69876859/why-does-bind-fix-failed-to-execute-fetch-on-window-illegal-invocation-err\n// @ts-expect-error Broad typing to support a range of fetch implementations\nconst DEFAULT_FETCH_IMPLEMENTATION = (...args) => fetch(...args);\nconst LANGSMITH_FETCH_IMPLEMENTATION_KEY = Symbol.for(\"lg:fetch_implementation\");\n/**\n * Overrides the fetch implementation used for LangSmith calls.\n * You should use this if you need to use an implementation of fetch\n * other than the default global (e.g. for dealing with proxies).\n * @param fetch The new fetch function to use.\n */\nconst overrideFetchImplementation = (fetch) => {\n    globalThis[LANGSMITH_FETCH_IMPLEMENTATION_KEY] = fetch;\n};\n/**\n * @internal\n */\nconst _getFetchImplementation = () => {\n    return (globalThis[LANGSMITH_FETCH_IMPLEMENTATION_KEY] ??\n        DEFAULT_FETCH_IMPLEMENTATION);\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQGFnLXVpL2xhbmdncmFwaC9ub2RlX21vZHVsZXMvQGxhbmdjaGFpbi9sYW5nZ3JhcGgtc2RrL2Rpc3Qvc2luZ2xldG9ucy9mZXRjaC5qcyIsIm1hcHBpbmdzIjoiOzs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIi9ob21lL2NldGVjL05vZGVQcm9qZWN0cy9hZ3VpX3Rlc3Qvbm9kZV9tb2R1bGVzL0BhZy11aS9sYW5nZ3JhcGgvbm9kZV9tb2R1bGVzL0BsYW5nY2hhaW4vbGFuZ2dyYXBoLXNkay9kaXN0L3NpbmdsZXRvbnMvZmV0Y2guanMiXSwic291cmNlc0NvbnRlbnQiOlsiLyogZXNsaW50LWRpc2FibGUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueSAqL1xuLy8gV3JhcCB0aGUgZGVmYXVsdCBmZXRjaCBjYWxsIGR1ZSB0byBpc3N1ZXMgd2l0aCBpbGxlZ2FsIGludm9jYXRpb25zXG4vLyBpbiBzb21lIGVudmlyb25tZW50czpcbi8vIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzY5ODc2ODU5L3doeS1kb2VzLWJpbmQtZml4LWZhaWxlZC10by1leGVjdXRlLWZldGNoLW9uLXdpbmRvdy1pbGxlZ2FsLWludm9jYXRpb24tZXJyXG4vLyBAdHMtZXhwZWN0LWVycm9yIEJyb2FkIHR5cGluZyB0byBzdXBwb3J0IGEgcmFuZ2Ugb2YgZmV0Y2ggaW1wbGVtZW50YXRpb25zXG5jb25zdCBERUZBVUxUX0ZFVENIX0lNUExFTUVOVEFUSU9OID0gKC4uLmFyZ3MpID0+IGZldGNoKC4uLmFyZ3MpO1xuY29uc3QgTEFOR1NNSVRIX0ZFVENIX0lNUExFTUVOVEFUSU9OX0tFWSA9IFN5bWJvbC5mb3IoXCJsZzpmZXRjaF9pbXBsZW1lbnRhdGlvblwiKTtcbi8qKlxuICogT3ZlcnJpZGVzIHRoZSBmZXRjaCBpbXBsZW1lbnRhdGlvbiB1c2VkIGZvciBMYW5nU21pdGggY2FsbHMuXG4gKiBZb3Ugc2hvdWxkIHVzZSB0aGlzIGlmIHlvdSBuZWVkIHRvIHVzZSBhbiBpbXBsZW1lbnRhdGlvbiBvZiBmZXRjaFxuICogb3RoZXIgdGhhbiB0aGUgZGVmYXVsdCBnbG9iYWwgKGUuZy4gZm9yIGRlYWxpbmcgd2l0aCBwcm94aWVzKS5cbiAqIEBwYXJhbSBmZXRjaCBUaGUgbmV3IGZldGNoIGZ1bmN0aW9uIHRvIHVzZS5cbiAqL1xuZXhwb3J0IGNvbnN0IG92ZXJyaWRlRmV0Y2hJbXBsZW1lbnRhdGlvbiA9IChmZXRjaCkgPT4ge1xuICAgIGdsb2JhbFRoaXNbTEFOR1NNSVRIX0ZFVENIX0lNUExFTUVOVEFUSU9OX0tFWV0gPSBmZXRjaDtcbn07XG4vKipcbiAqIEBpbnRlcm5hbFxuICovXG5leHBvcnQgY29uc3QgX2dldEZldGNoSW1wbGVtZW50YXRpb24gPSAoKSA9PiB7XG4gICAgcmV0dXJuIChnbG9iYWxUaGlzW0xBTkdTTUlUSF9GRVRDSF9JTVBMRU1FTlRBVElPTl9LRVldID8/XG4gICAgICAgIERFRkFVTFRfRkVUQ0hfSU1QTEVNRU5UQVRJT04pO1xufTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@ag-ui/langgraph/node_modules/@langchain/langgraph-sdk/dist/singletons/fetch.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@ag-ui/langgraph/node_modules/@langchain/langgraph-sdk/dist/utils/async_caller.js":
/*!********************************************************************************************************!*\
  !*** ./node_modules/@ag-ui/langgraph/node_modules/@langchain/langgraph-sdk/dist/utils/async_caller.js ***!
  \********************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AsyncCaller: () => (/* binding */ AsyncCaller)\n/* harmony export */ });\n/* harmony import */ var p_retry__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! p-retry */ \"(rsc)/./node_modules/p-retry/index.js\");\n/* harmony import */ var p_queue__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! p-queue */ \"(rsc)/./node_modules/p-queue/dist/index.js\");\n/* harmony import */ var _singletons_fetch_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../singletons/fetch.js */ \"(rsc)/./node_modules/@ag-ui/langgraph/node_modules/@langchain/langgraph-sdk/dist/singletons/fetch.js\");\n\n\n\nconst STATUS_NO_RETRY = [\n    400, // Bad Request\n    401, // Unauthorized\n    402, // Payment required\n    403, // Forbidden\n    404, // Not Found\n    405, // Method Not Allowed\n    406, // Not Acceptable\n    407, // Proxy Authentication Required\n    408, // Request Timeout\n    409, // Conflict\n    422, // Unprocessable Entity\n];\n/**\n * Do not rely on globalThis.Response, rather just\n * do duck typing\n */\nfunction isResponse(x) {\n    if (x == null || typeof x !== \"object\")\n        return false;\n    return \"status\" in x && \"statusText\" in x && \"text\" in x;\n}\n/**\n * Utility error to properly handle failed requests\n */\nclass HTTPError extends Error {\n    constructor(status, message, response) {\n        super(`HTTP ${status}: ${message}`);\n        Object.defineProperty(this, \"status\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"text\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"response\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        this.status = status;\n        this.text = message;\n        this.response = response;\n    }\n    static async fromResponse(response, options) {\n        try {\n            return new HTTPError(response.status, await response.text(), options?.includeResponse ? response : undefined);\n        }\n        catch {\n            return new HTTPError(response.status, response.statusText, options?.includeResponse ? response : undefined);\n        }\n    }\n}\n/**\n * A class that can be used to make async calls with concurrency and retry logic.\n *\n * This is useful for making calls to any kind of \"expensive\" external resource,\n * be it because it's rate-limited, subject to network issues, etc.\n *\n * Concurrent calls are limited by the `maxConcurrency` parameter, which defaults\n * to `Infinity`. This means that by default, all calls will be made in parallel.\n *\n * Retries are limited by the `maxRetries` parameter, which defaults to 5. This\n * means that by default, each call will be retried up to 5 times, with an\n * exponential backoff between each attempt.\n */\nclass AsyncCaller {\n    constructor(params) {\n        Object.defineProperty(this, \"maxConcurrency\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"maxRetries\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"queue\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"onFailedResponseHook\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"customFetch\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        this.maxConcurrency = params.maxConcurrency ?? Infinity;\n        this.maxRetries = params.maxRetries ?? 4;\n        if ( true) {\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            this.queue = new p_queue__WEBPACK_IMPORTED_MODULE_1__[\"default\"]({\n                concurrency: this.maxConcurrency,\n            });\n        }\n        else {\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            this.queue = new p_queue__WEBPACK_IMPORTED_MODULE_1__({ concurrency: this.maxConcurrency });\n        }\n        this.onFailedResponseHook = params?.onFailedResponseHook;\n        this.customFetch = params.fetch;\n    }\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    call(callable, ...args) {\n        const { onFailedResponseHook } = this;\n        return this.queue.add(() => p_retry__WEBPACK_IMPORTED_MODULE_0__(() => callable(...args).catch(async (error) => {\n            // eslint-disable-next-line no-instanceof/no-instanceof\n            if (error instanceof Error) {\n                throw error;\n            }\n            else if (isResponse(error)) {\n                throw await HTTPError.fromResponse(error, {\n                    includeResponse: !!onFailedResponseHook,\n                });\n            }\n            else {\n                throw new Error(error);\n            }\n        }), {\n            async onFailedAttempt(error) {\n                if (error.message.startsWith(\"Cancel\") ||\n                    error.message.startsWith(\"TimeoutError\") ||\n                    error.message.startsWith(\"AbortError\")) {\n                    throw error;\n                }\n                // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                if (error?.code === \"ECONNABORTED\") {\n                    throw error;\n                }\n                // eslint-disable-next-line no-instanceof/no-instanceof\n                if (error instanceof HTTPError) {\n                    if (STATUS_NO_RETRY.includes(error.status)) {\n                        throw error;\n                    }\n                    if (onFailedResponseHook && error.response) {\n                        await onFailedResponseHook(error.response);\n                    }\n                }\n            },\n            // If needed we can change some of the defaults here,\n            // but they're quite sensible.\n            retries: this.maxRetries,\n            randomize: true,\n        }), { throwOnTimeout: true });\n    }\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    callWithOptions(options, callable, ...args) {\n        // Note this doesn't cancel the underlying request,\n        // when available prefer to use the signal option of the underlying call\n        if (options.signal) {\n            return Promise.race([\n                this.call(callable, ...args),\n                new Promise((_, reject) => {\n                    options.signal?.addEventListener(\"abort\", () => {\n                        reject(new Error(\"AbortError\"));\n                    });\n                }),\n            ]);\n        }\n        return this.call(callable, ...args);\n    }\n    fetch(...args) {\n        const fetchFn = this.customFetch ?? (0,_singletons_fetch_js__WEBPACK_IMPORTED_MODULE_2__._getFetchImplementation)();\n        return this.call(() => fetchFn(...args).then((res) => (res.ok ? res : Promise.reject(res))));\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQGFnLXVpL2xhbmdncmFwaC9ub2RlX21vZHVsZXMvQGxhbmdjaGFpbi9sYW5nZ3JhcGgtc2RrL2Rpc3QvdXRpbHMvYXN5bmNfY2FsbGVyLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBNkI7QUFDRztBQUNpQztBQUNqRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0IsT0FBTyxJQUFJLFFBQVE7QUFDekM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFlBQVksS0FBc0I7QUFDbEM7QUFDQSw2QkFBNkIsK0NBQWlCO0FBQzlDO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QixvQ0FBUyxHQUFHLGtDQUFrQztBQUMzRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsdUJBQXVCO0FBQ3ZDLG9DQUFvQyxvQ0FBTTtBQUMxQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVMsS0FBSyxzQkFBc0I7QUFDcEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQixpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRDQUE0Qyw2RUFBdUI7QUFDbkU7QUFDQTtBQUNBIiwic291cmNlcyI6WyIvaG9tZS9jZXRlYy9Ob2RlUHJvamVjdHMvYWd1aV90ZXN0L25vZGVfbW9kdWxlcy9AYWctdWkvbGFuZ2dyYXBoL25vZGVfbW9kdWxlcy9AbGFuZ2NoYWluL2xhbmdncmFwaC1zZGsvZGlzdC91dGlscy9hc3luY19jYWxsZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHBSZXRyeSBmcm9tIFwicC1yZXRyeVwiO1xuaW1wb3J0IFBRdWV1ZU1vZCBmcm9tIFwicC1xdWV1ZVwiO1xuaW1wb3J0IHsgX2dldEZldGNoSW1wbGVtZW50YXRpb24gfSBmcm9tIFwiLi4vc2luZ2xldG9ucy9mZXRjaC5qc1wiO1xuY29uc3QgU1RBVFVTX05PX1JFVFJZID0gW1xuICAgIDQwMCwgLy8gQmFkIFJlcXVlc3RcbiAgICA0MDEsIC8vIFVuYXV0aG9yaXplZFxuICAgIDQwMiwgLy8gUGF5bWVudCByZXF1aXJlZFxuICAgIDQwMywgLy8gRm9yYmlkZGVuXG4gICAgNDA0LCAvLyBOb3QgRm91bmRcbiAgICA0MDUsIC8vIE1ldGhvZCBOb3QgQWxsb3dlZFxuICAgIDQwNiwgLy8gTm90IEFjY2VwdGFibGVcbiAgICA0MDcsIC8vIFByb3h5IEF1dGhlbnRpY2F0aW9uIFJlcXVpcmVkXG4gICAgNDA4LCAvLyBSZXF1ZXN0IFRpbWVvdXRcbiAgICA0MDksIC8vIENvbmZsaWN0XG4gICAgNDIyLCAvLyBVbnByb2Nlc3NhYmxlIEVudGl0eVxuXTtcbi8qKlxuICogRG8gbm90IHJlbHkgb24gZ2xvYmFsVGhpcy5SZXNwb25zZSwgcmF0aGVyIGp1c3RcbiAqIGRvIGR1Y2sgdHlwaW5nXG4gKi9cbmZ1bmN0aW9uIGlzUmVzcG9uc2UoeCkge1xuICAgIGlmICh4ID09IG51bGwgfHwgdHlwZW9mIHggIT09IFwib2JqZWN0XCIpXG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICByZXR1cm4gXCJzdGF0dXNcIiBpbiB4ICYmIFwic3RhdHVzVGV4dFwiIGluIHggJiYgXCJ0ZXh0XCIgaW4geDtcbn1cbi8qKlxuICogVXRpbGl0eSBlcnJvciB0byBwcm9wZXJseSBoYW5kbGUgZmFpbGVkIHJlcXVlc3RzXG4gKi9cbmNsYXNzIEhUVFBFcnJvciBleHRlbmRzIEVycm9yIHtcbiAgICBjb25zdHJ1Y3RvcihzdGF0dXMsIG1lc3NhZ2UsIHJlc3BvbnNlKSB7XG4gICAgICAgIHN1cGVyKGBIVFRQICR7c3RhdHVzfTogJHttZXNzYWdlfWApO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJzdGF0dXNcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IHZvaWQgMFxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwidGV4dFwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogdm9pZCAwXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJyZXNwb25zZVwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogdm9pZCAwXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnN0YXR1cyA9IHN0YXR1cztcbiAgICAgICAgdGhpcy50ZXh0ID0gbWVzc2FnZTtcbiAgICAgICAgdGhpcy5yZXNwb25zZSA9IHJlc3BvbnNlO1xuICAgIH1cbiAgICBzdGF0aWMgYXN5bmMgZnJvbVJlc3BvbnNlKHJlc3BvbnNlLCBvcHRpb25zKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IEhUVFBFcnJvcihyZXNwb25zZS5zdGF0dXMsIGF3YWl0IHJlc3BvbnNlLnRleHQoKSwgb3B0aW9ucz8uaW5jbHVkZVJlc3BvbnNlID8gcmVzcG9uc2UgOiB1bmRlZmluZWQpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgSFRUUEVycm9yKHJlc3BvbnNlLnN0YXR1cywgcmVzcG9uc2Uuc3RhdHVzVGV4dCwgb3B0aW9ucz8uaW5jbHVkZVJlc3BvbnNlID8gcmVzcG9uc2UgOiB1bmRlZmluZWQpO1xuICAgICAgICB9XG4gICAgfVxufVxuLyoqXG4gKiBBIGNsYXNzIHRoYXQgY2FuIGJlIHVzZWQgdG8gbWFrZSBhc3luYyBjYWxscyB3aXRoIGNvbmN1cnJlbmN5IGFuZCByZXRyeSBsb2dpYy5cbiAqXG4gKiBUaGlzIGlzIHVzZWZ1bCBmb3IgbWFraW5nIGNhbGxzIHRvIGFueSBraW5kIG9mIFwiZXhwZW5zaXZlXCIgZXh0ZXJuYWwgcmVzb3VyY2UsXG4gKiBiZSBpdCBiZWNhdXNlIGl0J3MgcmF0ZS1saW1pdGVkLCBzdWJqZWN0IHRvIG5ldHdvcmsgaXNzdWVzLCBldGMuXG4gKlxuICogQ29uY3VycmVudCBjYWxscyBhcmUgbGltaXRlZCBieSB0aGUgYG1heENvbmN1cnJlbmN5YCBwYXJhbWV0ZXIsIHdoaWNoIGRlZmF1bHRzXG4gKiB0byBgSW5maW5pdHlgLiBUaGlzIG1lYW5zIHRoYXQgYnkgZGVmYXVsdCwgYWxsIGNhbGxzIHdpbGwgYmUgbWFkZSBpbiBwYXJhbGxlbC5cbiAqXG4gKiBSZXRyaWVzIGFyZSBsaW1pdGVkIGJ5IHRoZSBgbWF4UmV0cmllc2AgcGFyYW1ldGVyLCB3aGljaCBkZWZhdWx0cyB0byA1LiBUaGlzXG4gKiBtZWFucyB0aGF0IGJ5IGRlZmF1bHQsIGVhY2ggY2FsbCB3aWxsIGJlIHJldHJpZWQgdXAgdG8gNSB0aW1lcywgd2l0aCBhblxuICogZXhwb25lbnRpYWwgYmFja29mZiBiZXR3ZWVuIGVhY2ggYXR0ZW1wdC5cbiAqL1xuZXhwb3J0IGNsYXNzIEFzeW5jQ2FsbGVyIHtcbiAgICBjb25zdHJ1Y3RvcihwYXJhbXMpIHtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwibWF4Q29uY3VycmVuY3lcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IHZvaWQgMFxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwibWF4UmV0cmllc1wiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogdm9pZCAwXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJxdWV1ZVwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogdm9pZCAwXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJvbkZhaWxlZFJlc3BvbnNlSG9va1wiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogdm9pZCAwXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJjdXN0b21GZXRjaFwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogdm9pZCAwXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLm1heENvbmN1cnJlbmN5ID0gcGFyYW1zLm1heENvbmN1cnJlbmN5ID8/IEluZmluaXR5O1xuICAgICAgICB0aGlzLm1heFJldHJpZXMgPSBwYXJhbXMubWF4UmV0cmllcyA/PyA0O1xuICAgICAgICBpZiAoXCJkZWZhdWx0XCIgaW4gUFF1ZXVlTW9kKSB7XG4gICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgICAgICAgICAgdGhpcy5xdWV1ZSA9IG5ldyBQUXVldWVNb2QuZGVmYXVsdCh7XG4gICAgICAgICAgICAgICAgY29uY3VycmVuY3k6IHRoaXMubWF4Q29uY3VycmVuY3ksXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgICAgICB0aGlzLnF1ZXVlID0gbmV3IFBRdWV1ZU1vZCh7IGNvbmN1cnJlbmN5OiB0aGlzLm1heENvbmN1cnJlbmN5IH0pO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMub25GYWlsZWRSZXNwb25zZUhvb2sgPSBwYXJhbXM/Lm9uRmFpbGVkUmVzcG9uc2VIb29rO1xuICAgICAgICB0aGlzLmN1c3RvbUZldGNoID0gcGFyYW1zLmZldGNoO1xuICAgIH1cbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgIGNhbGwoY2FsbGFibGUsIC4uLmFyZ3MpIHtcbiAgICAgICAgY29uc3QgeyBvbkZhaWxlZFJlc3BvbnNlSG9vayB9ID0gdGhpcztcbiAgICAgICAgcmV0dXJuIHRoaXMucXVldWUuYWRkKCgpID0+IHBSZXRyeSgoKSA9PiBjYWxsYWJsZSguLi5hcmdzKS5jYXRjaChhc3luYyAoZXJyb3IpID0+IHtcbiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1pbnN0YW5jZW9mL25vLWluc3RhbmNlb2ZcbiAgICAgICAgICAgIGlmIChlcnJvciBpbnN0YW5jZW9mIEVycm9yKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChpc1Jlc3BvbnNlKGVycm9yKSkge1xuICAgICAgICAgICAgICAgIHRocm93IGF3YWl0IEhUVFBFcnJvci5mcm9tUmVzcG9uc2UoZXJyb3IsIHtcbiAgICAgICAgICAgICAgICAgICAgaW5jbHVkZVJlc3BvbnNlOiAhIW9uRmFpbGVkUmVzcG9uc2VIb29rLFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGVycm9yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSksIHtcbiAgICAgICAgICAgIGFzeW5jIG9uRmFpbGVkQXR0ZW1wdChlcnJvcikge1xuICAgICAgICAgICAgICAgIGlmIChlcnJvci5tZXNzYWdlLnN0YXJ0c1dpdGgoXCJDYW5jZWxcIikgfHxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3IubWVzc2FnZS5zdGFydHNXaXRoKFwiVGltZW91dEVycm9yXCIpIHx8XG4gICAgICAgICAgICAgICAgICAgIGVycm9yLm1lc3NhZ2Uuc3RhcnRzV2l0aChcIkFib3J0RXJyb3JcIikpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgICAgICAgICAgaWYgKGVycm9yPy5jb2RlID09PSBcIkVDT05OQUJPUlRFRFwiKSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IGVycm9yO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8taW5zdGFuY2VvZi9uby1pbnN0YW5jZW9mXG4gICAgICAgICAgICAgICAgaWYgKGVycm9yIGluc3RhbmNlb2YgSFRUUEVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChTVEFUVVNfTk9fUkVUUlkuaW5jbHVkZXMoZXJyb3Iuc3RhdHVzKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKG9uRmFpbGVkUmVzcG9uc2VIb29rICYmIGVycm9yLnJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBvbkZhaWxlZFJlc3BvbnNlSG9vayhlcnJvci5yZXNwb25zZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgLy8gSWYgbmVlZGVkIHdlIGNhbiBjaGFuZ2Ugc29tZSBvZiB0aGUgZGVmYXVsdHMgaGVyZSxcbiAgICAgICAgICAgIC8vIGJ1dCB0aGV5J3JlIHF1aXRlIHNlbnNpYmxlLlxuICAgICAgICAgICAgcmV0cmllczogdGhpcy5tYXhSZXRyaWVzLFxuICAgICAgICAgICAgcmFuZG9taXplOiB0cnVlLFxuICAgICAgICB9KSwgeyB0aHJvd09uVGltZW91dDogdHJ1ZSB9KTtcbiAgICB9XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICBjYWxsV2l0aE9wdGlvbnMob3B0aW9ucywgY2FsbGFibGUsIC4uLmFyZ3MpIHtcbiAgICAgICAgLy8gTm90ZSB0aGlzIGRvZXNuJ3QgY2FuY2VsIHRoZSB1bmRlcmx5aW5nIHJlcXVlc3QsXG4gICAgICAgIC8vIHdoZW4gYXZhaWxhYmxlIHByZWZlciB0byB1c2UgdGhlIHNpZ25hbCBvcHRpb24gb2YgdGhlIHVuZGVybHlpbmcgY2FsbFxuICAgICAgICBpZiAob3B0aW9ucy5zaWduYWwpIHtcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJhY2UoW1xuICAgICAgICAgICAgICAgIHRoaXMuY2FsbChjYWxsYWJsZSwgLi4uYXJncyksXG4gICAgICAgICAgICAgICAgbmV3IFByb21pc2UoKF8sIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBvcHRpb25zLnNpZ25hbD8uYWRkRXZlbnRMaXN0ZW5lcihcImFib3J0XCIsICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChuZXcgRXJyb3IoXCJBYm9ydEVycm9yXCIpKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICBdKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5jYWxsKGNhbGxhYmxlLCAuLi5hcmdzKTtcbiAgICB9XG4gICAgZmV0Y2goLi4uYXJncykge1xuICAgICAgICBjb25zdCBmZXRjaEZuID0gdGhpcy5jdXN0b21GZXRjaCA/PyBfZ2V0RmV0Y2hJbXBsZW1lbnRhdGlvbigpO1xuICAgICAgICByZXR1cm4gdGhpcy5jYWxsKCgpID0+IGZldGNoRm4oLi4uYXJncykudGhlbigocmVzKSA9PiAocmVzLm9rID8gcmVzIDogUHJvbWlzZS5yZWplY3QocmVzKSkpKTtcbiAgICB9XG59XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@ag-ui/langgraph/node_modules/@langchain/langgraph-sdk/dist/utils/async_caller.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@ag-ui/langgraph/node_modules/@langchain/langgraph-sdk/dist/utils/env.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/@ag-ui/langgraph/node_modules/@langchain/langgraph-sdk/dist/utils/env.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getEnvironmentVariable: () => (/* binding */ getEnvironmentVariable)\n/* harmony export */ });\nfunction getEnvironmentVariable(name) {\n    // Certain setups (Deno, frontend) will throw an error if you try to access environment variables\n    try {\n        return typeof process !== \"undefined\"\n            ? // eslint-disable-next-line no-process-env\n                process.env?.[name]\n            : undefined;\n    }\n    catch (e) {\n        return undefined;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQGFnLXVpL2xhbmdncmFwaC9ub2RlX21vZHVsZXMvQGxhbmdjaGFpbi9sYW5nZ3JhcGgtc2RrL2Rpc3QvdXRpbHMvZW52LmpzIiwibWFwcGluZ3MiOiI7Ozs7QUFBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIi9ob21lL2NldGVjL05vZGVQcm9qZWN0cy9hZ3VpX3Rlc3Qvbm9kZV9tb2R1bGVzL0BhZy11aS9sYW5nZ3JhcGgvbm9kZV9tb2R1bGVzL0BsYW5nY2hhaW4vbGFuZ2dyYXBoLXNkay9kaXN0L3V0aWxzL2Vudi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZnVuY3Rpb24gZ2V0RW52aXJvbm1lbnRWYXJpYWJsZShuYW1lKSB7XG4gICAgLy8gQ2VydGFpbiBzZXR1cHMgKERlbm8sIGZyb250ZW5kKSB3aWxsIHRocm93IGFuIGVycm9yIGlmIHlvdSB0cnkgdG8gYWNjZXNzIGVudmlyb25tZW50IHZhcmlhYmxlc1xuICAgIHRyeSB7XG4gICAgICAgIHJldHVybiB0eXBlb2YgcHJvY2VzcyAhPT0gXCJ1bmRlZmluZWRcIlxuICAgICAgICAgICAgPyAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tcHJvY2Vzcy1lbnZcbiAgICAgICAgICAgICAgICBwcm9jZXNzLmVudj8uW25hbWVdXG4gICAgICAgICAgICA6IHVuZGVmaW5lZDtcbiAgICB9XG4gICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG59XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@ag-ui/langgraph/node_modules/@langchain/langgraph-sdk/dist/utils/env.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@ag-ui/langgraph/node_modules/@langchain/langgraph-sdk/dist/utils/signals.js":
/*!***************************************************************************************************!*\
  !*** ./node_modules/@ag-ui/langgraph/node_modules/@langchain/langgraph-sdk/dist/utils/signals.js ***!
  \***************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   mergeSignals: () => (/* binding */ mergeSignals)\n/* harmony export */ });\nfunction mergeSignals(...signals) {\n    const nonZeroSignals = signals.filter((signal) => signal != null);\n    if (nonZeroSignals.length === 0)\n        return undefined;\n    if (nonZeroSignals.length === 1)\n        return nonZeroSignals[0];\n    const controller = new AbortController();\n    for (const signal of signals) {\n        if (signal?.aborted) {\n            controller.abort(signal.reason);\n            return controller.signal;\n        }\n        signal?.addEventListener(\"abort\", () => controller.abort(signal.reason), {\n            once: true,\n        });\n    }\n    return controller.signal;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQGFnLXVpL2xhbmdncmFwaC9ub2RlX21vZHVsZXMvQGxhbmdjaGFpbi9sYW5nZ3JhcGgtc2RrL2Rpc3QvdXRpbHMvc2lnbmFscy5qcyIsIm1hcHBpbmdzIjoiOzs7O0FBQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIi9ob21lL2NldGVjL05vZGVQcm9qZWN0cy9hZ3VpX3Rlc3Qvbm9kZV9tb2R1bGVzL0BhZy11aS9sYW5nZ3JhcGgvbm9kZV9tb2R1bGVzL0BsYW5nY2hhaW4vbGFuZ2dyYXBoLXNkay9kaXN0L3V0aWxzL3NpZ25hbHMuanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGZ1bmN0aW9uIG1lcmdlU2lnbmFscyguLi5zaWduYWxzKSB7XG4gICAgY29uc3Qgbm9uWmVyb1NpZ25hbHMgPSBzaWduYWxzLmZpbHRlcigoc2lnbmFsKSA9PiBzaWduYWwgIT0gbnVsbCk7XG4gICAgaWYgKG5vblplcm9TaWduYWxzLmxlbmd0aCA9PT0gMClcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICBpZiAobm9uWmVyb1NpZ25hbHMubGVuZ3RoID09PSAxKVxuICAgICAgICByZXR1cm4gbm9uWmVyb1NpZ25hbHNbMF07XG4gICAgY29uc3QgY29udHJvbGxlciA9IG5ldyBBYm9ydENvbnRyb2xsZXIoKTtcbiAgICBmb3IgKGNvbnN0IHNpZ25hbCBvZiBzaWduYWxzKSB7XG4gICAgICAgIGlmIChzaWduYWw/LmFib3J0ZWQpIHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXIuYWJvcnQoc2lnbmFsLnJlYXNvbik7XG4gICAgICAgICAgICByZXR1cm4gY29udHJvbGxlci5zaWduYWw7XG4gICAgICAgIH1cbiAgICAgICAgc2lnbmFsPy5hZGRFdmVudExpc3RlbmVyKFwiYWJvcnRcIiwgKCkgPT4gY29udHJvbGxlci5hYm9ydChzaWduYWwucmVhc29uKSwge1xuICAgICAgICAgICAgb25jZTogdHJ1ZSxcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHJldHVybiBjb250cm9sbGVyLnNpZ25hbDtcbn1cbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@ag-ui/langgraph/node_modules/@langchain/langgraph-sdk/dist/utils/signals.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@ag-ui/langgraph/node_modules/@langchain/langgraph-sdk/dist/utils/sse.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/@ag-ui/langgraph/node_modules/@langchain/langgraph-sdk/dist/utils/sse.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   BytesLineDecoder: () => (/* binding */ BytesLineDecoder),\n/* harmony export */   SSEDecoder: () => (/* binding */ SSEDecoder)\n/* harmony export */ });\nconst CR = \"\\r\".charCodeAt(0);\nconst LF = \"\\n\".charCodeAt(0);\nconst NULL = \"\\0\".charCodeAt(0);\nconst COLON = \":\".charCodeAt(0);\nconst SPACE = \" \".charCodeAt(0);\nconst TRAILING_NEWLINE = [CR, LF];\nfunction BytesLineDecoder() {\n    let buffer = [];\n    let trailingCr = false;\n    return new TransformStream({\n        start() {\n            buffer = [];\n            trailingCr = false;\n        },\n        transform(chunk, controller) {\n            // See https://docs.python.org/3/glossary.html#term-universal-newlines\n            let text = chunk;\n            // Handle trailing CR from previous chunk\n            if (trailingCr) {\n                text = joinArrays([[CR], text]);\n                trailingCr = false;\n            }\n            // Check for trailing CR in current chunk\n            if (text.length > 0 && text.at(-1) === CR) {\n                trailingCr = true;\n                text = text.subarray(0, -1);\n            }\n            if (!text.length)\n                return;\n            const trailingNewline = TRAILING_NEWLINE.includes(text.at(-1));\n            const lastIdx = text.length - 1;\n            const { lines } = text.reduce((acc, cur, idx) => {\n                if (acc.from > idx)\n                    return acc;\n                if (cur === CR || cur === LF) {\n                    acc.lines.push(text.subarray(acc.from, idx));\n                    if (cur === CR && text[idx + 1] === LF) {\n                        acc.from = idx + 2;\n                    }\n                    else {\n                        acc.from = idx + 1;\n                    }\n                }\n                if (idx === lastIdx && acc.from <= lastIdx) {\n                    acc.lines.push(text.subarray(acc.from));\n                }\n                return acc;\n            }, { lines: [], from: 0 });\n            if (lines.length === 1 && !trailingNewline) {\n                buffer.push(lines[0]);\n                return;\n            }\n            if (buffer.length) {\n                // Include existing buffer in first line\n                buffer.push(lines[0]);\n                lines[0] = joinArrays(buffer);\n                buffer = [];\n            }\n            if (!trailingNewline) {\n                // If the last segment is not newline terminated,\n                // buffer it for the next chunk\n                if (lines.length)\n                    buffer = [lines.pop()];\n            }\n            // Enqueue complete lines\n            for (const line of lines) {\n                controller.enqueue(line);\n            }\n        },\n        flush(controller) {\n            if (buffer.length) {\n                controller.enqueue(joinArrays(buffer));\n            }\n        },\n    });\n}\nfunction SSEDecoder() {\n    let event = \"\";\n    let data = [];\n    let lastEventId = \"\";\n    let retry = null;\n    const decoder = new TextDecoder();\n    return new TransformStream({\n        transform(chunk, controller) {\n            // Handle empty line case\n            if (!chunk.length) {\n                if (!event && !data.length && !lastEventId && retry == null)\n                    return;\n                const sse = {\n                    id: lastEventId || undefined,\n                    event,\n                    data: data.length ? decodeArraysToJson(decoder, data) : null,\n                };\n                // NOTE: as per the SSE spec, do not reset lastEventId\n                event = \"\";\n                data = [];\n                retry = null;\n                controller.enqueue(sse);\n                return;\n            }\n            // Ignore comments\n            if (chunk[0] === COLON)\n                return;\n            const sepIdx = chunk.indexOf(COLON);\n            if (sepIdx === -1)\n                return;\n            const fieldName = decoder.decode(chunk.subarray(0, sepIdx));\n            let value = chunk.subarray(sepIdx + 1);\n            if (value[0] === SPACE)\n                value = value.subarray(1);\n            if (fieldName === \"event\") {\n                event = decoder.decode(value);\n            }\n            else if (fieldName === \"data\") {\n                data.push(value);\n            }\n            else if (fieldName === \"id\") {\n                if (value.indexOf(NULL) === -1)\n                    lastEventId = decoder.decode(value);\n            }\n            else if (fieldName === \"retry\") {\n                const retryNum = Number.parseInt(decoder.decode(value), 10);\n                if (!Number.isNaN(retryNum))\n                    retry = retryNum;\n            }\n        },\n        flush(controller) {\n            if (event) {\n                controller.enqueue({\n                    id: lastEventId || undefined,\n                    event,\n                    data: data.length ? decodeArraysToJson(decoder, data) : null,\n                });\n            }\n        },\n    });\n}\nfunction joinArrays(data) {\n    const totalLength = data.reduce((acc, curr) => acc + curr.length, 0);\n    const merged = new Uint8Array(totalLength);\n    let offset = 0;\n    for (const c of data) {\n        merged.set(c, offset);\n        offset += c.length;\n    }\n    return merged;\n}\nfunction decodeArraysToJson(decoder, data) {\n    return JSON.parse(decoder.decode(joinArrays(data)));\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQGFnLXVpL2xhbmdncmFwaC9ub2RlX21vZHVsZXMvQGxhbmdjaGFpbi9sYW5nZ3JhcGgtc2RrL2Rpc3QvdXRpbHMvc3NlLmpzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixRQUFRO0FBQzVCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsSUFBSSxvQkFBb0I7QUFDckM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCxLQUFLO0FBQ0w7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQSxTQUFTO0FBQ1QsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIi9ob21lL2NldGVjL05vZGVQcm9qZWN0cy9hZ3VpX3Rlc3Qvbm9kZV9tb2R1bGVzL0BhZy11aS9sYW5nZ3JhcGgvbm9kZV9tb2R1bGVzL0BsYW5nY2hhaW4vbGFuZ2dyYXBoLXNkay9kaXN0L3V0aWxzL3NzZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBDUiA9IFwiXFxyXCIuY2hhckNvZGVBdCgwKTtcbmNvbnN0IExGID0gXCJcXG5cIi5jaGFyQ29kZUF0KDApO1xuY29uc3QgTlVMTCA9IFwiXFwwXCIuY2hhckNvZGVBdCgwKTtcbmNvbnN0IENPTE9OID0gXCI6XCIuY2hhckNvZGVBdCgwKTtcbmNvbnN0IFNQQUNFID0gXCIgXCIuY2hhckNvZGVBdCgwKTtcbmNvbnN0IFRSQUlMSU5HX05FV0xJTkUgPSBbQ1IsIExGXTtcbmV4cG9ydCBmdW5jdGlvbiBCeXRlc0xpbmVEZWNvZGVyKCkge1xuICAgIGxldCBidWZmZXIgPSBbXTtcbiAgICBsZXQgdHJhaWxpbmdDciA9IGZhbHNlO1xuICAgIHJldHVybiBuZXcgVHJhbnNmb3JtU3RyZWFtKHtcbiAgICAgICAgc3RhcnQoKSB7XG4gICAgICAgICAgICBidWZmZXIgPSBbXTtcbiAgICAgICAgICAgIHRyYWlsaW5nQ3IgPSBmYWxzZTtcbiAgICAgICAgfSxcbiAgICAgICAgdHJhbnNmb3JtKGNodW5rLCBjb250cm9sbGVyKSB7XG4gICAgICAgICAgICAvLyBTZWUgaHR0cHM6Ly9kb2NzLnB5dGhvbi5vcmcvMy9nbG9zc2FyeS5odG1sI3Rlcm0tdW5pdmVyc2FsLW5ld2xpbmVzXG4gICAgICAgICAgICBsZXQgdGV4dCA9IGNodW5rO1xuICAgICAgICAgICAgLy8gSGFuZGxlIHRyYWlsaW5nIENSIGZyb20gcHJldmlvdXMgY2h1bmtcbiAgICAgICAgICAgIGlmICh0cmFpbGluZ0NyKSB7XG4gICAgICAgICAgICAgICAgdGV4dCA9IGpvaW5BcnJheXMoW1tDUl0sIHRleHRdKTtcbiAgICAgICAgICAgICAgICB0cmFpbGluZ0NyID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBDaGVjayBmb3IgdHJhaWxpbmcgQ1IgaW4gY3VycmVudCBjaHVua1xuICAgICAgICAgICAgaWYgKHRleHQubGVuZ3RoID4gMCAmJiB0ZXh0LmF0KC0xKSA9PT0gQ1IpIHtcbiAgICAgICAgICAgICAgICB0cmFpbGluZ0NyID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB0ZXh0ID0gdGV4dC5zdWJhcnJheSgwLCAtMSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIXRleHQubGVuZ3RoKVxuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIGNvbnN0IHRyYWlsaW5nTmV3bGluZSA9IFRSQUlMSU5HX05FV0xJTkUuaW5jbHVkZXModGV4dC5hdCgtMSkpO1xuICAgICAgICAgICAgY29uc3QgbGFzdElkeCA9IHRleHQubGVuZ3RoIC0gMTtcbiAgICAgICAgICAgIGNvbnN0IHsgbGluZXMgfSA9IHRleHQucmVkdWNlKChhY2MsIGN1ciwgaWR4KSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGFjYy5mcm9tID4gaWR4KVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYWNjO1xuICAgICAgICAgICAgICAgIGlmIChjdXIgPT09IENSIHx8IGN1ciA9PT0gTEYpIHtcbiAgICAgICAgICAgICAgICAgICAgYWNjLmxpbmVzLnB1c2godGV4dC5zdWJhcnJheShhY2MuZnJvbSwgaWR4KSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjdXIgPT09IENSICYmIHRleHRbaWR4ICsgMV0gPT09IExGKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhY2MuZnJvbSA9IGlkeCArIDI7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhY2MuZnJvbSA9IGlkeCArIDE7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGlkeCA9PT0gbGFzdElkeCAmJiBhY2MuZnJvbSA8PSBsYXN0SWR4KSB7XG4gICAgICAgICAgICAgICAgICAgIGFjYy5saW5lcy5wdXNoKHRleHQuc3ViYXJyYXkoYWNjLmZyb20pKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGFjYztcbiAgICAgICAgICAgIH0sIHsgbGluZXM6IFtdLCBmcm9tOiAwIH0pO1xuICAgICAgICAgICAgaWYgKGxpbmVzLmxlbmd0aCA9PT0gMSAmJiAhdHJhaWxpbmdOZXdsaW5lKSB7XG4gICAgICAgICAgICAgICAgYnVmZmVyLnB1c2gobGluZXNbMF0pO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChidWZmZXIubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgLy8gSW5jbHVkZSBleGlzdGluZyBidWZmZXIgaW4gZmlyc3QgbGluZVxuICAgICAgICAgICAgICAgIGJ1ZmZlci5wdXNoKGxpbmVzWzBdKTtcbiAgICAgICAgICAgICAgICBsaW5lc1swXSA9IGpvaW5BcnJheXMoYnVmZmVyKTtcbiAgICAgICAgICAgICAgICBidWZmZXIgPSBbXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghdHJhaWxpbmdOZXdsaW5lKSB7XG4gICAgICAgICAgICAgICAgLy8gSWYgdGhlIGxhc3Qgc2VnbWVudCBpcyBub3QgbmV3bGluZSB0ZXJtaW5hdGVkLFxuICAgICAgICAgICAgICAgIC8vIGJ1ZmZlciBpdCBmb3IgdGhlIG5leHQgY2h1bmtcbiAgICAgICAgICAgICAgICBpZiAobGluZXMubGVuZ3RoKVxuICAgICAgICAgICAgICAgICAgICBidWZmZXIgPSBbbGluZXMucG9wKCldO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gRW5xdWV1ZSBjb21wbGV0ZSBsaW5lc1xuICAgICAgICAgICAgZm9yIChjb25zdCBsaW5lIG9mIGxpbmVzKSB7XG4gICAgICAgICAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKGxpbmUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBmbHVzaChjb250cm9sbGVyKSB7XG4gICAgICAgICAgICBpZiAoYnVmZmVyLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXIuZW5xdWV1ZShqb2luQXJyYXlzKGJ1ZmZlcikpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgIH0pO1xufVxuZXhwb3J0IGZ1bmN0aW9uIFNTRURlY29kZXIoKSB7XG4gICAgbGV0IGV2ZW50ID0gXCJcIjtcbiAgICBsZXQgZGF0YSA9IFtdO1xuICAgIGxldCBsYXN0RXZlbnRJZCA9IFwiXCI7XG4gICAgbGV0IHJldHJ5ID0gbnVsbDtcbiAgICBjb25zdCBkZWNvZGVyID0gbmV3IFRleHREZWNvZGVyKCk7XG4gICAgcmV0dXJuIG5ldyBUcmFuc2Zvcm1TdHJlYW0oe1xuICAgICAgICB0cmFuc2Zvcm0oY2h1bmssIGNvbnRyb2xsZXIpIHtcbiAgICAgICAgICAgIC8vIEhhbmRsZSBlbXB0eSBsaW5lIGNhc2VcbiAgICAgICAgICAgIGlmICghY2h1bmsubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFldmVudCAmJiAhZGF0YS5sZW5ndGggJiYgIWxhc3RFdmVudElkICYmIHJldHJ5ID09IG51bGwpXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICBjb25zdCBzc2UgPSB7XG4gICAgICAgICAgICAgICAgICAgIGlkOiBsYXN0RXZlbnRJZCB8fCB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgICAgIGV2ZW50LFxuICAgICAgICAgICAgICAgICAgICBkYXRhOiBkYXRhLmxlbmd0aCA/IGRlY29kZUFycmF5c1RvSnNvbihkZWNvZGVyLCBkYXRhKSA6IG51bGwsXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAvLyBOT1RFOiBhcyBwZXIgdGhlIFNTRSBzcGVjLCBkbyBub3QgcmVzZXQgbGFzdEV2ZW50SWRcbiAgICAgICAgICAgICAgICBldmVudCA9IFwiXCI7XG4gICAgICAgICAgICAgICAgZGF0YSA9IFtdO1xuICAgICAgICAgICAgICAgIHJldHJ5ID0gbnVsbDtcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyLmVucXVldWUoc3NlKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBJZ25vcmUgY29tbWVudHNcbiAgICAgICAgICAgIGlmIChjaHVua1swXSA9PT0gQ09MT04pXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgY29uc3Qgc2VwSWR4ID0gY2h1bmsuaW5kZXhPZihDT0xPTik7XG4gICAgICAgICAgICBpZiAoc2VwSWR4ID09PSAtMSlcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICBjb25zdCBmaWVsZE5hbWUgPSBkZWNvZGVyLmRlY29kZShjaHVuay5zdWJhcnJheSgwLCBzZXBJZHgpKTtcbiAgICAgICAgICAgIGxldCB2YWx1ZSA9IGNodW5rLnN1YmFycmF5KHNlcElkeCArIDEpO1xuICAgICAgICAgICAgaWYgKHZhbHVlWzBdID09PSBTUEFDRSlcbiAgICAgICAgICAgICAgICB2YWx1ZSA9IHZhbHVlLnN1YmFycmF5KDEpO1xuICAgICAgICAgICAgaWYgKGZpZWxkTmFtZSA9PT0gXCJldmVudFwiKSB7XG4gICAgICAgICAgICAgICAgZXZlbnQgPSBkZWNvZGVyLmRlY29kZSh2YWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChmaWVsZE5hbWUgPT09IFwiZGF0YVwiKSB7XG4gICAgICAgICAgICAgICAgZGF0YS5wdXNoKHZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGZpZWxkTmFtZSA9PT0gXCJpZFwiKSB7XG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlLmluZGV4T2YoTlVMTCkgPT09IC0xKVxuICAgICAgICAgICAgICAgICAgICBsYXN0RXZlbnRJZCA9IGRlY29kZXIuZGVjb2RlKHZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGZpZWxkTmFtZSA9PT0gXCJyZXRyeVwiKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcmV0cnlOdW0gPSBOdW1iZXIucGFyc2VJbnQoZGVjb2Rlci5kZWNvZGUodmFsdWUpLCAxMCk7XG4gICAgICAgICAgICAgICAgaWYgKCFOdW1iZXIuaXNOYU4ocmV0cnlOdW0pKVxuICAgICAgICAgICAgICAgICAgICByZXRyeSA9IHJldHJ5TnVtO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBmbHVzaChjb250cm9sbGVyKSB7XG4gICAgICAgICAgICBpZiAoZXZlbnQpIHtcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyLmVucXVldWUoe1xuICAgICAgICAgICAgICAgICAgICBpZDogbGFzdEV2ZW50SWQgfHwgdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgICAgICBldmVudCxcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogZGF0YS5sZW5ndGggPyBkZWNvZGVBcnJheXNUb0pzb24oZGVjb2RlciwgZGF0YSkgOiBudWxsLFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgIH0pO1xufVxuZnVuY3Rpb24gam9pbkFycmF5cyhkYXRhKSB7XG4gICAgY29uc3QgdG90YWxMZW5ndGggPSBkYXRhLnJlZHVjZSgoYWNjLCBjdXJyKSA9PiBhY2MgKyBjdXJyLmxlbmd0aCwgMCk7XG4gICAgY29uc3QgbWVyZ2VkID0gbmV3IFVpbnQ4QXJyYXkodG90YWxMZW5ndGgpO1xuICAgIGxldCBvZmZzZXQgPSAwO1xuICAgIGZvciAoY29uc3QgYyBvZiBkYXRhKSB7XG4gICAgICAgIG1lcmdlZC5zZXQoYywgb2Zmc2V0KTtcbiAgICAgICAgb2Zmc2V0ICs9IGMubGVuZ3RoO1xuICAgIH1cbiAgICByZXR1cm4gbWVyZ2VkO1xufVxuZnVuY3Rpb24gZGVjb2RlQXJyYXlzVG9Kc29uKGRlY29kZXIsIGRhdGEpIHtcbiAgICByZXR1cm4gSlNPTi5wYXJzZShkZWNvZGVyLmRlY29kZShqb2luQXJyYXlzKGRhdGEpKSk7XG59XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@ag-ui/langgraph/node_modules/@langchain/langgraph-sdk/dist/utils/sse.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@ag-ui/langgraph/node_modules/@langchain/langgraph-sdk/dist/utils/stream.js":
/*!**************************************************************************************************!*\
  !*** ./node_modules/@ag-ui/langgraph/node_modules/@langchain/langgraph-sdk/dist/utils/stream.js ***!
  \**************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   IterableReadableStream: () => (/* binding */ IterableReadableStream)\n/* harmony export */ });\n/*\n * Support async iterator syntax for ReadableStreams in all environments.\n * Source: https://github.com/MattiasBuelens/web-streams-polyfill/pull/122#issuecomment-1627354490\n */\nclass IterableReadableStream extends ReadableStream {\n    constructor() {\n        super(...arguments);\n        Object.defineProperty(this, \"reader\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n    }\n    ensureReader() {\n        if (!this.reader) {\n            this.reader = this.getReader();\n        }\n    }\n    async next() {\n        this.ensureReader();\n        try {\n            const result = await this.reader.read();\n            if (result.done) {\n                this.reader.releaseLock(); // release lock when stream becomes closed\n                return {\n                    done: true,\n                    value: undefined,\n                };\n            }\n            else {\n                return {\n                    done: false,\n                    value: result.value,\n                };\n            }\n        }\n        catch (e) {\n            this.reader.releaseLock(); // release lock when stream becomes errored\n            throw e;\n        }\n    }\n    async return() {\n        this.ensureReader();\n        // If wrapped in a Node stream, cancel is already called.\n        if (this.locked) {\n            const cancelPromise = this.reader.cancel(); // cancel first, but don't await yet\n            this.reader.releaseLock(); // release lock first\n            await cancelPromise; // now await it\n        }\n        return { done: true, value: undefined };\n    }\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    async throw(e) {\n        this.ensureReader();\n        if (this.locked) {\n            const cancelPromise = this.reader.cancel(); // cancel first, but don't await yet\n            this.reader.releaseLock(); // release lock first\n            await cancelPromise; // now await it\n        }\n        throw e;\n    }\n    // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n    // @ts-ignore Not present in Node 18 types, required in latest Node 22\n    async [Symbol.asyncDispose]() {\n        await this.return();\n    }\n    [Symbol.asyncIterator]() {\n        return this;\n    }\n    static fromReadableStream(stream) {\n        // From https://developer.mozilla.org/en-US/docs/Web/API/Streams_API/Using_readable_streams#reading_the_stream\n        const reader = stream.getReader();\n        return new IterableReadableStream({\n            start(controller) {\n                return pump();\n                function pump() {\n                    return reader.read().then(({ done, value }) => {\n                        // When no more data needs to be consumed, close the stream\n                        if (done) {\n                            controller.close();\n                            return;\n                        }\n                        // Enqueue the next data chunk into our target stream\n                        controller.enqueue(value);\n                        return pump();\n                    });\n                }\n            },\n            cancel() {\n                reader.releaseLock();\n            },\n        });\n    }\n    static fromAsyncGenerator(generator) {\n        return new IterableReadableStream({\n            async pull(controller) {\n                const { value, done } = await generator.next();\n                // When no more data needs to be consumed, close the stream\n                if (done) {\n                    controller.close();\n                }\n                // Fix: `else if (value)` will hang the streaming when nullish value (e.g. empty string) is pulled\n                controller.enqueue(value);\n            },\n            async cancel(reason) {\n                await generator.return(reason);\n            },\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQGFnLXVpL2xhbmdncmFwaC9ub2RlX21vZHVsZXMvQGxhbmdjaGFpbi9sYW5nZ3JhcGgtc2RrL2Rpc3QvdXRpbHMvc3RyZWFtLmpzIiwibWFwcGluZ3MiOiI7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJDQUEyQztBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVDQUF1QztBQUN2QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdEQUF3RDtBQUN4RCx1Q0FBdUM7QUFDdkMsaUNBQWlDO0FBQ2pDO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3REFBd0Q7QUFDeEQsdUNBQXVDO0FBQ3ZDLGlDQUFpQztBQUNqQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpREFBaUQsYUFBYTtBQUM5RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGNBQWM7QUFDdEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0EiLCJzb3VyY2VzIjpbIi9ob21lL2NldGVjL05vZGVQcm9qZWN0cy9hZ3VpX3Rlc3Qvbm9kZV9tb2R1bGVzL0BhZy11aS9sYW5nZ3JhcGgvbm9kZV9tb2R1bGVzL0BsYW5nY2hhaW4vbGFuZ2dyYXBoLXNkay9kaXN0L3V0aWxzL3N0cmVhbS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuICogU3VwcG9ydCBhc3luYyBpdGVyYXRvciBzeW50YXggZm9yIFJlYWRhYmxlU3RyZWFtcyBpbiBhbGwgZW52aXJvbm1lbnRzLlxuICogU291cmNlOiBodHRwczovL2dpdGh1Yi5jb20vTWF0dGlhc0J1ZWxlbnMvd2ViLXN0cmVhbXMtcG9seWZpbGwvcHVsbC8xMjIjaXNzdWVjb21tZW50LTE2MjczNTQ0OTBcbiAqL1xuZXhwb3J0IGNsYXNzIEl0ZXJhYmxlUmVhZGFibGVTdHJlYW0gZXh0ZW5kcyBSZWFkYWJsZVN0cmVhbSB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHN1cGVyKC4uLmFyZ3VtZW50cyk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcInJlYWRlclwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogdm9pZCAwXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBlbnN1cmVSZWFkZXIoKSB7XG4gICAgICAgIGlmICghdGhpcy5yZWFkZXIpIHtcbiAgICAgICAgICAgIHRoaXMucmVhZGVyID0gdGhpcy5nZXRSZWFkZXIoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBhc3luYyBuZXh0KCkge1xuICAgICAgICB0aGlzLmVuc3VyZVJlYWRlcigpO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5yZWFkZXIucmVhZCgpO1xuICAgICAgICAgICAgaWYgKHJlc3VsdC5kb25lKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5yZWFkZXIucmVsZWFzZUxvY2soKTsgLy8gcmVsZWFzZSBsb2NrIHdoZW4gc3RyZWFtIGJlY29tZXMgY2xvc2VkXG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgZG9uZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgZG9uZTogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiByZXN1bHQudmFsdWUsXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgdGhpcy5yZWFkZXIucmVsZWFzZUxvY2soKTsgLy8gcmVsZWFzZSBsb2NrIHdoZW4gc3RyZWFtIGJlY29tZXMgZXJyb3JlZFxuICAgICAgICAgICAgdGhyb3cgZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBhc3luYyByZXR1cm4oKSB7XG4gICAgICAgIHRoaXMuZW5zdXJlUmVhZGVyKCk7XG4gICAgICAgIC8vIElmIHdyYXBwZWQgaW4gYSBOb2RlIHN0cmVhbSwgY2FuY2VsIGlzIGFscmVhZHkgY2FsbGVkLlxuICAgICAgICBpZiAodGhpcy5sb2NrZWQpIHtcbiAgICAgICAgICAgIGNvbnN0IGNhbmNlbFByb21pc2UgPSB0aGlzLnJlYWRlci5jYW5jZWwoKTsgLy8gY2FuY2VsIGZpcnN0LCBidXQgZG9uJ3QgYXdhaXQgeWV0XG4gICAgICAgICAgICB0aGlzLnJlYWRlci5yZWxlYXNlTG9jaygpOyAvLyByZWxlYXNlIGxvY2sgZmlyc3RcbiAgICAgICAgICAgIGF3YWl0IGNhbmNlbFByb21pc2U7IC8vIG5vdyBhd2FpdCBpdFxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7IGRvbmU6IHRydWUsIHZhbHVlOiB1bmRlZmluZWQgfTtcbiAgICB9XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICBhc3luYyB0aHJvdyhlKSB7XG4gICAgICAgIHRoaXMuZW5zdXJlUmVhZGVyKCk7XG4gICAgICAgIGlmICh0aGlzLmxvY2tlZCkge1xuICAgICAgICAgICAgY29uc3QgY2FuY2VsUHJvbWlzZSA9IHRoaXMucmVhZGVyLmNhbmNlbCgpOyAvLyBjYW5jZWwgZmlyc3QsIGJ1dCBkb24ndCBhd2FpdCB5ZXRcbiAgICAgICAgICAgIHRoaXMucmVhZGVyLnJlbGVhc2VMb2NrKCk7IC8vIHJlbGVhc2UgbG9jayBmaXJzdFxuICAgICAgICAgICAgYXdhaXQgY2FuY2VsUHJvbWlzZTsgLy8gbm93IGF3YWl0IGl0XG4gICAgICAgIH1cbiAgICAgICAgdGhyb3cgZTtcbiAgICB9XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9iYW4tdHMtY29tbWVudFxuICAgIC8vIEB0cy1pZ25vcmUgTm90IHByZXNlbnQgaW4gTm9kZSAxOCB0eXBlcywgcmVxdWlyZWQgaW4gbGF0ZXN0IE5vZGUgMjJcbiAgICBhc3luYyBbU3ltYm9sLmFzeW5jRGlzcG9zZV0oKSB7XG4gICAgICAgIGF3YWl0IHRoaXMucmV0dXJuKCk7XG4gICAgfVxuICAgIFtTeW1ib2wuYXN5bmNJdGVyYXRvcl0oKSB7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICBzdGF0aWMgZnJvbVJlYWRhYmxlU3RyZWFtKHN0cmVhbSkge1xuICAgICAgICAvLyBGcm9tIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS9TdHJlYW1zX0FQSS9Vc2luZ19yZWFkYWJsZV9zdHJlYW1zI3JlYWRpbmdfdGhlX3N0cmVhbVxuICAgICAgICBjb25zdCByZWFkZXIgPSBzdHJlYW0uZ2V0UmVhZGVyKCk7XG4gICAgICAgIHJldHVybiBuZXcgSXRlcmFibGVSZWFkYWJsZVN0cmVhbSh7XG4gICAgICAgICAgICBzdGFydChjb250cm9sbGVyKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHB1bXAoKTtcbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBwdW1wKCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVhZGVyLnJlYWQoKS50aGVuKCh7IGRvbmUsIHZhbHVlIH0pID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFdoZW4gbm8gbW9yZSBkYXRhIG5lZWRzIHRvIGJlIGNvbnN1bWVkLCBjbG9zZSB0aGUgc3RyZWFtXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZG9uZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXIuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBFbnF1ZXVlIHRoZSBuZXh0IGRhdGEgY2h1bmsgaW50byBvdXIgdGFyZ2V0IHN0cmVhbVxuICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwdW1wKCk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBjYW5jZWwoKSB7XG4gICAgICAgICAgICAgICAgcmVhZGVyLnJlbGVhc2VMb2NrKCk7XG4gICAgICAgICAgICB9LFxuICAgICAgICB9KTtcbiAgICB9XG4gICAgc3RhdGljIGZyb21Bc3luY0dlbmVyYXRvcihnZW5lcmF0b3IpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBJdGVyYWJsZVJlYWRhYmxlU3RyZWFtKHtcbiAgICAgICAgICAgIGFzeW5jIHB1bGwoY29udHJvbGxlcikge1xuICAgICAgICAgICAgICAgIGNvbnN0IHsgdmFsdWUsIGRvbmUgfSA9IGF3YWl0IGdlbmVyYXRvci5uZXh0KCk7XG4gICAgICAgICAgICAgICAgLy8gV2hlbiBubyBtb3JlIGRhdGEgbmVlZHMgdG8gYmUgY29uc3VtZWQsIGNsb3NlIHRoZSBzdHJlYW1cbiAgICAgICAgICAgICAgICBpZiAoZG9uZSkge1xuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyLmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIEZpeDogYGVsc2UgaWYgKHZhbHVlKWAgd2lsbCBoYW5nIHRoZSBzdHJlYW1pbmcgd2hlbiBudWxsaXNoIHZhbHVlIChlLmcuIGVtcHR5IHN0cmluZykgaXMgcHVsbGVkXG4gICAgICAgICAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKHZhbHVlKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBhc3luYyBjYW5jZWwocmVhc29uKSB7XG4gICAgICAgICAgICAgICAgYXdhaXQgZ2VuZXJhdG9yLnJldHVybihyZWFzb24pO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgfSk7XG4gICAgfVxufVxuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@ag-ui/langgraph/node_modules/@langchain/langgraph-sdk/dist/utils/stream.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@ag-ui/langgraph/node_modules/@langchain/langgraph-sdk/index.js":
/*!**************************************************************************************!*\
  !*** ./node_modules/@ag-ui/langgraph/node_modules/@langchain/langgraph-sdk/index.js ***!
  \**************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   Client: () => (/* reexport safe */ _dist_index_js__WEBPACK_IMPORTED_MODULE_0__.Client),
/* harmony export */   getApiKey: () => (/* reexport safe */ _dist_index_js__WEBPACK_IMPORTED_MODULE_0__.getApiKey),
/* harmony export */   overrideFetchImplementation: () => (/* reexport safe */ _dist_index_js__WEBPACK_IMPORTED_MODULE_0__.overrideFetchImplementation)
/* harmony export */ });
/* harmony import */ var _dist_index_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./dist/index.js */ "(rsc)/./node_modules/@ag-ui/langgraph/node_modules/@langchain/langgraph-sdk/dist/index.js");


/***/ }),

/***/ "(rsc)/./node_modules/@ag-ui/proto/dist/index.mjs":
/*!**************************************************!*\
  !*** ./node_modules/@ag-ui/proto/dist/index.mjs ***!
  \**************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AGUI_MEDIA_TYPE: () => (/* binding */ AGUI_MEDIA_TYPE),\n/* harmony export */   decode: () => (/* binding */ decode),\n/* harmony export */   encode: () => (/* binding */ encode)\n/* harmony export */ });\n/* harmony import */ var _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @ag-ui/core */ \"(rsc)/./node_modules/@ag-ui/core/dist/index.mjs\");\n/* harmony import */ var _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @bufbuild/protobuf/wire */ \"(rsc)/./node_modules/@bufbuild/protobuf/dist/esm/wire/binary-encoding.js\");\n// src/proto.ts\n\n\n// src/generated/events.ts\n\n\n// src/generated/google/protobuf/struct.ts\n\nfunction createBaseStruct() {\n  return { fields: {} };\n}\nvar Struct = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    Object.entries(message.fields).forEach(([key, value]) => {\n      if (value !== void 0) {\n        Struct_FieldsEntry.encode({ key, value }, writer.uint32(10).fork()).join();\n      }\n    });\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    let end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseStruct();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 10) {\n            break;\n          }\n          const entry1 = Struct_FieldsEntry.decode(reader, reader.uint32());\n          if (entry1.value !== void 0) {\n            message.fields[entry1.key] = entry1.value;\n          }\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return Struct.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a;\n    const message = createBaseStruct();\n    message.fields = Object.entries((_a = object.fields) != null ? _a : {}).reduce(\n      (acc, [key, value]) => {\n        if (value !== void 0) {\n          acc[key] = value;\n        }\n        return acc;\n      },\n      {}\n    );\n    return message;\n  },\n  wrap(object) {\n    const struct = createBaseStruct();\n    if (object !== void 0) {\n      for (const key of Object.keys(object)) {\n        struct.fields[key] = object[key];\n      }\n    }\n    return struct;\n  },\n  unwrap(message) {\n    const object = {};\n    if (message.fields) {\n      for (const key of Object.keys(message.fields)) {\n        object[key] = message.fields[key];\n      }\n    }\n    return object;\n  }\n};\nfunction createBaseStruct_FieldsEntry() {\n  return { key: \"\", value: void 0 };\n}\nvar Struct_FieldsEntry = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    if (message.key !== \"\") {\n      writer.uint32(10).string(message.key);\n    }\n    if (message.value !== void 0) {\n      Value.encode(Value.wrap(message.value), writer.uint32(18).fork()).join();\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    let end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseStruct_FieldsEntry();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 10) {\n            break;\n          }\n          message.key = reader.string();\n          continue;\n        }\n        case 2: {\n          if (tag !== 18) {\n            break;\n          }\n          message.value = Value.unwrap(Value.decode(reader, reader.uint32()));\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return Struct_FieldsEntry.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a, _b;\n    const message = createBaseStruct_FieldsEntry();\n    message.key = (_a = object.key) != null ? _a : \"\";\n    message.value = (_b = object.value) != null ? _b : void 0;\n    return message;\n  }\n};\nfunction createBaseValue() {\n  return {\n    nullValue: void 0,\n    numberValue: void 0,\n    stringValue: void 0,\n    boolValue: void 0,\n    structValue: void 0,\n    listValue: void 0\n  };\n}\nvar Value = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    if (message.nullValue !== void 0) {\n      writer.uint32(8).int32(message.nullValue);\n    }\n    if (message.numberValue !== void 0) {\n      writer.uint32(17).double(message.numberValue);\n    }\n    if (message.stringValue !== void 0) {\n      writer.uint32(26).string(message.stringValue);\n    }\n    if (message.boolValue !== void 0) {\n      writer.uint32(32).bool(message.boolValue);\n    }\n    if (message.structValue !== void 0) {\n      Struct.encode(Struct.wrap(message.structValue), writer.uint32(42).fork()).join();\n    }\n    if (message.listValue !== void 0) {\n      ListValue.encode(ListValue.wrap(message.listValue), writer.uint32(50).fork()).join();\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    let end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseValue();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 8) {\n            break;\n          }\n          message.nullValue = reader.int32();\n          continue;\n        }\n        case 2: {\n          if (tag !== 17) {\n            break;\n          }\n          message.numberValue = reader.double();\n          continue;\n        }\n        case 3: {\n          if (tag !== 26) {\n            break;\n          }\n          message.stringValue = reader.string();\n          continue;\n        }\n        case 4: {\n          if (tag !== 32) {\n            break;\n          }\n          message.boolValue = reader.bool();\n          continue;\n        }\n        case 5: {\n          if (tag !== 42) {\n            break;\n          }\n          message.structValue = Struct.unwrap(Struct.decode(reader, reader.uint32()));\n          continue;\n        }\n        case 6: {\n          if (tag !== 50) {\n            break;\n          }\n          message.listValue = ListValue.unwrap(ListValue.decode(reader, reader.uint32()));\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return Value.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a, _b, _c, _d, _e, _f;\n    const message = createBaseValue();\n    message.nullValue = (_a = object.nullValue) != null ? _a : void 0;\n    message.numberValue = (_b = object.numberValue) != null ? _b : void 0;\n    message.stringValue = (_c = object.stringValue) != null ? _c : void 0;\n    message.boolValue = (_d = object.boolValue) != null ? _d : void 0;\n    message.structValue = (_e = object.structValue) != null ? _e : void 0;\n    message.listValue = (_f = object.listValue) != null ? _f : void 0;\n    return message;\n  },\n  wrap(value) {\n    const result = createBaseValue();\n    if (value === null) {\n      result.nullValue = 0 /* NULL_VALUE */;\n    } else if (typeof value === \"boolean\") {\n      result.boolValue = value;\n    } else if (typeof value === \"number\") {\n      result.numberValue = value;\n    } else if (typeof value === \"string\") {\n      result.stringValue = value;\n    } else if (globalThis.Array.isArray(value)) {\n      result.listValue = value;\n    } else if (typeof value === \"object\") {\n      result.structValue = value;\n    } else if (typeof value !== \"undefined\") {\n      throw new globalThis.Error(\"Unsupported any value type: \" + typeof value);\n    }\n    return result;\n  },\n  unwrap(message) {\n    if (message.stringValue !== void 0) {\n      return message.stringValue;\n    } else if ((message == null ? void 0 : message.numberValue) !== void 0) {\n      return message.numberValue;\n    } else if ((message == null ? void 0 : message.boolValue) !== void 0) {\n      return message.boolValue;\n    } else if ((message == null ? void 0 : message.structValue) !== void 0) {\n      return message.structValue;\n    } else if ((message == null ? void 0 : message.listValue) !== void 0) {\n      return message.listValue;\n    } else if ((message == null ? void 0 : message.nullValue) !== void 0) {\n      return null;\n    }\n    return void 0;\n  }\n};\nfunction createBaseListValue() {\n  return { values: [] };\n}\nvar ListValue = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    for (const v of message.values) {\n      Value.encode(Value.wrap(v), writer.uint32(10).fork()).join();\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    let end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseListValue();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 10) {\n            break;\n          }\n          message.values.push(Value.unwrap(Value.decode(reader, reader.uint32())));\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return ListValue.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a;\n    const message = createBaseListValue();\n    message.values = ((_a = object.values) == null ? void 0 : _a.map((e) => e)) || [];\n    return message;\n  },\n  wrap(array) {\n    const result = createBaseListValue();\n    result.values = array != null ? array : [];\n    return result;\n  },\n  unwrap(message) {\n    if ((message == null ? void 0 : message.hasOwnProperty(\"values\")) && globalThis.Array.isArray(message.values)) {\n      return message.values;\n    } else {\n      return message;\n    }\n  }\n};\n\n// src/generated/patch.ts\n\nvar JsonPatchOperationType = /* @__PURE__ */ ((JsonPatchOperationType2) => {\n  JsonPatchOperationType2[JsonPatchOperationType2[\"ADD\"] = 0] = \"ADD\";\n  JsonPatchOperationType2[JsonPatchOperationType2[\"REMOVE\"] = 1] = \"REMOVE\";\n  JsonPatchOperationType2[JsonPatchOperationType2[\"REPLACE\"] = 2] = \"REPLACE\";\n  JsonPatchOperationType2[JsonPatchOperationType2[\"MOVE\"] = 3] = \"MOVE\";\n  JsonPatchOperationType2[JsonPatchOperationType2[\"COPY\"] = 4] = \"COPY\";\n  JsonPatchOperationType2[JsonPatchOperationType2[\"TEST\"] = 5] = \"TEST\";\n  JsonPatchOperationType2[JsonPatchOperationType2[\"UNRECOGNIZED\"] = -1] = \"UNRECOGNIZED\";\n  return JsonPatchOperationType2;\n})(JsonPatchOperationType || {});\nfunction createBaseJsonPatchOperation() {\n  return { op: 0, path: \"\", from: void 0, value: void 0 };\n}\nvar JsonPatchOperation = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    if (message.op !== 0) {\n      writer.uint32(8).int32(message.op);\n    }\n    if (message.path !== \"\") {\n      writer.uint32(18).string(message.path);\n    }\n    if (message.from !== void 0) {\n      writer.uint32(26).string(message.from);\n    }\n    if (message.value !== void 0) {\n      Value.encode(Value.wrap(message.value), writer.uint32(34).fork()).join();\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    let end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseJsonPatchOperation();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 8) {\n            break;\n          }\n          message.op = reader.int32();\n          continue;\n        }\n        case 2: {\n          if (tag !== 18) {\n            break;\n          }\n          message.path = reader.string();\n          continue;\n        }\n        case 3: {\n          if (tag !== 26) {\n            break;\n          }\n          message.from = reader.string();\n          continue;\n        }\n        case 4: {\n          if (tag !== 34) {\n            break;\n          }\n          message.value = Value.unwrap(Value.decode(reader, reader.uint32()));\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return JsonPatchOperation.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a, _b, _c, _d;\n    const message = createBaseJsonPatchOperation();\n    message.op = (_a = object.op) != null ? _a : 0;\n    message.path = (_b = object.path) != null ? _b : \"\";\n    message.from = (_c = object.from) != null ? _c : void 0;\n    message.value = (_d = object.value) != null ? _d : void 0;\n    return message;\n  }\n};\n\n// src/generated/types.ts\n\nfunction createBaseToolCall() {\n  return { id: \"\", type: \"\", function: void 0 };\n}\nvar ToolCall = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    if (message.id !== \"\") {\n      writer.uint32(10).string(message.id);\n    }\n    if (message.type !== \"\") {\n      writer.uint32(18).string(message.type);\n    }\n    if (message.function !== void 0) {\n      ToolCall_Function.encode(message.function, writer.uint32(26).fork()).join();\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    let end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseToolCall();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 10) {\n            break;\n          }\n          message.id = reader.string();\n          continue;\n        }\n        case 2: {\n          if (tag !== 18) {\n            break;\n          }\n          message.type = reader.string();\n          continue;\n        }\n        case 3: {\n          if (tag !== 26) {\n            break;\n          }\n          message.function = ToolCall_Function.decode(reader, reader.uint32());\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return ToolCall.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a, _b;\n    const message = createBaseToolCall();\n    message.id = (_a = object.id) != null ? _a : \"\";\n    message.type = (_b = object.type) != null ? _b : \"\";\n    message.function = object.function !== void 0 && object.function !== null ? ToolCall_Function.fromPartial(object.function) : void 0;\n    return message;\n  }\n};\nfunction createBaseToolCall_Function() {\n  return { name: \"\", arguments: \"\" };\n}\nvar ToolCall_Function = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    if (message.name !== \"\") {\n      writer.uint32(10).string(message.name);\n    }\n    if (message.arguments !== \"\") {\n      writer.uint32(18).string(message.arguments);\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    let end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseToolCall_Function();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 10) {\n            break;\n          }\n          message.name = reader.string();\n          continue;\n        }\n        case 2: {\n          if (tag !== 18) {\n            break;\n          }\n          message.arguments = reader.string();\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return ToolCall_Function.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a, _b;\n    const message = createBaseToolCall_Function();\n    message.name = (_a = object.name) != null ? _a : \"\";\n    message.arguments = (_b = object.arguments) != null ? _b : \"\";\n    return message;\n  }\n};\nfunction createBaseMessage() {\n  return {\n    id: \"\",\n    role: \"\",\n    content: void 0,\n    name: void 0,\n    toolCalls: [],\n    toolCallId: void 0,\n    error: void 0\n  };\n}\nvar Message = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    if (message.id !== \"\") {\n      writer.uint32(10).string(message.id);\n    }\n    if (message.role !== \"\") {\n      writer.uint32(18).string(message.role);\n    }\n    if (message.content !== void 0) {\n      writer.uint32(26).string(message.content);\n    }\n    if (message.name !== void 0) {\n      writer.uint32(34).string(message.name);\n    }\n    for (const v of message.toolCalls) {\n      ToolCall.encode(v, writer.uint32(42).fork()).join();\n    }\n    if (message.toolCallId !== void 0) {\n      writer.uint32(50).string(message.toolCallId);\n    }\n    if (message.error !== void 0) {\n      writer.uint32(58).string(message.error);\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    let end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseMessage();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 10) {\n            break;\n          }\n          message.id = reader.string();\n          continue;\n        }\n        case 2: {\n          if (tag !== 18) {\n            break;\n          }\n          message.role = reader.string();\n          continue;\n        }\n        case 3: {\n          if (tag !== 26) {\n            break;\n          }\n          message.content = reader.string();\n          continue;\n        }\n        case 4: {\n          if (tag !== 34) {\n            break;\n          }\n          message.name = reader.string();\n          continue;\n        }\n        case 5: {\n          if (tag !== 42) {\n            break;\n          }\n          message.toolCalls.push(ToolCall.decode(reader, reader.uint32()));\n          continue;\n        }\n        case 6: {\n          if (tag !== 50) {\n            break;\n          }\n          message.toolCallId = reader.string();\n          continue;\n        }\n        case 7: {\n          if (tag !== 58) {\n            break;\n          }\n          message.error = reader.string();\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return Message.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a, _b, _c, _d, _e, _f, _g;\n    const message = createBaseMessage();\n    message.id = (_a = object.id) != null ? _a : \"\";\n    message.role = (_b = object.role) != null ? _b : \"\";\n    message.content = (_c = object.content) != null ? _c : void 0;\n    message.name = (_d = object.name) != null ? _d : void 0;\n    message.toolCalls = ((_e = object.toolCalls) == null ? void 0 : _e.map((e) => ToolCall.fromPartial(e))) || [];\n    message.toolCallId = (_f = object.toolCallId) != null ? _f : void 0;\n    message.error = (_g = object.error) != null ? _g : void 0;\n    return message;\n  }\n};\n\n// src/generated/events.ts\nvar EventType = /* @__PURE__ */ ((EventType3) => {\n  EventType3[EventType3[\"TEXT_MESSAGE_START\"] = 0] = \"TEXT_MESSAGE_START\";\n  EventType3[EventType3[\"TEXT_MESSAGE_CONTENT\"] = 1] = \"TEXT_MESSAGE_CONTENT\";\n  EventType3[EventType3[\"TEXT_MESSAGE_END\"] = 2] = \"TEXT_MESSAGE_END\";\n  EventType3[EventType3[\"TOOL_CALL_START\"] = 3] = \"TOOL_CALL_START\";\n  EventType3[EventType3[\"TOOL_CALL_ARGS\"] = 4] = \"TOOL_CALL_ARGS\";\n  EventType3[EventType3[\"TOOL_CALL_END\"] = 5] = \"TOOL_CALL_END\";\n  EventType3[EventType3[\"STATE_SNAPSHOT\"] = 6] = \"STATE_SNAPSHOT\";\n  EventType3[EventType3[\"STATE_DELTA\"] = 7] = \"STATE_DELTA\";\n  EventType3[EventType3[\"MESSAGES_SNAPSHOT\"] = 8] = \"MESSAGES_SNAPSHOT\";\n  EventType3[EventType3[\"RAW\"] = 9] = \"RAW\";\n  EventType3[EventType3[\"CUSTOM\"] = 10] = \"CUSTOM\";\n  EventType3[EventType3[\"RUN_STARTED\"] = 11] = \"RUN_STARTED\";\n  EventType3[EventType3[\"RUN_FINISHED\"] = 12] = \"RUN_FINISHED\";\n  EventType3[EventType3[\"RUN_ERROR\"] = 13] = \"RUN_ERROR\";\n  EventType3[EventType3[\"STEP_STARTED\"] = 14] = \"STEP_STARTED\";\n  EventType3[EventType3[\"STEP_FINISHED\"] = 15] = \"STEP_FINISHED\";\n  EventType3[EventType3[\"UNRECOGNIZED\"] = -1] = \"UNRECOGNIZED\";\n  return EventType3;\n})(EventType || {});\nfunction createBaseBaseEvent() {\n  return { type: 0, timestamp: void 0, rawEvent: void 0 };\n}\nvar BaseEvent = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    if (message.type !== 0) {\n      writer.uint32(8).int32(message.type);\n    }\n    if (message.timestamp !== void 0) {\n      writer.uint32(16).int64(message.timestamp);\n    }\n    if (message.rawEvent !== void 0) {\n      Value.encode(Value.wrap(message.rawEvent), writer.uint32(26).fork()).join();\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    let end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseBaseEvent();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 8) {\n            break;\n          }\n          message.type = reader.int32();\n          continue;\n        }\n        case 2: {\n          if (tag !== 16) {\n            break;\n          }\n          message.timestamp = longToNumber(reader.int64());\n          continue;\n        }\n        case 3: {\n          if (tag !== 26) {\n            break;\n          }\n          message.rawEvent = Value.unwrap(Value.decode(reader, reader.uint32()));\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return BaseEvent.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a, _b, _c;\n    const message = createBaseBaseEvent();\n    message.type = (_a = object.type) != null ? _a : 0;\n    message.timestamp = (_b = object.timestamp) != null ? _b : void 0;\n    message.rawEvent = (_c = object.rawEvent) != null ? _c : void 0;\n    return message;\n  }\n};\nfunction createBaseTextMessageStartEvent() {\n  return { baseEvent: void 0, messageId: \"\", role: void 0 };\n}\nvar TextMessageStartEvent = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    if (message.baseEvent !== void 0) {\n      BaseEvent.encode(message.baseEvent, writer.uint32(10).fork()).join();\n    }\n    if (message.messageId !== \"\") {\n      writer.uint32(18).string(message.messageId);\n    }\n    if (message.role !== void 0) {\n      writer.uint32(26).string(message.role);\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    let end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseTextMessageStartEvent();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 10) {\n            break;\n          }\n          message.baseEvent = BaseEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 2: {\n          if (tag !== 18) {\n            break;\n          }\n          message.messageId = reader.string();\n          continue;\n        }\n        case 3: {\n          if (tag !== 26) {\n            break;\n          }\n          message.role = reader.string();\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return TextMessageStartEvent.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a, _b;\n    const message = createBaseTextMessageStartEvent();\n    message.baseEvent = object.baseEvent !== void 0 && object.baseEvent !== null ? BaseEvent.fromPartial(object.baseEvent) : void 0;\n    message.messageId = (_a = object.messageId) != null ? _a : \"\";\n    message.role = (_b = object.role) != null ? _b : void 0;\n    return message;\n  }\n};\nfunction createBaseTextMessageContentEvent() {\n  return { baseEvent: void 0, messageId: \"\", delta: \"\" };\n}\nvar TextMessageContentEvent = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    if (message.baseEvent !== void 0) {\n      BaseEvent.encode(message.baseEvent, writer.uint32(10).fork()).join();\n    }\n    if (message.messageId !== \"\") {\n      writer.uint32(18).string(message.messageId);\n    }\n    if (message.delta !== \"\") {\n      writer.uint32(26).string(message.delta);\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    let end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseTextMessageContentEvent();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 10) {\n            break;\n          }\n          message.baseEvent = BaseEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 2: {\n          if (tag !== 18) {\n            break;\n          }\n          message.messageId = reader.string();\n          continue;\n        }\n        case 3: {\n          if (tag !== 26) {\n            break;\n          }\n          message.delta = reader.string();\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return TextMessageContentEvent.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a, _b;\n    const message = createBaseTextMessageContentEvent();\n    message.baseEvent = object.baseEvent !== void 0 && object.baseEvent !== null ? BaseEvent.fromPartial(object.baseEvent) : void 0;\n    message.messageId = (_a = object.messageId) != null ? _a : \"\";\n    message.delta = (_b = object.delta) != null ? _b : \"\";\n    return message;\n  }\n};\nfunction createBaseTextMessageEndEvent() {\n  return { baseEvent: void 0, messageId: \"\" };\n}\nvar TextMessageEndEvent = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    if (message.baseEvent !== void 0) {\n      BaseEvent.encode(message.baseEvent, writer.uint32(10).fork()).join();\n    }\n    if (message.messageId !== \"\") {\n      writer.uint32(18).string(message.messageId);\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    let end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseTextMessageEndEvent();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 10) {\n            break;\n          }\n          message.baseEvent = BaseEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 2: {\n          if (tag !== 18) {\n            break;\n          }\n          message.messageId = reader.string();\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return TextMessageEndEvent.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a;\n    const message = createBaseTextMessageEndEvent();\n    message.baseEvent = object.baseEvent !== void 0 && object.baseEvent !== null ? BaseEvent.fromPartial(object.baseEvent) : void 0;\n    message.messageId = (_a = object.messageId) != null ? _a : \"\";\n    return message;\n  }\n};\nfunction createBaseToolCallStartEvent() {\n  return { baseEvent: void 0, toolCallId: \"\", toolCallName: \"\", parentMessageId: void 0 };\n}\nvar ToolCallStartEvent = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    if (message.baseEvent !== void 0) {\n      BaseEvent.encode(message.baseEvent, writer.uint32(10).fork()).join();\n    }\n    if (message.toolCallId !== \"\") {\n      writer.uint32(18).string(message.toolCallId);\n    }\n    if (message.toolCallName !== \"\") {\n      writer.uint32(26).string(message.toolCallName);\n    }\n    if (message.parentMessageId !== void 0) {\n      writer.uint32(34).string(message.parentMessageId);\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    let end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseToolCallStartEvent();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 10) {\n            break;\n          }\n          message.baseEvent = BaseEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 2: {\n          if (tag !== 18) {\n            break;\n          }\n          message.toolCallId = reader.string();\n          continue;\n        }\n        case 3: {\n          if (tag !== 26) {\n            break;\n          }\n          message.toolCallName = reader.string();\n          continue;\n        }\n        case 4: {\n          if (tag !== 34) {\n            break;\n          }\n          message.parentMessageId = reader.string();\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return ToolCallStartEvent.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a, _b, _c;\n    const message = createBaseToolCallStartEvent();\n    message.baseEvent = object.baseEvent !== void 0 && object.baseEvent !== null ? BaseEvent.fromPartial(object.baseEvent) : void 0;\n    message.toolCallId = (_a = object.toolCallId) != null ? _a : \"\";\n    message.toolCallName = (_b = object.toolCallName) != null ? _b : \"\";\n    message.parentMessageId = (_c = object.parentMessageId) != null ? _c : void 0;\n    return message;\n  }\n};\nfunction createBaseToolCallArgsEvent() {\n  return { baseEvent: void 0, toolCallId: \"\", delta: \"\" };\n}\nvar ToolCallArgsEvent = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    if (message.baseEvent !== void 0) {\n      BaseEvent.encode(message.baseEvent, writer.uint32(10).fork()).join();\n    }\n    if (message.toolCallId !== \"\") {\n      writer.uint32(18).string(message.toolCallId);\n    }\n    if (message.delta !== \"\") {\n      writer.uint32(26).string(message.delta);\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    let end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseToolCallArgsEvent();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 10) {\n            break;\n          }\n          message.baseEvent = BaseEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 2: {\n          if (tag !== 18) {\n            break;\n          }\n          message.toolCallId = reader.string();\n          continue;\n        }\n        case 3: {\n          if (tag !== 26) {\n            break;\n          }\n          message.delta = reader.string();\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return ToolCallArgsEvent.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a, _b;\n    const message = createBaseToolCallArgsEvent();\n    message.baseEvent = object.baseEvent !== void 0 && object.baseEvent !== null ? BaseEvent.fromPartial(object.baseEvent) : void 0;\n    message.toolCallId = (_a = object.toolCallId) != null ? _a : \"\";\n    message.delta = (_b = object.delta) != null ? _b : \"\";\n    return message;\n  }\n};\nfunction createBaseToolCallEndEvent() {\n  return { baseEvent: void 0, toolCallId: \"\" };\n}\nvar ToolCallEndEvent = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    if (message.baseEvent !== void 0) {\n      BaseEvent.encode(message.baseEvent, writer.uint32(10).fork()).join();\n    }\n    if (message.toolCallId !== \"\") {\n      writer.uint32(18).string(message.toolCallId);\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    let end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseToolCallEndEvent();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 10) {\n            break;\n          }\n          message.baseEvent = BaseEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 2: {\n          if (tag !== 18) {\n            break;\n          }\n          message.toolCallId = reader.string();\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return ToolCallEndEvent.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a;\n    const message = createBaseToolCallEndEvent();\n    message.baseEvent = object.baseEvent !== void 0 && object.baseEvent !== null ? BaseEvent.fromPartial(object.baseEvent) : void 0;\n    message.toolCallId = (_a = object.toolCallId) != null ? _a : \"\";\n    return message;\n  }\n};\nfunction createBaseStateSnapshotEvent() {\n  return { baseEvent: void 0, snapshot: void 0 };\n}\nvar StateSnapshotEvent = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    if (message.baseEvent !== void 0) {\n      BaseEvent.encode(message.baseEvent, writer.uint32(10).fork()).join();\n    }\n    if (message.snapshot !== void 0) {\n      Value.encode(Value.wrap(message.snapshot), writer.uint32(18).fork()).join();\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    let end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseStateSnapshotEvent();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 10) {\n            break;\n          }\n          message.baseEvent = BaseEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 2: {\n          if (tag !== 18) {\n            break;\n          }\n          message.snapshot = Value.unwrap(Value.decode(reader, reader.uint32()));\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return StateSnapshotEvent.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a;\n    const message = createBaseStateSnapshotEvent();\n    message.baseEvent = object.baseEvent !== void 0 && object.baseEvent !== null ? BaseEvent.fromPartial(object.baseEvent) : void 0;\n    message.snapshot = (_a = object.snapshot) != null ? _a : void 0;\n    return message;\n  }\n};\nfunction createBaseStateDeltaEvent() {\n  return { baseEvent: void 0, delta: [] };\n}\nvar StateDeltaEvent = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    if (message.baseEvent !== void 0) {\n      BaseEvent.encode(message.baseEvent, writer.uint32(10).fork()).join();\n    }\n    for (const v of message.delta) {\n      JsonPatchOperation.encode(v, writer.uint32(18).fork()).join();\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    let end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseStateDeltaEvent();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 10) {\n            break;\n          }\n          message.baseEvent = BaseEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 2: {\n          if (tag !== 18) {\n            break;\n          }\n          message.delta.push(JsonPatchOperation.decode(reader, reader.uint32()));\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return StateDeltaEvent.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a;\n    const message = createBaseStateDeltaEvent();\n    message.baseEvent = object.baseEvent !== void 0 && object.baseEvent !== null ? BaseEvent.fromPartial(object.baseEvent) : void 0;\n    message.delta = ((_a = object.delta) == null ? void 0 : _a.map((e) => JsonPatchOperation.fromPartial(e))) || [];\n    return message;\n  }\n};\nfunction createBaseMessagesSnapshotEvent() {\n  return { baseEvent: void 0, messages: [] };\n}\nvar MessagesSnapshotEvent = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    if (message.baseEvent !== void 0) {\n      BaseEvent.encode(message.baseEvent, writer.uint32(10).fork()).join();\n    }\n    for (const v of message.messages) {\n      Message.encode(v, writer.uint32(18).fork()).join();\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    let end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseMessagesSnapshotEvent();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 10) {\n            break;\n          }\n          message.baseEvent = BaseEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 2: {\n          if (tag !== 18) {\n            break;\n          }\n          message.messages.push(Message.decode(reader, reader.uint32()));\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return MessagesSnapshotEvent.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a;\n    const message = createBaseMessagesSnapshotEvent();\n    message.baseEvent = object.baseEvent !== void 0 && object.baseEvent !== null ? BaseEvent.fromPartial(object.baseEvent) : void 0;\n    message.messages = ((_a = object.messages) == null ? void 0 : _a.map((e) => Message.fromPartial(e))) || [];\n    return message;\n  }\n};\nfunction createBaseRawEvent() {\n  return { baseEvent: void 0, event: void 0, source: void 0 };\n}\nvar RawEvent = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    if (message.baseEvent !== void 0) {\n      BaseEvent.encode(message.baseEvent, writer.uint32(10).fork()).join();\n    }\n    if (message.event !== void 0) {\n      Value.encode(Value.wrap(message.event), writer.uint32(18).fork()).join();\n    }\n    if (message.source !== void 0) {\n      writer.uint32(26).string(message.source);\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    let end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseRawEvent();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 10) {\n            break;\n          }\n          message.baseEvent = BaseEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 2: {\n          if (tag !== 18) {\n            break;\n          }\n          message.event = Value.unwrap(Value.decode(reader, reader.uint32()));\n          continue;\n        }\n        case 3: {\n          if (tag !== 26) {\n            break;\n          }\n          message.source = reader.string();\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return RawEvent.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a, _b;\n    const message = createBaseRawEvent();\n    message.baseEvent = object.baseEvent !== void 0 && object.baseEvent !== null ? BaseEvent.fromPartial(object.baseEvent) : void 0;\n    message.event = (_a = object.event) != null ? _a : void 0;\n    message.source = (_b = object.source) != null ? _b : void 0;\n    return message;\n  }\n};\nfunction createBaseCustomEvent() {\n  return { baseEvent: void 0, name: \"\", value: void 0 };\n}\nvar CustomEvent = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    if (message.baseEvent !== void 0) {\n      BaseEvent.encode(message.baseEvent, writer.uint32(10).fork()).join();\n    }\n    if (message.name !== \"\") {\n      writer.uint32(18).string(message.name);\n    }\n    if (message.value !== void 0) {\n      Value.encode(Value.wrap(message.value), writer.uint32(26).fork()).join();\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    let end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseCustomEvent();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 10) {\n            break;\n          }\n          message.baseEvent = BaseEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 2: {\n          if (tag !== 18) {\n            break;\n          }\n          message.name = reader.string();\n          continue;\n        }\n        case 3: {\n          if (tag !== 26) {\n            break;\n          }\n          message.value = Value.unwrap(Value.decode(reader, reader.uint32()));\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return CustomEvent.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a, _b;\n    const message = createBaseCustomEvent();\n    message.baseEvent = object.baseEvent !== void 0 && object.baseEvent !== null ? BaseEvent.fromPartial(object.baseEvent) : void 0;\n    message.name = (_a = object.name) != null ? _a : \"\";\n    message.value = (_b = object.value) != null ? _b : void 0;\n    return message;\n  }\n};\nfunction createBaseRunStartedEvent() {\n  return { baseEvent: void 0, threadId: \"\", runId: \"\" };\n}\nvar RunStartedEvent = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    if (message.baseEvent !== void 0) {\n      BaseEvent.encode(message.baseEvent, writer.uint32(10).fork()).join();\n    }\n    if (message.threadId !== \"\") {\n      writer.uint32(18).string(message.threadId);\n    }\n    if (message.runId !== \"\") {\n      writer.uint32(26).string(message.runId);\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    let end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseRunStartedEvent();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 10) {\n            break;\n          }\n          message.baseEvent = BaseEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 2: {\n          if (tag !== 18) {\n            break;\n          }\n          message.threadId = reader.string();\n          continue;\n        }\n        case 3: {\n          if (tag !== 26) {\n            break;\n          }\n          message.runId = reader.string();\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return RunStartedEvent.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a, _b;\n    const message = createBaseRunStartedEvent();\n    message.baseEvent = object.baseEvent !== void 0 && object.baseEvent !== null ? BaseEvent.fromPartial(object.baseEvent) : void 0;\n    message.threadId = (_a = object.threadId) != null ? _a : \"\";\n    message.runId = (_b = object.runId) != null ? _b : \"\";\n    return message;\n  }\n};\nfunction createBaseRunFinishedEvent() {\n  return { baseEvent: void 0, threadId: \"\", runId: \"\", result: void 0 };\n}\nvar RunFinishedEvent = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    if (message.baseEvent !== void 0) {\n      BaseEvent.encode(message.baseEvent, writer.uint32(10).fork()).join();\n    }\n    if (message.threadId !== \"\") {\n      writer.uint32(18).string(message.threadId);\n    }\n    if (message.runId !== \"\") {\n      writer.uint32(26).string(message.runId);\n    }\n    if (message.result !== void 0) {\n      Value.encode(Value.wrap(message.result), writer.uint32(34).fork()).join();\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    let end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseRunFinishedEvent();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 10) {\n            break;\n          }\n          message.baseEvent = BaseEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 2: {\n          if (tag !== 18) {\n            break;\n          }\n          message.threadId = reader.string();\n          continue;\n        }\n        case 3: {\n          if (tag !== 26) {\n            break;\n          }\n          message.runId = reader.string();\n          continue;\n        }\n        case 4: {\n          if (tag !== 34) {\n            break;\n          }\n          message.result = Value.unwrap(Value.decode(reader, reader.uint32()));\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return RunFinishedEvent.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a, _b, _c;\n    const message = createBaseRunFinishedEvent();\n    message.baseEvent = object.baseEvent !== void 0 && object.baseEvent !== null ? BaseEvent.fromPartial(object.baseEvent) : void 0;\n    message.threadId = (_a = object.threadId) != null ? _a : \"\";\n    message.runId = (_b = object.runId) != null ? _b : \"\";\n    message.result = (_c = object.result) != null ? _c : void 0;\n    return message;\n  }\n};\nfunction createBaseRunErrorEvent() {\n  return { baseEvent: void 0, code: void 0, message: \"\" };\n}\nvar RunErrorEvent = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    if (message.baseEvent !== void 0) {\n      BaseEvent.encode(message.baseEvent, writer.uint32(10).fork()).join();\n    }\n    if (message.code !== void 0) {\n      writer.uint32(18).string(message.code);\n    }\n    if (message.message !== \"\") {\n      writer.uint32(26).string(message.message);\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    let end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseRunErrorEvent();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 10) {\n            break;\n          }\n          message.baseEvent = BaseEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 2: {\n          if (tag !== 18) {\n            break;\n          }\n          message.code = reader.string();\n          continue;\n        }\n        case 3: {\n          if (tag !== 26) {\n            break;\n          }\n          message.message = reader.string();\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return RunErrorEvent.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a, _b;\n    const message = createBaseRunErrorEvent();\n    message.baseEvent = object.baseEvent !== void 0 && object.baseEvent !== null ? BaseEvent.fromPartial(object.baseEvent) : void 0;\n    message.code = (_a = object.code) != null ? _a : void 0;\n    message.message = (_b = object.message) != null ? _b : \"\";\n    return message;\n  }\n};\nfunction createBaseStepStartedEvent() {\n  return { baseEvent: void 0, stepName: \"\" };\n}\nvar StepStartedEvent = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    if (message.baseEvent !== void 0) {\n      BaseEvent.encode(message.baseEvent, writer.uint32(10).fork()).join();\n    }\n    if (message.stepName !== \"\") {\n      writer.uint32(18).string(message.stepName);\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    let end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseStepStartedEvent();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 10) {\n            break;\n          }\n          message.baseEvent = BaseEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 2: {\n          if (tag !== 18) {\n            break;\n          }\n          message.stepName = reader.string();\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return StepStartedEvent.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a;\n    const message = createBaseStepStartedEvent();\n    message.baseEvent = object.baseEvent !== void 0 && object.baseEvent !== null ? BaseEvent.fromPartial(object.baseEvent) : void 0;\n    message.stepName = (_a = object.stepName) != null ? _a : \"\";\n    return message;\n  }\n};\nfunction createBaseStepFinishedEvent() {\n  return { baseEvent: void 0, stepName: \"\" };\n}\nvar StepFinishedEvent = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    if (message.baseEvent !== void 0) {\n      BaseEvent.encode(message.baseEvent, writer.uint32(10).fork()).join();\n    }\n    if (message.stepName !== \"\") {\n      writer.uint32(18).string(message.stepName);\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    let end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseStepFinishedEvent();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 10) {\n            break;\n          }\n          message.baseEvent = BaseEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 2: {\n          if (tag !== 18) {\n            break;\n          }\n          message.stepName = reader.string();\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return StepFinishedEvent.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a;\n    const message = createBaseStepFinishedEvent();\n    message.baseEvent = object.baseEvent !== void 0 && object.baseEvent !== null ? BaseEvent.fromPartial(object.baseEvent) : void 0;\n    message.stepName = (_a = object.stepName) != null ? _a : \"\";\n    return message;\n  }\n};\nfunction createBaseTextMessageChunkEvent() {\n  return { baseEvent: void 0, messageId: void 0, role: void 0, delta: void 0 };\n}\nvar TextMessageChunkEvent = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    if (message.baseEvent !== void 0) {\n      BaseEvent.encode(message.baseEvent, writer.uint32(10).fork()).join();\n    }\n    if (message.messageId !== void 0) {\n      writer.uint32(18).string(message.messageId);\n    }\n    if (message.role !== void 0) {\n      writer.uint32(26).string(message.role);\n    }\n    if (message.delta !== void 0) {\n      writer.uint32(34).string(message.delta);\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    let end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseTextMessageChunkEvent();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 10) {\n            break;\n          }\n          message.baseEvent = BaseEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 2: {\n          if (tag !== 18) {\n            break;\n          }\n          message.messageId = reader.string();\n          continue;\n        }\n        case 3: {\n          if (tag !== 26) {\n            break;\n          }\n          message.role = reader.string();\n          continue;\n        }\n        case 4: {\n          if (tag !== 34) {\n            break;\n          }\n          message.delta = reader.string();\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return TextMessageChunkEvent.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a, _b, _c;\n    const message = createBaseTextMessageChunkEvent();\n    message.baseEvent = object.baseEvent !== void 0 && object.baseEvent !== null ? BaseEvent.fromPartial(object.baseEvent) : void 0;\n    message.messageId = (_a = object.messageId) != null ? _a : void 0;\n    message.role = (_b = object.role) != null ? _b : void 0;\n    message.delta = (_c = object.delta) != null ? _c : void 0;\n    return message;\n  }\n};\nfunction createBaseToolCallChunkEvent() {\n  return {\n    baseEvent: void 0,\n    toolCallId: void 0,\n    toolCallName: void 0,\n    parentMessageId: void 0,\n    delta: void 0\n  };\n}\nvar ToolCallChunkEvent = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    if (message.baseEvent !== void 0) {\n      BaseEvent.encode(message.baseEvent, writer.uint32(10).fork()).join();\n    }\n    if (message.toolCallId !== void 0) {\n      writer.uint32(18).string(message.toolCallId);\n    }\n    if (message.toolCallName !== void 0) {\n      writer.uint32(26).string(message.toolCallName);\n    }\n    if (message.parentMessageId !== void 0) {\n      writer.uint32(34).string(message.parentMessageId);\n    }\n    if (message.delta !== void 0) {\n      writer.uint32(42).string(message.delta);\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    let end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseToolCallChunkEvent();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 10) {\n            break;\n          }\n          message.baseEvent = BaseEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 2: {\n          if (tag !== 18) {\n            break;\n          }\n          message.toolCallId = reader.string();\n          continue;\n        }\n        case 3: {\n          if (tag !== 26) {\n            break;\n          }\n          message.toolCallName = reader.string();\n          continue;\n        }\n        case 4: {\n          if (tag !== 34) {\n            break;\n          }\n          message.parentMessageId = reader.string();\n          continue;\n        }\n        case 5: {\n          if (tag !== 42) {\n            break;\n          }\n          message.delta = reader.string();\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return ToolCallChunkEvent.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a, _b, _c, _d;\n    const message = createBaseToolCallChunkEvent();\n    message.baseEvent = object.baseEvent !== void 0 && object.baseEvent !== null ? BaseEvent.fromPartial(object.baseEvent) : void 0;\n    message.toolCallId = (_a = object.toolCallId) != null ? _a : void 0;\n    message.toolCallName = (_b = object.toolCallName) != null ? _b : void 0;\n    message.parentMessageId = (_c = object.parentMessageId) != null ? _c : void 0;\n    message.delta = (_d = object.delta) != null ? _d : void 0;\n    return message;\n  }\n};\nfunction createBaseEvent() {\n  return {\n    textMessageStart: void 0,\n    textMessageContent: void 0,\n    textMessageEnd: void 0,\n    toolCallStart: void 0,\n    toolCallArgs: void 0,\n    toolCallEnd: void 0,\n    stateSnapshot: void 0,\n    stateDelta: void 0,\n    messagesSnapshot: void 0,\n    raw: void 0,\n    custom: void 0,\n    runStarted: void 0,\n    runFinished: void 0,\n    runError: void 0,\n    stepStarted: void 0,\n    stepFinished: void 0,\n    textMessageChunk: void 0,\n    toolCallChunk: void 0\n  };\n}\nvar Event = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    if (message.textMessageStart !== void 0) {\n      TextMessageStartEvent.encode(message.textMessageStart, writer.uint32(10).fork()).join();\n    }\n    if (message.textMessageContent !== void 0) {\n      TextMessageContentEvent.encode(message.textMessageContent, writer.uint32(18).fork()).join();\n    }\n    if (message.textMessageEnd !== void 0) {\n      TextMessageEndEvent.encode(message.textMessageEnd, writer.uint32(26).fork()).join();\n    }\n    if (message.toolCallStart !== void 0) {\n      ToolCallStartEvent.encode(message.toolCallStart, writer.uint32(34).fork()).join();\n    }\n    if (message.toolCallArgs !== void 0) {\n      ToolCallArgsEvent.encode(message.toolCallArgs, writer.uint32(42).fork()).join();\n    }\n    if (message.toolCallEnd !== void 0) {\n      ToolCallEndEvent.encode(message.toolCallEnd, writer.uint32(50).fork()).join();\n    }\n    if (message.stateSnapshot !== void 0) {\n      StateSnapshotEvent.encode(message.stateSnapshot, writer.uint32(58).fork()).join();\n    }\n    if (message.stateDelta !== void 0) {\n      StateDeltaEvent.encode(message.stateDelta, writer.uint32(66).fork()).join();\n    }\n    if (message.messagesSnapshot !== void 0) {\n      MessagesSnapshotEvent.encode(message.messagesSnapshot, writer.uint32(74).fork()).join();\n    }\n    if (message.raw !== void 0) {\n      RawEvent.encode(message.raw, writer.uint32(82).fork()).join();\n    }\n    if (message.custom !== void 0) {\n      CustomEvent.encode(message.custom, writer.uint32(90).fork()).join();\n    }\n    if (message.runStarted !== void 0) {\n      RunStartedEvent.encode(message.runStarted, writer.uint32(98).fork()).join();\n    }\n    if (message.runFinished !== void 0) {\n      RunFinishedEvent.encode(message.runFinished, writer.uint32(106).fork()).join();\n    }\n    if (message.runError !== void 0) {\n      RunErrorEvent.encode(message.runError, writer.uint32(114).fork()).join();\n    }\n    if (message.stepStarted !== void 0) {\n      StepStartedEvent.encode(message.stepStarted, writer.uint32(122).fork()).join();\n    }\n    if (message.stepFinished !== void 0) {\n      StepFinishedEvent.encode(message.stepFinished, writer.uint32(130).fork()).join();\n    }\n    if (message.textMessageChunk !== void 0) {\n      TextMessageChunkEvent.encode(message.textMessageChunk, writer.uint32(138).fork()).join();\n    }\n    if (message.toolCallChunk !== void 0) {\n      ToolCallChunkEvent.encode(message.toolCallChunk, writer.uint32(146).fork()).join();\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    let end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseEvent();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 10) {\n            break;\n          }\n          message.textMessageStart = TextMessageStartEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 2: {\n          if (tag !== 18) {\n            break;\n          }\n          message.textMessageContent = TextMessageContentEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 3: {\n          if (tag !== 26) {\n            break;\n          }\n          message.textMessageEnd = TextMessageEndEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 4: {\n          if (tag !== 34) {\n            break;\n          }\n          message.toolCallStart = ToolCallStartEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 5: {\n          if (tag !== 42) {\n            break;\n          }\n          message.toolCallArgs = ToolCallArgsEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 6: {\n          if (tag !== 50) {\n            break;\n          }\n          message.toolCallEnd = ToolCallEndEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 7: {\n          if (tag !== 58) {\n            break;\n          }\n          message.stateSnapshot = StateSnapshotEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 8: {\n          if (tag !== 66) {\n            break;\n          }\n          message.stateDelta = StateDeltaEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 9: {\n          if (tag !== 74) {\n            break;\n          }\n          message.messagesSnapshot = MessagesSnapshotEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 10: {\n          if (tag !== 82) {\n            break;\n          }\n          message.raw = RawEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 11: {\n          if (tag !== 90) {\n            break;\n          }\n          message.custom = CustomEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 12: {\n          if (tag !== 98) {\n            break;\n          }\n          message.runStarted = RunStartedEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 13: {\n          if (tag !== 106) {\n            break;\n          }\n          message.runFinished = RunFinishedEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 14: {\n          if (tag !== 114) {\n            break;\n          }\n          message.runError = RunErrorEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 15: {\n          if (tag !== 122) {\n            break;\n          }\n          message.stepStarted = StepStartedEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 16: {\n          if (tag !== 130) {\n            break;\n          }\n          message.stepFinished = StepFinishedEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 17: {\n          if (tag !== 138) {\n            break;\n          }\n          message.textMessageChunk = TextMessageChunkEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 18: {\n          if (tag !== 146) {\n            break;\n          }\n          message.toolCallChunk = ToolCallChunkEvent.decode(reader, reader.uint32());\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return Event.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    const message = createBaseEvent();\n    message.textMessageStart = object.textMessageStart !== void 0 && object.textMessageStart !== null ? TextMessageStartEvent.fromPartial(object.textMessageStart) : void 0;\n    message.textMessageContent = object.textMessageContent !== void 0 && object.textMessageContent !== null ? TextMessageContentEvent.fromPartial(object.textMessageContent) : void 0;\n    message.textMessageEnd = object.textMessageEnd !== void 0 && object.textMessageEnd !== null ? TextMessageEndEvent.fromPartial(object.textMessageEnd) : void 0;\n    message.toolCallStart = object.toolCallStart !== void 0 && object.toolCallStart !== null ? ToolCallStartEvent.fromPartial(object.toolCallStart) : void 0;\n    message.toolCallArgs = object.toolCallArgs !== void 0 && object.toolCallArgs !== null ? ToolCallArgsEvent.fromPartial(object.toolCallArgs) : void 0;\n    message.toolCallEnd = object.toolCallEnd !== void 0 && object.toolCallEnd !== null ? ToolCallEndEvent.fromPartial(object.toolCallEnd) : void 0;\n    message.stateSnapshot = object.stateSnapshot !== void 0 && object.stateSnapshot !== null ? StateSnapshotEvent.fromPartial(object.stateSnapshot) : void 0;\n    message.stateDelta = object.stateDelta !== void 0 && object.stateDelta !== null ? StateDeltaEvent.fromPartial(object.stateDelta) : void 0;\n    message.messagesSnapshot = object.messagesSnapshot !== void 0 && object.messagesSnapshot !== null ? MessagesSnapshotEvent.fromPartial(object.messagesSnapshot) : void 0;\n    message.raw = object.raw !== void 0 && object.raw !== null ? RawEvent.fromPartial(object.raw) : void 0;\n    message.custom = object.custom !== void 0 && object.custom !== null ? CustomEvent.fromPartial(object.custom) : void 0;\n    message.runStarted = object.runStarted !== void 0 && object.runStarted !== null ? RunStartedEvent.fromPartial(object.runStarted) : void 0;\n    message.runFinished = object.runFinished !== void 0 && object.runFinished !== null ? RunFinishedEvent.fromPartial(object.runFinished) : void 0;\n    message.runError = object.runError !== void 0 && object.runError !== null ? RunErrorEvent.fromPartial(object.runError) : void 0;\n    message.stepStarted = object.stepStarted !== void 0 && object.stepStarted !== null ? StepStartedEvent.fromPartial(object.stepStarted) : void 0;\n    message.stepFinished = object.stepFinished !== void 0 && object.stepFinished !== null ? StepFinishedEvent.fromPartial(object.stepFinished) : void 0;\n    message.textMessageChunk = object.textMessageChunk !== void 0 && object.textMessageChunk !== null ? TextMessageChunkEvent.fromPartial(object.textMessageChunk) : void 0;\n    message.toolCallChunk = object.toolCallChunk !== void 0 && object.toolCallChunk !== null ? ToolCallChunkEvent.fromPartial(object.toolCallChunk) : void 0;\n    return message;\n  }\n};\nfunction longToNumber(int64) {\n  const num = globalThis.Number(int64.toString());\n  if (num > globalThis.Number.MAX_SAFE_INTEGER) {\n    throw new globalThis.Error(\"Value is larger than Number.MAX_SAFE_INTEGER\");\n  }\n  if (num < globalThis.Number.MIN_SAFE_INTEGER) {\n    throw new globalThis.Error(\"Value is smaller than Number.MIN_SAFE_INTEGER\");\n  }\n  return num;\n}\n\n// src/proto.ts\nfunction toCamelCase(str) {\n  return str.toLowerCase().replace(/_([a-z])/g, (_, letter) => letter.toUpperCase());\n}\nfunction encode(event) {\n  const oneofField = toCamelCase(event.type);\n  const { type, timestamp, rawEvent, ...rest } = event;\n  if (type === _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.MESSAGES_SNAPSHOT) {\n    rest.messages = rest.messages.map((message) => {\n      const untypedMessage = message;\n      if (untypedMessage.toolCalls === void 0) {\n        return { ...message, toolCalls: [] };\n      }\n      return message;\n    });\n  }\n  if (type === _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.STATE_DELTA) {\n    rest.delta = rest.delta.map((operation) => ({\n      ...operation,\n      op: JsonPatchOperationType[operation.op.toUpperCase()]\n    }));\n  }\n  const eventMessage = {\n    [oneofField]: {\n      baseEvent: {\n        type: EventType[event.type],\n        timestamp,\n        rawEvent\n      },\n      ...rest\n    }\n  };\n  return Event.encode(eventMessage).finish();\n}\nfunction decode(data) {\n  var _a;\n  const event = Event.decode(data);\n  const decoded = Object.values(event).find((value) => value !== void 0);\n  if (!decoded) {\n    throw new Error(\"Invalid event\");\n  }\n  decoded.type = EventType[decoded.baseEvent.type];\n  decoded.timestamp = decoded.baseEvent.timestamp;\n  decoded.rawEvent = decoded.baseEvent.rawEvent;\n  if (decoded.type === _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.MESSAGES_SNAPSHOT) {\n    for (const message of decoded.messages) {\n      const untypedMessage = message;\n      if (((_a = untypedMessage.toolCalls) == null ? void 0 : _a.length) === 0) {\n        untypedMessage.toolCalls = void 0;\n      }\n    }\n  }\n  if (decoded.type === _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.STATE_DELTA) {\n    for (const operation of decoded.delta) {\n      operation.op = JsonPatchOperationType[operation.op].toLowerCase();\n      Object.keys(operation).forEach((key) => {\n        if (operation[key] === void 0) {\n          delete operation[key];\n        }\n      });\n    }\n  }\n  Object.keys(decoded).forEach((key) => {\n    if (decoded[key] === void 0) {\n      delete decoded[key];\n    }\n  });\n  return _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventSchemas.parse(decoded);\n}\n\n// src/index.ts\nvar AGUI_MEDIA_TYPE = \"application/vnd.ag-ui.event+proto\";\n\n//# sourceMappingURL=index.mjs.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQGFnLXVpL3Byb3RvL2Rpc3QvaW5kZXgubWpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQUE7QUFDb0U7O0FBRXBFO0FBQ3VHOztBQUV2RztBQUNxRTtBQUNyRTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0EsK0JBQStCLGlFQUFZO0FBQzNDO0FBQ0E7QUFDQSxvQ0FBb0MsWUFBWTtBQUNoRDtBQUNBLEtBQUs7QUFDTDtBQUNBLEdBQUc7QUFDSDtBQUNBLG9DQUFvQyxpRUFBWSxlQUFlLGlFQUFZO0FBQzNFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0Esc0RBQXNEO0FBQ3RELEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSwwRUFBMEU7QUFDMUU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQSwrQkFBK0IsaUVBQVk7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQSxvQ0FBb0MsaUVBQVksZUFBZSxpRUFBWTtBQUMzRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0Esa0VBQWtFO0FBQ2xFLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQixpRUFBWTtBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBLG9DQUFvQyxpRUFBWSxlQUFlLGlFQUFZO0FBQzNFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBLHFEQUFxRDtBQUNyRCxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQSxNQUFNO0FBQ047QUFDQSxNQUFNO0FBQ047QUFDQSxNQUFNO0FBQ047QUFDQSxNQUFNO0FBQ047QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBLE1BQU07QUFDTjtBQUNBLE1BQU07QUFDTjtBQUNBLE1BQU07QUFDTjtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBLCtCQUErQixpRUFBWTtB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O0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0EsK0JBQStCLGlFQUFhO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0Esb0NBQW9DLGlFQUFhLGVBQWUsaUVBQWE7QUFDN0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0EscUVBQXFFO0FBQ3JFLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0EsK0JBQStCLGlFQUFhO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0Esb0NBQW9DLGlFQUFhLGVBQWUsaUVBQWE7QUFDN0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0EsdUVBQXVFO0FBQ3ZFLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0EsK0JBQStCLGlFQUFhO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0Esb0NBQW9DLGlFQUFhLGVBQWUsaUVBQWE7QUFDN0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBLG1FQUFtRTtBQUNuRSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQSwrQkFBK0IsaUVBQWE7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQSxvQ0FBb0MsaUVBQWEsZUFBZSxpRUFBYTtBQUM3RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBLGtFQUFrRTtBQUNsRSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0EsK0JBQStCLGlFQUFhO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0Esb0NBQW9DLGlFQUFhLGVBQWUsaUVBQWE7QUFDN0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0EsaUVBQWlFO0FBQ2pFLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0EsK0JBQStCLGlFQUFhO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0Esb0NBQW9DLGlFQUFhLGVBQWUsaUVBQWE7QUFDN0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBLGdFQUFnRTtBQUNoRSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQSwrQkFBK0IsaUVBQWE7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQSxvQ0FBb0MsaUVBQWEsZUFBZSxpRUFBYTtBQUM3RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0Esa0VBQWtFO0FBQ2xFLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBLCtCQUErQixpRUFBYTtBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBLG9DQUFvQyxpRUFBYSxlQUFlLGlFQUFhO0FBQzdFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQSwrREFBK0Q7QUFDL0QsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0EsK0JBQStCLGlFQUFhO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0Esb0NBQW9DLGlFQUFhLGVBQWUsaUVBQWE7QUFDN0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBLHFFQUFxRTtBQUNyRSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQSwrQkFBK0IsaUVBQWE7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQSxvQ0FBb0MsaUVBQWEsZUFBZSxpRUFBYTtBQUM3RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQSx3REFBd0Q7QUFDeEQsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQSwrQkFBK0IsaUVBQWE7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQSxvQ0FBb0MsaUVBQWEsZUFBZSxpRUFBYTtBQUM3RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQSwyREFBMkQ7QUFDM0QsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQSwrQkFBK0IsaUVBQWE7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQSxvQ0FBb0MsaUVBQWEsZUFBZSxpRUFBYTtBQUM3RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQSwrREFBK0Q7QUFDL0QsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQSwrQkFBK0IsaUVBQWE7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtB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O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQSxvQ0FBb0MsaUVBQWEsZUFBZSxpRUFBYTtBQUM3RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQSxxREFBcUQ7QUFDckQsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVLHFDQUFxQztBQUMvQyxlQUFlLGtEQUFVO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsZUFBZSxrREFBVTtBQUN6QjtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLGtEQUFVO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLGtEQUFVO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsU0FBUyxxREFBWTtBQUNyQjs7QUFFQTtBQUNBO0FBS0U7QUFDRiIsInNvdXJjZXMiOlsiL2hvbWUvY2V0ZWMvTm9kZVByb2plY3RzL2FndWlfdGVzdC9ub2RlX21vZHVsZXMvQGFnLXVpL3Byb3RvL2Rpc3QvaW5kZXgubWpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIHNyYy9wcm90by50c1xuaW1wb3J0IHsgRXZlbnRTY2hlbWFzLCBFdmVudFR5cGUgYXMgRXZlbnRUeXBlMiB9IGZyb20gXCJAYWctdWkvY29yZVwiO1xuXG4vLyBzcmMvZ2VuZXJhdGVkL2V2ZW50cy50c1xuaW1wb3J0IHsgQmluYXJ5UmVhZGVyIGFzIEJpbmFyeVJlYWRlcjQsIEJpbmFyeVdyaXRlciBhcyBCaW5hcnlXcml0ZXI0IH0gZnJvbSBcIkBidWZidWlsZC9wcm90b2J1Zi93aXJlXCI7XG5cbi8vIHNyYy9nZW5lcmF0ZWQvZ29vZ2xlL3Byb3RvYnVmL3N0cnVjdC50c1xuaW1wb3J0IHsgQmluYXJ5UmVhZGVyLCBCaW5hcnlXcml0ZXIgfSBmcm9tIFwiQGJ1ZmJ1aWxkL3Byb3RvYnVmL3dpcmVcIjtcbmZ1bmN0aW9uIGNyZWF0ZUJhc2VTdHJ1Y3QoKSB7XG4gIHJldHVybiB7IGZpZWxkczoge30gfTtcbn1cbnZhciBTdHJ1Y3QgPSB7XG4gIGVuY29kZShtZXNzYWdlLCB3cml0ZXIgPSBuZXcgQmluYXJ5V3JpdGVyKCkpIHtcbiAgICBPYmplY3QuZW50cmllcyhtZXNzYWdlLmZpZWxkcykuZm9yRWFjaCgoW2tleSwgdmFsdWVdKSA9PiB7XG4gICAgICBpZiAodmFsdWUgIT09IHZvaWQgMCkge1xuICAgICAgICBTdHJ1Y3RfRmllbGRzRW50cnkuZW5jb2RlKHsga2V5LCB2YWx1ZSB9LCB3cml0ZXIudWludDMyKDEwKS5mb3JrKCkpLmpvaW4oKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gd3JpdGVyO1xuICB9LFxuICBkZWNvZGUoaW5wdXQsIGxlbmd0aCkge1xuICAgIGNvbnN0IHJlYWRlciA9IGlucHV0IGluc3RhbmNlb2YgQmluYXJ5UmVhZGVyID8gaW5wdXQgOiBuZXcgQmluYXJ5UmVhZGVyKGlucHV0KTtcbiAgICBsZXQgZW5kID0gbGVuZ3RoID09PSB2b2lkIDAgPyByZWFkZXIubGVuIDogcmVhZGVyLnBvcyArIGxlbmd0aDtcbiAgICBjb25zdCBtZXNzYWdlID0gY3JlYXRlQmFzZVN0cnVjdCgpO1xuICAgIHdoaWxlIChyZWFkZXIucG9zIDwgZW5kKSB7XG4gICAgICBjb25zdCB0YWcgPSByZWFkZXIudWludDMyKCk7XG4gICAgICBzd2l0Y2ggKHRhZyA+Pj4gMykge1xuICAgICAgICBjYXNlIDE6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAxMCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnN0IGVudHJ5MSA9IFN0cnVjdF9GaWVsZHNFbnRyeS5kZWNvZGUocmVhZGVyLCByZWFkZXIudWludDMyKCkpO1xuICAgICAgICAgIGlmIChlbnRyeTEudmFsdWUgIT09IHZvaWQgMCkge1xuICAgICAgICAgICAgbWVzc2FnZS5maWVsZHNbZW50cnkxLmtleV0gPSBlbnRyeTEudmFsdWU7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAoKHRhZyAmIDcpID09PSA0IHx8IHRhZyA9PT0gMCkge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIHJlYWRlci5za2lwKHRhZyAmIDcpO1xuICAgIH1cbiAgICByZXR1cm4gbWVzc2FnZTtcbiAgfSxcbiAgY3JlYXRlKGJhc2UpIHtcbiAgICByZXR1cm4gU3RydWN0LmZyb21QYXJ0aWFsKGJhc2UgIT0gbnVsbCA/IGJhc2UgOiB7fSk7XG4gIH0sXG4gIGZyb21QYXJ0aWFsKG9iamVjdCkge1xuICAgIHZhciBfYTtcbiAgICBjb25zdCBtZXNzYWdlID0gY3JlYXRlQmFzZVN0cnVjdCgpO1xuICAgIG1lc3NhZ2UuZmllbGRzID0gT2JqZWN0LmVudHJpZXMoKF9hID0gb2JqZWN0LmZpZWxkcykgIT0gbnVsbCA/IF9hIDoge30pLnJlZHVjZShcbiAgICAgIChhY2MsIFtrZXksIHZhbHVlXSkgPT4ge1xuICAgICAgICBpZiAodmFsdWUgIT09IHZvaWQgMCkge1xuICAgICAgICAgIGFjY1trZXldID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGFjYztcbiAgICAgIH0sXG4gICAgICB7fVxuICAgICk7XG4gICAgcmV0dXJuIG1lc3NhZ2U7XG4gIH0sXG4gIHdyYXAob2JqZWN0KSB7XG4gICAgY29uc3Qgc3RydWN0ID0gY3JlYXRlQmFzZVN0cnVjdCgpO1xuICAgIGlmIChvYmplY3QgIT09IHZvaWQgMCkge1xuICAgICAgZm9yIChjb25zdCBrZXkgb2YgT2JqZWN0LmtleXMob2JqZWN0KSkge1xuICAgICAgICBzdHJ1Y3QuZmllbGRzW2tleV0gPSBvYmplY3Rba2V5XTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHN0cnVjdDtcbiAgfSxcbiAgdW53cmFwKG1lc3NhZ2UpIHtcbiAgICBjb25zdCBvYmplY3QgPSB7fTtcbiAgICBpZiAobWVzc2FnZS5maWVsZHMpIHtcbiAgICAgIGZvciAoY29uc3Qga2V5IG9mIE9iamVjdC5rZXlzKG1lc3NhZ2UuZmllbGRzKSkge1xuICAgICAgICBvYmplY3Rba2V5XSA9IG1lc3NhZ2UuZmllbGRzW2tleV07XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBvYmplY3Q7XG4gIH1cbn07XG5mdW5jdGlvbiBjcmVhdGVCYXNlU3RydWN0X0ZpZWxkc0VudHJ5KCkge1xuICByZXR1cm4geyBrZXk6IFwiXCIsIHZhbHVlOiB2b2lkIDAgfTtcbn1cbnZhciBTdHJ1Y3RfRmllbGRzRW50cnkgPSB7XG4gIGVuY29kZShtZXNzYWdlLCB3cml0ZXIgPSBuZXcgQmluYXJ5V3JpdGVyKCkpIHtcbiAgICBpZiAobWVzc2FnZS5rZXkgIT09IFwiXCIpIHtcbiAgICAgIHdyaXRlci51aW50MzIoMTApLnN0cmluZyhtZXNzYWdlLmtleSk7XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLnZhbHVlICE9PSB2b2lkIDApIHtcbiAgICAgIFZhbHVlLmVuY29kZShWYWx1ZS53cmFwKG1lc3NhZ2UudmFsdWUpLCB3cml0ZXIudWludDMyKDE4KS5mb3JrKCkpLmpvaW4oKTtcbiAgICB9XG4gICAgcmV0dXJuIHdyaXRlcjtcbiAgfSxcbiAgZGVjb2RlKGlucHV0LCBsZW5ndGgpIHtcbiAgICBjb25zdCByZWFkZXIgPSBpbnB1dCBpbnN0YW5jZW9mIEJpbmFyeVJlYWRlciA/IGlucHV0IDogbmV3IEJpbmFyeVJlYWRlcihpbnB1dCk7XG4gICAgbGV0IGVuZCA9IGxlbmd0aCA9PT0gdm9pZCAwID8gcmVhZGVyLmxlbiA6IHJlYWRlci5wb3MgKyBsZW5ndGg7XG4gICAgY29uc3QgbWVzc2FnZSA9IGNyZWF0ZUJhc2VTdHJ1Y3RfRmllbGRzRW50cnkoKTtcbiAgICB3aGlsZSAocmVhZGVyLnBvcyA8IGVuZCkge1xuICAgICAgY29uc3QgdGFnID0gcmVhZGVyLnVpbnQzMigpO1xuICAgICAgc3dpdGNoICh0YWcgPj4+IDMpIHtcbiAgICAgICAgY2FzZSAxOiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gMTApIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLmtleSA9IHJlYWRlci5zdHJpbmcoKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIDI6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAxOCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UudmFsdWUgPSBWYWx1ZS51bndyYXAoVmFsdWUuZGVjb2RlKHJlYWRlciwgcmVhZGVyLnVpbnQzMigpKSk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmICgodGFnICYgNykgPT09IDQgfHwgdGFnID09PSAwKSB7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgcmVhZGVyLnNraXAodGFnICYgNyk7XG4gICAgfVxuICAgIHJldHVybiBtZXNzYWdlO1xuICB9LFxuICBjcmVhdGUoYmFzZSkge1xuICAgIHJldHVybiBTdHJ1Y3RfRmllbGRzRW50cnkuZnJvbVBhcnRpYWwoYmFzZSAhPSBudWxsID8gYmFzZSA6IHt9KTtcbiAgfSxcbiAgZnJvbVBhcnRpYWwob2JqZWN0KSB7XG4gICAgdmFyIF9hLCBfYjtcbiAgICBjb25zdCBtZXNzYWdlID0gY3JlYXRlQmFzZVN0cnVjdF9GaWVsZHNFbnRyeSgpO1xuICAgIG1lc3NhZ2Uua2V5ID0gKF9hID0gb2JqZWN0LmtleSkgIT0gbnVsbCA/IF9hIDogXCJcIjtcbiAgICBtZXNzYWdlLnZhbHVlID0gKF9iID0gb2JqZWN0LnZhbHVlKSAhPSBudWxsID8gX2IgOiB2b2lkIDA7XG4gICAgcmV0dXJuIG1lc3NhZ2U7XG4gIH1cbn07XG5mdW5jdGlvbiBjcmVhdGVCYXNlVmFsdWUoKSB7XG4gIHJldHVybiB7XG4gICAgbnVsbFZhbHVlOiB2b2lkIDAsXG4gICAgbnVtYmVyVmFsdWU6IHZvaWQgMCxcbiAgICBzdHJpbmdWYWx1ZTogdm9pZCAwLFxuICAgIGJvb2xWYWx1ZTogdm9pZCAwLFxuICAgIHN0cnVjdFZhbHVlOiB2b2lkIDAsXG4gICAgbGlzdFZhbHVlOiB2b2lkIDBcbiAgfTtcbn1cbnZhciBWYWx1ZSA9IHtcbiAgZW5jb2RlKG1lc3NhZ2UsIHdyaXRlciA9IG5ldyBCaW5hcnlXcml0ZXIoKSkge1xuICAgIGlmIChtZXNzYWdlLm51bGxWYWx1ZSAhPT0gdm9pZCAwKSB7XG4gICAgICB3cml0ZXIudWludDMyKDgpLmludDMyKG1lc3NhZ2UubnVsbFZhbHVlKTtcbiAgICB9XG4gICAgaWYgKG1lc3NhZ2UubnVtYmVyVmFsdWUgIT09IHZvaWQgMCkge1xuICAgICAgd3JpdGVyLnVpbnQzMigxNykuZG91YmxlKG1lc3NhZ2UubnVtYmVyVmFsdWUpO1xuICAgIH1cbiAgICBpZiAobWVzc2FnZS5zdHJpbmdWYWx1ZSAhPT0gdm9pZCAwKSB7XG4gICAgICB3cml0ZXIudWludDMyKDI2KS5zdHJpbmcobWVzc2FnZS5zdHJpbmdWYWx1ZSk7XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLmJvb2xWYWx1ZSAhPT0gdm9pZCAwKSB7XG4gICAgICB3cml0ZXIudWludDMyKDMyKS5ib29sKG1lc3NhZ2UuYm9vbFZhbHVlKTtcbiAgICB9XG4gICAgaWYgKG1lc3NhZ2Uuc3RydWN0VmFsdWUgIT09IHZvaWQgMCkge1xuICAgICAgU3RydWN0LmVuY29kZShTdHJ1Y3Qud3JhcChtZXNzYWdlLnN0cnVjdFZhbHVlKSwgd3JpdGVyLnVpbnQzMig0MikuZm9yaygpKS5qb2luKCk7XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLmxpc3RWYWx1ZSAhPT0gdm9pZCAwKSB7XG4gICAgICBMaXN0VmFsdWUuZW5jb2RlKExpc3RWYWx1ZS53cmFwKG1lc3NhZ2UubGlzdFZhbHVlKSwgd3JpdGVyLnVpbnQzMig1MCkuZm9yaygpKS5qb2luKCk7XG4gICAgfVxuICAgIHJldHVybiB3cml0ZXI7XG4gIH0sXG4gIGRlY29kZShpbnB1dCwgbGVuZ3RoKSB7XG4gICAgY29uc3QgcmVhZGVyID0gaW5wdXQgaW5zdGFuY2VvZiBCaW5hcnlSZWFkZXIgPyBpbnB1dCA6IG5ldyBCaW5hcnlSZWFkZXIoaW5wdXQpO1xuICAgIGxldCBlbmQgPSBsZW5ndGggPT09IHZvaWQgMCA/IHJlYWRlci5sZW4gOiByZWFkZXIucG9zICsgbGVuZ3RoO1xuICAgIGNvbnN0IG1lc3NhZ2UgPSBjcmVhdGVCYXNlVmFsdWUoKTtcbiAgICB3aGlsZSAocmVhZGVyLnBvcyA8IGVuZCkge1xuICAgICAgY29uc3QgdGFnID0gcmVhZGVyLnVpbnQzMigpO1xuICAgICAgc3dpdGNoICh0YWcgPj4+IDMpIHtcbiAgICAgICAgY2FzZSAxOiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gOCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UubnVsbFZhbHVlID0gcmVhZGVyLmludDMyKCk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAyOiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gMTcpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLm51bWJlclZhbHVlID0gcmVhZGVyLmRvdWJsZSgpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgMzoge1xuICAgICAgICAgIGlmICh0YWcgIT09IDI2KSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS5zdHJpbmdWYWx1ZSA9IHJlYWRlci5zdHJpbmcoKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIDQ6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAzMikge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UuYm9vbFZhbHVlID0gcmVhZGVyLmJvb2woKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIDU6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSA0Mikge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2Uuc3RydWN0VmFsdWUgPSBTdHJ1Y3QudW53cmFwKFN0cnVjdC5kZWNvZGUocmVhZGVyLCByZWFkZXIudWludDMyKCkpKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIDY6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSA1MCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UubGlzdFZhbHVlID0gTGlzdFZhbHVlLnVud3JhcChMaXN0VmFsdWUuZGVjb2RlKHJlYWRlciwgcmVhZGVyLnVpbnQzMigpKSk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmICgodGFnICYgNykgPT09IDQgfHwgdGFnID09PSAwKSB7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgcmVhZGVyLnNraXAodGFnICYgNyk7XG4gICAgfVxuICAgIHJldHVybiBtZXNzYWdlO1xuICB9LFxuICBjcmVhdGUoYmFzZSkge1xuICAgIHJldHVybiBWYWx1ZS5mcm9tUGFydGlhbChiYXNlICE9IG51bGwgPyBiYXNlIDoge30pO1xuICB9LFxuICBmcm9tUGFydGlhbChvYmplY3QpIHtcbiAgICB2YXIgX2EsIF9iLCBfYywgX2QsIF9lLCBfZjtcbiAgICBjb25zdCBtZXNzYWdlID0gY3JlYXRlQmFzZVZhbHVlKCk7XG4gICAgbWVzc2FnZS5udWxsVmFsdWUgPSAoX2EgPSBvYmplY3QubnVsbFZhbHVlKSAhPSBudWxsID8gX2EgOiB2b2lkIDA7XG4gICAgbWVzc2FnZS5udW1iZXJWYWx1ZSA9IChfYiA9IG9iamVjdC5udW1iZXJWYWx1ZSkgIT0gbnVsbCA/IF9iIDogdm9pZCAwO1xuICAgIG1lc3NhZ2Uuc3RyaW5nVmFsdWUgPSAoX2MgPSBvYmplY3Quc3RyaW5nVmFsdWUpICE9IG51bGwgPyBfYyA6IHZvaWQgMDtcbiAgICBtZXNzYWdlLmJvb2xWYWx1ZSA9IChfZCA9IG9iamVjdC5ib29sVmFsdWUpICE9IG51bGwgPyBfZCA6IHZvaWQgMDtcbiAgICBtZXNzYWdlLnN0cnVjdFZhbHVlID0gKF9lID0gb2JqZWN0LnN0cnVjdFZhbHVlKSAhPSBudWxsID8gX2UgOiB2b2lkIDA7XG4gICAgbWVzc2FnZS5saXN0VmFsdWUgPSAoX2YgPSBvYmplY3QubGlzdFZhbHVlKSAhPSBudWxsID8gX2YgOiB2b2lkIDA7XG4gICAgcmV0dXJuIG1lc3NhZ2U7XG4gIH0sXG4gIHdyYXAodmFsdWUpIHtcbiAgICBjb25zdCByZXN1bHQgPSBjcmVhdGVCYXNlVmFsdWUoKTtcbiAgICBpZiAodmFsdWUgPT09IG51bGwpIHtcbiAgICAgIHJlc3VsdC5udWxsVmFsdWUgPSAwIC8qIE5VTExfVkFMVUUgKi87XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgdmFsdWUgPT09IFwiYm9vbGVhblwiKSB7XG4gICAgICByZXN1bHQuYm9vbFZhbHVlID0gdmFsdWU7XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgdmFsdWUgPT09IFwibnVtYmVyXCIpIHtcbiAgICAgIHJlc3VsdC5udW1iZXJWYWx1ZSA9IHZhbHVlO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIHZhbHVlID09PSBcInN0cmluZ1wiKSB7XG4gICAgICByZXN1bHQuc3RyaW5nVmFsdWUgPSB2YWx1ZTtcbiAgICB9IGVsc2UgaWYgKGdsb2JhbFRoaXMuQXJyYXkuaXNBcnJheSh2YWx1ZSkpIHtcbiAgICAgIHJlc3VsdC5saXN0VmFsdWUgPSB2YWx1ZTtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJvYmplY3RcIikge1xuICAgICAgcmVzdWx0LnN0cnVjdFZhbHVlID0gdmFsdWU7XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgdmFsdWUgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgIHRocm93IG5ldyBnbG9iYWxUaGlzLkVycm9yKFwiVW5zdXBwb3J0ZWQgYW55IHZhbHVlIHR5cGU6IFwiICsgdHlwZW9mIHZhbHVlKTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfSxcbiAgdW53cmFwKG1lc3NhZ2UpIHtcbiAgICBpZiAobWVzc2FnZS5zdHJpbmdWYWx1ZSAhPT0gdm9pZCAwKSB7XG4gICAgICByZXR1cm4gbWVzc2FnZS5zdHJpbmdWYWx1ZTtcbiAgICB9IGVsc2UgaWYgKChtZXNzYWdlID09IG51bGwgPyB2b2lkIDAgOiBtZXNzYWdlLm51bWJlclZhbHVlKSAhPT0gdm9pZCAwKSB7XG4gICAgICByZXR1cm4gbWVzc2FnZS5udW1iZXJWYWx1ZTtcbiAgICB9IGVsc2UgaWYgKChtZXNzYWdlID09IG51bGwgPyB2b2lkIDAgOiBtZXNzYWdlLmJvb2xWYWx1ZSkgIT09IHZvaWQgMCkge1xuICAgICAgcmV0dXJuIG1lc3NhZ2UuYm9vbFZhbHVlO1xuICAgIH0gZWxzZSBpZiAoKG1lc3NhZ2UgPT0gbnVsbCA/IHZvaWQgMCA6IG1lc3NhZ2Uuc3RydWN0VmFsdWUpICE9PSB2b2lkIDApIHtcbiAgICAgIHJldHVybiBtZXNzYWdlLnN0cnVjdFZhbHVlO1xuICAgIH0gZWxzZSBpZiAoKG1lc3NhZ2UgPT0gbnVsbCA/IHZvaWQgMCA6IG1lc3NhZ2UubGlzdFZhbHVlKSAhPT0gdm9pZCAwKSB7XG4gICAgICByZXR1cm4gbWVzc2FnZS5saXN0VmFsdWU7XG4gICAgfSBlbHNlIGlmICgobWVzc2FnZSA9PSBudWxsID8gdm9pZCAwIDogbWVzc2FnZS5udWxsVmFsdWUpICE9PSB2b2lkIDApIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICByZXR1cm4gdm9pZCAwO1xuICB9XG59O1xuZnVuY3Rpb24gY3JlYXRlQmFzZUxpc3RWYWx1ZSgpIHtcbiAgcmV0dXJuIHsgdmFsdWVzOiBbXSB9O1xufVxudmFyIExpc3RWYWx1ZSA9IHtcbiAgZW5jb2RlKG1lc3NhZ2UsIHdyaXRlciA9IG5ldyBCaW5hcnlXcml0ZXIoKSkge1xuICAgIGZvciAoY29uc3QgdiBvZiBtZXNzYWdlLnZhbHVlcykge1xuICAgICAgVmFsdWUuZW5jb2RlKFZhbHVlLndyYXAodiksIHdyaXRlci51aW50MzIoMTApLmZvcmsoKSkuam9pbigpO1xuICAgIH1cbiAgICByZXR1cm4gd3JpdGVyO1xuICB9LFxuICBkZWNvZGUoaW5wdXQsIGxlbmd0aCkge1xuICAgIGNvbnN0IHJlYWRlciA9IGlucHV0IGluc3RhbmNlb2YgQmluYXJ5UmVhZGVyID8gaW5wdXQgOiBuZXcgQmluYXJ5UmVhZGVyKGlucHV0KTtcbiAgICBsZXQgZW5kID0gbGVuZ3RoID09PSB2b2lkIDAgPyByZWFkZXIubGVuIDogcmVhZGVyLnBvcyArIGxlbmd0aDtcbiAgICBjb25zdCBtZXNzYWdlID0gY3JlYXRlQmFzZUxpc3RWYWx1ZSgpO1xuICAgIHdoaWxlIChyZWFkZXIucG9zIDwgZW5kKSB7XG4gICAgICBjb25zdCB0YWcgPSByZWFkZXIudWludDMyKCk7XG4gICAgICBzd2l0Y2ggKHRhZyA+Pj4gMykge1xuICAgICAgICBjYXNlIDE6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAxMCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UudmFsdWVzLnB1c2goVmFsdWUudW53cmFwKFZhbHVlLmRlY29kZShyZWFkZXIsIHJlYWRlci51aW50MzIoKSkpKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKCh0YWcgJiA3KSA9PT0gNCB8fCB0YWcgPT09IDApIHtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICByZWFkZXIuc2tpcCh0YWcgJiA3KTtcbiAgICB9XG4gICAgcmV0dXJuIG1lc3NhZ2U7XG4gIH0sXG4gIGNyZWF0ZShiYXNlKSB7XG4gICAgcmV0dXJuIExpc3RWYWx1ZS5mcm9tUGFydGlhbChiYXNlICE9IG51bGwgPyBiYXNlIDoge30pO1xuICB9LFxuICBmcm9tUGFydGlhbChvYmplY3QpIHtcbiAgICB2YXIgX2E7XG4gICAgY29uc3QgbWVzc2FnZSA9IGNyZWF0ZUJhc2VMaXN0VmFsdWUoKTtcbiAgICBtZXNzYWdlLnZhbHVlcyA9ICgoX2EgPSBvYmplY3QudmFsdWVzKSA9PSBudWxsID8gdm9pZCAwIDogX2EubWFwKChlKSA9PiBlKSkgfHwgW107XG4gICAgcmV0dXJuIG1lc3NhZ2U7XG4gIH0sXG4gIHdyYXAoYXJyYXkpIHtcbiAgICBjb25zdCByZXN1bHQgPSBjcmVhdGVCYXNlTGlzdFZhbHVlKCk7XG4gICAgcmVzdWx0LnZhbHVlcyA9IGFycmF5ICE9IG51bGwgPyBhcnJheSA6IFtdO1xuICAgIHJldHVybiByZXN1bHQ7XG4gIH0sXG4gIHVud3JhcChtZXNzYWdlKSB7XG4gICAgaWYgKChtZXNzYWdlID09IG51bGwgPyB2b2lkIDAgOiBtZXNzYWdlLmhhc093blByb3BlcnR5KFwidmFsdWVzXCIpKSAmJiBnbG9iYWxUaGlzLkFycmF5LmlzQXJyYXkobWVzc2FnZS52YWx1ZXMpKSB7XG4gICAgICByZXR1cm4gbWVzc2FnZS52YWx1ZXM7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBtZXNzYWdlO1xuICAgIH1cbiAgfVxufTtcblxuLy8gc3JjL2dlbmVyYXRlZC9wYXRjaC50c1xuaW1wb3J0IHsgQmluYXJ5UmVhZGVyIGFzIEJpbmFyeVJlYWRlcjIsIEJpbmFyeVdyaXRlciBhcyBCaW5hcnlXcml0ZXIyIH0gZnJvbSBcIkBidWZidWlsZC9wcm90b2J1Zi93aXJlXCI7XG52YXIgSnNvblBhdGNoT3BlcmF0aW9uVHlwZSA9IC8qIEBfX1BVUkVfXyAqLyAoKEpzb25QYXRjaE9wZXJhdGlvblR5cGUyKSA9PiB7XG4gIEpzb25QYXRjaE9wZXJhdGlvblR5cGUyW0pzb25QYXRjaE9wZXJhdGlvblR5cGUyW1wiQUREXCJdID0gMF0gPSBcIkFERFwiO1xuICBKc29uUGF0Y2hPcGVyYXRpb25UeXBlMltKc29uUGF0Y2hPcGVyYXRpb25UeXBlMltcIlJFTU9WRVwiXSA9IDFdID0gXCJSRU1PVkVcIjtcbiAgSnNvblBhdGNoT3BlcmF0aW9uVHlwZTJbSnNvblBhdGNoT3BlcmF0aW9uVHlwZTJbXCJSRVBMQUNFXCJdID0gMl0gPSBcIlJFUExBQ0VcIjtcbiAgSnNvblBhdGNoT3BlcmF0aW9uVHlwZTJbSnNvblBhdGNoT3BlcmF0aW9uVHlwZTJbXCJNT1ZFXCJdID0gM10gPSBcIk1PVkVcIjtcbiAgSnNvblBhdGNoT3BlcmF0aW9uVHlwZTJbSnNvblBhdGNoT3BlcmF0aW9uVHlwZTJbXCJDT1BZXCJdID0gNF0gPSBcIkNPUFlcIjtcbiAgSnNvblBhdGNoT3BlcmF0aW9uVHlwZTJbSnNvblBhdGNoT3BlcmF0aW9uVHlwZTJbXCJURVNUXCJdID0gNV0gPSBcIlRFU1RcIjtcbiAgSnNvblBhdGNoT3BlcmF0aW9uVHlwZTJbSnNvblBhdGNoT3BlcmF0aW9uVHlwZTJbXCJVTlJFQ09HTklaRURcIl0gPSAtMV0gPSBcIlVOUkVDT0dOSVpFRFwiO1xuICByZXR1cm4gSnNvblBhdGNoT3BlcmF0aW9uVHlwZTI7XG59KShKc29uUGF0Y2hPcGVyYXRpb25UeXBlIHx8IHt9KTtcbmZ1bmN0aW9uIGNyZWF0ZUJhc2VKc29uUGF0Y2hPcGVyYXRpb24oKSB7XG4gIHJldHVybiB7IG9wOiAwLCBwYXRoOiBcIlwiLCBmcm9tOiB2b2lkIDAsIHZhbHVlOiB2b2lkIDAgfTtcbn1cbnZhciBKc29uUGF0Y2hPcGVyYXRpb24gPSB7XG4gIGVuY29kZShtZXNzYWdlLCB3cml0ZXIgPSBuZXcgQmluYXJ5V3JpdGVyMigpKSB7XG4gICAgaWYgKG1lc3NhZ2Uub3AgIT09IDApIHtcbiAgICAgIHdyaXRlci51aW50MzIoOCkuaW50MzIobWVzc2FnZS5vcCk7XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLnBhdGggIT09IFwiXCIpIHtcbiAgICAgIHdyaXRlci51aW50MzIoMTgpLnN0cmluZyhtZXNzYWdlLnBhdGgpO1xuICAgIH1cbiAgICBpZiAobWVzc2FnZS5mcm9tICE9PSB2b2lkIDApIHtcbiAgICAgIHdyaXRlci51aW50MzIoMjYpLnN0cmluZyhtZXNzYWdlLmZyb20pO1xuICAgIH1cbiAgICBpZiAobWVzc2FnZS52YWx1ZSAhPT0gdm9pZCAwKSB7XG4gICAgICBWYWx1ZS5lbmNvZGUoVmFsdWUud3JhcChtZXNzYWdlLnZhbHVlKSwgd3JpdGVyLnVpbnQzMigzNCkuZm9yaygpKS5qb2luKCk7XG4gICAgfVxuICAgIHJldHVybiB3cml0ZXI7XG4gIH0sXG4gIGRlY29kZShpbnB1dCwgbGVuZ3RoKSB7XG4gICAgY29uc3QgcmVhZGVyID0gaW5wdXQgaW5zdGFuY2VvZiBCaW5hcnlSZWFkZXIyID8gaW5wdXQgOiBuZXcgQmluYXJ5UmVhZGVyMihpbnB1dCk7XG4gICAgbGV0IGVuZCA9IGxlbmd0aCA9PT0gdm9pZCAwID8gcmVhZGVyLmxlbiA6IHJlYWRlci5wb3MgKyBsZW5ndGg7XG4gICAgY29uc3QgbWVzc2FnZSA9IGNyZWF0ZUJhc2VKc29uUGF0Y2hPcGVyYXRpb24oKTtcbiAgICB3aGlsZSAocmVhZGVyLnBvcyA8IGVuZCkge1xuICAgICAgY29uc3QgdGFnID0gcmVhZGVyLnVpbnQzMigpO1xuICAgICAgc3dpdGNoICh0YWcgPj4+IDMpIHtcbiAgICAgICAgY2FzZSAxOiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gOCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2Uub3AgPSByZWFkZXIuaW50MzIoKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIDI6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAxOCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UucGF0aCA9IHJlYWRlci5zdHJpbmcoKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIDM6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAyNikge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UuZnJvbSA9IHJlYWRlci5zdHJpbmcoKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIDQ6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAzNCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UudmFsdWUgPSBWYWx1ZS51bndyYXAoVmFsdWUuZGVjb2RlKHJlYWRlciwgcmVhZGVyLnVpbnQzMigpKSk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmICgodGFnICYgNykgPT09IDQgfHwgdGFnID09PSAwKSB7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgcmVhZGVyLnNraXAodGFnICYgNyk7XG4gICAgfVxuICAgIHJldHVybiBtZXNzYWdlO1xuICB9LFxuICBjcmVhdGUoYmFzZSkge1xuICAgIHJldHVybiBKc29uUGF0Y2hPcGVyYXRpb24uZnJvbVBhcnRpYWwoYmFzZSAhPSBudWxsID8gYmFzZSA6IHt9KTtcbiAgfSxcbiAgZnJvbVBhcnRpYWwob2JqZWN0KSB7XG4gICAgdmFyIF9hLCBfYiwgX2MsIF9kO1xuICAgIGNvbnN0IG1lc3NhZ2UgPSBjcmVhdGVCYXNlSnNvblBhdGNoT3BlcmF0aW9uKCk7XG4gICAgbWVzc2FnZS5vcCA9IChfYSA9IG9iamVjdC5vcCkgIT0gbnVsbCA/IF9hIDogMDtcbiAgICBtZXNzYWdlLnBhdGggPSAoX2IgPSBvYmplY3QucGF0aCkgIT0gbnVsbCA/IF9iIDogXCJcIjtcbiAgICBtZXNzYWdlLmZyb20gPSAoX2MgPSBvYmplY3QuZnJvbSkgIT0gbnVsbCA/IF9jIDogdm9pZCAwO1xuICAgIG1lc3NhZ2UudmFsdWUgPSAoX2QgPSBvYmplY3QudmFsdWUpICE9IG51bGwgPyBfZCA6IHZvaWQgMDtcbiAgICByZXR1cm4gbWVzc2FnZTtcbiAgfVxufTtcblxuLy8gc3JjL2dlbmVyYXRlZC90eXBlcy50c1xuaW1wb3J0IHsgQmluYXJ5UmVhZGVyIGFzIEJpbmFyeVJlYWRlcjMsIEJpbmFyeVdyaXRlciBhcyBCaW5hcnlXcml0ZXIzIH0gZnJvbSBcIkBidWZidWlsZC9wcm90b2J1Zi93aXJlXCI7XG5mdW5jdGlvbiBjcmVhdGVCYXNlVG9vbENhbGwoKSB7XG4gIHJldHVybiB7IGlkOiBcIlwiLCB0eXBlOiBcIlwiLCBmdW5jdGlvbjogdm9pZCAwIH07XG59XG52YXIgVG9vbENhbGwgPSB7XG4gIGVuY29kZShtZXNzYWdlLCB3cml0ZXIgPSBuZXcgQmluYXJ5V3JpdGVyMygpKSB7XG4gICAgaWYgKG1lc3NhZ2UuaWQgIT09IFwiXCIpIHtcbiAgICAgIHdyaXRlci51aW50MzIoMTApLnN0cmluZyhtZXNzYWdlLmlkKTtcbiAgICB9XG4gICAgaWYgKG1lc3NhZ2UudHlwZSAhPT0gXCJcIikge1xuICAgICAgd3JpdGVyLnVpbnQzMigxOCkuc3RyaW5nKG1lc3NhZ2UudHlwZSk7XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLmZ1bmN0aW9uICE9PSB2b2lkIDApIHtcbiAgICAgIFRvb2xDYWxsX0Z1bmN0aW9uLmVuY29kZShtZXNzYWdlLmZ1bmN0aW9uLCB3cml0ZXIudWludDMyKDI2KS5mb3JrKCkpLmpvaW4oKTtcbiAgICB9XG4gICAgcmV0dXJuIHdyaXRlcjtcbiAgfSxcbiAgZGVjb2RlKGlucHV0LCBsZW5ndGgpIHtcbiAgICBjb25zdCByZWFkZXIgPSBpbnB1dCBpbnN0YW5jZW9mIEJpbmFyeVJlYWRlcjMgPyBpbnB1dCA6IG5ldyBCaW5hcnlSZWFkZXIzKGlucHV0KTtcbiAgICBsZXQgZW5kID0gbGVuZ3RoID09PSB2b2lkIDAgPyByZWFkZXIubGVuIDogcmVhZGVyLnBvcyArIGxlbmd0aDtcbiAgICBjb25zdCBtZXNzYWdlID0gY3JlYXRlQmFzZVRvb2xDYWxsKCk7XG4gICAgd2hpbGUgKHJlYWRlci5wb3MgPCBlbmQpIHtcbiAgICAgIGNvbnN0IHRhZyA9IHJlYWRlci51aW50MzIoKTtcbiAgICAgIHN3aXRjaCAodGFnID4+PiAzKSB7XG4gICAgICAgIGNhc2UgMToge1xuICAgICAgICAgIGlmICh0YWcgIT09IDEwKSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS5pZCA9IHJlYWRlci5zdHJpbmcoKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIDI6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAxOCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UudHlwZSA9IHJlYWRlci5zdHJpbmcoKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIDM6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAyNikge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UuZnVuY3Rpb24gPSBUb29sQ2FsbF9GdW5jdGlvbi5kZWNvZGUocmVhZGVyLCByZWFkZXIudWludDMyKCkpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAoKHRhZyAmIDcpID09PSA0IHx8IHRhZyA9PT0gMCkge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIHJlYWRlci5za2lwKHRhZyAmIDcpO1xuICAgIH1cbiAgICByZXR1cm4gbWVzc2FnZTtcbiAgfSxcbiAgY3JlYXRlKGJhc2UpIHtcbiAgICByZXR1cm4gVG9vbENhbGwuZnJvbVBhcnRpYWwoYmFzZSAhPSBudWxsID8gYmFzZSA6IHt9KTtcbiAgfSxcbiAgZnJvbVBhcnRpYWwob2JqZWN0KSB7XG4gICAgdmFyIF9hLCBfYjtcbiAgICBjb25zdCBtZXNzYWdlID0gY3JlYXRlQmFzZVRvb2xDYWxsKCk7XG4gICAgbWVzc2FnZS5pZCA9IChfYSA9IG9iamVjdC5pZCkgIT0gbnVsbCA/IF9hIDogXCJcIjtcbiAgICBtZXNzYWdlLnR5cGUgPSAoX2IgPSBvYmplY3QudHlwZSkgIT0gbnVsbCA/IF9iIDogXCJcIjtcbiAgICBtZXNzYWdlLmZ1bmN0aW9uID0gb2JqZWN0LmZ1bmN0aW9uICE9PSB2b2lkIDAgJiYgb2JqZWN0LmZ1bmN0aW9uICE9PSBudWxsID8gVG9vbENhbGxfRnVuY3Rpb24uZnJvbVBhcnRpYWwob2JqZWN0LmZ1bmN0aW9uKSA6IHZvaWQgMDtcbiAgICByZXR1cm4gbWVzc2FnZTtcbiAgfVxufTtcbmZ1bmN0aW9uIGNyZWF0ZUJhc2VUb29sQ2FsbF9GdW5jdGlvbigpIHtcbiAgcmV0dXJuIHsgbmFtZTogXCJcIiwgYXJndW1lbnRzOiBcIlwiIH07XG59XG52YXIgVG9vbENhbGxfRnVuY3Rpb24gPSB7XG4gIGVuY29kZShtZXNzYWdlLCB3cml0ZXIgPSBuZXcgQmluYXJ5V3JpdGVyMygpKSB7XG4gICAgaWYgKG1lc3NhZ2UubmFtZSAhPT0gXCJcIikge1xuICAgICAgd3JpdGVyLnVpbnQzMigxMCkuc3RyaW5nKG1lc3NhZ2UubmFtZSk7XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLmFyZ3VtZW50cyAhPT0gXCJcIikge1xuICAgICAgd3JpdGVyLnVpbnQzMigxOCkuc3RyaW5nKG1lc3NhZ2UuYXJndW1lbnRzKTtcbiAgICB9XG4gICAgcmV0dXJuIHdyaXRlcjtcbiAgfSxcbiAgZGVjb2RlKGlucHV0LCBsZW5ndGgpIHtcbiAgICBjb25zdCByZWFkZXIgPSBpbnB1dCBpbnN0YW5jZW9mIEJpbmFyeVJlYWRlcjMgPyBpbnB1dCA6IG5ldyBCaW5hcnlSZWFkZXIzKGlucHV0KTtcbiAgICBsZXQgZW5kID0gbGVuZ3RoID09PSB2b2lkIDAgPyByZWFkZXIubGVuIDogcmVhZGVyLnBvcyArIGxlbmd0aDtcbiAgICBjb25zdCBtZXNzYWdlID0gY3JlYXRlQmFzZVRvb2xDYWxsX0Z1bmN0aW9uKCk7XG4gICAgd2hpbGUgKHJlYWRlci5wb3MgPCBlbmQpIHtcbiAgICAgIGNvbnN0IHRhZyA9IHJlYWRlci51aW50MzIoKTtcbiAgICAgIHN3aXRjaCAodGFnID4+PiAzKSB7XG4gICAgICAgIGNhc2UgMToge1xuICAgICAgICAgIGlmICh0YWcgIT09IDEwKSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS5uYW1lID0gcmVhZGVyLnN0cmluZygpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgMjoge1xuICAgICAgICAgIGlmICh0YWcgIT09IDE4KSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS5hcmd1bWVudHMgPSByZWFkZXIuc3RyaW5nKCk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmICgodGFnICYgNykgPT09IDQgfHwgdGFnID09PSAwKSB7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgcmVhZGVyLnNraXAodGFnICYgNyk7XG4gICAgfVxuICAgIHJldHVybiBtZXNzYWdlO1xuICB9LFxuICBjcmVhdGUoYmFzZSkge1xuICAgIHJldHVybiBUb29sQ2FsbF9GdW5jdGlvbi5mcm9tUGFydGlhbChiYXNlICE9IG51bGwgPyBiYXNlIDoge30pO1xuICB9LFxuICBmcm9tUGFydGlhbChvYmplY3QpIHtcbiAgICB2YXIgX2EsIF9iO1xuICAgIGNvbnN0IG1lc3NhZ2UgPSBjcmVhdGVCYXNlVG9vbENhbGxfRnVuY3Rpb24oKTtcbiAgICBtZXNzYWdlLm5hbWUgPSAoX2EgPSBvYmplY3QubmFtZSkgIT0gbnVsbCA/IF9hIDogXCJcIjtcbiAgICBtZXNzYWdlLmFyZ3VtZW50cyA9IChfYiA9IG9iamVjdC5hcmd1bWVudHMpICE9IG51bGwgPyBfYiA6IFwiXCI7XG4gICAgcmV0dXJuIG1lc3NhZ2U7XG4gIH1cbn07XG5mdW5jdGlvbiBjcmVhdGVCYXNlTWVzc2FnZSgpIHtcbiAgcmV0dXJuIHtcbiAgICBpZDogXCJcIixcbiAgICByb2xlOiBcIlwiLFxuICAgIGNvbnRlbnQ6IHZvaWQgMCxcbiAgICBuYW1lOiB2b2lkIDAsXG4gICAgdG9vbENhbGxzOiBbXSxcbiAgICB0b29sQ2FsbElkOiB2b2lkIDAsXG4gICAgZXJyb3I6IHZvaWQgMFxuICB9O1xufVxudmFyIE1lc3NhZ2UgPSB7XG4gIGVuY29kZShtZXNzYWdlLCB3cml0ZXIgPSBuZXcgQmluYXJ5V3JpdGVyMygpKSB7XG4gICAgaWYgKG1lc3NhZ2UuaWQgIT09IFwiXCIpIHtcbiAgICAgIHdyaXRlci51aW50MzIoMTApLnN0cmluZyhtZXNzYWdlLmlkKTtcbiAgICB9XG4gICAgaWYgKG1lc3NhZ2Uucm9sZSAhPT0gXCJcIikge1xuICAgICAgd3JpdGVyLnVpbnQzMigxOCkuc3RyaW5nKG1lc3NhZ2Uucm9sZSk7XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLmNvbnRlbnQgIT09IHZvaWQgMCkge1xuICAgICAgd3JpdGVyLnVpbnQzMigyNikuc3RyaW5nKG1lc3NhZ2UuY29udGVudCk7XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLm5hbWUgIT09IHZvaWQgMCkge1xuICAgICAgd3JpdGVyLnVpbnQzMigzNCkuc3RyaW5nKG1lc3NhZ2UubmFtZSk7XG4gICAgfVxuICAgIGZvciAoY29uc3QgdiBvZiBtZXNzYWdlLnRvb2xDYWxscykge1xuICAgICAgVG9vbENhbGwuZW5jb2RlKHYsIHdyaXRlci51aW50MzIoNDIpLmZvcmsoKSkuam9pbigpO1xuICAgIH1cbiAgICBpZiAobWVzc2FnZS50b29sQ2FsbElkICE9PSB2b2lkIDApIHtcbiAgICAgIHdyaXRlci51aW50MzIoNTApLnN0cmluZyhtZXNzYWdlLnRvb2xDYWxsSWQpO1xuICAgIH1cbiAgICBpZiAobWVzc2FnZS5lcnJvciAhPT0gdm9pZCAwKSB7XG4gICAgICB3cml0ZXIudWludDMyKDU4KS5zdHJpbmcobWVzc2FnZS5lcnJvcik7XG4gICAgfVxuICAgIHJldHVybiB3cml0ZXI7XG4gIH0sXG4gIGRlY29kZShpbnB1dCwgbGVuZ3RoKSB7XG4gICAgY29uc3QgcmVhZGVyID0gaW5wdXQgaW5zdGFuY2VvZiBCaW5hcnlSZWFkZXIzID8gaW5wdXQgOiBuZXcgQmluYXJ5UmVhZGVyMyhpbnB1dCk7XG4gICAgbGV0IGVuZCA9IGxlbmd0aCA9PT0gdm9pZCAwID8gcmVhZGVyLmxlbiA6IHJlYWRlci5wb3MgKyBsZW5ndGg7XG4gICAgY29uc3QgbWVzc2FnZSA9IGNyZWF0ZUJhc2VNZXNzYWdlKCk7XG4gICAgd2hpbGUgKHJlYWRlci5wb3MgPCBlbmQpIHtcbiAgICAgIGNvbnN0IHRhZyA9IHJlYWRlci51aW50MzIoKTtcbiAgICAgIHN3aXRjaCAodGFnID4+PiAzKSB7XG4gICAgICAgIGNhc2UgMToge1xuICAgICAgICAgIGlmICh0YWcgIT09IDEwKSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS5pZCA9IHJlYWRlci5zdHJpbmcoKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIDI6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAxOCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2Uucm9sZSA9IHJlYWRlci5zdHJpbmcoKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIDM6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAyNikge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UuY29udGVudCA9IHJlYWRlci5zdHJpbmcoKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIDQ6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAzNCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UubmFtZSA9IHJlYWRlci5zdHJpbmcoKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIDU6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSA0Mikge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UudG9vbENhbGxzLnB1c2goVG9vbENhbGwuZGVjb2RlKHJlYWRlciwgcmVhZGVyLnVpbnQzMigpKSk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSA2OiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gNTApIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLnRvb2xDYWxsSWQgPSByZWFkZXIuc3RyaW5nKCk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSA3OiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gNTgpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLmVycm9yID0gcmVhZGVyLnN0cmluZygpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAoKHRhZyAmIDcpID09PSA0IHx8IHRhZyA9PT0gMCkge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIHJlYWRlci5za2lwKHRhZyAmIDcpO1xuICAgIH1cbiAgICByZXR1cm4gbWVzc2FnZTtcbiAgfSxcbiAgY3JlYXRlKGJhc2UpIHtcbiAgICByZXR1cm4gTWVzc2FnZS5mcm9tUGFydGlhbChiYXNlICE9IG51bGwgPyBiYXNlIDoge30pO1xuICB9LFxuICBmcm9tUGFydGlhbChvYmplY3QpIHtcbiAgICB2YXIgX2EsIF9iLCBfYywgX2QsIF9lLCBfZiwgX2c7XG4gICAgY29uc3QgbWVzc2FnZSA9IGNyZWF0ZUJhc2VNZXNzYWdlKCk7XG4gICAgbWVzc2FnZS5pZCA9IChfYSA9IG9iamVjdC5pZCkgIT0gbnVsbCA/IF9hIDogXCJcIjtcbiAgICBtZXNzYWdlLnJvbGUgPSAoX2IgPSBvYmplY3Qucm9sZSkgIT0gbnVsbCA/IF9iIDogXCJcIjtcbiAgICBtZXNzYWdlLmNvbnRlbnQgPSAoX2MgPSBvYmplY3QuY29udGVudCkgIT0gbnVsbCA/IF9jIDogdm9pZCAwO1xuICAgIG1lc3NhZ2UubmFtZSA9IChfZCA9IG9iamVjdC5uYW1lKSAhPSBudWxsID8gX2QgOiB2b2lkIDA7XG4gICAgbWVzc2FnZS50b29sQ2FsbHMgPSAoKF9lID0gb2JqZWN0LnRvb2xDYWxscykgPT0gbnVsbCA/IHZvaWQgMCA6IF9lLm1hcCgoZSkgPT4gVG9vbENhbGwuZnJvbVBhcnRpYWwoZSkpKSB8fCBbXTtcbiAgICBtZXNzYWdlLnRvb2xDYWxsSWQgPSAoX2YgPSBvYmplY3QudG9vbENhbGxJZCkgIT0gbnVsbCA/IF9mIDogdm9pZCAwO1xuICAgIG1lc3NhZ2UuZXJyb3IgPSAoX2cgPSBvYmplY3QuZXJyb3IpICE9IG51bGwgPyBfZyA6IHZvaWQgMDtcbiAgICByZXR1cm4gbWVzc2FnZTtcbiAgfVxufTtcblxuLy8gc3JjL2dlbmVyYXRlZC9ldmVudHMudHNcbnZhciBFdmVudFR5cGUgPSAvKiBAX19QVVJFX18gKi8gKChFdmVudFR5cGUzKSA9PiB7XG4gIEV2ZW50VHlwZTNbRXZlbnRUeXBlM1tcIlRFWFRfTUVTU0FHRV9TVEFSVFwiXSA9IDBdID0gXCJURVhUX01FU1NBR0VfU1RBUlRcIjtcbiAgRXZlbnRUeXBlM1tFdmVudFR5cGUzW1wiVEVYVF9NRVNTQUdFX0NPTlRFTlRcIl0gPSAxXSA9IFwiVEVYVF9NRVNTQUdFX0NPTlRFTlRcIjtcbiAgRXZlbnRUeXBlM1tFdmVudFR5cGUzW1wiVEVYVF9NRVNTQUdFX0VORFwiXSA9IDJdID0gXCJURVhUX01FU1NBR0VfRU5EXCI7XG4gIEV2ZW50VHlwZTNbRXZlbnRUeXBlM1tcIlRPT0xfQ0FMTF9TVEFSVFwiXSA9IDNdID0gXCJUT09MX0NBTExfU1RBUlRcIjtcbiAgRXZlbnRUeXBlM1tFdmVudFR5cGUzW1wiVE9PTF9DQUxMX0FSR1NcIl0gPSA0XSA9IFwiVE9PTF9DQUxMX0FSR1NcIjtcbiAgRXZlbnRUeXBlM1tFdmVudFR5cGUzW1wiVE9PTF9DQUxMX0VORFwiXSA9IDVdID0gXCJUT09MX0NBTExfRU5EXCI7XG4gIEV2ZW50VHlwZTNbRXZlbnRUeXBlM1tcIlNUQVRFX1NOQVBTSE9UXCJdID0gNl0gPSBcIlNUQVRFX1NOQVBTSE9UXCI7XG4gIEV2ZW50VHlwZTNbRXZlbnRUeXBlM1tcIlNUQVRFX0RFTFRBXCJdID0gN10gPSBcIlNUQVRFX0RFTFRBXCI7XG4gIEV2ZW50VHlwZTNbRXZlbnRUeXBlM1tcIk1FU1NBR0VTX1NOQVBTSE9UXCJdID0gOF0gPSBcIk1FU1NBR0VTX1NOQVBTSE9UXCI7XG4gIEV2ZW50VHlwZTNbRXZlbnRUeXBlM1tcIlJBV1wiXSA9IDldID0gXCJSQVdcIjtcbiAgRXZlbnRUeXBlM1tFdmVudFR5cGUzW1wiQ1VTVE9NXCJdID0gMTBdID0gXCJDVVNUT01cIjtcbiAgRXZlbnRUeXBlM1tFdmVudFR5cGUzW1wiUlVOX1NUQVJURURcIl0gPSAxMV0gPSBcIlJVTl9TVEFSVEVEXCI7XG4gIEV2ZW50VHlwZTNbRXZlbnRUeXBlM1tcIlJVTl9GSU5JU0hFRFwiXSA9IDEyXSA9IFwiUlVOX0ZJTklTSEVEXCI7XG4gIEV2ZW50VHlwZTNbRXZlbnRUeXBlM1tcIlJVTl9FUlJPUlwiXSA9IDEzXSA9IFwiUlVOX0VSUk9SXCI7XG4gIEV2ZW50VHlwZTNbRXZlbnRUeXBlM1tcIlNURVBfU1RBUlRFRFwiXSA9IDE0XSA9IFwiU1RFUF9TVEFSVEVEXCI7XG4gIEV2ZW50VHlwZTNbRXZlbnRUeXBlM1tcIlNURVBfRklOSVNIRURcIl0gPSAxNV0gPSBcIlNURVBfRklOSVNIRURcIjtcbiAgRXZlbnRUeXBlM1tFdmVudFR5cGUzW1wiVU5SRUNPR05JWkVEXCJdID0gLTFdID0gXCJVTlJFQ09HTklaRURcIjtcbiAgcmV0dXJuIEV2ZW50VHlwZTM7XG59KShFdmVudFR5cGUgfHwge30pO1xuZnVuY3Rpb24gY3JlYXRlQmFzZUJhc2VFdmVudCgpIHtcbiAgcmV0dXJuIHsgdHlwZTogMCwgdGltZXN0YW1wOiB2b2lkIDAsIHJhd0V2ZW50OiB2b2lkIDAgfTtcbn1cbnZhciBCYXNlRXZlbnQgPSB7XG4gIGVuY29kZShtZXNzYWdlLCB3cml0ZXIgPSBuZXcgQmluYXJ5V3JpdGVyNCgpKSB7XG4gICAgaWYgKG1lc3NhZ2UudHlwZSAhPT0gMCkge1xuICAgICAgd3JpdGVyLnVpbnQzMig4KS5pbnQzMihtZXNzYWdlLnR5cGUpO1xuICAgIH1cbiAgICBpZiAobWVzc2FnZS50aW1lc3RhbXAgIT09IHZvaWQgMCkge1xuICAgICAgd3JpdGVyLnVpbnQzMigxNikuaW50NjQobWVzc2FnZS50aW1lc3RhbXApO1xuICAgIH1cbiAgICBpZiAobWVzc2FnZS5yYXdFdmVudCAhPT0gdm9pZCAwKSB7XG4gICAgICBWYWx1ZS5lbmNvZGUoVmFsdWUud3JhcChtZXNzYWdlLnJhd0V2ZW50KSwgd3JpdGVyLnVpbnQzMigyNikuZm9yaygpKS5qb2luKCk7XG4gICAgfVxuICAgIHJldHVybiB3cml0ZXI7XG4gIH0sXG4gIGRlY29kZShpbnB1dCwgbGVuZ3RoKSB7XG4gICAgY29uc3QgcmVhZGVyID0gaW5wdXQgaW5zdGFuY2VvZiBCaW5hcnlSZWFkZXI0ID8gaW5wdXQgOiBuZXcgQmluYXJ5UmVhZGVyNChpbnB1dCk7XG4gICAgbGV0IGVuZCA9IGxlbmd0aCA9PT0gdm9pZCAwID8gcmVhZGVyLmxlbiA6IHJlYWRlci5wb3MgKyBsZW5ndGg7XG4gICAgY29uc3QgbWVzc2FnZSA9IGNyZWF0ZUJhc2VCYXNlRXZlbnQoKTtcbiAgICB3aGlsZSAocmVhZGVyLnBvcyA8IGVuZCkge1xuICAgICAgY29uc3QgdGFnID0gcmVhZGVyLnVpbnQzMigpO1xuICAgICAgc3dpdGNoICh0YWcgPj4+IDMpIHtcbiAgICAgICAgY2FzZSAxOiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gOCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UudHlwZSA9IHJlYWRlci5pbnQzMigpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgMjoge1xuICAgICAgICAgIGlmICh0YWcgIT09IDE2KSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS50aW1lc3RhbXAgPSBsb25nVG9OdW1iZXIocmVhZGVyLmludDY0KCkpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgMzoge1xuICAgICAgICAgIGlmICh0YWcgIT09IDI2KSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS5yYXdFdmVudCA9IFZhbHVlLnVud3JhcChWYWx1ZS5kZWNvZGUocmVhZGVyLCByZWFkZXIudWludDMyKCkpKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKCh0YWcgJiA3KSA9PT0gNCB8fCB0YWcgPT09IDApIHtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICByZWFkZXIuc2tpcCh0YWcgJiA3KTtcbiAgICB9XG4gICAgcmV0dXJuIG1lc3NhZ2U7XG4gIH0sXG4gIGNyZWF0ZShiYXNlKSB7XG4gICAgcmV0dXJuIEJhc2VFdmVudC5mcm9tUGFydGlhbChiYXNlICE9IG51bGwgPyBiYXNlIDoge30pO1xuICB9LFxuICBmcm9tUGFydGlhbChvYmplY3QpIHtcbiAgICB2YXIgX2EsIF9iLCBfYztcbiAgICBjb25zdCBtZXNzYWdlID0gY3JlYXRlQmFzZUJhc2VFdmVudCgpO1xuICAgIG1lc3NhZ2UudHlwZSA9IChfYSA9IG9iamVjdC50eXBlKSAhPSBudWxsID8gX2EgOiAwO1xuICAgIG1lc3NhZ2UudGltZXN0YW1wID0gKF9iID0gb2JqZWN0LnRpbWVzdGFtcCkgIT0gbnVsbCA/IF9iIDogdm9pZCAwO1xuICAgIG1lc3NhZ2UucmF3RXZlbnQgPSAoX2MgPSBvYmplY3QucmF3RXZlbnQpICE9IG51bGwgPyBfYyA6IHZvaWQgMDtcbiAgICByZXR1cm4gbWVzc2FnZTtcbiAgfVxufTtcbmZ1bmN0aW9uIGNyZWF0ZUJhc2VUZXh0TWVzc2FnZVN0YXJ0RXZlbnQoKSB7XG4gIHJldHVybiB7IGJhc2VFdmVudDogdm9pZCAwLCBtZXNzYWdlSWQ6IFwiXCIsIHJvbGU6IHZvaWQgMCB9O1xufVxudmFyIFRleHRNZXNzYWdlU3RhcnRFdmVudCA9IHtcbiAgZW5jb2RlKG1lc3NhZ2UsIHdyaXRlciA9IG5ldyBCaW5hcnlXcml0ZXI0KCkpIHtcbiAgICBpZiAobWVzc2FnZS5iYXNlRXZlbnQgIT09IHZvaWQgMCkge1xuICAgICAgQmFzZUV2ZW50LmVuY29kZShtZXNzYWdlLmJhc2VFdmVudCwgd3JpdGVyLnVpbnQzMigxMCkuZm9yaygpKS5qb2luKCk7XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLm1lc3NhZ2VJZCAhPT0gXCJcIikge1xuICAgICAgd3JpdGVyLnVpbnQzMigxOCkuc3RyaW5nKG1lc3NhZ2UubWVzc2FnZUlkKTtcbiAgICB9XG4gICAgaWYgKG1lc3NhZ2Uucm9sZSAhPT0gdm9pZCAwKSB7XG4gICAgICB3cml0ZXIudWludDMyKDI2KS5zdHJpbmcobWVzc2FnZS5yb2xlKTtcbiAgICB9XG4gICAgcmV0dXJuIHdyaXRlcjtcbiAgfSxcbiAgZGVjb2RlKGlucHV0LCBsZW5ndGgpIHtcbiAgICBjb25zdCByZWFkZXIgPSBpbnB1dCBpbnN0YW5jZW9mIEJpbmFyeVJlYWRlcjQgPyBpbnB1dCA6IG5ldyBCaW5hcnlSZWFkZXI0KGlucHV0KTtcbiAgICBsZXQgZW5kID0gbGVuZ3RoID09PSB2b2lkIDAgPyByZWFkZXIubGVuIDogcmVhZGVyLnBvcyArIGxlbmd0aDtcbiAgICBjb25zdCBtZXNzYWdlID0gY3JlYXRlQmFzZVRleHRNZXNzYWdlU3RhcnRFdmVudCgpO1xuICAgIHdoaWxlIChyZWFkZXIucG9zIDwgZW5kKSB7XG4gICAgICBjb25zdCB0YWcgPSByZWFkZXIudWludDMyKCk7XG4gICAgICBzd2l0Y2ggKHRhZyA+Pj4gMykge1xuICAgICAgICBjYXNlIDE6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAxMCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UuYmFzZUV2ZW50ID0gQmFzZUV2ZW50LmRlY29kZShyZWFkZXIsIHJlYWRlci51aW50MzIoKSk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAyOiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gMTgpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLm1lc3NhZ2VJZCA9IHJlYWRlci5zdHJpbmcoKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIDM6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAyNikge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2Uucm9sZSA9IHJlYWRlci5zdHJpbmcoKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKCh0YWcgJiA3KSA9PT0gNCB8fCB0YWcgPT09IDApIHtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICByZWFkZXIuc2tpcCh0YWcgJiA3KTtcbiAgICB9XG4gICAgcmV0dXJuIG1lc3NhZ2U7XG4gIH0sXG4gIGNyZWF0ZShiYXNlKSB7XG4gICAgcmV0dXJuIFRleHRNZXNzYWdlU3RhcnRFdmVudC5mcm9tUGFydGlhbChiYXNlICE9IG51bGwgPyBiYXNlIDoge30pO1xuICB9LFxuICBmcm9tUGFydGlhbChvYmplY3QpIHtcbiAgICB2YXIgX2EsIF9iO1xuICAgIGNvbnN0IG1lc3NhZ2UgPSBjcmVhdGVCYXNlVGV4dE1lc3NhZ2VTdGFydEV2ZW50KCk7XG4gICAgbWVzc2FnZS5iYXNlRXZlbnQgPSBvYmplY3QuYmFzZUV2ZW50ICE9PSB2b2lkIDAgJiYgb2JqZWN0LmJhc2VFdmVudCAhPT0gbnVsbCA/IEJhc2VFdmVudC5mcm9tUGFydGlhbChvYmplY3QuYmFzZUV2ZW50KSA6IHZvaWQgMDtcbiAgICBtZXNzYWdlLm1lc3NhZ2VJZCA9IChfYSA9IG9iamVjdC5tZXNzYWdlSWQpICE9IG51bGwgPyBfYSA6IFwiXCI7XG4gICAgbWVzc2FnZS5yb2xlID0gKF9iID0gb2JqZWN0LnJvbGUpICE9IG51bGwgPyBfYiA6IHZvaWQgMDtcbiAgICByZXR1cm4gbWVzc2FnZTtcbiAgfVxufTtcbmZ1bmN0aW9uIGNyZWF0ZUJhc2VUZXh0TWVzc2FnZUNvbnRlbnRFdmVudCgpIHtcbiAgcmV0dXJuIHsgYmFzZUV2ZW50OiB2b2lkIDAsIG1lc3NhZ2VJZDogXCJcIiwgZGVsdGE6IFwiXCIgfTtcbn1cbnZhciBUZXh0TWVzc2FnZUNvbnRlbnRFdmVudCA9IHtcbiAgZW5jb2RlKG1lc3NhZ2UsIHdyaXRlciA9IG5ldyBCaW5hcnlXcml0ZXI0KCkpIHtcbiAgICBpZiAobWVzc2FnZS5iYXNlRXZlbnQgIT09IHZvaWQgMCkge1xuICAgICAgQmFzZUV2ZW50LmVuY29kZShtZXNzYWdlLmJhc2VFdmVudCwgd3JpdGVyLnVpbnQzMigxMCkuZm9yaygpKS5qb2luKCk7XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLm1lc3NhZ2VJZCAhPT0gXCJcIikge1xuICAgICAgd3JpdGVyLnVpbnQzMigxOCkuc3RyaW5nKG1lc3NhZ2UubWVzc2FnZUlkKTtcbiAgICB9XG4gICAgaWYgKG1lc3NhZ2UuZGVsdGEgIT09IFwiXCIpIHtcbiAgICAgIHdyaXRlci51aW50MzIoMjYpLnN0cmluZyhtZXNzYWdlLmRlbHRhKTtcbiAgICB9XG4gICAgcmV0dXJuIHdyaXRlcjtcbiAgfSxcbiAgZGVjb2RlKGlucHV0LCBsZW5ndGgpIHtcbiAgICBjb25zdCByZWFkZXIgPSBpbnB1dCBpbnN0YW5jZW9mIEJpbmFyeVJlYWRlcjQgPyBpbnB1dCA6IG5ldyBCaW5hcnlSZWFkZXI0KGlucHV0KTtcbiAgICBsZXQgZW5kID0gbGVuZ3RoID09PSB2b2lkIDAgPyByZWFkZXIubGVuIDogcmVhZGVyLnBvcyArIGxlbmd0aDtcbiAgICBjb25zdCBtZXNzYWdlID0gY3JlYXRlQmFzZVRleHRNZXNzYWdlQ29udGVudEV2ZW50KCk7XG4gICAgd2hpbGUgKHJlYWRlci5wb3MgPCBlbmQpIHtcbiAgICAgIGNvbnN0IHRhZyA9IHJlYWRlci51aW50MzIoKTtcbiAgICAgIHN3aXRjaCAodGFnID4+PiAzKSB7XG4gICAgICAgIGNhc2UgMToge1xuICAgICAgICAgIGlmICh0YWcgIT09IDEwKSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS5iYXNlRXZlbnQgPSBCYXNlRXZlbnQuZGVjb2RlKHJlYWRlciwgcmVhZGVyLnVpbnQzMigpKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIDI6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAxOCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UubWVzc2FnZUlkID0gcmVhZGVyLnN0cmluZygpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgMzoge1xuICAgICAgICAgIGlmICh0YWcgIT09IDI2KSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS5kZWx0YSA9IHJlYWRlci5zdHJpbmcoKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKCh0YWcgJiA3KSA9PT0gNCB8fCB0YWcgPT09IDApIHtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICByZWFkZXIuc2tpcCh0YWcgJiA3KTtcbiAgICB9XG4gICAgcmV0dXJuIG1lc3NhZ2U7XG4gIH0sXG4gIGNyZWF0ZShiYXNlKSB7XG4gICAgcmV0dXJuIFRleHRNZXNzYWdlQ29udGVudEV2ZW50LmZyb21QYXJ0aWFsKGJhc2UgIT0gbnVsbCA/IGJhc2UgOiB7fSk7XG4gIH0sXG4gIGZyb21QYXJ0aWFsKG9iamVjdCkge1xuICAgIHZhciBfYSwgX2I7XG4gICAgY29uc3QgbWVzc2FnZSA9IGNyZWF0ZUJhc2VUZXh0TWVzc2FnZUNvbnRlbnRFdmVudCgpO1xuICAgIG1lc3NhZ2UuYmFzZUV2ZW50ID0gb2JqZWN0LmJhc2VFdmVudCAhPT0gdm9pZCAwICYmIG9iamVjdC5iYXNlRXZlbnQgIT09IG51bGwgPyBCYXNlRXZlbnQuZnJvbVBhcnRpYWwob2JqZWN0LmJhc2VFdmVudCkgOiB2b2lkIDA7XG4gICAgbWVzc2FnZS5tZXNzYWdlSWQgPSAoX2EgPSBvYmplY3QubWVzc2FnZUlkKSAhPSBudWxsID8gX2EgOiBcIlwiO1xuICAgIG1lc3NhZ2UuZGVsdGEgPSAoX2IgPSBvYmplY3QuZGVsdGEpICE9IG51bGwgPyBfYiA6IFwiXCI7XG4gICAgcmV0dXJuIG1lc3NhZ2U7XG4gIH1cbn07XG5mdW5jdGlvbiBjcmVhdGVCYXNlVGV4dE1lc3NhZ2VFbmRFdmVudCgpIHtcbiAgcmV0dXJuIHsgYmFzZUV2ZW50OiB2b2lkIDAsIG1lc3NhZ2VJZDogXCJcIiB9O1xufVxudmFyIFRleHRNZXNzYWdlRW5kRXZlbnQgPSB7XG4gIGVuY29kZShtZXNzYWdlLCB3cml0ZXIgPSBuZXcgQmluYXJ5V3JpdGVyNCgpKSB7XG4gICAgaWYgKG1lc3NhZ2UuYmFzZUV2ZW50ICE9PSB2b2lkIDApIHtcbiAgICAgIEJhc2VFdmVudC5lbmNvZGUobWVzc2FnZS5iYXNlRXZlbnQsIHdyaXRlci51aW50MzIoMTApLmZvcmsoKSkuam9pbigpO1xuICAgIH1cbiAgICBpZiAobWVzc2FnZS5tZXNzYWdlSWQgIT09IFwiXCIpIHtcbiAgICAgIHdyaXRlci51aW50MzIoMTgpLnN0cmluZyhtZXNzYWdlLm1lc3NhZ2VJZCk7XG4gICAgfVxuICAgIHJldHVybiB3cml0ZXI7XG4gIH0sXG4gIGRlY29kZShpbnB1dCwgbGVuZ3RoKSB7XG4gICAgY29uc3QgcmVhZGVyID0gaW5wdXQgaW5zdGFuY2VvZiBCaW5hcnlSZWFkZXI0ID8gaW5wdXQgOiBuZXcgQmluYXJ5UmVhZGVyNChpbnB1dCk7XG4gICAgbGV0IGVuZCA9IGxlbmd0aCA9PT0gdm9pZCAwID8gcmVhZGVyLmxlbiA6IHJlYWRlci5wb3MgKyBsZW5ndGg7XG4gICAgY29uc3QgbWVzc2FnZSA9IGNyZWF0ZUJhc2VUZXh0TWVzc2FnZUVuZEV2ZW50KCk7XG4gICAgd2hpbGUgKHJlYWRlci5wb3MgPCBlbmQpIHtcbiAgICAgIGNvbnN0IHRhZyA9IHJlYWRlci51aW50MzIoKTtcbiAgICAgIHN3aXRjaCAodGFnID4+PiAzKSB7XG4gICAgICAgIGNhc2UgMToge1xuICAgICAgICAgIGlmICh0YWcgIT09IDEwKSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS5iYXNlRXZlbnQgPSBCYXNlRXZlbnQuZGVjb2RlKHJlYWRlciwgcmVhZGVyLnVpbnQzMigpKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIDI6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAxOCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UubWVzc2FnZUlkID0gcmVhZGVyLnN0cmluZygpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAoKHRhZyAmIDcpID09PSA0IHx8IHRhZyA9PT0gMCkge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIHJlYWRlci5za2lwKHRhZyAmIDcpO1xuICAgIH1cbiAgICByZXR1cm4gbWVzc2FnZTtcbiAgfSxcbiAgY3JlYXRlKGJhc2UpIHtcbiAgICByZXR1cm4gVGV4dE1lc3NhZ2VFbmRFdmVudC5mcm9tUGFydGlhbChiYXNlICE9IG51bGwgPyBiYXNlIDoge30pO1xuICB9LFxuICBmcm9tUGFydGlhbChvYmplY3QpIHtcbiAgICB2YXIgX2E7XG4gICAgY29uc3QgbWVzc2FnZSA9IGNyZWF0ZUJhc2VUZXh0TWVzc2FnZUVuZEV2ZW50KCk7XG4gICAgbWVzc2FnZS5iYXNlRXZlbnQgPSBvYmplY3QuYmFzZUV2ZW50ICE9PSB2b2lkIDAgJiYgb2JqZWN0LmJhc2VFdmVudCAhPT0gbnVsbCA/IEJhc2VFdmVudC5mcm9tUGFydGlhbChvYmplY3QuYmFzZUV2ZW50KSA6IHZvaWQgMDtcbiAgICBtZXNzYWdlLm1lc3NhZ2VJZCA9IChfYSA9IG9iamVjdC5tZXNzYWdlSWQpICE9IG51bGwgPyBfYSA6IFwiXCI7XG4gICAgcmV0dXJuIG1lc3NhZ2U7XG4gIH1cbn07XG5mdW5jdGlvbiBjcmVhdGVCYXNlVG9vbENhbGxTdGFydEV2ZW50KCkge1xuICByZXR1cm4geyBiYXNlRXZlbnQ6IHZvaWQgMCwgdG9vbENhbGxJZDogXCJcIiwgdG9vbENhbGxOYW1lOiBcIlwiLCBwYXJlbnRNZXNzYWdlSWQ6IHZvaWQgMCB9O1xufVxudmFyIFRvb2xDYWxsU3RhcnRFdmVudCA9IHtcbiAgZW5jb2RlKG1lc3NhZ2UsIHdyaXRlciA9IG5ldyBCaW5hcnlXcml0ZXI0KCkpIHtcbiAgICBpZiAobWVzc2FnZS5iYXNlRXZlbnQgIT09IHZvaWQgMCkge1xuICAgICAgQmFzZUV2ZW50LmVuY29kZShtZXNzYWdlLmJhc2VFdmVudCwgd3JpdGVyLnVpbnQzMigxMCkuZm9yaygpKS5qb2luKCk7XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLnRvb2xDYWxsSWQgIT09IFwiXCIpIHtcbiAgICAgIHdyaXRlci51aW50MzIoMTgpLnN0cmluZyhtZXNzYWdlLnRvb2xDYWxsSWQpO1xuICAgIH1cbiAgICBpZiAobWVzc2FnZS50b29sQ2FsbE5hbWUgIT09IFwiXCIpIHtcbiAgICAgIHdyaXRlci51aW50MzIoMjYpLnN0cmluZyhtZXNzYWdlLnRvb2xDYWxsTmFtZSk7XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLnBhcmVudE1lc3NhZ2VJZCAhPT0gdm9pZCAwKSB7XG4gICAgICB3cml0ZXIudWludDMyKDM0KS5zdHJpbmcobWVzc2FnZS5wYXJlbnRNZXNzYWdlSWQpO1xuICAgIH1cbiAgICByZXR1cm4gd3JpdGVyO1xuICB9LFxuICBkZWNvZGUoaW5wdXQsIGxlbmd0aCkge1xuICAgIGNvbnN0IHJlYWRlciA9IGlucHV0IGluc3RhbmNlb2YgQmluYXJ5UmVhZGVyNCA/IGlucHV0IDogbmV3IEJpbmFyeVJlYWRlcjQoaW5wdXQpO1xuICAgIGxldCBlbmQgPSBsZW5ndGggPT09IHZvaWQgMCA/IHJlYWRlci5sZW4gOiByZWFkZXIucG9zICsgbGVuZ3RoO1xuICAgIGNvbnN0IG1lc3NhZ2UgPSBjcmVhdGVCYXNlVG9vbENhbGxTdGFydEV2ZW50KCk7XG4gICAgd2hpbGUgKHJlYWRlci5wb3MgPCBlbmQpIHtcbiAgICAgIGNvbnN0IHRhZyA9IHJlYWRlci51aW50MzIoKTtcbiAgICAgIHN3aXRjaCAodGFnID4+PiAzKSB7XG4gICAgICAgIGNhc2UgMToge1xuICAgICAgICAgIGlmICh0YWcgIT09IDEwKSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS5iYXNlRXZlbnQgPSBCYXNlRXZlbnQuZGVjb2RlKHJlYWRlciwgcmVhZGVyLnVpbnQzMigpKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIDI6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAxOCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UudG9vbENhbGxJZCA9IHJlYWRlci5zdHJpbmcoKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIDM6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAyNikge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UudG9vbENhbGxOYW1lID0gcmVhZGVyLnN0cmluZygpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgNDoge1xuICAgICAgICAgIGlmICh0YWcgIT09IDM0KSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS5wYXJlbnRNZXNzYWdlSWQgPSByZWFkZXIuc3RyaW5nKCk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmICgodGFnICYgNykgPT09IDQgfHwgdGFnID09PSAwKSB7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgcmVhZGVyLnNraXAodGFnICYgNyk7XG4gICAgfVxuICAgIHJldHVybiBtZXNzYWdlO1xuICB9LFxuICBjcmVhdGUoYmFzZSkge1xuICAgIHJldHVybiBUb29sQ2FsbFN0YXJ0RXZlbnQuZnJvbVBhcnRpYWwoYmFzZSAhPSBudWxsID8gYmFzZSA6IHt9KTtcbiAgfSxcbiAgZnJvbVBhcnRpYWwob2JqZWN0KSB7XG4gICAgdmFyIF9hLCBfYiwgX2M7XG4gICAgY29uc3QgbWVzc2FnZSA9IGNyZWF0ZUJhc2VUb29sQ2FsbFN0YXJ0RXZlbnQoKTtcbiAgICBtZXNzYWdlLmJhc2VFdmVudCA9IG9iamVjdC5iYXNlRXZlbnQgIT09IHZvaWQgMCAmJiBvYmplY3QuYmFzZUV2ZW50ICE9PSBudWxsID8gQmFzZUV2ZW50LmZyb21QYXJ0aWFsKG9iamVjdC5iYXNlRXZlbnQpIDogdm9pZCAwO1xuICAgIG1lc3NhZ2UudG9vbENhbGxJZCA9IChfYSA9IG9iamVjdC50b29sQ2FsbElkKSAhPSBudWxsID8gX2EgOiBcIlwiO1xuICAgIG1lc3NhZ2UudG9vbENhbGxOYW1lID0gKF9iID0gb2JqZWN0LnRvb2xDYWxsTmFtZSkgIT0gbnVsbCA/IF9iIDogXCJcIjtcbiAgICBtZXNzYWdlLnBhcmVudE1lc3NhZ2VJZCA9IChfYyA9IG9iamVjdC5wYXJlbnRNZXNzYWdlSWQpICE9IG51bGwgPyBfYyA6IHZvaWQgMDtcbiAgICByZXR1cm4gbWVzc2FnZTtcbiAgfVxufTtcbmZ1bmN0aW9uIGNyZWF0ZUJhc2VUb29sQ2FsbEFyZ3NFdmVudCgpIHtcbiAgcmV0dXJuIHsgYmFzZUV2ZW50OiB2b2lkIDAsIHRvb2xDYWxsSWQ6IFwiXCIsIGRlbHRhOiBcIlwiIH07XG59XG52YXIgVG9vbENhbGxBcmdzRXZlbnQgPSB7XG4gIGVuY29kZShtZXNzYWdlLCB3cml0ZXIgPSBuZXcgQmluYXJ5V3JpdGVyNCgpKSB7XG4gICAgaWYgKG1lc3NhZ2UuYmFzZUV2ZW50ICE9PSB2b2lkIDApIHtcbiAgICAgIEJhc2VFdmVudC5lbmNvZGUobWVzc2FnZS5iYXNlRXZlbnQsIHdyaXRlci51aW50MzIoMTApLmZvcmsoKSkuam9pbigpO1xuICAgIH1cbiAgICBpZiAobWVzc2FnZS50b29sQ2FsbElkICE9PSBcIlwiKSB7XG4gICAgICB3cml0ZXIudWludDMyKDE4KS5zdHJpbmcobWVzc2FnZS50b29sQ2FsbElkKTtcbiAgICB9XG4gICAgaWYgKG1lc3NhZ2UuZGVsdGEgIT09IFwiXCIpIHtcbiAgICAgIHdyaXRlci51aW50MzIoMjYpLnN0cmluZyhtZXNzYWdlLmRlbHRhKTtcbiAgICB9XG4gICAgcmV0dXJuIHdyaXRlcjtcbiAgfSxcbiAgZGVjb2RlKGlucHV0LCBsZW5ndGgpIHtcbiAgICBjb25zdCByZWFkZXIgPSBpbnB1dCBpbnN0YW5jZW9mIEJpbmFyeVJlYWRlcjQgPyBpbnB1dCA6IG5ldyBCaW5hcnlSZWFkZXI0KGlucHV0KTtcbiAgICBsZXQgZW5kID0gbGVuZ3RoID09PSB2b2lkIDAgPyByZWFkZXIubGVuIDogcmVhZGVyLnBvcyArIGxlbmd0aDtcbiAgICBjb25zdCBtZXNzYWdlID0gY3JlYXRlQmFzZVRvb2xDYWxsQXJnc0V2ZW50KCk7XG4gICAgd2hpbGUgKHJlYWRlci5wb3MgPCBlbmQpIHtcbiAgICAgIGNvbnN0IHRhZyA9IHJlYWRlci51aW50MzIoKTtcbiAgICAgIHN3aXRjaCAodGFnID4+PiAzKSB7XG4gICAgICAgIGNhc2UgMToge1xuICAgICAgICAgIGlmICh0YWcgIT09IDEwKSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS5iYXNlRXZlbnQgPSBCYXNlRXZlbnQuZGVjb2RlKHJlYWRlciwgcmVhZGVyLnVpbnQzMigpKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIDI6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAxOCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UudG9vbENhbGxJZCA9IHJlYWRlci5zdHJpbmcoKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIDM6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAyNikge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UuZGVsdGEgPSByZWFkZXIuc3RyaW5nKCk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmICgodGFnICYgNykgPT09IDQgfHwgdGFnID09PSAwKSB7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgcmVhZGVyLnNraXAodGFnICYgNyk7XG4gICAgfVxuICAgIHJldHVybiBtZXNzYWdlO1xuICB9LFxuICBjcmVhdGUoYmFzZSkge1xuICAgIHJldHVybiBUb29sQ2FsbEFyZ3NFdmVudC5mcm9tUGFydGlhbChiYXNlICE9IG51bGwgPyBiYXNlIDoge30pO1xuICB9LFxuICBmcm9tUGFydGlhbChvYmplY3QpIHtcbiAgICB2YXIgX2EsIF9iO1xuICAgIGNvbnN0IG1lc3NhZ2UgPSBjcmVhdGVCYXNlVG9vbENhbGxBcmdzRXZlbnQoKTtcbiAgICBtZXNzYWdlLmJhc2VFdmVudCA9IG9iamVjdC5iYXNlRXZlbnQgIT09IHZvaWQgMCAmJiBvYmplY3QuYmFzZUV2ZW50ICE9PSBudWxsID8gQmFzZUV2ZW50LmZyb21QYXJ0aWFsKG9iamVjdC5iYXNlRXZlbnQpIDogdm9pZCAwO1xuICAgIG1lc3NhZ2UudG9vbENhbGxJZCA9IChfYSA9IG9iamVjdC50b29sQ2FsbElkKSAhPSBudWxsID8gX2EgOiBcIlwiO1xuICAgIG1lc3NhZ2UuZGVsdGEgPSAoX2IgPSBvYmplY3QuZGVsdGEpICE9IG51bGwgPyBfYiA6IFwiXCI7XG4gICAgcmV0dXJuIG1lc3NhZ2U7XG4gIH1cbn07XG5mdW5jdGlvbiBjcmVhdGVCYXNlVG9vbENhbGxFbmRFdmVudCgpIHtcbiAgcmV0dXJuIHsgYmFzZUV2ZW50OiB2b2lkIDAsIHRvb2xDYWxsSWQ6IFwiXCIgfTtcbn1cbnZhciBUb29sQ2FsbEVuZEV2ZW50ID0ge1xuICBlbmNvZGUobWVzc2FnZSwgd3JpdGVyID0gbmV3IEJpbmFyeVdyaXRlcjQoKSkge1xuICAgIGlmIChtZXNzYWdlLmJhc2VFdmVudCAhPT0gdm9pZCAwKSB7XG4gICAgICBCYXNlRXZlbnQuZW5jb2RlKG1lc3NhZ2UuYmFzZUV2ZW50LCB3cml0ZXIudWludDMyKDEwKS5mb3JrKCkpLmpvaW4oKTtcbiAgICB9XG4gICAgaWYgKG1lc3NhZ2UudG9vbENhbGxJZCAhPT0gXCJcIikge1xuICAgICAgd3JpdGVyLnVpbnQzMigxOCkuc3RyaW5nKG1lc3NhZ2UudG9vbENhbGxJZCk7XG4gICAgfVxuICAgIHJldHVybiB3cml0ZXI7XG4gIH0sXG4gIGRlY29kZShpbnB1dCwgbGVuZ3RoKSB7XG4gICAgY29uc3QgcmVhZGVyID0gaW5wdXQgaW5zdGFuY2VvZiBCaW5hcnlSZWFkZXI0ID8gaW5wdXQgOiBuZXcgQmluYXJ5UmVhZGVyNChpbnB1dCk7XG4gICAgbGV0IGVuZCA9IGxlbmd0aCA9PT0gdm9pZCAwID8gcmVhZGVyLmxlbiA6IHJlYWRlci5wb3MgKyBsZW5ndGg7XG4gICAgY29uc3QgbWVzc2FnZSA9IGNyZWF0ZUJhc2VUb29sQ2FsbEVuZEV2ZW50KCk7XG4gICAgd2hpbGUgKHJlYWRlci5wb3MgPCBlbmQpIHtcbiAgICAgIGNvbnN0IHRhZyA9IHJlYWRlci51aW50MzIoKTtcbiAgICAgIHN3aXRjaCAodGFnID4+PiAzKSB7XG4gICAgICAgIGNhc2UgMToge1xuICAgICAgICAgIGlmICh0YWcgIT09IDEwKSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS5iYXNlRXZlbnQgPSBCYXNlRXZlbnQuZGVjb2RlKHJlYWRlciwgcmVhZGVyLnVpbnQzMigpKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIDI6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAxOCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UudG9vbENhbGxJZCA9IHJlYWRlci5zdHJpbmcoKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKCh0YWcgJiA3KSA9PT0gNCB8fCB0YWcgPT09IDApIHtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICByZWFkZXIuc2tpcCh0YWcgJiA3KTtcbiAgICB9XG4gICAgcmV0dXJuIG1lc3NhZ2U7XG4gIH0sXG4gIGNyZWF0ZShiYXNlKSB7XG4gICAgcmV0dXJuIFRvb2xDYWxsRW5kRXZlbnQuZnJvbVBhcnRpYWwoYmFzZSAhPSBudWxsID8gYmFzZSA6IHt9KTtcbiAgfSxcbiAgZnJvbVBhcnRpYWwob2JqZWN0KSB7XG4gICAgdmFyIF9hO1xuICAgIGNvbnN0IG1lc3NhZ2UgPSBjcmVhdGVCYXNlVG9vbENhbGxFbmRFdmVudCgpO1xuICAgIG1lc3NhZ2UuYmFzZUV2ZW50ID0gb2JqZWN0LmJhc2VFdmVudCAhPT0gdm9pZCAwICYmIG9iamVjdC5iYXNlRXZlbnQgIT09IG51bGwgPyBCYXNlRXZlbnQuZnJvbVBhcnRpYWwob2JqZWN0LmJhc2VFdmVudCkgOiB2b2lkIDA7XG4gICAgbWVzc2FnZS50b29sQ2FsbElkID0gKF9hID0gb2JqZWN0LnRvb2xDYWxsSWQpICE9IG51bGwgPyBfYSA6IFwiXCI7XG4gICAgcmV0dXJuIG1lc3NhZ2U7XG4gIH1cbn07XG5mdW5jdGlvbiBjcmVhdGVCYXNlU3RhdGVTbmFwc2hvdEV2ZW50KCkge1xuICByZXR1cm4geyBiYXNlRXZlbnQ6IHZvaWQgMCwgc25hcHNob3Q6IHZvaWQgMCB9O1xufVxudmFyIFN0YXRlU25hcHNob3RFdmVudCA9IHtcbiAgZW5jb2RlKG1lc3NhZ2UsIHdyaXRlciA9IG5ldyBCaW5hcnlXcml0ZXI0KCkpIHtcbiAgICBpZiAobWVzc2FnZS5iYXNlRXZlbnQgIT09IHZvaWQgMCkge1xuICAgICAgQmFzZUV2ZW50LmVuY29kZShtZXNzYWdlLmJhc2VFdmVudCwgd3JpdGVyLnVpbnQzMigxMCkuZm9yaygpKS5qb2luKCk7XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLnNuYXBzaG90ICE9PSB2b2lkIDApIHtcbiAgICAgIFZhbHVlLmVuY29kZShWYWx1ZS53cmFwKG1lc3NhZ2Uuc25hcHNob3QpLCB3cml0ZXIudWludDMyKDE4KS5mb3JrKCkpLmpvaW4oKTtcbiAgICB9XG4gICAgcmV0dXJuIHdyaXRlcjtcbiAgfSxcbiAgZGVjb2RlKGlucHV0LCBsZW5ndGgpIHtcbiAgICBjb25zdCByZWFkZXIgPSBpbnB1dCBpbnN0YW5jZW9mIEJpbmFyeVJlYWRlcjQgPyBpbnB1dCA6IG5ldyBCaW5hcnlSZWFkZXI0KGlucHV0KTtcbiAgICBsZXQgZW5kID0gbGVuZ3RoID09PSB2b2lkIDAgPyByZWFkZXIubGVuIDogcmVhZGVyLnBvcyArIGxlbmd0aDtcbiAgICBjb25zdCBtZXNzYWdlID0gY3JlYXRlQmFzZVN0YXRlU25hcHNob3RFdmVudCgpO1xuICAgIHdoaWxlIChyZWFkZXIucG9zIDwgZW5kKSB7XG4gICAgICBjb25zdCB0YWcgPSByZWFkZXIudWludDMyKCk7XG4gICAgICBzd2l0Y2ggKHRhZyA+Pj4gMykge1xuICAgICAgICBjYXNlIDE6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAxMCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UuYmFzZUV2ZW50ID0gQmFzZUV2ZW50LmRlY29kZShyZWFkZXIsIHJlYWRlci51aW50MzIoKSk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAyOiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gMTgpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLnNuYXBzaG90ID0gVmFsdWUudW53cmFwKFZhbHVlLmRlY29kZShyZWFkZXIsIHJlYWRlci51aW50MzIoKSkpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAoKHRhZyAmIDcpID09PSA0IHx8IHRhZyA9PT0gMCkge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIHJlYWRlci5za2lwKHRhZyAmIDcpO1xuICAgIH1cbiAgICByZXR1cm4gbWVzc2FnZTtcbiAgfSxcbiAgY3JlYXRlKGJhc2UpIHtcbiAgICByZXR1cm4gU3RhdGVTbmFwc2hvdEV2ZW50LmZyb21QYXJ0aWFsKGJhc2UgIT0gbnVsbCA/IGJhc2UgOiB7fSk7XG4gIH0sXG4gIGZyb21QYXJ0aWFsKG9iamVjdCkge1xuICAgIHZhciBfYTtcbiAgICBjb25zdCBtZXNzYWdlID0gY3JlYXRlQmFzZVN0YXRlU25hcHNob3RFdmVudCgpO1xuICAgIG1lc3NhZ2UuYmFzZUV2ZW50ID0gb2JqZWN0LmJhc2VFdmVudCAhPT0gdm9pZCAwICYmIG9iamVjdC5iYXNlRXZlbnQgIT09IG51bGwgPyBCYXNlRXZlbnQuZnJvbVBhcnRpYWwob2JqZWN0LmJhc2VFdmVudCkgOiB2b2lkIDA7XG4gICAgbWVzc2FnZS5zbmFwc2hvdCA9IChfYSA9IG9iamVjdC5zbmFwc2hvdCkgIT0gbnVsbCA/IF9hIDogdm9pZCAwO1xuICAgIHJldHVybiBtZXNzYWdlO1xuICB9XG59O1xuZnVuY3Rpb24gY3JlYXRlQmFzZVN0YXRlRGVsdGFFdmVudCgpIHtcbiAgcmV0dXJuIHsgYmFzZUV2ZW50OiB2b2lkIDAsIGRlbHRhOiBbXSB9O1xufVxudmFyIFN0YXRlRGVsdGFFdmVudCA9IHtcbiAgZW5jb2RlKG1lc3NhZ2UsIHdyaXRlciA9IG5ldyBCaW5hcnlXcml0ZXI0KCkpIHtcbiAgICBpZiAobWVzc2FnZS5iYXNlRXZlbnQgIT09IHZvaWQgMCkge1xuICAgICAgQmFzZUV2ZW50LmVuY29kZShtZXNzYWdlLmJhc2VFdmVudCwgd3JpdGVyLnVpbnQzMigxMCkuZm9yaygpKS5qb2luKCk7XG4gICAgfVxuICAgIGZvciAoY29uc3QgdiBvZiBtZXNzYWdlLmRlbHRhKSB7XG4gICAgICBKc29uUGF0Y2hPcGVyYXRpb24uZW5jb2RlKHYsIHdyaXRlci51aW50MzIoMTgpLmZvcmsoKSkuam9pbigpO1xuICAgIH1cbiAgICByZXR1cm4gd3JpdGVyO1xuICB9LFxuICBkZWNvZGUoaW5wdXQsIGxlbmd0aCkge1xuICAgIGNvbnN0IHJlYWRlciA9IGlucHV0IGluc3RhbmNlb2YgQmluYXJ5UmVhZGVyNCA/IGlucHV0IDogbmV3IEJpbmFyeVJlYWRlcjQoaW5wdXQpO1xuICAgIGxldCBlbmQgPSBsZW5ndGggPT09IHZvaWQgMCA/IHJlYWRlci5sZW4gOiByZWFkZXIucG9zICsgbGVuZ3RoO1xuICAgIGNvbnN0IG1lc3NhZ2UgPSBjcmVhdGVCYXNlU3RhdGVEZWx0YUV2ZW50KCk7XG4gICAgd2hpbGUgKHJlYWRlci5wb3MgPCBlbmQpIHtcbiAgICAgIGNvbnN0IHRhZyA9IHJlYWRlci51aW50MzIoKTtcbiAgICAgIHN3aXRjaCAodGFnID4+PiAzKSB7XG4gICAgICAgIGNhc2UgMToge1xuICAgICAgICAgIGlmICh0YWcgIT09IDEwKSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS5iYXNlRXZlbnQgPSBCYXNlRXZlbnQuZGVjb2RlKHJlYWRlciwgcmVhZGVyLnVpbnQzMigpKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIDI6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAxOCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UuZGVsdGEucHVzaChKc29uUGF0Y2hPcGVyYXRpb24uZGVjb2RlKHJlYWRlciwgcmVhZGVyLnVpbnQzMigpKSk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmICgodGFnICYgNykgPT09IDQgfHwgdGFnID09PSAwKSB7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgcmVhZGVyLnNraXAodGFnICYgNyk7XG4gICAgfVxuICAgIHJldHVybiBtZXNzYWdlO1xuICB9LFxuICBjcmVhdGUoYmFzZSkge1xuICAgIHJldHVybiBTdGF0ZURlbHRhRXZlbnQuZnJvbVBhcnRpYWwoYmFzZSAhPSBudWxsID8gYmFzZSA6IHt9KTtcbiAgfSxcbiAgZnJvbVBhcnRpYWwob2JqZWN0KSB7XG4gICAgdmFyIF9hO1xuICAgIGNvbnN0IG1lc3NhZ2UgPSBjcmVhdGVCYXNlU3RhdGVEZWx0YUV2ZW50KCk7XG4gICAgbWVzc2FnZS5iYXNlRXZlbnQgPSBvYmplY3QuYmFzZUV2ZW50ICE9PSB2b2lkIDAgJiYgb2JqZWN0LmJhc2VFdmVudCAhPT0gbnVsbCA/IEJhc2VFdmVudC5mcm9tUGFydGlhbChvYmplY3QuYmFzZUV2ZW50KSA6IHZvaWQgMDtcbiAgICBtZXNzYWdlLmRlbHRhID0gKChfYSA9IG9iamVjdC5kZWx0YSkgPT0gbnVsbCA/IHZvaWQgMCA6IF9hLm1hcCgoZSkgPT4gSnNvblBhdGNoT3BlcmF0aW9uLmZyb21QYXJ0aWFsKGUpKSkgfHwgW107XG4gICAgcmV0dXJuIG1lc3NhZ2U7XG4gIH1cbn07XG5mdW5jdGlvbiBjcmVhdGVCYXNlTWVzc2FnZXNTbmFwc2hvdEV2ZW50KCkge1xuICByZXR1cm4geyBiYXNlRXZlbnQ6IHZvaWQgMCwgbWVzc2FnZXM6IFtdIH07XG59XG52YXIgTWVzc2FnZXNTbmFwc2hvdEV2ZW50ID0ge1xuICBlbmNvZGUobWVzc2FnZSwgd3JpdGVyID0gbmV3IEJpbmFyeVdyaXRlcjQoKSkge1xuICAgIGlmIChtZXNzYWdlLmJhc2VFdmVudCAhPT0gdm9pZCAwKSB7XG4gICAgICBCYXNlRXZlbnQuZW5jb2RlKG1lc3NhZ2UuYmFzZUV2ZW50LCB3cml0ZXIudWludDMyKDEwKS5mb3JrKCkpLmpvaW4oKTtcbiAgICB9XG4gICAgZm9yIChjb25zdCB2IG9mIG1lc3NhZ2UubWVzc2FnZXMpIHtcbiAgICAgIE1lc3NhZ2UuZW5jb2RlKHYsIHdyaXRlci51aW50MzIoMTgpLmZvcmsoKSkuam9pbigpO1xuICAgIH1cbiAgICByZXR1cm4gd3JpdGVyO1xuICB9LFxuICBkZWNvZGUoaW5wdXQsIGxlbmd0aCkge1xuICAgIGNvbnN0IHJlYWRlciA9IGlucHV0IGluc3RhbmNlb2YgQmluYXJ5UmVhZGVyNCA/IGlucHV0IDogbmV3IEJpbmFyeVJlYWRlcjQoaW5wdXQpO1xuICAgIGxldCBlbmQgPSBsZW5ndGggPT09IHZvaWQgMCA/IHJlYWRlci5sZW4gOiByZWFkZXIucG9zICsgbGVuZ3RoO1xuICAgIGNvbnN0IG1lc3NhZ2UgPSBjcmVhdGVCYXNlTWVzc2FnZXNTbmFwc2hvdEV2ZW50KCk7XG4gICAgd2hpbGUgKHJlYWRlci5wb3MgPCBlbmQpIHtcbiAgICAgIGNvbnN0IHRhZyA9IHJlYWRlci51aW50MzIoKTtcbiAgICAgIHN3aXRjaCAodGFnID4+PiAzKSB7XG4gICAgICAgIGNhc2UgMToge1xuICAgICAgICAgIGlmICh0YWcgIT09IDEwKSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS5iYXNlRXZlbnQgPSBCYXNlRXZlbnQuZGVjb2RlKHJlYWRlciwgcmVhZGVyLnVpbnQzMigpKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIDI6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAxOCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UubWVzc2FnZXMucHVzaChNZXNzYWdlLmRlY29kZShyZWFkZXIsIHJlYWRlci51aW50MzIoKSkpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAoKHRhZyAmIDcpID09PSA0IHx8IHRhZyA9PT0gMCkge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIHJlYWRlci5za2lwKHRhZyAmIDcpO1xuICAgIH1cbiAgICByZXR1cm4gbWVzc2FnZTtcbiAgfSxcbiAgY3JlYXRlKGJhc2UpIHtcbiAgICByZXR1cm4gTWVzc2FnZXNTbmFwc2hvdEV2ZW50LmZyb21QYXJ0aWFsKGJhc2UgIT0gbnVsbCA/IGJhc2UgOiB7fSk7XG4gIH0sXG4gIGZyb21QYXJ0aWFsKG9iamVjdCkge1xuICAgIHZhciBfYTtcbiAgICBjb25zdCBtZXNzYWdlID0gY3JlYXRlQmFzZU1lc3NhZ2VzU25hcHNob3RFdmVudCgpO1xuICAgIG1lc3NhZ2UuYmFzZUV2ZW50ID0gb2JqZWN0LmJhc2VFdmVudCAhPT0gdm9pZCAwICYmIG9iamVjdC5iYXNlRXZlbnQgIT09IG51bGwgPyBCYXNlRXZlbnQuZnJvbVBhcnRpYWwob2JqZWN0LmJhc2VFdmVudCkgOiB2b2lkIDA7XG4gICAgbWVzc2FnZS5tZXNzYWdlcyA9ICgoX2EgPSBvYmplY3QubWVzc2FnZXMpID09IG51bGwgPyB2b2lkIDAgOiBfYS5tYXAoKGUpID0+IE1lc3NhZ2UuZnJvbVBhcnRpYWwoZSkpKSB8fCBbXTtcbiAgICByZXR1cm4gbWVzc2FnZTtcbiAgfVxufTtcbmZ1bmN0aW9uIGNyZWF0ZUJhc2VSYXdFdmVudCgpIHtcbiAgcmV0dXJuIHsgYmFzZUV2ZW50OiB2b2lkIDAsIGV2ZW50OiB2b2lkIDAsIHNvdXJjZTogdm9pZCAwIH07XG59XG52YXIgUmF3RXZlbnQgPSB7XG4gIGVuY29kZShtZXNzYWdlLCB3cml0ZXIgPSBuZXcgQmluYXJ5V3JpdGVyNCgpKSB7XG4gICAgaWYgKG1lc3NhZ2UuYmFzZUV2ZW50ICE9PSB2b2lkIDApIHtcbiAgICAgIEJhc2VFdmVudC5lbmNvZGUobWVzc2FnZS5iYXNlRXZlbnQsIHdyaXRlci51aW50MzIoMTApLmZvcmsoKSkuam9pbigpO1xuICAgIH1cbiAgICBpZiAobWVzc2FnZS5ldmVudCAhPT0gdm9pZCAwKSB7XG4gICAgICBWYWx1ZS5lbmNvZGUoVmFsdWUud3JhcChtZXNzYWdlLmV2ZW50KSwgd3JpdGVyLnVpbnQzMigxOCkuZm9yaygpKS5qb2luKCk7XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLnNvdXJjZSAhPT0gdm9pZCAwKSB7XG4gICAgICB3cml0ZXIudWludDMyKDI2KS5zdHJpbmcobWVzc2FnZS5zb3VyY2UpO1xuICAgIH1cbiAgICByZXR1cm4gd3JpdGVyO1xuICB9LFxuICBkZWNvZGUoaW5wdXQsIGxlbmd0aCkge1xuICAgIGNvbnN0IHJlYWRlciA9IGlucHV0IGluc3RhbmNlb2YgQmluYXJ5UmVhZGVyNCA/IGlucHV0IDogbmV3IEJpbmFyeVJlYWRlcjQoaW5wdXQpO1xuICAgIGxldCBlbmQgPSBsZW5ndGggPT09IHZvaWQgMCA/IHJlYWRlci5sZW4gOiByZWFkZXIucG9zICsgbGVuZ3RoO1xuICAgIGNvbnN0IG1lc3NhZ2UgPSBjcmVhdGVCYXNlUmF3RXZlbnQoKTtcbiAgICB3aGlsZSAocmVhZGVyLnBvcyA8IGVuZCkge1xuICAgICAgY29uc3QgdGFnID0gcmVhZGVyLnVpbnQzMigpO1xuICAgICAgc3dpdGNoICh0YWcgPj4+IDMpIHtcbiAgICAgICAgY2FzZSAxOiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gMTApIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLmJhc2VFdmVudCA9IEJhc2VFdmVudC5kZWNvZGUocmVhZGVyLCByZWFkZXIudWludDMyKCkpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgMjoge1xuICAgICAgICAgIGlmICh0YWcgIT09IDE4KSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS5ldmVudCA9IFZhbHVlLnVud3JhcChWYWx1ZS5kZWNvZGUocmVhZGVyLCByZWFkZXIudWludDMyKCkpKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIDM6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAyNikge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2Uuc291cmNlID0gcmVhZGVyLnN0cmluZygpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAoKHRhZyAmIDcpID09PSA0IHx8IHRhZyA9PT0gMCkge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIHJlYWRlci5za2lwKHRhZyAmIDcpO1xuICAgIH1cbiAgICByZXR1cm4gbWVzc2FnZTtcbiAgfSxcbiAgY3JlYXRlKGJhc2UpIHtcbiAgICByZXR1cm4gUmF3RXZlbnQuZnJvbVBhcnRpYWwoYmFzZSAhPSBudWxsID8gYmFzZSA6IHt9KTtcbiAgfSxcbiAgZnJvbVBhcnRpYWwob2JqZWN0KSB7XG4gICAgdmFyIF9hLCBfYjtcbiAgICBjb25zdCBtZXNzYWdlID0gY3JlYXRlQmFzZVJhd0V2ZW50KCk7XG4gICAgbWVzc2FnZS5iYXNlRXZlbnQgPSBvYmplY3QuYmFzZUV2ZW50ICE9PSB2b2lkIDAgJiYgb2JqZWN0LmJhc2VFdmVudCAhPT0gbnVsbCA/IEJhc2VFdmVudC5mcm9tUGFydGlhbChvYmplY3QuYmFzZUV2ZW50KSA6IHZvaWQgMDtcbiAgICBtZXNzYWdlLmV2ZW50ID0gKF9hID0gb2JqZWN0LmV2ZW50KSAhPSBudWxsID8gX2EgOiB2b2lkIDA7XG4gICAgbWVzc2FnZS5zb3VyY2UgPSAoX2IgPSBvYmplY3Quc291cmNlKSAhPSBudWxsID8gX2IgOiB2b2lkIDA7XG4gICAgcmV0dXJuIG1lc3NhZ2U7XG4gIH1cbn07XG5mdW5jdGlvbiBjcmVhdGVCYXNlQ3VzdG9tRXZlbnQoKSB7XG4gIHJldHVybiB7IGJhc2VFdmVudDogdm9pZCAwLCBuYW1lOiBcIlwiLCB2YWx1ZTogdm9pZCAwIH07XG59XG52YXIgQ3VzdG9tRXZlbnQgPSB7XG4gIGVuY29kZShtZXNzYWdlLCB3cml0ZXIgPSBuZXcgQmluYXJ5V3JpdGVyNCgpKSB7XG4gICAgaWYgKG1lc3NhZ2UuYmFzZUV2ZW50ICE9PSB2b2lkIDApIHtcbiAgICAgIEJhc2VFdmVudC5lbmNvZGUobWVzc2FnZS5iYXNlRXZlbnQsIHdyaXRlci51aW50MzIoMTApLmZvcmsoKSkuam9pbigpO1xuICAgIH1cbiAgICBpZiAobWVzc2FnZS5uYW1lICE9PSBcIlwiKSB7XG4gICAgICB3cml0ZXIudWludDMyKDE4KS5zdHJpbmcobWVzc2FnZS5uYW1lKTtcbiAgICB9XG4gICAgaWYgKG1lc3NhZ2UudmFsdWUgIT09IHZvaWQgMCkge1xuICAgICAgVmFsdWUuZW5jb2RlKFZhbHVlLndyYXAobWVzc2FnZS52YWx1ZSksIHdyaXRlci51aW50MzIoMjYpLmZvcmsoKSkuam9pbigpO1xuICAgIH1cbiAgICByZXR1cm4gd3JpdGVyO1xuICB9LFxuICBkZWNvZGUoaW5wdXQsIGxlbmd0aCkge1xuICAgIGNvbnN0IHJlYWRlciA9IGlucHV0IGluc3RhbmNlb2YgQmluYXJ5UmVhZGVyNCA/IGlucHV0IDogbmV3IEJpbmFyeVJlYWRlcjQoaW5wdXQpO1xuICAgIGxldCBlbmQgPSBsZW5ndGggPT09IHZvaWQgMCA/IHJlYWRlci5sZW4gOiByZWFkZXIucG9zICsgbGVuZ3RoO1xuICAgIGNvbnN0IG1lc3NhZ2UgPSBjcmVhdGVCYXNlQ3VzdG9tRXZlbnQoKTtcbiAgICB3aGlsZSAocmVhZGVyLnBvcyA8IGVuZCkge1xuICAgICAgY29uc3QgdGFnID0gcmVhZGVyLnVpbnQzMigpO1xuICAgICAgc3dpdGNoICh0YWcgPj4+IDMpIHtcbiAgICAgICAgY2FzZSAxOiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gMTApIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLmJhc2VFdmVudCA9IEJhc2VFdmVudC5kZWNvZGUocmVhZGVyLCByZWFkZXIudWludDMyKCkpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgMjoge1xuICAgICAgICAgIGlmICh0YWcgIT09IDE4KSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS5uYW1lID0gcmVhZGVyLnN0cmluZygpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgMzoge1xuICAgICAgICAgIGlmICh0YWcgIT09IDI2KSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS52YWx1ZSA9IFZhbHVlLnVud3JhcChWYWx1ZS5kZWNvZGUocmVhZGVyLCByZWFkZXIudWludDMyKCkpKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKCh0YWcgJiA3KSA9PT0gNCB8fCB0YWcgPT09IDApIHtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICByZWFkZXIuc2tpcCh0YWcgJiA3KTtcbiAgICB9XG4gICAgcmV0dXJuIG1lc3NhZ2U7XG4gIH0sXG4gIGNyZWF0ZShiYXNlKSB7XG4gICAgcmV0dXJuIEN1c3RvbUV2ZW50LmZyb21QYXJ0aWFsKGJhc2UgIT0gbnVsbCA/IGJhc2UgOiB7fSk7XG4gIH0sXG4gIGZyb21QYXJ0aWFsKG9iamVjdCkge1xuICAgIHZhciBfYSwgX2I7XG4gICAgY29uc3QgbWVzc2FnZSA9IGNyZWF0ZUJhc2VDdXN0b21FdmVudCgpO1xuICAgIG1lc3NhZ2UuYmFzZUV2ZW50ID0gb2JqZWN0LmJhc2VFdmVudCAhPT0gdm9pZCAwICYmIG9iamVjdC5iYXNlRXZlbnQgIT09IG51bGwgPyBCYXNlRXZlbnQuZnJvbVBhcnRpYWwob2JqZWN0LmJhc2VFdmVudCkgOiB2b2lkIDA7XG4gICAgbWVzc2FnZS5uYW1lID0gKF9hID0gb2JqZWN0Lm5hbWUpICE9IG51bGwgPyBfYSA6IFwiXCI7XG4gICAgbWVzc2FnZS52YWx1ZSA9IChfYiA9IG9iamVjdC52YWx1ZSkgIT0gbnVsbCA/IF9iIDogdm9pZCAwO1xuICAgIHJldHVybiBtZXNzYWdlO1xuICB9XG59O1xuZnVuY3Rpb24gY3JlYXRlQmFzZVJ1blN0YXJ0ZWRFdmVudCgpIHtcbiAgcmV0dXJuIHsgYmFzZUV2ZW50OiB2b2lkIDAsIHRocmVhZElkOiBcIlwiLCBydW5JZDogXCJcIiB9O1xufVxudmFyIFJ1blN0YXJ0ZWRFdmVudCA9IHtcbiAgZW5jb2RlKG1lc3NhZ2UsIHdyaXRlciA9IG5ldyBCaW5hcnlXcml0ZXI0KCkpIHtcbiAgICBpZiAobWVzc2FnZS5iYXNlRXZlbnQgIT09IHZvaWQgMCkge1xuICAgICAgQmFzZUV2ZW50LmVuY29kZShtZXNzYWdlLmJhc2VFdmVudCwgd3JpdGVyLnVpbnQzMigxMCkuZm9yaygpKS5qb2luKCk7XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLnRocmVhZElkICE9PSBcIlwiKSB7XG4gICAgICB3cml0ZXIudWludDMyKDE4KS5zdHJpbmcobWVzc2FnZS50aHJlYWRJZCk7XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLnJ1bklkICE9PSBcIlwiKSB7XG4gICAgICB3cml0ZXIudWludDMyKDI2KS5zdHJpbmcobWVzc2FnZS5ydW5JZCk7XG4gICAgfVxuICAgIHJldHVybiB3cml0ZXI7XG4gIH0sXG4gIGRlY29kZShpbnB1dCwgbGVuZ3RoKSB7XG4gICAgY29uc3QgcmVhZGVyID0gaW5wdXQgaW5zdGFuY2VvZiBCaW5hcnlSZWFkZXI0ID8gaW5wdXQgOiBuZXcgQmluYXJ5UmVhZGVyNChpbnB1dCk7XG4gICAgbGV0IGVuZCA9IGxlbmd0aCA9PT0gdm9pZCAwID8gcmVhZGVyLmxlbiA6IHJlYWRlci5wb3MgKyBsZW5ndGg7XG4gICAgY29uc3QgbWVzc2FnZSA9IGNyZWF0ZUJhc2VSdW5TdGFydGVkRXZlbnQoKTtcbiAgICB3aGlsZSAocmVhZGVyLnBvcyA8IGVuZCkge1xuICAgICAgY29uc3QgdGFnID0gcmVhZGVyLnVpbnQzMigpO1xuICAgICAgc3dpdGNoICh0YWcgPj4+IDMpIHtcbiAgICAgICAgY2FzZSAxOiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gMTApIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLmJhc2VFdmVudCA9IEJhc2VFdmVudC5kZWNvZGUocmVhZGVyLCByZWFkZXIudWludDMyKCkpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgMjoge1xuICAgICAgICAgIGlmICh0YWcgIT09IDE4KSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS50aHJlYWRJZCA9IHJlYWRlci5zdHJpbmcoKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIDM6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAyNikge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UucnVuSWQgPSByZWFkZXIuc3RyaW5nKCk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmICgodGFnICYgNykgPT09IDQgfHwgdGFnID09PSAwKSB7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgcmVhZGVyLnNraXAodGFnICYgNyk7XG4gICAgfVxuICAgIHJldHVybiBtZXNzYWdlO1xuICB9LFxuICBjcmVhdGUoYmFzZSkge1xuICAgIHJldHVybiBSdW5TdGFydGVkRXZlbnQuZnJvbVBhcnRpYWwoYmFzZSAhPSBudWxsID8gYmFzZSA6IHt9KTtcbiAgfSxcbiAgZnJvbVBhcnRpYWwob2JqZWN0KSB7XG4gICAgdmFyIF9hLCBfYjtcbiAgICBjb25zdCBtZXNzYWdlID0gY3JlYXRlQmFzZVJ1blN0YXJ0ZWRFdmVudCgpO1xuICAgIG1lc3NhZ2UuYmFzZUV2ZW50ID0gb2JqZWN0LmJhc2VFdmVudCAhPT0gdm9pZCAwICYmIG9iamVjdC5iYXNlRXZlbnQgIT09IG51bGwgPyBCYXNlRXZlbnQuZnJvbVBhcnRpYWwob2JqZWN0LmJhc2VFdmVudCkgOiB2b2lkIDA7XG4gICAgbWVzc2FnZS50aHJlYWRJZCA9IChfYSA9IG9iamVjdC50aHJlYWRJZCkgIT0gbnVsbCA/IF9hIDogXCJcIjtcbiAgICBtZXNzYWdlLnJ1bklkID0gKF9iID0gb2JqZWN0LnJ1bklkKSAhPSBudWxsID8gX2IgOiBcIlwiO1xuICAgIHJldHVybiBtZXNzYWdlO1xuICB9XG59O1xuZnVuY3Rpb24gY3JlYXRlQmFzZVJ1bkZpbmlzaGVkRXZlbnQoKSB7XG4gIHJldHVybiB7IGJhc2VFdmVudDogdm9pZCAwLCB0aHJlYWRJZDogXCJcIiwgcnVuSWQ6IFwiXCIsIHJlc3VsdDogdm9pZCAwIH07XG59XG52YXIgUnVuRmluaXNoZWRFdmVudCA9IHtcbiAgZW5jb2RlKG1lc3NhZ2UsIHdyaXRlciA9IG5ldyBCaW5hcnlXcml0ZXI0KCkpIHtcbiAgICBpZiAobWVzc2FnZS5iYXNlRXZlbnQgIT09IHZvaWQgMCkge1xuICAgICAgQmFzZUV2ZW50LmVuY29kZShtZXNzYWdlLmJhc2VFdmVudCwgd3JpdGVyLnVpbnQzMigxMCkuZm9yaygpKS5qb2luKCk7XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLnRocmVhZElkICE9PSBcIlwiKSB7XG4gICAgICB3cml0ZXIudWludDMyKDE4KS5zdHJpbmcobWVzc2FnZS50aHJlYWRJZCk7XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLnJ1bklkICE9PSBcIlwiKSB7XG4gICAgICB3cml0ZXIudWludDMyKDI2KS5zdHJpbmcobWVzc2FnZS5ydW5JZCk7XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLnJlc3VsdCAhPT0gdm9pZCAwKSB7XG4gICAgICBWYWx1ZS5lbmNvZGUoVmFsdWUud3JhcChtZXNzYWdlLnJlc3VsdCksIHdyaXRlci51aW50MzIoMzQpLmZvcmsoKSkuam9pbigpO1xuICAgIH1cbiAgICByZXR1cm4gd3JpdGVyO1xuICB9LFxuICBkZWNvZGUoaW5wdXQsIGxlbmd0aCkge1xuICAgIGNvbnN0IHJlYWRlciA9IGlucHV0IGluc3RhbmNlb2YgQmluYXJ5UmVhZGVyNCA/IGlucHV0IDogbmV3IEJpbmFyeVJlYWRlcjQoaW5wdXQpO1xuICAgIGxldCBlbmQgPSBsZW5ndGggPT09IHZvaWQgMCA/IHJlYWRlci5sZW4gOiByZWFkZXIucG9zICsgbGVuZ3RoO1xuICAgIGNvbnN0IG1lc3NhZ2UgPSBjcmVhdGVCYXNlUnVuRmluaXNoZWRFdmVudCgpO1xuICAgIHdoaWxlIChyZWFkZXIucG9zIDwgZW5kKSB7XG4gICAgICBjb25zdCB0YWcgPSByZWFkZXIudWludDMyKCk7XG4gICAgICBzd2l0Y2ggKHRhZyA+Pj4gMykge1xuICAgICAgICBjYXNlIDE6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAxMCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UuYmFzZUV2ZW50ID0gQmFzZUV2ZW50LmRlY29kZShyZWFkZXIsIHJlYWRlci51aW50MzIoKSk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAyOiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gMTgpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLnRocmVhZElkID0gcmVhZGVyLnN0cmluZygpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgMzoge1xuICAgICAgICAgIGlmICh0YWcgIT09IDI2KSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS5ydW5JZCA9IHJlYWRlci5zdHJpbmcoKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIDQ6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAzNCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UucmVzdWx0ID0gVmFsdWUudW53cmFwKFZhbHVlLmRlY29kZShyZWFkZXIsIHJlYWRlci51aW50MzIoKSkpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAoKHRhZyAmIDcpID09PSA0IHx8IHRhZyA9PT0gMCkge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIHJlYWRlci5za2lwKHRhZyAmIDcpO1xuICAgIH1cbiAgICByZXR1cm4gbWVzc2FnZTtcbiAgfSxcbiAgY3JlYXRlKGJhc2UpIHtcbiAgICByZXR1cm4gUnVuRmluaXNoZWRFdmVudC5mcm9tUGFydGlhbChiYXNlICE9IG51bGwgPyBiYXNlIDoge30pO1xuICB9LFxuICBmcm9tUGFydGlhbChvYmplY3QpIHtcbiAgICB2YXIgX2EsIF9iLCBfYztcbiAgICBjb25zdCBtZXNzYWdlID0gY3JlYXRlQmFzZVJ1bkZpbmlzaGVkRXZlbnQoKTtcbiAgICBtZXNzYWdlLmJhc2VFdmVudCA9IG9iamVjdC5iYXNlRXZlbnQgIT09IHZvaWQgMCAmJiBvYmplY3QuYmFzZUV2ZW50ICE9PSBudWxsID8gQmFzZUV2ZW50LmZyb21QYXJ0aWFsKG9iamVjdC5iYXNlRXZlbnQpIDogdm9pZCAwO1xuICAgIG1lc3NhZ2UudGhyZWFkSWQgPSAoX2EgPSBvYmplY3QudGhyZWFkSWQpICE9IG51bGwgPyBfYSA6IFwiXCI7XG4gICAgbWVzc2FnZS5ydW5JZCA9IChfYiA9IG9iamVjdC5ydW5JZCkgIT0gbnVsbCA/IF9iIDogXCJcIjtcbiAgICBtZXNzYWdlLnJlc3VsdCA9IChfYyA9IG9iamVjdC5yZXN1bHQpICE9IG51bGwgPyBfYyA6IHZvaWQgMDtcbiAgICByZXR1cm4gbWVzc2FnZTtcbiAgfVxufTtcbmZ1bmN0aW9uIGNyZWF0ZUJhc2VSdW5FcnJvckV2ZW50KCkge1xuICByZXR1cm4geyBiYXNlRXZlbnQ6IHZvaWQgMCwgY29kZTogdm9pZCAwLCBtZXNzYWdlOiBcIlwiIH07XG59XG52YXIgUnVuRXJyb3JFdmVudCA9IHtcbiAgZW5jb2RlKG1lc3NhZ2UsIHdyaXRlciA9IG5ldyBCaW5hcnlXcml0ZXI0KCkpIHtcbiAgICBpZiAobWVzc2FnZS5iYXNlRXZlbnQgIT09IHZvaWQgMCkge1xuICAgICAgQmFzZUV2ZW50LmVuY29kZShtZXNzYWdlLmJhc2VFdmVudCwgd3JpdGVyLnVpbnQzMigxMCkuZm9yaygpKS5qb2luKCk7XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLmNvZGUgIT09IHZvaWQgMCkge1xuICAgICAgd3JpdGVyLnVpbnQzMigxOCkuc3RyaW5nKG1lc3NhZ2UuY29kZSk7XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLm1lc3NhZ2UgIT09IFwiXCIpIHtcbiAgICAgIHdyaXRlci51aW50MzIoMjYpLnN0cmluZyhtZXNzYWdlLm1lc3NhZ2UpO1xuICAgIH1cbiAgICByZXR1cm4gd3JpdGVyO1xuICB9LFxuICBkZWNvZGUoaW5wdXQsIGxlbmd0aCkge1xuICAgIGNvbnN0IHJlYWRlciA9IGlucHV0IGluc3RhbmNlb2YgQmluYXJ5UmVhZGVyNCA/IGlucHV0IDogbmV3IEJpbmFyeVJlYWRlcjQoaW5wdXQpO1xuICAgIGxldCBlbmQgPSBsZW5ndGggPT09IHZvaWQgMCA/IHJlYWRlci5sZW4gOiByZWFkZXIucG9zICsgbGVuZ3RoO1xuICAgIGNvbnN0IG1lc3NhZ2UgPSBjcmVhdGVCYXNlUnVuRXJyb3JFdmVudCgpO1xuICAgIHdoaWxlIChyZWFkZXIucG9zIDwgZW5kKSB7XG4gICAgICBjb25zdCB0YWcgPSByZWFkZXIudWludDMyKCk7XG4gICAgICBzd2l0Y2ggKHRhZyA+Pj4gMykge1xuICAgICAgICBjYXNlIDE6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAxMCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UuYmFzZUV2ZW50ID0gQmFzZUV2ZW50LmRlY29kZShyZWFkZXIsIHJlYWRlci51aW50MzIoKSk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAyOiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gMTgpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLmNvZGUgPSByZWFkZXIuc3RyaW5nKCk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAzOiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gMjYpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLm1lc3NhZ2UgPSByZWFkZXIuc3RyaW5nKCk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmICgodGFnICYgNykgPT09IDQgfHwgdGFnID09PSAwKSB7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgcmVhZGVyLnNraXAodGFnICYgNyk7XG4gICAgfVxuICAgIHJldHVybiBtZXNzYWdlO1xuICB9LFxuICBjcmVhdGUoYmFzZSkge1xuICAgIHJldHVybiBSdW5FcnJvckV2ZW50LmZyb21QYXJ0aWFsKGJhc2UgIT0gbnVsbCA/IGJhc2UgOiB7fSk7XG4gIH0sXG4gIGZyb21QYXJ0aWFsKG9iamVjdCkge1xuICAgIHZhciBfYSwgX2I7XG4gICAgY29uc3QgbWVzc2FnZSA9IGNyZWF0ZUJhc2VSdW5FcnJvckV2ZW50KCk7XG4gICAgbWVzc2FnZS5iYXNlRXZlbnQgPSBvYmplY3QuYmFzZUV2ZW50ICE9PSB2b2lkIDAgJiYgb2JqZWN0LmJhc2VFdmVudCAhPT0gbnVsbCA/IEJhc2VFdmVudC5mcm9tUGFydGlhbChvYmplY3QuYmFzZUV2ZW50KSA6IHZvaWQgMDtcbiAgICBtZXNzYWdlLmNvZGUgPSAoX2EgPSBvYmplY3QuY29kZSkgIT0gbnVsbCA/IF9hIDogdm9pZCAwO1xuICAgIG1lc3NhZ2UubWVzc2FnZSA9IChfYiA9IG9iamVjdC5tZXNzYWdlKSAhPSBudWxsID8gX2IgOiBcIlwiO1xuICAgIHJldHVybiBtZXNzYWdlO1xuICB9XG59O1xuZnVuY3Rpb24gY3JlYXRlQmFzZVN0ZXBTdGFydGVkRXZlbnQoKSB7XG4gIHJldHVybiB7IGJhc2VFdmVudDogdm9pZCAwLCBzdGVwTmFtZTogXCJcIiB9O1xufVxudmFyIFN0ZXBTdGFydGVkRXZlbnQgPSB7XG4gIGVuY29kZShtZXNzYWdlLCB3cml0ZXIgPSBuZXcgQmluYXJ5V3JpdGVyNCgpKSB7XG4gICAgaWYgKG1lc3NhZ2UuYmFzZUV2ZW50ICE9PSB2b2lkIDApIHtcbiAgICAgIEJhc2VFdmVudC5lbmNvZGUobWVzc2FnZS5iYXNlRXZlbnQsIHdyaXRlci51aW50MzIoMTApLmZvcmsoKSkuam9pbigpO1xuICAgIH1cbiAgICBpZiAobWVzc2FnZS5zdGVwTmFtZSAhPT0gXCJcIikge1xuICAgICAgd3JpdGVyLnVpbnQzMigxOCkuc3RyaW5nKG1lc3NhZ2Uuc3RlcE5hbWUpO1xuICAgIH1cbiAgICByZXR1cm4gd3JpdGVyO1xuICB9LFxuICBkZWNvZGUoaW5wdXQsIGxlbmd0aCkge1xuICAgIGNvbnN0IHJlYWRlciA9IGlucHV0IGluc3RhbmNlb2YgQmluYXJ5UmVhZGVyNCA/IGlucHV0IDogbmV3IEJpbmFyeVJlYWRlcjQoaW5wdXQpO1xuICAgIGxldCBlbmQgPSBsZW5ndGggPT09IHZvaWQgMCA/IHJlYWRlci5sZW4gOiByZWFkZXIucG9zICsgbGVuZ3RoO1xuICAgIGNvbnN0IG1lc3NhZ2UgPSBjcmVhdGVCYXNlU3RlcFN0YXJ0ZWRFdmVudCgpO1xuICAgIHdoaWxlIChyZWFkZXIucG9zIDwgZW5kKSB7XG4gICAgICBjb25zdCB0YWcgPSByZWFkZXIudWludDMyKCk7XG4gICAgICBzd2l0Y2ggKHRhZyA+Pj4gMykge1xuICAgICAgICBjYXNlIDE6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAxMCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UuYmFzZUV2ZW50ID0gQmFzZUV2ZW50LmRlY29kZShyZWFkZXIsIHJlYWRlci51aW50MzIoKSk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAyOiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gMTgpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLnN0ZXBOYW1lID0gcmVhZGVyLnN0cmluZygpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAoKHRhZyAmIDcpID09PSA0IHx8IHRhZyA9PT0gMCkge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIHJlYWRlci5za2lwKHRhZyAmIDcpO1xuICAgIH1cbiAgICByZXR1cm4gbWVzc2FnZTtcbiAgfSxcbiAgY3JlYXRlKGJhc2UpIHtcbiAgICByZXR1cm4gU3RlcFN0YXJ0ZWRFdmVudC5mcm9tUGFydGlhbChiYXNlICE9IG51bGwgPyBiYXNlIDoge30pO1xuICB9LFxuICBmcm9tUGFydGlhbChvYmplY3QpIHtcbiAgICB2YXIgX2E7XG4gICAgY29uc3QgbWVzc2FnZSA9IGNyZWF0ZUJhc2VTdGVwU3RhcnRlZEV2ZW50KCk7XG4gICAgbWVzc2FnZS5iYXNlRXZlbnQgPSBvYmplY3QuYmFzZUV2ZW50ICE9PSB2b2lkIDAgJiYgb2JqZWN0LmJhc2VFdmVudCAhPT0gbnVsbCA/IEJhc2VFdmVudC5mcm9tUGFydGlhbChvYmplY3QuYmFzZUV2ZW50KSA6IHZvaWQgMDtcbiAgICBtZXNzYWdlLnN0ZXBOYW1lID0gKF9hID0gb2JqZWN0LnN0ZXBOYW1lKSAhPSBudWxsID8gX2EgOiBcIlwiO1xuICAgIHJldHVybiBtZXNzYWdlO1xuICB9XG59O1xuZnVuY3Rpb24gY3JlYXRlQmFzZVN0ZXBGaW5pc2hlZEV2ZW50KCkge1xuICByZXR1cm4geyBiYXNlRXZlbnQ6IHZvaWQgMCwgc3RlcE5hbWU6IFwiXCIgfTtcbn1cbnZhciBTdGVwRmluaXNoZWRFdmVudCA9IHtcbiAgZW5jb2RlKG1lc3NhZ2UsIHdyaXRlciA9IG5ldyBCaW5hcnlXcml0ZXI0KCkpIHtcbiAgICBpZiAobWVzc2FnZS5iYXNlRXZlbnQgIT09IHZvaWQgMCkge1xuICAgICAgQmFzZUV2ZW50LmVuY29kZShtZXNzYWdlLmJhc2VFdmVudCwgd3JpdGVyLnVpbnQzMigxMCkuZm9yaygpKS5qb2luKCk7XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLnN0ZXBOYW1lICE9PSBcIlwiKSB7XG4gICAgICB3cml0ZXIudWludDMyKDE4KS5zdHJpbmcobWVzc2FnZS5zdGVwTmFtZSk7XG4gICAgfVxuICAgIHJldHVybiB3cml0ZXI7XG4gIH0sXG4gIGRlY29kZShpbnB1dCwgbGVuZ3RoKSB7XG4gICAgY29uc3QgcmVhZGVyID0gaW5wdXQgaW5zdGFuY2VvZiBCaW5hcnlSZWFkZXI0ID8gaW5wdXQgOiBuZXcgQmluYXJ5UmVhZGVyNChpbnB1dCk7XG4gICAgbGV0IGVuZCA9IGxlbmd0aCA9PT0gdm9pZCAwID8gcmVhZGVyLmxlbiA6IHJlYWRlci5wb3MgKyBsZW5ndGg7XG4gICAgY29uc3QgbWVzc2FnZSA9IGNyZWF0ZUJhc2VTdGVwRmluaXNoZWRFdmVudCgpO1xuICAgIHdoaWxlIChyZWFkZXIucG9zIDwgZW5kKSB7XG4gICAgICBjb25zdCB0YWcgPSByZWFkZXIudWludDMyKCk7XG4gICAgICBzd2l0Y2ggKHRhZyA+Pj4gMykge1xuICAgICAgICBjYXNlIDE6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAxMCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UuYmFzZUV2ZW50ID0gQmFzZUV2ZW50LmRlY29kZShyZWFkZXIsIHJlYWRlci51aW50MzIoKSk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAyOiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gMTgpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLnN0ZXBOYW1lID0gcmVhZGVyLnN0cmluZygpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAoKHRhZyAmIDcpID09PSA0IHx8IHRhZyA9PT0gMCkge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIHJlYWRlci5za2lwKHRhZyAmIDcpO1xuICAgIH1cbiAgICByZXR1cm4gbWVzc2FnZTtcbiAgfSxcbiAgY3JlYXRlKGJhc2UpIHtcbiAgICByZXR1cm4gU3RlcEZpbmlzaGVkRXZlbnQuZnJvbVBhcnRpYWwoYmFzZSAhPSBudWxsID8gYmFzZSA6IHt9KTtcbiAgfSxcbiAgZnJvbVBhcnRpYWwob2JqZWN0KSB7XG4gICAgdmFyIF9hO1xuICAgIGNvbnN0IG1lc3NhZ2UgPSBjcmVhdGVCYXNlU3RlcEZpbmlzaGVkRXZlbnQoKTtcbiAgICBtZXNzYWdlLmJhc2VFdmVudCA9IG9iamVjdC5iYXNlRXZlbnQgIT09IHZvaWQgMCAmJiBvYmplY3QuYmFzZUV2ZW50ICE9PSBudWxsID8gQmFzZUV2ZW50LmZyb21QYXJ0aWFsKG9iamVjdC5iYXNlRXZlbnQpIDogdm9pZCAwO1xuICAgIG1lc3NhZ2Uuc3RlcE5hbWUgPSAoX2EgPSBvYmplY3Quc3RlcE5hbWUpICE9IG51bGwgPyBfYSA6IFwiXCI7XG4gICAgcmV0dXJuIG1lc3NhZ2U7XG4gIH1cbn07XG5mdW5jdGlvbiBjcmVhdGVCYXNlVGV4dE1lc3NhZ2VDaHVua0V2ZW50KCkge1xuICByZXR1cm4geyBiYXNlRXZlbnQ6IHZvaWQgMCwgbWVzc2FnZUlkOiB2b2lkIDAsIHJvbGU6IHZvaWQgMCwgZGVsdGE6IHZvaWQgMCB9O1xufVxudmFyIFRleHRNZXNzYWdlQ2h1bmtFdmVudCA9IHtcbiAgZW5jb2RlKG1lc3NhZ2UsIHdyaXRlciA9IG5ldyBCaW5hcnlXcml0ZXI0KCkpIHtcbiAgICBpZiAobWVzc2FnZS5iYXNlRXZlbnQgIT09IHZvaWQgMCkge1xuICAgICAgQmFzZUV2ZW50LmVuY29kZShtZXNzYWdlLmJhc2VFdmVudCwgd3JpdGVyLnVpbnQzMigxMCkuZm9yaygpKS5qb2luKCk7XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLm1lc3NhZ2VJZCAhPT0gdm9pZCAwKSB7XG4gICAgICB3cml0ZXIudWludDMyKDE4KS5zdHJpbmcobWVzc2FnZS5tZXNzYWdlSWQpO1xuICAgIH1cbiAgICBpZiAobWVzc2FnZS5yb2xlICE9PSB2b2lkIDApIHtcbiAgICAgIHdyaXRlci51aW50MzIoMjYpLnN0cmluZyhtZXNzYWdlLnJvbGUpO1xuICAgIH1cbiAgICBpZiAobWVzc2FnZS5kZWx0YSAhPT0gdm9pZCAwKSB7XG4gICAgICB3cml0ZXIudWludDMyKDM0KS5zdHJpbmcobWVzc2FnZS5kZWx0YSk7XG4gICAgfVxuICAgIHJldHVybiB3cml0ZXI7XG4gIH0sXG4gIGRlY29kZShpbnB1dCwgbGVuZ3RoKSB7XG4gICAgY29uc3QgcmVhZGVyID0gaW5wdXQgaW5zdGFuY2VvZiBCaW5hcnlSZWFkZXI0ID8gaW5wdXQgOiBuZXcgQmluYXJ5UmVhZGVyNChpbnB1dCk7XG4gICAgbGV0IGVuZCA9IGxlbmd0aCA9PT0gdm9pZCAwID8gcmVhZGVyLmxlbiA6IHJlYWRlci5wb3MgKyBsZW5ndGg7XG4gICAgY29uc3QgbWVzc2FnZSA9IGNyZWF0ZUJhc2VUZXh0TWVzc2FnZUNodW5rRXZlbnQoKTtcbiAgICB3aGlsZSAocmVhZGVyLnBvcyA8IGVuZCkge1xuICAgICAgY29uc3QgdGFnID0gcmVhZGVyLnVpbnQzMigpO1xuICAgICAgc3dpdGNoICh0YWcgPj4+IDMpIHtcbiAgICAgICAgY2FzZSAxOiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gMTApIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLmJhc2VFdmVudCA9IEJhc2VFdmVudC5kZWNvZGUocmVhZGVyLCByZWFkZXIudWludDMyKCkpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgMjoge1xuICAgICAgICAgIGlmICh0YWcgIT09IDE4KSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS5tZXNzYWdlSWQgPSByZWFkZXIuc3RyaW5nKCk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAzOiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gMjYpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLnJvbGUgPSByZWFkZXIuc3RyaW5nKCk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSA0OiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gMzQpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLmRlbHRhID0gcmVhZGVyLnN0cmluZygpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAoKHRhZyAmIDcpID09PSA0IHx8IHRhZyA9PT0gMCkge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIHJlYWRlci5za2lwKHRhZyAmIDcpO1xuICAgIH1cbiAgICByZXR1cm4gbWVzc2FnZTtcbiAgfSxcbiAgY3JlYXRlKGJhc2UpIHtcbiAgICByZXR1cm4gVGV4dE1lc3NhZ2VDaHVua0V2ZW50LmZyb21QYXJ0aWFsKGJhc2UgIT0gbnVsbCA/IGJhc2UgOiB7fSk7XG4gIH0sXG4gIGZyb21QYXJ0aWFsKG9iamVjdCkge1xuICAgIHZhciBfYSwgX2IsIF9jO1xuICAgIGNvbnN0IG1lc3NhZ2UgPSBjcmVhdGVCYXNlVGV4dE1lc3NhZ2VDaHVua0V2ZW50KCk7XG4gICAgbWVzc2FnZS5iYXNlRXZlbnQgPSBvYmplY3QuYmFzZUV2ZW50ICE9PSB2b2lkIDAgJiYgb2JqZWN0LmJhc2VFdmVudCAhPT0gbnVsbCA/IEJhc2VFdmVudC5mcm9tUGFydGlhbChvYmplY3QuYmFzZUV2ZW50KSA6IHZvaWQgMDtcbiAgICBtZXNzYWdlLm1lc3NhZ2VJZCA9IChfYSA9IG9iamVjdC5tZXNzYWdlSWQpICE9IG51bGwgPyBfYSA6IHZvaWQgMDtcbiAgICBtZXNzYWdlLnJvbGUgPSAoX2IgPSBvYmplY3Qucm9sZSkgIT0gbnVsbCA/IF9iIDogdm9pZCAwO1xuICAgIG1lc3NhZ2UuZGVsdGEgPSAoX2MgPSBvYmplY3QuZGVsdGEpICE9IG51bGwgPyBfYyA6IHZvaWQgMDtcbiAgICByZXR1cm4gbWVzc2FnZTtcbiAgfVxufTtcbmZ1bmN0aW9uIGNyZWF0ZUJhc2VUb29sQ2FsbENodW5rRXZlbnQoKSB7XG4gIHJldHVybiB7XG4gICAgYmFzZUV2ZW50OiB2b2lkIDAsXG4gICAgdG9vbENhbGxJZDogdm9pZCAwLFxuICAgIHRvb2xDYWxsTmFtZTogdm9pZCAwLFxuICAgIHBhcmVudE1lc3NhZ2VJZDogdm9pZCAwLFxuICAgIGRlbHRhOiB2b2lkIDBcbiAgfTtcbn1cbnZhciBUb29sQ2FsbENodW5rRXZlbnQgPSB7XG4gIGVuY29kZShtZXNzYWdlLCB3cml0ZXIgPSBuZXcgQmluYXJ5V3JpdGVyNCgpKSB7XG4gICAgaWYgKG1lc3NhZ2UuYmFzZUV2ZW50ICE9PSB2b2lkIDApIHtcbiAgICAgIEJhc2VFdmVudC5lbmNvZGUobWVzc2FnZS5iYXNlRXZlbnQsIHdyaXRlci51aW50MzIoMTApLmZvcmsoKSkuam9pbigpO1xuICAgIH1cbiAgICBpZiAobWVzc2FnZS50b29sQ2FsbElkICE9PSB2b2lkIDApIHtcbiAgICAgIHdyaXRlci51aW50MzIoMTgpLnN0cmluZyhtZXNzYWdlLnRvb2xDYWxsSWQpO1xuICAgIH1cbiAgICBpZiAobWVzc2FnZS50b29sQ2FsbE5hbWUgIT09IHZvaWQgMCkge1xuICAgICAgd3JpdGVyLnVpbnQzMigyNikuc3RyaW5nKG1lc3NhZ2UudG9vbENhbGxOYW1lKTtcbiAgICB9XG4gICAgaWYgKG1lc3NhZ2UucGFyZW50TWVzc2FnZUlkICE9PSB2b2lkIDApIHtcbiAgICAgIHdyaXRlci51aW50MzIoMzQpLnN0cmluZyhtZXNzYWdlLnBhcmVudE1lc3NhZ2VJZCk7XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLmRlbHRhICE9PSB2b2lkIDApIHtcbiAgICAgIHdyaXRlci51aW50MzIoNDIpLnN0cmluZyhtZXNzYWdlLmRlbHRhKTtcbiAgICB9XG4gICAgcmV0dXJuIHdyaXRlcjtcbiAgfSxcbiAgZGVjb2RlKGlucHV0LCBsZW5ndGgpIHtcbiAgICBjb25zdCByZWFkZXIgPSBpbnB1dCBpbnN0YW5jZW9mIEJpbmFyeVJlYWRlcjQgPyBpbnB1dCA6IG5ldyBCaW5hcnlSZWFkZXI0KGlucHV0KTtcbiAgICBsZXQgZW5kID0gbGVuZ3RoID09PSB2b2lkIDAgPyByZWFkZXIubGVuIDogcmVhZGVyLnBvcyArIGxlbmd0aDtcbiAgICBjb25zdCBtZXNzYWdlID0gY3JlYXRlQmFzZVRvb2xDYWxsQ2h1bmtFdmVudCgpO1xuICAgIHdoaWxlIChyZWFkZXIucG9zIDwgZW5kKSB7XG4gICAgICBjb25zdCB0YWcgPSByZWFkZXIudWludDMyKCk7XG4gICAgICBzd2l0Y2ggKHRhZyA+Pj4gMykge1xuICAgICAgICBjYXNlIDE6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAxMCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UuYmFzZUV2ZW50ID0gQmFzZUV2ZW50LmRlY29kZShyZWFkZXIsIHJlYWRlci51aW50MzIoKSk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAyOiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gMTgpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLnRvb2xDYWxsSWQgPSByZWFkZXIuc3RyaW5nKCk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAzOiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gMjYpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLnRvb2xDYWxsTmFtZSA9IHJlYWRlci5zdHJpbmcoKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIDQ6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAzNCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UucGFyZW50TWVzc2FnZUlkID0gcmVhZGVyLnN0cmluZygpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgNToge1xuICAgICAgICAgIGlmICh0YWcgIT09IDQyKSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS5kZWx0YSA9IHJlYWRlci5zdHJpbmcoKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKCh0YWcgJiA3KSA9PT0gNCB8fCB0YWcgPT09IDApIHtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICByZWFkZXIuc2tpcCh0YWcgJiA3KTtcbiAgICB9XG4gICAgcmV0dXJuIG1lc3NhZ2U7XG4gIH0sXG4gIGNyZWF0ZShiYXNlKSB7XG4gICAgcmV0dXJuIFRvb2xDYWxsQ2h1bmtFdmVudC5mcm9tUGFydGlhbChiYXNlICE9IG51bGwgPyBiYXNlIDoge30pO1xuICB9LFxuICBmcm9tUGFydGlhbChvYmplY3QpIHtcbiAgICB2YXIgX2EsIF9iLCBfYywgX2Q7XG4gICAgY29uc3QgbWVzc2FnZSA9IGNyZWF0ZUJhc2VUb29sQ2FsbENodW5rRXZlbnQoKTtcbiAgICBtZXNzYWdlLmJhc2VFdmVudCA9IG9iamVjdC5iYXNlRXZlbnQgIT09IHZvaWQgMCAmJiBvYmplY3QuYmFzZUV2ZW50ICE9PSBudWxsID8gQmFzZUV2ZW50LmZyb21QYXJ0aWFsKG9iamVjdC5iYXNlRXZlbnQpIDogdm9pZCAwO1xuICAgIG1lc3NhZ2UudG9vbENhbGxJZCA9IChfYSA9IG9iamVjdC50b29sQ2FsbElkKSAhPSBudWxsID8gX2EgOiB2b2lkIDA7XG4gICAgbWVzc2FnZS50b29sQ2FsbE5hbWUgPSAoX2IgPSBvYmplY3QudG9vbENhbGxOYW1lKSAhPSBudWxsID8gX2IgOiB2b2lkIDA7XG4gICAgbWVzc2FnZS5wYXJlbnRNZXNzYWdlSWQgPSAoX2MgPSBvYmplY3QucGFyZW50TWVzc2FnZUlkKSAhPSBudWxsID8gX2MgOiB2b2lkIDA7XG4gICAgbWVzc2FnZS5kZWx0YSA9IChfZCA9IG9iamVjdC5kZWx0YSkgIT0gbnVsbCA/IF9kIDogdm9pZCAwO1xuICAgIHJldHVybiBtZXNzYWdlO1xuICB9XG59O1xuZnVuY3Rpb24gY3JlYXRlQmFzZUV2ZW50KCkge1xuICByZXR1cm4ge1xuICAgIHRleHRNZXNzYWdlU3RhcnQ6IHZvaWQgMCxcbiAgICB0ZXh0TWVzc2FnZUNvbnRlbnQ6IHZvaWQgMCxcbiAgICB0ZXh0TWVzc2FnZUVuZDogdm9pZCAwLFxuICAgIHRvb2xDYWxsU3RhcnQ6IHZvaWQgMCxcbiAgICB0b29sQ2FsbEFyZ3M6IHZvaWQgMCxcbiAgICB0b29sQ2FsbEVuZDogdm9pZCAwLFxuICAgIHN0YXRlU25hcHNob3Q6IHZvaWQgMCxcbiAgICBzdGF0ZURlbHRhOiB2b2lkIDAsXG4gICAgbWVzc2FnZXNTbmFwc2hvdDogdm9pZCAwLFxuICAgIHJhdzogdm9pZCAwLFxuICAgIGN1c3RvbTogdm9pZCAwLFxuICAgIHJ1blN0YXJ0ZWQ6IHZvaWQgMCxcbiAgICBydW5GaW5pc2hlZDogdm9pZCAwLFxuICAgIHJ1bkVycm9yOiB2b2lkIDAsXG4gICAgc3RlcFN0YXJ0ZWQ6IHZvaWQgMCxcbiAgICBzdGVwRmluaXNoZWQ6IHZvaWQgMCxcbiAgICB0ZXh0TWVzc2FnZUNodW5rOiB2b2lkIDAsXG4gICAgdG9vbENhbGxDaHVuazogdm9pZCAwXG4gIH07XG59XG52YXIgRXZlbnQgPSB7XG4gIGVuY29kZShtZXNzYWdlLCB3cml0ZXIgPSBuZXcgQmluYXJ5V3JpdGVyNCgpKSB7XG4gICAgaWYgKG1lc3NhZ2UudGV4dE1lc3NhZ2VTdGFydCAhPT0gdm9pZCAwKSB7XG4gICAgICBUZXh0TWVzc2FnZVN0YXJ0RXZlbnQuZW5jb2RlKG1lc3NhZ2UudGV4dE1lc3NhZ2VTdGFydCwgd3JpdGVyLnVpbnQzMigxMCkuZm9yaygpKS5qb2luKCk7XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLnRleHRNZXNzYWdlQ29udGVudCAhPT0gdm9pZCAwKSB7XG4gICAgICBUZXh0TWVzc2FnZUNvbnRlbnRFdmVudC5lbmNvZGUobWVzc2FnZS50ZXh0TWVzc2FnZUNvbnRlbnQsIHdyaXRlci51aW50MzIoMTgpLmZvcmsoKSkuam9pbigpO1xuICAgIH1cbiAgICBpZiAobWVzc2FnZS50ZXh0TWVzc2FnZUVuZCAhPT0gdm9pZCAwKSB7XG4gICAgICBUZXh0TWVzc2FnZUVuZEV2ZW50LmVuY29kZShtZXNzYWdlLnRleHRNZXNzYWdlRW5kLCB3cml0ZXIudWludDMyKDI2KS5mb3JrKCkpLmpvaW4oKTtcbiAgICB9XG4gICAgaWYgKG1lc3NhZ2UudG9vbENhbGxTdGFydCAhPT0gdm9pZCAwKSB7XG4gICAgICBUb29sQ2FsbFN0YXJ0RXZlbnQuZW5jb2RlKG1lc3NhZ2UudG9vbENhbGxTdGFydCwgd3JpdGVyLnVpbnQzMigzNCkuZm9yaygpKS5qb2luKCk7XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLnRvb2xDYWxsQXJncyAhPT0gdm9pZCAwKSB7XG4gICAgICBUb29sQ2FsbEFyZ3NFdmVudC5lbmNvZGUobWVzc2FnZS50b29sQ2FsbEFyZ3MsIHdyaXRlci51aW50MzIoNDIpLmZvcmsoKSkuam9pbigpO1xuICAgIH1cbiAgICBpZiAobWVzc2FnZS50b29sQ2FsbEVuZCAhPT0gdm9pZCAwKSB7XG4gICAgICBUb29sQ2FsbEVuZEV2ZW50LmVuY29kZShtZXNzYWdlLnRvb2xDYWxsRW5kLCB3cml0ZXIudWludDMyKDUwKS5mb3JrKCkpLmpvaW4oKTtcbiAgICB9XG4gICAgaWYgKG1lc3NhZ2Uuc3RhdGVTbmFwc2hvdCAhPT0gdm9pZCAwKSB7XG4gICAgICBTdGF0ZVNuYXBzaG90RXZlbnQuZW5jb2RlKG1lc3NhZ2Uuc3RhdGVTbmFwc2hvdCwgd3JpdGVyLnVpbnQzMig1OCkuZm9yaygpKS5qb2luKCk7XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLnN0YXRlRGVsdGEgIT09IHZvaWQgMCkge1xuICAgICAgU3RhdGVEZWx0YUV2ZW50LmVuY29kZShtZXNzYWdlLnN0YXRlRGVsdGEsIHdyaXRlci51aW50MzIoNjYpLmZvcmsoKSkuam9pbigpO1xuICAgIH1cbiAgICBpZiAobWVzc2FnZS5tZXNzYWdlc1NuYXBzaG90ICE9PSB2b2lkIDApIHtcbiAgICAgIE1lc3NhZ2VzU25hcHNob3RFdmVudC5lbmNvZGUobWVzc2FnZS5tZXNzYWdlc1NuYXBzaG90LCB3cml0ZXIudWludDMyKDc0KS5mb3JrKCkpLmpvaW4oKTtcbiAgICB9XG4gICAgaWYgKG1lc3NhZ2UucmF3ICE9PSB2b2lkIDApIHtcbiAgICAgIFJhd0V2ZW50LmVuY29kZShtZXNzYWdlLnJhdywgd3JpdGVyLnVpbnQzMig4MikuZm9yaygpKS5qb2luKCk7XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLmN1c3RvbSAhPT0gdm9pZCAwKSB7XG4gICAgICBDdXN0b21FdmVudC5lbmNvZGUobWVzc2FnZS5jdXN0b20sIHdyaXRlci51aW50MzIoOTApLmZvcmsoKSkuam9pbigpO1xuICAgIH1cbiAgICBpZiAobWVzc2FnZS5ydW5TdGFydGVkICE9PSB2b2lkIDApIHtcbiAgICAgIFJ1blN0YXJ0ZWRFdmVudC5lbmNvZGUobWVzc2FnZS5ydW5TdGFydGVkLCB3cml0ZXIudWludDMyKDk4KS5mb3JrKCkpLmpvaW4oKTtcbiAgICB9XG4gICAgaWYgKG1lc3NhZ2UucnVuRmluaXNoZWQgIT09IHZvaWQgMCkge1xuICAgICAgUnVuRmluaXNoZWRFdmVudC5lbmNvZGUobWVzc2FnZS5ydW5GaW5pc2hlZCwgd3JpdGVyLnVpbnQzMigxMDYpLmZvcmsoKSkuam9pbigpO1xuICAgIH1cbiAgICBpZiAobWVzc2FnZS5ydW5FcnJvciAhPT0gdm9pZCAwKSB7XG4gICAgICBSdW5FcnJvckV2ZW50LmVuY29kZShtZXNzYWdlLnJ1bkVycm9yLCB3cml0ZXIudWludDMyKDExNCkuZm9yaygpKS5qb2luKCk7XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLnN0ZXBTdGFydGVkICE9PSB2b2lkIDApIHtcbiAgICAgIFN0ZXBTdGFydGVkRXZlbnQuZW5jb2RlKG1lc3NhZ2Uuc3RlcFN0YXJ0ZWQsIHdyaXRlci51aW50MzIoMTIyKS5mb3JrKCkpLmpvaW4oKTtcbiAgICB9XG4gICAgaWYgKG1lc3NhZ2Uuc3RlcEZpbmlzaGVkICE9PSB2b2lkIDApIHtcbiAgICAgIFN0ZXBGaW5pc2hlZEV2ZW50LmVuY29kZShtZXNzYWdlLnN0ZXBGaW5pc2hlZCwgd3JpdGVyLnVpbnQzMigxMzApLmZvcmsoKSkuam9pbigpO1xuICAgIH1cbiAgICBpZiAobWVzc2FnZS50ZXh0TWVzc2FnZUNodW5rICE9PSB2b2lkIDApIHtcbiAgICAgIFRleHRNZXNzYWdlQ2h1bmtFdmVudC5lbmNvZGUobWVzc2FnZS50ZXh0TWVzc2FnZUNodW5rLCB3cml0ZXIudWludDMyKDEzOCkuZm9yaygpKS5qb2luKCk7XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLnRvb2xDYWxsQ2h1bmsgIT09IHZvaWQgMCkge1xuICAgICAgVG9vbENhbGxDaHVua0V2ZW50LmVuY29kZShtZXNzYWdlLnRvb2xDYWxsQ2h1bmssIHdyaXRlci51aW50MzIoMTQ2KS5mb3JrKCkpLmpvaW4oKTtcbiAgICB9XG4gICAgcmV0dXJuIHdyaXRlcjtcbiAgfSxcbiAgZGVjb2RlKGlucHV0LCBsZW5ndGgpIHtcbiAgICBjb25zdCByZWFkZXIgPSBpbnB1dCBpbnN0YW5jZW9mIEJpbmFyeVJlYWRlcjQgPyBpbnB1dCA6IG5ldyBCaW5hcnlSZWFkZXI0KGlucHV0KTtcbiAgICBsZXQgZW5kID0gbGVuZ3RoID09PSB2b2lkIDAgPyByZWFkZXIubGVuIDogcmVhZGVyLnBvcyArIGxlbmd0aDtcbiAgICBjb25zdCBtZXNzYWdlID0gY3JlYXRlQmFzZUV2ZW50KCk7XG4gICAgd2hpbGUgKHJlYWRlci5wb3MgPCBlbmQpIHtcbiAgICAgIGNvbnN0IHRhZyA9IHJlYWRlci51aW50MzIoKTtcbiAgICAgIHN3aXRjaCAodGFnID4+PiAzKSB7XG4gICAgICAgIGNhc2UgMToge1xuICAgICAgICAgIGlmICh0YWcgIT09IDEwKSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS50ZXh0TWVzc2FnZVN0YXJ0ID0gVGV4dE1lc3NhZ2VTdGFydEV2ZW50LmRlY29kZShyZWFkZXIsIHJlYWRlci51aW50MzIoKSk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAyOiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gMTgpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLnRleHRNZXNzYWdlQ29udGVudCA9IFRleHRNZXNzYWdlQ29udGVudEV2ZW50LmRlY29kZShyZWFkZXIsIHJlYWRlci51aW50MzIoKSk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAzOiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gMjYpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLnRleHRNZXNzYWdlRW5kID0gVGV4dE1lc3NhZ2VFbmRFdmVudC5kZWNvZGUocmVhZGVyLCByZWFkZXIudWludDMyKCkpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgNDoge1xuICAgICAgICAgIGlmICh0YWcgIT09IDM0KSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS50b29sQ2FsbFN0YXJ0ID0gVG9vbENhbGxTdGFydEV2ZW50LmRlY29kZShyZWFkZXIsIHJlYWRlci51aW50MzIoKSk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSA1OiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gNDIpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLnRvb2xDYWxsQXJncyA9IFRvb2xDYWxsQXJnc0V2ZW50LmRlY29kZShyZWFkZXIsIHJlYWRlci51aW50MzIoKSk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSA2OiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gNTApIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLnRvb2xDYWxsRW5kID0gVG9vbENhbGxFbmRFdmVudC5kZWNvZGUocmVhZGVyLCByZWFkZXIudWludDMyKCkpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgNzoge1xuICAgICAgICAgIGlmICh0YWcgIT09IDU4KSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS5zdGF0ZVNuYXBzaG90ID0gU3RhdGVTbmFwc2hvdEV2ZW50LmRlY29kZShyZWFkZXIsIHJlYWRlci51aW50MzIoKSk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSA4OiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gNjYpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLnN0YXRlRGVsdGEgPSBTdGF0ZURlbHRhRXZlbnQuZGVjb2RlKHJlYWRlciwgcmVhZGVyLnVpbnQzMigpKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIDk6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSA3NCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UubWVzc2FnZXNTbmFwc2hvdCA9IE1lc3NhZ2VzU25hcHNob3RFdmVudC5kZWNvZGUocmVhZGVyLCByZWFkZXIudWludDMyKCkpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgMTA6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSA4Mikge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UucmF3ID0gUmF3RXZlbnQuZGVjb2RlKHJlYWRlciwgcmVhZGVyLnVpbnQzMigpKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIDExOiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gOTApIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLmN1c3RvbSA9IEN1c3RvbUV2ZW50LmRlY29kZShyZWFkZXIsIHJlYWRlci51aW50MzIoKSk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAxMjoge1xuICAgICAgICAgIGlmICh0YWcgIT09IDk4KSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS5ydW5TdGFydGVkID0gUnVuU3RhcnRlZEV2ZW50LmRlY29kZShyZWFkZXIsIHJlYWRlci51aW50MzIoKSk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAxMzoge1xuICAgICAgICAgIGlmICh0YWcgIT09IDEwNikge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UucnVuRmluaXNoZWQgPSBSdW5GaW5pc2hlZEV2ZW50LmRlY29kZShyZWFkZXIsIHJlYWRlci51aW50MzIoKSk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAxNDoge1xuICAgICAgICAgIGlmICh0YWcgIT09IDExNCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UucnVuRXJyb3IgPSBSdW5FcnJvckV2ZW50LmRlY29kZShyZWFkZXIsIHJlYWRlci51aW50MzIoKSk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAxNToge1xuICAgICAgICAgIGlmICh0YWcgIT09IDEyMikge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2Uuc3RlcFN0YXJ0ZWQgPSBTdGVwU3RhcnRlZEV2ZW50LmRlY29kZShyZWFkZXIsIHJlYWRlci51aW50MzIoKSk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAxNjoge1xuICAgICAgICAgIGlmICh0YWcgIT09IDEzMCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2Uuc3RlcEZpbmlzaGVkID0gU3RlcEZpbmlzaGVkRXZlbnQuZGVjb2RlKHJlYWRlciwgcmVhZGVyLnVpbnQzMigpKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIDE3OiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gMTM4KSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS50ZXh0TWVzc2FnZUNodW5rID0gVGV4dE1lc3NhZ2VDaHVua0V2ZW50LmRlY29kZShyZWFkZXIsIHJlYWRlci51aW50MzIoKSk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAxODoge1xuICAgICAgICAgIGlmICh0YWcgIT09IDE0Nikge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UudG9vbENhbGxDaHVuayA9IFRvb2xDYWxsQ2h1bmtFdmVudC5kZWNvZGUocmVhZGVyLCByZWFkZXIudWludDMyKCkpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAoKHRhZyAmIDcpID09PSA0IHx8IHRhZyA9PT0gMCkge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIHJlYWRlci5za2lwKHRhZyAmIDcpO1xuICAgIH1cbiAgICByZXR1cm4gbWVzc2FnZTtcbiAgfSxcbiAgY3JlYXRlKGJhc2UpIHtcbiAgICByZXR1cm4gRXZlbnQuZnJvbVBhcnRpYWwoYmFzZSAhPSBudWxsID8gYmFzZSA6IHt9KTtcbiAgfSxcbiAgZnJvbVBhcnRpYWwob2JqZWN0KSB7XG4gICAgY29uc3QgbWVzc2FnZSA9IGNyZWF0ZUJhc2VFdmVudCgpO1xuICAgIG1lc3NhZ2UudGV4dE1lc3NhZ2VTdGFydCA9IG9iamVjdC50ZXh0TWVzc2FnZVN0YXJ0ICE9PSB2b2lkIDAgJiYgb2JqZWN0LnRleHRNZXNzYWdlU3RhcnQgIT09IG51bGwgPyBUZXh0TWVzc2FnZVN0YXJ0RXZlbnQuZnJvbVBhcnRpYWwob2JqZWN0LnRleHRNZXNzYWdlU3RhcnQpIDogdm9pZCAwO1xuICAgIG1lc3NhZ2UudGV4dE1lc3NhZ2VDb250ZW50ID0gb2JqZWN0LnRleHRNZXNzYWdlQ29udGVudCAhPT0gdm9pZCAwICYmIG9iamVjdC50ZXh0TWVzc2FnZUNvbnRlbnQgIT09IG51bGwgPyBUZXh0TWVzc2FnZUNvbnRlbnRFdmVudC5mcm9tUGFydGlhbChvYmplY3QudGV4dE1lc3NhZ2VDb250ZW50KSA6IHZvaWQgMDtcbiAgICBtZXNzYWdlLnRleHRNZXNzYWdlRW5kID0gb2JqZWN0LnRleHRNZXNzYWdlRW5kICE9PSB2b2lkIDAgJiYgb2JqZWN0LnRleHRNZXNzYWdlRW5kICE9PSBudWxsID8gVGV4dE1lc3NhZ2VFbmRFdmVudC5mcm9tUGFydGlhbChvYmplY3QudGV4dE1lc3NhZ2VFbmQpIDogdm9pZCAwO1xuICAgIG1lc3NhZ2UudG9vbENhbGxTdGFydCA9IG9iamVjdC50b29sQ2FsbFN0YXJ0ICE9PSB2b2lkIDAgJiYgb2JqZWN0LnRvb2xDYWxsU3RhcnQgIT09IG51bGwgPyBUb29sQ2FsbFN0YXJ0RXZlbnQuZnJvbVBhcnRpYWwob2JqZWN0LnRvb2xDYWxsU3RhcnQpIDogdm9pZCAwO1xuICAgIG1lc3NhZ2UudG9vbENhbGxBcmdzID0gb2JqZWN0LnRvb2xDYWxsQXJncyAhPT0gdm9pZCAwICYmIG9iamVjdC50b29sQ2FsbEFyZ3MgIT09IG51bGwgPyBUb29sQ2FsbEFyZ3NFdmVudC5mcm9tUGFydGlhbChvYmplY3QudG9vbENhbGxBcmdzKSA6IHZvaWQgMDtcbiAgICBtZXNzYWdlLnRvb2xDYWxsRW5kID0gb2JqZWN0LnRvb2xDYWxsRW5kICE9PSB2b2lkIDAgJiYgb2JqZWN0LnRvb2xDYWxsRW5kICE9PSBudWxsID8gVG9vbENhbGxFbmRFdmVudC5mcm9tUGFydGlhbChvYmplY3QudG9vbENhbGxFbmQpIDogdm9pZCAwO1xuICAgIG1lc3NhZ2Uuc3RhdGVTbmFwc2hvdCA9IG9iamVjdC5zdGF0ZVNuYXBzaG90ICE9PSB2b2lkIDAgJiYgb2JqZWN0LnN0YXRlU25hcHNob3QgIT09IG51bGwgPyBTdGF0ZVNuYXBzaG90RXZlbnQuZnJvbVBhcnRpYWwob2JqZWN0LnN0YXRlU25hcHNob3QpIDogdm9pZCAwO1xuICAgIG1lc3NhZ2Uuc3RhdGVEZWx0YSA9IG9iamVjdC5zdGF0ZURlbHRhICE9PSB2b2lkIDAgJiYgb2JqZWN0LnN0YXRlRGVsdGEgIT09IG51bGwgPyBTdGF0ZURlbHRhRXZlbnQuZnJvbVBhcnRpYWwob2JqZWN0LnN0YXRlRGVsdGEpIDogdm9pZCAwO1xuICAgIG1lc3NhZ2UubWVzc2FnZXNTbmFwc2hvdCA9IG9iamVjdC5tZXNzYWdlc1NuYXBzaG90ICE9PSB2b2lkIDAgJiYgb2JqZWN0Lm1lc3NhZ2VzU25hcHNob3QgIT09IG51bGwgPyBNZXNzYWdlc1NuYXBzaG90RXZlbnQuZnJvbVBhcnRpYWwob2JqZWN0Lm1lc3NhZ2VzU25hcHNob3QpIDogdm9pZCAwO1xuICAgIG1lc3NhZ2UucmF3ID0gb2JqZWN0LnJhdyAhPT0gdm9pZCAwICYmIG9iamVjdC5yYXcgIT09IG51bGwgPyBSYXdFdmVudC5mcm9tUGFydGlhbChvYmplY3QucmF3KSA6IHZvaWQgMDtcbiAgICBtZXNzYWdlLmN1c3RvbSA9IG9iamVjdC5jdXN0b20gIT09IHZvaWQgMCAmJiBvYmplY3QuY3VzdG9tICE9PSBudWxsID8gQ3VzdG9tRXZlbnQuZnJvbVBhcnRpYWwob2JqZWN0LmN1c3RvbSkgOiB2b2lkIDA7XG4gICAgbWVzc2FnZS5ydW5TdGFydGVkID0gb2JqZWN0LnJ1blN0YXJ0ZWQgIT09IHZvaWQgMCAmJiBvYmplY3QucnVuU3RhcnRlZCAhPT0gbnVsbCA/IFJ1blN0YXJ0ZWRFdmVudC5mcm9tUGFydGlhbChvYmplY3QucnVuU3RhcnRlZCkgOiB2b2lkIDA7XG4gICAgbWVzc2FnZS5ydW5GaW5pc2hlZCA9IG9iamVjdC5ydW5GaW5pc2hlZCAhPT0gdm9pZCAwICYmIG9iamVjdC5ydW5GaW5pc2hlZCAhPT0gbnVsbCA/IFJ1bkZpbmlzaGVkRXZlbnQuZnJvbVBhcnRpYWwob2JqZWN0LnJ1bkZpbmlzaGVkKSA6IHZvaWQgMDtcbiAgICBtZXNzYWdlLnJ1bkVycm9yID0gb2JqZWN0LnJ1bkVycm9yICE9PSB2b2lkIDAgJiYgb2JqZWN0LnJ1bkVycm9yICE9PSBudWxsID8gUnVuRXJyb3JFdmVudC5mcm9tUGFydGlhbChvYmplY3QucnVuRXJyb3IpIDogdm9pZCAwO1xuICAgIG1lc3NhZ2Uuc3RlcFN0YXJ0ZWQgPSBvYmplY3Quc3RlcFN0YXJ0ZWQgIT09IHZvaWQgMCAmJiBvYmplY3Quc3RlcFN0YXJ0ZWQgIT09IG51bGwgPyBTdGVwU3RhcnRlZEV2ZW50LmZyb21QYXJ0aWFsKG9iamVjdC5zdGVwU3RhcnRlZCkgOiB2b2lkIDA7XG4gICAgbWVzc2FnZS5zdGVwRmluaXNoZWQgPSBvYmplY3Quc3RlcEZpbmlzaGVkICE9PSB2b2lkIDAgJiYgb2JqZWN0LnN0ZXBGaW5pc2hlZCAhPT0gbnVsbCA/IFN0ZXBGaW5pc2hlZEV2ZW50LmZyb21QYXJ0aWFsKG9iamVjdC5zdGVwRmluaXNoZWQpIDogdm9pZCAwO1xuICAgIG1lc3NhZ2UudGV4dE1lc3NhZ2VDaHVuayA9IG9iamVjdC50ZXh0TWVzc2FnZUNodW5rICE9PSB2b2lkIDAgJiYgb2JqZWN0LnRleHRNZXNzYWdlQ2h1bmsgIT09IG51bGwgPyBUZXh0TWVzc2FnZUNodW5rRXZlbnQuZnJvbVBhcnRpYWwob2JqZWN0LnRleHRNZXNzYWdlQ2h1bmspIDogdm9pZCAwO1xuICAgIG1lc3NhZ2UudG9vbENhbGxDaHVuayA9IG9iamVjdC50b29sQ2FsbENodW5rICE9PSB2b2lkIDAgJiYgb2JqZWN0LnRvb2xDYWxsQ2h1bmsgIT09IG51bGwgPyBUb29sQ2FsbENodW5rRXZlbnQuZnJvbVBhcnRpYWwob2JqZWN0LnRvb2xDYWxsQ2h1bmspIDogdm9pZCAwO1xuICAgIHJldHVybiBtZXNzYWdlO1xuICB9XG59O1xuZnVuY3Rpb24gbG9uZ1RvTnVtYmVyKGludDY0KSB7XG4gIGNvbnN0IG51bSA9IGdsb2JhbFRoaXMuTnVtYmVyKGludDY0LnRvU3RyaW5nKCkpO1xuICBpZiAobnVtID4gZ2xvYmFsVGhpcy5OdW1iZXIuTUFYX1NBRkVfSU5URUdFUikge1xuICAgIHRocm93IG5ldyBnbG9iYWxUaGlzLkVycm9yKFwiVmFsdWUgaXMgbGFyZ2VyIHRoYW4gTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVJcIik7XG4gIH1cbiAgaWYgKG51bSA8IGdsb2JhbFRoaXMuTnVtYmVyLk1JTl9TQUZFX0lOVEVHRVIpIHtcbiAgICB0aHJvdyBuZXcgZ2xvYmFsVGhpcy5FcnJvcihcIlZhbHVlIGlzIHNtYWxsZXIgdGhhbiBOdW1iZXIuTUlOX1NBRkVfSU5URUdFUlwiKTtcbiAgfVxuICByZXR1cm4gbnVtO1xufVxuXG4vLyBzcmMvcHJvdG8udHNcbmZ1bmN0aW9uIHRvQ2FtZWxDYXNlKHN0cikge1xuICByZXR1cm4gc3RyLnRvTG93ZXJDYXNlKCkucmVwbGFjZSgvXyhbYS16XSkvZywgKF8sIGxldHRlcikgPT4gbGV0dGVyLnRvVXBwZXJDYXNlKCkpO1xufVxuZnVuY3Rpb24gZW5jb2RlKGV2ZW50KSB7XG4gIGNvbnN0IG9uZW9mRmllbGQgPSB0b0NhbWVsQ2FzZShldmVudC50eXBlKTtcbiAgY29uc3QgeyB0eXBlLCB0aW1lc3RhbXAsIHJhd0V2ZW50LCAuLi5yZXN0IH0gPSBldmVudDtcbiAgaWYgKHR5cGUgPT09IEV2ZW50VHlwZTIuTUVTU0FHRVNfU05BUFNIT1QpIHtcbiAgICByZXN0Lm1lc3NhZ2VzID0gcmVzdC5tZXNzYWdlcy5tYXAoKG1lc3NhZ2UpID0+IHtcbiAgICAgIGNvbnN0IHVudHlwZWRNZXNzYWdlID0gbWVzc2FnZTtcbiAgICAgIGlmICh1bnR5cGVkTWVzc2FnZS50b29sQ2FsbHMgPT09IHZvaWQgMCkge1xuICAgICAgICByZXR1cm4geyAuLi5tZXNzYWdlLCB0b29sQ2FsbHM6IFtdIH07XG4gICAgICB9XG4gICAgICByZXR1cm4gbWVzc2FnZTtcbiAgICB9KTtcbiAgfVxuICBpZiAodHlwZSA9PT0gRXZlbnRUeXBlMi5TVEFURV9ERUxUQSkge1xuICAgIHJlc3QuZGVsdGEgPSByZXN0LmRlbHRhLm1hcCgob3BlcmF0aW9uKSA9PiAoe1xuICAgICAgLi4ub3BlcmF0aW9uLFxuICAgICAgb3A6IEpzb25QYXRjaE9wZXJhdGlvblR5cGVbb3BlcmF0aW9uLm9wLnRvVXBwZXJDYXNlKCldXG4gICAgfSkpO1xuICB9XG4gIGNvbnN0IGV2ZW50TWVzc2FnZSA9IHtcbiAgICBbb25lb2ZGaWVsZF06IHtcbiAgICAgIGJhc2VFdmVudDoge1xuICAgICAgICB0eXBlOiBFdmVudFR5cGVbZXZlbnQudHlwZV0sXG4gICAgICAgIHRpbWVzdGFtcCxcbiAgICAgICAgcmF3RXZlbnRcbiAgICAgIH0sXG4gICAgICAuLi5yZXN0XG4gICAgfVxuICB9O1xuICByZXR1cm4gRXZlbnQuZW5jb2RlKGV2ZW50TWVzc2FnZSkuZmluaXNoKCk7XG59XG5mdW5jdGlvbiBkZWNvZGUoZGF0YSkge1xuICB2YXIgX2E7XG4gIGNvbnN0IGV2ZW50ID0gRXZlbnQuZGVjb2RlKGRhdGEpO1xuICBjb25zdCBkZWNvZGVkID0gT2JqZWN0LnZhbHVlcyhldmVudCkuZmluZCgodmFsdWUpID0+IHZhbHVlICE9PSB2b2lkIDApO1xuICBpZiAoIWRlY29kZWQpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIGV2ZW50XCIpO1xuICB9XG4gIGRlY29kZWQudHlwZSA9IEV2ZW50VHlwZVtkZWNvZGVkLmJhc2VFdmVudC50eXBlXTtcbiAgZGVjb2RlZC50aW1lc3RhbXAgPSBkZWNvZGVkLmJhc2VFdmVudC50aW1lc3RhbXA7XG4gIGRlY29kZWQucmF3RXZlbnQgPSBkZWNvZGVkLmJhc2VFdmVudC5yYXdFdmVudDtcbiAgaWYgKGRlY29kZWQudHlwZSA9PT0gRXZlbnRUeXBlMi5NRVNTQUdFU19TTkFQU0hPVCkge1xuICAgIGZvciAoY29uc3QgbWVzc2FnZSBvZiBkZWNvZGVkLm1lc3NhZ2VzKSB7XG4gICAgICBjb25zdCB1bnR5cGVkTWVzc2FnZSA9IG1lc3NhZ2U7XG4gICAgICBpZiAoKChfYSA9IHVudHlwZWRNZXNzYWdlLnRvb2xDYWxscykgPT0gbnVsbCA/IHZvaWQgMCA6IF9hLmxlbmd0aCkgPT09IDApIHtcbiAgICAgICAgdW50eXBlZE1lc3NhZ2UudG9vbENhbGxzID0gdm9pZCAwO1xuICAgICAgfVxuICAgIH1cbiAgfVxuICBpZiAoZGVjb2RlZC50eXBlID09PSBFdmVudFR5cGUyLlNUQVRFX0RFTFRBKSB7XG4gICAgZm9yIChjb25zdCBvcGVyYXRpb24gb2YgZGVjb2RlZC5kZWx0YSkge1xuICAgICAgb3BlcmF0aW9uLm9wID0gSnNvblBhdGNoT3BlcmF0aW9uVHlwZVtvcGVyYXRpb24ub3BdLnRvTG93ZXJDYXNlKCk7XG4gICAgICBPYmplY3Qua2V5cyhvcGVyYXRpb24pLmZvckVhY2goKGtleSkgPT4ge1xuICAgICAgICBpZiAob3BlcmF0aW9uW2tleV0gPT09IHZvaWQgMCkge1xuICAgICAgICAgIGRlbGV0ZSBvcGVyYXRpb25ba2V5XTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICB9XG4gIE9iamVjdC5rZXlzKGRlY29kZWQpLmZvckVhY2goKGtleSkgPT4ge1xuICAgIGlmIChkZWNvZGVkW2tleV0gPT09IHZvaWQgMCkge1xuICAgICAgZGVsZXRlIGRlY29kZWRba2V5XTtcbiAgICB9XG4gIH0pO1xuICByZXR1cm4gRXZlbnRTY2hlbWFzLnBhcnNlKGRlY29kZWQpO1xufVxuXG4vLyBzcmMvaW5kZXgudHNcbnZhciBBR1VJX01FRElBX1RZUEUgPSBcImFwcGxpY2F0aW9uL3ZuZC5hZy11aS5ldmVudCtwcm90b1wiO1xuZXhwb3J0IHtcbiAgQUdVSV9NRURJQV9UWVBFLFxuICBkZWNvZGUsXG4gIGVuY29kZVxufTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4Lm1qcy5tYXAiXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@ag-ui/proto/dist/index.mjs\n");

/***/ })

};
;